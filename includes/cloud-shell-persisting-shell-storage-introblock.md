# <a name="persist-files-in-azure-cloud-shell"></a>Сохранение файлов в Azure Cloud Shell
Azure Cloud Shell использует хранилище файлов Azure, чтобы хранить файлы между сеансами.

## <a name="set-up-a-clouddrive-file-share"></a>Настроить общую папку clouddrive
При первом запуске Azure Cloud Shell предлагает привязать новый или существующий файловый ресурс, чтобы сохранять файлы между сеансами.

> [!NOTE]
> PowerShell и Bash совместно используют одну и ту же сетевую папку. С функцией автоматического подключения в Cloud Shell можно связать только одну общую папку.

### <a name="create-new-storage"></a>Создание хранилища

Если вы используете базовые параметры и выбрали только подписку, Cloud Shell создаст три ресурса от вашего имени в поддерживаемом регионе, находящемся ближе всего к вам:
* группу ресурсов `cloud-shell-storage-<region>`;
* учетную запись хранения `cs<uniqueGuid>`;
* файловый ресурс `cs-<user>-<domain>-com-<uniqueGuid>`.

![Настройка подписки](../articles/cloud-shell/media/persisting-shell-storage/basic-storage.png)

Файловый ресурс подключается как `clouddrive` в вашем каталоге `$Home`. Подключение выполняется один раз, и для последующих сеансов файловый ресурс подключается автоматически. 

> [!NOTE]
> Для обеспечения безопасности каждому пользователю следует подготовить собственное хранилище.  Для реализации управления доступом на основе ролей (RBAC) пользователи должны иметь права доступа участника или выше.

В Bash общая папка также содержит создаваемый образ размером 5 ГБ для автоматического хранения данных в каталоге `$Home`. 

### <a name="use-existing-resources"></a>Использование существующих ресурсов

С помощью расширенных параметров можно привязать существующие ресурсы. Когда появится запрос на настройку хранилища, щелкните **Показать дополнительные настройки**, чтобы просмотреть дополнительные параметры. Раскрывающиеся меню фильтруются с учетом назначенного региона Cloud Shell и учетных записей локально избыточного и геоизбыточного хранилищ.

В Bash существующие файловые ресурсы получают образ размером 5 ГБ, создаваемый для хранения каталога `$Home`.

![Настройка группы ресурсов](../articles/cloud-shell/media/persisting-shell-storage/advanced-storage.png)

### <a name="restrict-resource-creation-with-an-azure-resource-policy"></a>Ограничение создания ресурсов с помощью политик ресурсов Azure
Учетные записи хранения, создаваемые в Cloud Shell, помечаются тегом `ms-resource-usage:azure-cloud-shell`. Если вы хотите запретить пользователям создавать учетные записи хранения в Cloud Shell, создайте [политику ресурсов Azure на основе тегов](../articles/azure-policy/json-samples.md) для этого конкретного тега.

## <a name="supported-storage-regions"></a>Поддерживаемые регионы хранилища
Связанные учетные записи хранения Azure должны находиться в том же регионе, что и компьютер с Cloud Shell, к которому вы их подключаете.

Вот как можно найти назначенный регион:
* просмотреть примечание в диалоговом окне "Расширенные параметры хранилища";
* просмотреть имя созданной учетной записи хранения (например: `cloud-shell-storage-westus`);
* запустить `env` и найти переменную `ACC_LOCATION`.

Компьютеры с Cloud Shell находятся в следующих регионах:
|Область|Регион|
|---|---|
|Северная и Южная Америка|Восточная часть США, юго-центральный регион США, западная часть США|
|Европа|Северная Европа, Западная Европа|
|Азиатско-Тихоокеанский регион|Центральная Индия, Юго-Восточная Азия|

