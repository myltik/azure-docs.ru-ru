---
title: "Планировщик ресурсов Azure Site Recovery для сценариев развертывания виртуальных машин VMware в Azure | Документация Майкрософт"
description: "Руководство по использованию планировщика ресурсов Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 12/04/2017
ms.author: nisoneji
ms.openlocfilehash: 0910d5802d64ca637b3ecd1e392a6df8629c7f25
ms.sourcegitcommit: 922687d91838b77c038c68b415ab87d94729555e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2017
---
# <a name="azure-site-recovery-deployment-planner-for-vmware-to-azure"></a>Планировщик развертывания Azure Site Recovery для сценариев развертывания виртуальных машин VMware в Azure
В этой статье приведены рекомендации по использованию планировщика развертывания Azure Site Recovery в сценариях рабочих развертываний виртуальных машин VMware в Azure.

## <a name="overview"></a>Обзор

Перед установкой защиты виртуальных машин VMware с помощью Site Recovery выделите достаточный объем пропускной способности в зависимости от частоты ежедневного изменения данных в соответствии с требуемой целевой точкой восстановления (RPO). В локальной среде необходимо развернуть нужное число серверов конфигурации и обработки.

Кроме того, необходимо создать требуемое количество целевых учетных записей хранения Azure соответствующего типа (класса Standard или Premium), учитывая рост нагрузки на исходные рабочие серверы из-за более активного их использования в будущем. Тип хранилища определяется для каждой виртуальной машины на основе особенностей рабочей нагрузки (количества операций записи и чтения на диск в секунду, активности обработки данных) и ограничений Azure Site Recovery.

Планировщик развертывания Azure Site Recovery (версия 2) — это программа командной строки, доступная для сценариев аварийного восстановления виртуальных машин Hyper-V в Azure и VMware в Azure. Эта программа позволяет выполнить удаленное профилирование виртуальных машин VMware (никоим образом не влияя на рабочий процесс), чтобы оценить требования к пропускной способности и службе хранилища Azure для успешной репликации и отработки отказа. Вы можете запустить эту программу, не устанавливая в локальной среде каких-либо дополнительных компонентов Site Recovery. Однако чтобы получить более точные сведения о пропускной способности, мы рекомендуем запустить планировщик ресурсов на виртуальной машине Windows Server, соответствующей минимальным требованиям сервера конфигурации Site Recovery, который в конечном итоге потребуется развернуть на одном из первых этапов рабочего развертывания.

Эта программа предоставляет указанные ниже сведения.

**Оценка совместимости**

* Оценка соответствия виртуальной машины требованиям в зависимости от количества дисков, их размера, числа операций ввода-вывода в секунду, активности обработки данных, типа загрузки (EFI/BIOS) и версии ОС.
 
**Оценка пропускной способности сети и целевой точки восстановления**

* Расчетное значение пропускной способности, необходимой для разностной репликации.
* Пропускная способность, которую может получить Site Recovery при репликации данных из локальной среды в Azure.
* Количество виртуальных машин, которое можно включить в пакет, на основе расчетного значения пропускной способности для завершения начальной репликации в указанный промежуток времени.
* Целевая точка восстановления, которая может быть достигнута при указанной пропускной способности.
* Влияние низкой пропускной способности на требуемую целевую точку восстановления.

**Требования к инфраструктуре Azure**

* Требование к типу хранилища (хранилище класса Standard или Premium) каждой виртуальной машины.
* Общее число учетных записей хранения уровня Standard или Premium, которое необходимо настроить для репликации.
* Именование учетных записей хранения в соответствии с рекомендациями к службе хранилища Azure.
* Размещение учетной записи хранения каждой виртуальной машины.
* Число ядер Azure, которое необходимо настроить перед отработкой отказа или тестовой отработкой отказа, на подписку.
* Рекомендуемый размер виртуальной машины Azure для каждой локальной виртуальной машины.

**Требования к локальной инфраструктуре**
* Число серверов конфигурации и серверов обработки, которые необходимо развернуть в локальной среде.

**Оценочные затраты на аварийное восстановление в Azure:**
* оценочные общие затраты на аварийное восстановление в Azure: затраты на вычисление, хранение, сети и лицензии Azure Site Recovery;
* подробный анализ затрат для каждой виртуальной машины.


>[!IMPORTANT]
>
>При выполнении вычислений в программе использовался 30%-ный коэффициент роста характеристик рабочей нагрузки (из-за возможного роста использования со временем) и 95-й процентиль всех метрик профилирования (число операций записи и чтения в секунду, активность обработки данных и т. д.). Оба эти элемента (коэффициент роста и используемый процентиль) можно изменить. Дополнительные сведения о коэффициенте роста и используемом процентиле см. в разделе "Рекомендации по коэффициенту роста" и "Значение процентиля, используемое для вычисления".
>

## <a name="support-matrix"></a>Матрица поддержки

| | **VMware в VMware** |**Hyper-V в Azure**|**Из Azure в Azure**|**Из Hyper-V на дополнительный сайт**|**Из VMware на дополнительный сайт**
--|--|--|--|--|--
Поддерживаемые сценарии использования. |Да|Да|Нет|Да*|Нет
Поддерживаемая версия | vCenter 6.5, 6.0 или 5.5| Windows Server 2016, Windows Server 2012 R2 | Нет данных |Windows Server 2016, Windows Server 2012 R2|Нет данных
Поддерживаемая конфигурация|vCenter, ESXi| Кластер Hyper-V, узел Hyper-V|Нет данных|Кластер Hyper-V, узел Hyper-V|Нет данных|
Число серверов, которые можно профилировать для каждого запущенного экземпляра планировщика развертывания Azure Site Recovery. |Один (одновременно можно профилировать виртуальные машины на одном сервере vCenter Server или ESXi)|Несколько (одновременно можно профилировать виртуальные машины на нескольких узлах или кластерах узлов)| Нет данных |Несколько (одновременно можно профилировать виртуальные машины на нескольких узлах или кластерах узлов)| Нет данных

*Это средство в первую очередь предназначено для сценария аварийного восстановления виртуальных машин Hyper-V в Azure. При аварийном восстановлении виртуальных машин Hyper-V на вторичный сайт это средство может использоваться только для того, чтобы получить рекомендации на стороне источника, такие как необходимая пропускная способность сети, требуемое свободное место на каждом исходном сервере Hyper-V, а также количество необходимых операций пакетной обработки и определения пакетов для начальной репликации.  Пропустите рекомендации и сведения о затратах на Azure в отчете. Кроме того, операция оценки пропускной способности не применяется в сценариях аварийного восстановления виртуальных машин Hyper-V на вторичный сайт.

## <a name="prerequisites"></a>Предварительные требования
Программа выполняет два основных действия: осуществляет профилирование и создает отчет. С ее помощью также можно оценить пропускную способность. В таблице ниже приведены требования к серверу, на котором инициируется профилирование и измерение пропускной способности.

| Требование к серверу | Описание|
|---|---|
|Профилирование и измерение пропускной способности| <ul><li>Операционная система: Microsoft Windows Server 2016 или Microsoft Windows Server 2012 R2<br>(в идеале соответствует [рекомендациям по размеру сервера конфигурации](https://aka.ms/asr-v2a-on-prem-components)).</li><li>Конфигурация виртуальной машины: 8 виртуальных ЦП, 16 ГБ ОЗУ, жесткий диск емкостью 300 ГБ.</li><li>[Microsoft .NET Framework 4.5](https://aka.ms/dotnet-framework-45)</li><li>[VMware vSphere PowerCLI 6.0 R3](https://aka.ms/download_powercli).</li><li>[Распространяемый компонент Microsoft Visual C++ для Visual Studio 2012](https://aka.ms/vcplusplus-redistributable).</li><li>Интернет-доступ к Azure с этого сервера.</li><li>Учетная запись хранения Azure.</li><li>Права администратора на доступ к серверу.</li><li>Минимальное свободное место на диске: 100 ГБ (предполагается, что профилирование 1000 виртуальных машин в среднем с 3 дисками на каждую выполняется 30 дней).</li><li>Параметрам уровня статистики vCenter VMware необходимо присвоить значение 2 или выше.</li><li>Разрешение порта 443: планировщик развертывания ASR использует этот порт для подключения к серверу vCenter или узлу ESXi</ul></ul>|
| Создание отчетов. | Любой компьютер с Windows или Windows Server с Microsoft Excel 2013 или более поздней версии. |
| Разрешения пользователя | Разрешение только на чтение для учетной записи пользователя, используемой для доступа к серверу VMware vCenter Server или узлу VMware vSphere ESXi во время профилирования. |

> [!NOTE]
>
>Эта программа позволяет профилировать только виртуальные машины с дисками VMDK и RDM и не поддерживает диски iSCSI или NFS. Site Recovery поддерживает диски iSCSI и NFS для серверов VMware, но так как планировщик ресурсов запущен не в гостевой ОС и выполняет профилирование только на основе показателей счетчиков производительности vCenter, он не видит диски этого типа.
>

## <a name="download-and-extract-the-deployment-planner-tool"></a>Скачивание и извлечение планировщика развертывания
1. Скачайте последнюю версию [планировщика ресурсов Azure Site Recovery](https://aka.ms/asr-deployment-planner).  
Эта программа упакована в формате ZIP. Текущая ее версия поддерживает только сценарии развертывания виртуальных машин VMware в Azure.

2. Скопируйте ZIP-папку на сервер Windows Server, на котором необходимо запустить программу.  
Вы можете запустить планировщик на любом сервере Windows Server 2012 R2, имеющем сетевой доступ к vCenter Server или узлу vSphere ESXi, в котором содержатся виртуальные машины, профилирование которых необходимо выполнить. Но мы советуем запускать эту программу на сервере, конфигурация оборудования которого соответствует [рекомендациям по размеру сервера конфигурации](https://aka.ms/asr-v2a-on-prem-components). Если вы уже развернули компоненты Site Recovery в локальной среде, запустите программу на сервере конфигурации.

 При одинаковых конфигурациях оборудования сервера, рекомендуемого для запуска программы, и сервера конфигурации (со встроенным сервером обработки) пропускная способность, сведения о которой получены с помощью планировщика, будет соответствовать фактической пропускной способности, которой Site Recovery может добиться во время репликации. Значение пропускной способности зависит от доступной пропускной способности сети и конфигурации оборудования сервера (ЦП, хранилище и т. д.). При запуске программы на другом сервере пропускная способность вычисляется при передаче из этого сервера в Microsoft Azure. Кроме того, конфигурация оборудования на этом сервере и на сервере конфигурации может отличаться. И поэтому значение достигаемой пропускной способности, полученное с помощью этой программы, будет неточным.

3. Распакуйте ZIP-папку.  
Папка содержит несколько файлов и вложенных папок. Исполняемый файл ASRDeploymentPlanner.exe находится в родительской папке.

    Пример:  
    Скопируйте ZIP-файл в папку E:\ drive и распакуйте его.
   E:\ASR Deployment Planner_v2.0zip

    E:\ASR Deployment Planner_v2.0\ASRDeploymentPlanner.exe

### <a name="updating-to-the-latest-version-of-deployment-planner"></a>Обновление планировщика развертывания до последней версии
Если установлена предыдущая версия планировщика развертывания, выполните одно из следующих действий:
 * Если в последней версии нет исправления профилирования и оно уже выполняется, вам не нужно останавливать его.
 * Если в последней версии есть исправления профилирования, мы рекомендуем остановить профилирование, выполняемое в текущей версии, и запустить его с использованием новой версии.


 >[!NOTE]
 >
 >При запуске профилирования с использованием новой версии передайте тот же путь к выходному каталогу, который будет использоваться средством для добавления данных профиля в существующие файлы. При создании отчетов будет использоваться полный набор данных профилирования. Если передать разные выходные каталоги, то создадутся файлы, а старые данные профилирования нельзя будет использовать при создании отчета.
 >
 >Каждое обновление планировщика ресурсов с использованием ZIP-файла является накопительным. Не нужно копировать файлы новой версии в папку со старой версией. Вы можете создать и использовать папку.

## <a name="next-steps"></a>Дальнейшие действия
* [Запуск планировщика развертывания](site-recovery-vmware-deployment-planner-run.md).
