---
title: "Диагностика и устранение неполадок в среде службы \"Аналитика временных рядов\" | Документация Майкрософт"
description: "В этой статье описываются способы диагностики, устранения неполадок и решения распространенных проблем, с которыми вы можете столкнуться в среде службы \"Аналитика временных рядов Azure\"."
services: time-series-insights
ms.service: time-series-insights
author: venkatgct
ms.author: venkatja
manager: jhubbard
editor: MicrosoftDocs/tsidocs
ms.reviewer: v-mamcge, jasonh, kfile, anshan
ms.workload: big-data
ms.topic: troubleshooting
ms.date: 11/15/2017
ms.openlocfilehash: 757d37183ad334aca462af59bad261cfa686299e
ms.sourcegitcommit: 62eaa376437687de4ef2e325ac3d7e195d158f9f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2017
---
# <a name="diagnose-and-solve-problems-in-your-time-series-insights-environment"></a>Диагностика и устранение неполадок в среде Time Series Insights

## <a name="problem-1-no-data-is-shown"></a>Проблема 1. Данные не отображаются
Существует несколько причин, по которым данные могут не отображаться в [обозревателе службы "Аналитика временных рядов Azure"](https://insights.timeseries.azure.com).

### <a name="possible-cause-a-event-source-data-is-not-in-json-format"></a>Возможная причина А: данные источника события не в формате JSON
Среда службы "Аналитика временных рядов Azure" поддерживает только данные в формате JSON. Примеры JSON см. в разделе [Поддерживаемые формы JSON](time-series-insights-send-events.md#supported-json-shapes).

### <a name="possible-cause-b-event-source-key-is-missing-a-required-permission"></a>Возможная причина Б: для ключа источника события отсутствует необходимое разрешение
* Для Центра Интернета вещей необходимо указать ключ с разрешением на **подключение службы**.

   ![Разрешение на подключение службы Центра Интернета вещей](media/diagnose-and-solve-problems/iothub-serviceconnect-permissions.png)

   Как показано на предыдущем рисунке, можно использовать политику **iothubowner** или **service**, так как обеим назначено разрешение на **подключение службы**.
   
* Для концентратора событий необходимо указать ключ с разрешением на **прослушивание**.

   ![Разрешение на прослушивание концентратора событий](media/diagnose-and-solve-problems/eventhub-listen-permissions.png)

   Как показано на предыдущем рисунке, можно использовать политику **read** или **manage**, так как обеим назначено разрешение на **прослушивание**.

### <a name="possible-cause-c-the-consumer-group-provided-is-not-exclusive-to-time-series-insights"></a>Возможная причина В: указанная группа получателей не является уникальной для службы "Аналитика временных рядов".
Во время регистрации центра Интернета вещей или концентратора событий нужно указать группу получателей, которая будет использоваться для чтения данных. Эта группа получателей **не** должна быть общей. Иначе базовый концентратор событий автоматически отключит один из модулей чтения в случайном порядке. Укажите уникальную группу получателей, из которой должна считывать данные среда службы "Аналитика временных рядов".

## <a name="problem-2-some-data-is-shown-but-some-is-missing"></a>Проблема 2. Некоторые данные отображаются, но другие отсутствуют
Если данные отображаются частично и с задержкой, возможны несколько причин.

### <a name="possible-cause-a-your-environment-is-getting-throttled"></a>Возможная причина А: выполняется регулирование среды
Ограничение регулирования применяется на основе типа номера SKU и емкости среды. Все источники событий в среде совместно используют емкость. Если источник событий Центра Интернета вещей или концентратора событий превышает ограничение объема передаваемых данных, наблюдается регулирование и задержка.

На снимке экрана ниже показана среда Time Series Insights с номером SKU S1 и емкостью 3. Она может принимать 3 миллиона событий в день.

![Текущая емкость номера SKU среды](media/diagnose-and-solve-problems/environment-sku-current-capacity.png)

Например, предположим, что эта среда принимает сообщения от концентратора событий. Изучите скорость входящих данных, показанную на следующей схеме:

![Пример скорости входящих данных для концентратора событий](media/diagnose-and-solve-problems/eventhub-ingress-rate.png)

Как показано на схеме, ежедневная частота приема составляет около 67 000 сообщений. При этом передается примерно 46 сообщений в минуту. Если все сообщения концентратора событий свести к одному событию Time Series Insights, станет понятно, что в этой среде ничего не регулируется. Если все сообщения концентратора событий свести к 100 событиям Time Series Insights, каждую минуту будет передаваться по 4600 событий. Среда с номером SKU S1 и емкостью 3 может принимать только 2100 событий в минуту (1 миллион событий в день = 700 событий в минуту на 3 единицы = 2100 событий в минуту). Поэтому из-за регулирования происходит задержка. 

Подробные сведения о логике сведения см. в разделе [Поддерживаемые формы JSON](time-series-insights-send-events.md#supported-json-shapes).

### <a name="recommended-resolution-steps-for-excessive-throttling"></a>Рекомендуемые действия по устранению проблемы чрезмерного регулирования
Чтобы устранить задержку, увеличьте емкость номера SKU среды. Дополнительные сведения см. в статье [Как масштабировать среду Azure Time Series Insights](time-series-insights-how-to-scale-your-environment.md).

### <a name="possible-cause-b-initial-ingestion-of-historical-data-is-causing-slow-ingress"></a>Возможная причина Б: начальное получение исторических данных приводит к медленному их поступлению
Если вы подключаете существующий источник событий, скорее всего, в Центре Интернета вещей или концентраторе событий уже есть данные. Среда начинает извлекать данные, как только сообщения источника событий начинают сохраняться.

Это поведение по умолчанию, которое невозможно переопределить. Вы можете включить регулирование, поэтому обработка архивных данных может занять некоторое время.

#### <a name="recommended-resolution-steps-of-large-initial-ingestion"></a>Рекомендуемые действия по разрешению проблемы большого объема начального получения
Чтобы устранить задержку, выполните следующие действия.
1. Увеличьте емкость номера SKU до максимально допустимого значения (в этом случае — 10). После увеличения емкости прием данных ускорится. Значение ускорения можно увидеть в таблице доступности в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com). Плата взимается за увеличенную емкость.
2. Устранив задержку, уменьшите емкость номера SKU до нормального уровня приема.

## <a name="problem-3-my-event-sources-timestamp-property-name-setting-doesnt-work"></a>Проблема 3. Параметр *имени свойства метки времени* источника события не работает
Убедитесь, что имя и значение соответствуют следующим правилам:
* В имени свойства метки времени _учитывается регистр_.
* Так как значение свойства метки времени из источника событий является строкой JSON, оно должно иметь формат _гггг-мм-ддТчч:мм:сс.FFFFFFFK_. Например 2008-04-12T12:53Z.

## <a name="next-steps"></a>Дополнительная информация
- Чтобы получить помощь по этим темам, начните дискуссию на [форуме MSDN](https://social.msdn.microsoft.com/Forums/home?forum=AzureTimeSeriesInsights) или [Stack Overflow](https://stackoverflow.com/questions/tagged/azure-timeseries-insights). 
- Также вы можете обратиться в [службу поддержки Azure](https://azure.microsoft.com/support/options/).
