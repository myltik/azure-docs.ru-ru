---
title: Как добавить источник событий Центра Интернета вещей в службу "Аналитика временных рядов Azure" | Документация Майкрософт
description: Из этой статьи вы узнаете, как добавить в среду службы "Аналитика временных рядов" источник событий, подключенный к Центру Интернета вещей.
ms.service: time-series-insights
services: time-series-insights
author: sandshadow
ms.author: edett
manager: jhubbard
ms.reviewer: v-mamcge, jasonh, kfile, anshan
ms.workload: big-data
ms.topic: conceptual
ms.date: 11/21/2017
ms.openlocfilehash: 01ab5017a5f16a0c46ea2bc600cef6bbf81de963
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34652531"
---
# <a name="how-to-add-an-iot-hub-event-source-to-time-series-insights-environment"></a>Как добавить в среду службы "Аналитика временных рядов Azure" источник событий Центра Интернета вещей
Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов" источник события, который считывает данные из Центра Интернета вещей.

## <a name="prerequisites"></a>предварительным требованиям
- Создайте среду "Аналитика временных рядов". Дополнительные сведения см. в статье о [создании среды службы "Аналитика временных рядов" на портале Azure](time-series-insights-get-started.md). 
- Создайте Центр Интернета вещей. Дополнительные сведения о Центрах Интернета вещей см. в статье [Создание Центра Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
- В Центр Интернета вещей должны отправляться активные события сообщений.
- Создайте в Центре Интернета вещей выделенную группу потребителей, из которой среда службы "Аналитика временных рядов" будет получать информацию. Каждый источник событий "Аналитика временных рядов" должен иметь собственную выделенную группу потребителей, не используемую другими потребителями. Если несколько модулей чтения используют события из одной группы потребителей, как правило, во всех модулях могут произойти сбои. Дополнительные сведения см. в статье [Руководство разработчика для Центра Интернета вещей Azure](../iot-hub/iot-hub-devguide.md).

## <a name="add-a-new-event-source"></a>Добавление нового источника событий
1. Войдите на [портале Azure](https://portal.azure.com).

2. Найдите существующую среду "Аналитика временных рядов". На портале Azure щелкните **All resources** (Все ресурсы) в меню слева. Выберите среду Time Series Insights.

3. В разделе **Топология окружения** щелкните **Источники событий**.
   ![Добавление источников событий](media/time-series-insights-how-to-add-an-event-source-iothub/1-event-sources.png)

4. Щелкните **+ Добавить**.

5. Укажите **Имя источника событий**, уникальное для этой среды "Аналитика временных рядов", например **event-stream**.

   ![Укажите значения для первых трех параметров в форме.](media/time-series-insights-how-to-add-an-event-source-iothub/2-import-option.png)

6. Для параметра **Источник** укажите значение **Центр Интернета вещей**.

7. Выберите подходящий **Вариант импорта**. 
   - Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть Центр Интернета вещей. Это самый простой подход.
   - Выберите **Указать параметры Центра Интернета вещей вручную**, если нужный Центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры. 

8. Если вы выбрали вариант **Использовать Центр Интернета вещей в доступных подписках**, укажите обязательные свойства, которые описаны в следующей таблице.

   ![Сведения о подписке и Центре Интернета вещей](media/time-series-insights-how-to-add-an-event-source-iothub/3-new-event-source.png)

   | Свойство | ОПИСАНИЕ |
   | --- | --- |
   | Идентификатор подписки | Выберите подписку, в которой был создан этот Центр Интернета вещей.
   | Имя Центра Интернета вещей | Выберите имя центра Интернета вещей.
   | Имя политики Центра Интернета вещей | Выберите политику общего доступа, которую можно найти на вкладке "Параметры" Центра Интернета вещей. Каждой политике общего доступа присваивается имя, а также для нее задаются разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**.
   | Ключ политики Центра Интернета вещей | Ключ указывается автоматически.
   | Группа потребителей Центра Интернета вещей | Группа потребителей для чтения событий из Центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу потребителей для источника событий.
   | Формат сериализации событий | JSON — сейчас это единственная доступная сериализация. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
   | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в Центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если не указывать значение, в качестве метки времени для события будет использовано **время постановки события в очередь** в источнике событий. |

9. Если вы выбрали вариант **Указать параметры Центра Интернета вещей вручную**, укажите обязательные свойства, которые описаны в следующей таблице:

   | Свойство | ОПИСАНИЕ |
   | --- | --- |
   | Идентификатор подписки | Подписка, в которой был создан этот Центр Интернета вещей.
   | Группа ресурсов | Имя группы ресурсов, в которой создан этот Центр Интернета вещей.
   | Имя Центра Интернета вещей | Имя Центра Интернета вещей. При создании Центра Интернета вещей вы присваиваете ему определенное имя.
   | Имя политики Центра Интернета вещей | Политика общего доступа, которую можно создать на вкладке "Параметры" Центра Интернета вещей. Каждой политике общего доступа присваивается имя, а также для нее задаются разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**.
   | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен службы "Служебная шина". Введите первичный или вторичный ключ здесь.
   | Группа потребителей Центра Интернета вещей | Группа потребителей для чтения событий из Центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу потребителей для источника событий.
   | Формат сериализации событий | JSON — сейчас это единственная доступная сериализация. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
   | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в Центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время включения события в очередь** в пределах источника событий. |

10. Выберите **Создать**, чтобы добавить новый источник событий.

   ![Нажмите кнопку "Создать"](media/time-series-insights-how-to-add-an-event-source-iothub/4-create-button.png)

   После создания источника событий Time Series Insights автоматически запустит передачу данных в среду.

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей
Группы потребителей используются приложениями для извлечения данных из Центров Интернета вещей Azure. Создайте отдельную группу потребителей, которая будет использоваться только в этой среде службы "Аналитика временных рядов", чтобы обеспечить надежность взаимодействия с Центром Интернета вещей.

Чтобы добавить группу потребителей в Центр Интернета вещей, сделайте следующее.
1. На портале Azure найдите и откройте Центр Интернета вещей.

2. В разделе **Обмен сообщениями** выберите **Конечные точки**. 

   ![Создание группы потребителей](media/time-series-insights-how-to-add-an-event-source-iothub/5-add-consumer-group.png)

3. Выберите конечную точку **События**. Откроется страница **Свойства**.

4. В области **Группы потребителей** укажите новое уникальное имя для группы потребителей. Укажите это же имя при настройке нового источника событий в среде службы "Аналитика временных рядов".

5. Щелкните **Сохранить**, чтобы сохранить новую группу потребителей.

## <a name="next-steps"></a>Дополнительная информация
- [Определите политики доступа к данным](time-series-insights-data-access.md), чтобы защитить ваши данные.
- [Отправьте события](time-series-insights-send-events.md) в источник событий.
- Получите доступ к своей среде в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com).
