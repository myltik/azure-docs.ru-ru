---
title: Рекомендации для предприятий, переходящих на использование Azure | Документация Майкрософт
description: Описывается каркас, который предприятия могут использовать, чтобы обеспечить безопасную и управляемую среду.
services: azure-resource-manager
documentationcenter: na
author: rdendtler
manager: timlt
editor: tysonn
ms.assetid: 8692f37e-4d33-4100-b472-a8da37ce628f
ms.service: azure-resource-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/31/2017
ms.author: rodend;karlku;tomfitz
ms.openlocfilehash: 02553bb59cb37bab21d53adafc42fddcf08795a7
ms.sourcegitcommit: 6fcd9e220b9cd4cb2d4365de0299bf48fbb18c17
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2018
---
# <a name="azure-enterprise-scaffold---prescriptive-subscription-governance"></a>Корпоративный каркас Azure: рекомендуемая система управления подписками
Предприятия все чаще внедряют общедоступное облако ввиду его гибкости и динамичности. Они используют преимущества облака для создания дохода или оптимизации ресурсов для бизнеса. Microsoft Azure предоставляет множество служб, из которых как из строительных блоков предприятия могут конструировать решения для широкого спектра рабочих нагрузок и приложений. 

Но нередко сложно понять, откуда следует начинать. После выбора Azure часто возникает несколько вопросов:

* "Как соблюсти местные нормативные требования к независимости данных в некоторых странах?"
* "Как гарантировать, что никто случайно не изменит критически важную систему?"
* "Как узнать, что обеспечивает тот или иной ресурс, чтобы учесть его и правильно добавить в счет?"

Перспектива пустой подписки без какой-либо защиты пугает. Этот пробел может помешать перемещению в Azure.

Эта статья служит отправной точкой для технических специалистов и посвящена балансу требований управления и гибкости. В ней вводится понятие корпоративного каркаса, который помогает организациям при внедрении подписок Azure и управлении ими. 

## <a name="need-for-governance"></a>Требования управления
При перемещении в Azure необходимо заблаговременно рассмотреть вопрос управления, чтобы обеспечить успешное использование облака на предприятии. К сожалению, нехватка времени и волокита, связанная с созданием комплексной системы управления, приводят к тому, что некоторые рабочие группы сразу идут к поставщикам, не привлекая ИТ-отдел предприятия. Такой подход может оставить предприятие уязвимым, если управление ресурсами осуществляется неправильно. Характеристики общедоступного облака — гибкость, динамичность и стоимость на основе использования — важны для бизнес-групп, которым нужно быстро удовлетворять потребности клиентов (внутренних и внешних). Но ИТ-отделу предприятия нужно убедиться в эффективной защите данных и систем.

В реальной жизни для создания основы каркаса используется формирование шаблонов. Каркас обеспечивает общую структуру и предоставляет точки привязки, к которым можно присоединить более постоянные системы. Корпоративный каркас ничем не отличается: это набор гибких элементов управления и возможностей Azure, обеспечивающих структуру среды, и привязок для служб на основе общедоступного облака. Он предоставляет разработчикам (ИТ-отделам и бизнес-группам) основу для создания и присоединения новых служб.

В основе каркаса лежат рекомендации, полученные при сотрудничестве с клиентскими организациями различных размеров. Мы работали с разными клиентами, от небольших организаций, разрабатывающих решения в облаке, до предприятий из списка Fortune 500 и независимых поставщиков программного обеспечения, которые переходят на использование облака и разрабатывают решения в нем. Гибкость корпоративного каркаса предназначена для поддержки традиционных рабочих нагрузок ИТ и гибких рабочих нагрузок. Например, ее преимуществами могут воспользоваться разработчики, создающие приложения SaaS на основе возможностей Azure.

Корпоративный каркас предназначен стать основой каждой новой подписки в Azure. Он позволяет администраторам гарантировать, что рабочие нагрузки соответствуют минимальным требованиям управления организации, не мешая бизнес-группам и разработчикам быстро достигать собственных целей.

> [!IMPORTANT]
> Управление крайне важно для успешной работы Azure. В этой статье рассматривается техническая реализация корпоративного каркаса, но только затрагивается более широкий процесс и связи между компонентами. Политики управления действуют сверху вниз и определяются целями бизнеса. Естественно, в создании модели управления для Azure участвуют представители ИТ-отдела, но, что более важно, в нем должны активно участвовать представители руководителей бизнес-групп, а также специалисты по безопасности и управлению рисками. В конечном счете задача корпоративного каркаса — уменьшить бизнес-риски и помочь в выполнении миссии и достижении целей организации.
> 
> 

На рисунке ниже приведены компоненты каркаса. В основе лежит надежный план для отделов, учетных записей и подписок. Опорами служат политики Resource Manager и строгие стандарты именования. Остальная часть каркаса состоит из основных возможностей и функций Azure, обеспечивающих безопасную и управляемую среду.

![Компоненты каркаса](./media/resource-manager-subscription-governance/components.png)

> [!NOTE]
> После появления в 2008 году среда Azure быстро распространилась и выросла в размерах. Этот рост потребовал от инженеров Майкрософт пересмотреть подход к управлению службами и их развертыванию. В 2014 году на смену классической модели развертывания пришла модель Azure Resource Manager. Resource Manager позволяет организациям легко развертывать, упорядочивать ресурсы и управлять ими в Azure. Resource Manager обеспечивает распараллеливание при создании ресурсов, что ускоряет развертывание сложных, взаимозависимых решений. Он также предоставляет детализированное управление доступом и возможность помечать ресурсы метаданными. Корпорация Майкрософт рекомендует создавать все ресурсы, используя модель Resource Manager. Корпоративный каркас специально разработан для модели Resource Manager.
> 
> 

## <a name="define-your-hierarchy"></a>Определение иерархии
Основой каркаса является Соглашение о регистрации Azure Enterprise (и корпоративный портал). Соглашение о регистрации Enterprise определяет форму и использование служб Azure в компании и является основной структурой управления. В рамках Соглашения о регистрации Enterprise клиенты могут дополнительно разделить среду на отделы, учетные записи и, наконец, подписки. Подписка Azure представляет собой базовую единицу, в которой содержатся все ресурсы. Она также определяет несколько ограничений в Azure, в том числе количество ядер, ресурсов и т. д.

![Иерархия](./media/resource-manager-subscription-governance/agreement.png)

Все предприятия разные, и иерархия на предыдущем рисунке обеспечивает значительную гибкость в организации ресурсов Azure компании. Перед реализацией рекомендаций, содержащихся в этом документе, необходимо смоделировать иерархию и понять, как она влияет на выставление счетов, доступ к ресурсам и сложность.

Ниже представлены три распространенных шаблона для Соглашений о регистрации Azure Enterprise.

* **Функциональной** шаблон.
  
    ![functional](./media/resource-manager-subscription-governance/functional.png)
* Шаблон **подразделения**. 
  
    ![Подразделение](./media/resource-manager-subscription-governance/business.png)
* **Географической** шаблон.
  
    ![Географический](./media/resource-manager-subscription-governance/geographic.png)

Каркас применяется на уровне подписки, чтобы распространить на нее требования управления предприятия.

## <a name="naming-standards"></a>Стандарты именования
Первой опорой каркаса являются стандарты именования. Хорошо спроектированные стандарты именования позволяют определять ресурсы на портале, в счете и в сценариях. Скорее всего, у вас уже есть стандарты именования для локальной инфраструктуры. При добавлении Azure в свою среду следует распространить эти стандарты именования на ресурсы Azure. Стандарт именования упрощает и делает более эффективным управление средой на всех уровнях.

> [!TIP]
> Для соглашений об именовании:
> * Ознакомьтесь с [руководством по шаблонам и рекомендациями](../guidance/guidance-naming-conventions.md) и применяйте полученные знания, где это уместно. Это руководство поможет выбрать информативный стандарт именования.
> * Используйте шаблон camelCasing для имен ресурсов (например, мояГруппаРесурсов и имяВиртуальнойСети). Примечание. Существуют некоторые ресурсы, в том числе учетные записи хранения, для которых можно использовать только нижний регистр (без каких-либо специальных знаков).
> * Рассмотрите возможность использования политик Azure Resource Manager (как описано в следующем разделе) для применения стандартов именования.
> 
> Приведенные выше советы помогут вам реализовать единое соглашение об именовании.

## <a name="policies-and-auditing"></a>Политики и аудит
Вторая опора каркаса включает в себя создание [политик Azure](../azure-policy/azure-policy-introduction.md) и [аудит журнала действий](resource-group-audit.md). Политики Resource Manager дают возможность управлять рисками в Azure. Можно определить политики, которые гарантируют независимость данных путем ограничения, применения или аудита определенных действий. 

* Политика — это система **разрешений** по умолчанию. Вы контролируете действия, определяя и назначая для ресурсов политики, которые запрещают действия с этими ресурсами или осуществляют аудит этих действий.
* Политики описываются определениями политик на языке определения политик (с условиями if-then).
* Политики создаются в виде файлов в формате JSON (нотация объектов JavaScript). После определения политики ее можно назначить определенной области: подписке, группе ресурсов или ресурсу.

В политиках указывается множество действий, которые позволяют детализировать реализуемые сценарии. Доступны следующие действия:

* **Deny**: блокирует запрос ресурса;
* **Audit**: разрешает запрос, но добавляет строку в журнал действий (который может использоваться для отображения предупреждений или активации модулей Runbook).
* **Append**: добавляет указанные сведения в ресурс. Например, если у ресурса нет тега CostCenter, политика добавляет этот тег со значением по умолчанию.

### <a name="common-uses-of-resource-manager-policies"></a>Распространенные примеры использования политик Resource Manager
Политики Azure Resource Manager — это мощный инструмент из набора средств Azure. Они позволяют избежать непредвиденных расходов, выявить место возникновения затрат для ресурсов с помощью тегов и обеспечить соблюдение требований соответствия. А если совместить политики со встроенными функциями аудита, то можно создавать сложные и гибкие решения. Политики позволяют компаниям предоставлять элементы управления для традиционных рабочих нагрузок ИТ и гибких рабочих нагрузок, например, разработки приложений для клиентов. Ниже перечислены наиболее распространенные шаблоны использования политик, которые мы предусматриваем.

* **Географическое соответствие и независимость данных**. Azure предоставляет регионы по всему миру. Предприятиям часто требуется контролировать место создания ресурсов (чтобы обеспечить независимость данных или просто для того, чтобы ресурсы создавались близко к использующим их клиентам).
* **Управление затратами**. Подписка Azure может содержать ресурсы многих типов и масштабов. Корпорациям часто нужно обеспечить, чтобы стандартные подписки не использовали необоснованно большие ресурсы, которые могут стоить сотни долларов в месяц, если не больше.
* **Стандартное управление посредством обязательных тегов**. Требование наличия тегов является одной из наиболее распространенных и очень желаемых функций. Используя политики Azure Resource Manager, предприятия могут обеспечить добавление соответствующих тегов для ресурсов. Наиболее распространенные теги обозначают отдел, владельца ресурса и тип среды (например, рабочая, тестовая, для разработки).

**Примеры**

Традиционная подписка ИТ для бизнес-приложений:

* Применение тегов отдела и владельца ко всем ресурсам.
* Разрешение создавать ресурсы только в регионе "Северная Америка".
* Разрешение создавать только виртуальные машины серии G и кластеры HDInsight.

Гибкая среда для подразделения, создающего облачные приложения:

* Разрешение создавать ресурсы ТОЛЬКО в определенном регионе для соблюдения требований к независимости данных.
* Применение тега Соглашения о регистрации ко всем ресурсам. Если ресурс создается без тега, к нему добавляется тег **Среда: неизвестно**.
* Аудит при создании ресурсов за пределами региона "Северная Америка" (не препятствуя этому).
* Аудит при создании дорогостоящих ресурсов.

> [!TIP]
> Чаще всего политики Resource Manager в организациях используются для контроля *места*, в котором создаются ресурсы, и *типа* создаваемых ресурсов. Помимо контроля *места* и *типа* с помощью политик многие предприятия используют их для обеспечения ресурсов соответствующими метаданными, предназначенными для выставления счетов за потребление. Мы рекомендуем применять политики на уровне подписки для:
> 
> * обеспечения географического соответствия и независимости данных;
> * управления затратами;
> * применения обязательных тегов (определяемых потребностями бизнеса, например BillTo, Application Owner и т. п.).
> 
> Можно применить дополнительные политики на более низких уровнях области применения.
> 
> 

### <a name="audit---what-happened"></a>Аудит: что именно произошло?
Чтобы видеть, как функционирует среда, необходимо выполнять аудит действий пользователей. Для большинства типов ресурсов в Azure создаются журналы диагностики, которые можно анализировать с помощью инструмента журнала или Azure Log Analytics. Можно собирать журналы действий для нескольких подписок, чтобы получить представление на уровне отделов или предприятия. Записи аудита являются важным инструментом диагностики и ключевым механизмом активации событий в среде Azure.

Журналы действий из развернутых служб Resource Manager позволяют определить, какие были выполнены **операции** и кем. Журналы действий могут быть собраны и объединены с помощью таких инструментов, как Log Analytics.

## <a name="resource-tags"></a>Теги ресурсов
По мере того, как пользователи в вашей организации добавляют ресурсы в подписку, становится все более важным связать эти ресурсы с соответствующим отделом, клиентом и средой. Вы можете вложить метаданные в ресурсы с помощью [тегов](resource-group-using-tags.md). Теги используются для предоставления сведений о ресурсе или владельце. Теги позволяют не только объединять и группировать ресурсы различными способами, но и использовать эти метаданные для взимания средств за использование. Для пометки ресурса можно использовать до 15 пар "ключ:значение". 

Теги ресурсов являются гибким инструментом, и их следует вложить в большинство ресурсов. Ниже приведены примеры распространенных тегов ресурсов:

* BillTo;
* Department (или Business Unit);
* Environment (Production, Stage, Development);
* Tier (Web Tier, Application Tier);
* Application Owner;
* ProjectName

![tags](./media/resource-manager-subscription-governance/resource-group-tagging.png)

Дополнительные примеры тегов приведены в статье [Рекомендуемые соглашения об именовании для ресурсов Azure](../guidance/guidance-naming-conventions.md).

> [!TIP]
> Рассмотрите возможность создания политики, обязывающей применять теги для следующих компонентов:
> 
> * Группы ресурсов
> * Хранилище
> * Виртуальные машины
> * среды службы приложения и веб-серверы.
> 
> Эта стратегия тегов определяет в подписках, какие метаданные необходимы для деловой деятельности, управления финансами, обеспечения безопасности, управления рисками и общего управление средой. 

## <a name="resource-group"></a>Группа ресурсов
Resource Manager позволяет помещать ресурсы в предметные группы для управления, выставления счетов или обеспечения естественного сходства. Как упоминалось ранее, в Azure есть две модели развертывания. В более ранней классической модели базовой единицей управления была подписка. Было трудно разбить ресурсы в подписке, что приводило к созданию большого числа подписок. Благодаря модели Resource Manager мы стали свидетелями появления групп ресурсов. Группы ресурсов — это контейнеры ресурсов, которые имеют общий жизненный цикл или какой-либо атрибут, например "все серверы SQL Server" или "Приложение A".

Группа ресурсов не может содержать в себе другие группы ресурсов, и ресурсы могут принадлежать только одной группе ресурсов. Можно применить определенные действия для всех ресурсов в группе ресурсов. Например, при удалении группы ресурсов можно удалять все ее ресурсы. Как правило, в одну группу ресурсов помещается целиком приложение или связанная система. Например, одна группа ресурсов для трехуровневого приложения Contoso Web Application будет содержать веб-сервер, сервер приложений и сервер SQL Server.

> [!TIP]
> Способ организации групп ресурсов для традиционных рабочих нагрузок ИТ и гибких рабочих нагрузок ИТ может отличаться:
> 
> * В первом случае рабочие нагрузки чаще всего группируются по элементам в рамках одного жизненного цикла, например приложения. Группирование по приложениям позволяет управлять отдельными приложениями.
> * Во втором случае рабочие нагрузки, как правило, сосредотачиваются на облачных приложениях для внешних клиентов. Группы ресурсов должны отражать уровни развертывания (например, уровень Интернета, уровень приложений) и управления.
> 
> Понимание рабочей нагрузки помогает разработать стратегию групп ресурсов.

## <a name="role-based-access-control"></a>Контроль доступа на основе ролей
Вы, вероятно, задаетесь вопросами: "У кого должен быть доступ к ресурсам?" и "Как контролировать этот доступ?" Разрешение или запрет доступа к порталу Azure и управление доступом к ресурсам на портале являются очень важными аспектами. 

При первоначальном выпуске Azure элементы управления доступом к подписке были простыми: администратор или соадминистратор. В классической модели доступ к подписке подразумевал доступ ко всем ресурсам на портале. Отсутствие детализированного контроля приводило к созданию избыточного количества подписок, необходимых, чтобы обеспечить адекватный контроль доступа для Соглашения о регистрации Azure.

Больше такое увеличение числа подписок не требуется. Управление доступом на основе ролей позволяет назначать пользователям стандартные роли (например, роли типа "Чтение" и "Запись"). Можно также определить настраиваемые роли.

> [!TIP]
> Чтобы реализовать контроль доступа на основе ролей, выполните следующие действия:
> * Подключите свое корпоративное хранилище удостоверений (чаще всего это Active Directory) к Azure Active Directory с помощью инструмента AD Connect.
> * Управляйте администраторами и соадминистраторами подписки с помощью управляемого удостоверения. **Не** назначайте роль администратора или соадминистратора владельцу новой подписки. Вместо этого используйте роли RBAC, чтобы предоставить права **владельца** группе или отдельному пользователю.
> * Добавьте пользователей Azure в группу (например, в группу "Владельцы приложения А") в Active Directory. Используйте синхронизированную группу, чтобы предоставить необходимые права для управления группой ресурсов, содержащей это приложение.
> * Придерживайтесь принципа предоставления **минимальных привилегий**, необходимых для выполнения предстоящей работы. Например: 
>   * Группа развертывания: группа, которая может только развертывать ресурсы.
>   * Управление виртуальными машинами: группа, которая может перезапускать виртуальные машины (для эксплуатации).
> 
> Эти советы помогут вам управлять доступом пользователей в своей подписке.

## <a name="azure-resource-locks"></a>Блокировки ресурсов Azure
По мере того, как организация добавляет основные службы в подписку, становится все более важным обеспечить доступность этих служб, чтобы избежать прерывания деловой деятельности. [Блокировки ресурсов](resource-group-lock-resources.md) позволяют ограничить операции с ценными ресурсами, изменение или удаление которых оказало бы значительное влияние на приложения или облачную инфраструктуру. Блокировки можно применить к подписке, группе ресурсов или ресурсу. Как правило, блокировки применяются к таким основополагающим ресурсам, как виртуальные сети, шлюзы и учетные записи хранения. 

Сейчас блокировки ресурсов поддерживают два значения: CanNotDelete и ReadOnly. Блокировка CanNotDelete означает, что пользователи (с соответствующими правами) могут считать или изменить ресурс, но не могут его удалить. Блокировка ReadOnly означает, что авторизованные пользователи не могут удалить или изменить ресурс.

Для создания или удаления блокировок управления необходим доступ к действию `Microsoft.Authorization/*` или `Microsoft.Authorization/locks/*`.
Из встроенных ролей эти действия предоставляются только владельцу и администратору доступа пользователей.

> [!TIP]
> Параметры основной сети должны быть защищены с помощью блокировок. Случайное удаление шлюза или VPN типа "сеть — сеть" может привести к катастрофическим последствиям для подписки Azure. Azure не позволяет удалить виртуальную сеть, которая используется, но применение дополнительных ограничений будет полезной мерой предосторожности. 
> 
> * Виртуальная сеть: CanNotDelete.
> * Группа безопасности сети: CanNotDelete.
> * Политики: CanNotDelete.
> 
> Политики также имеют большое значение для обслуживания соответствующих элементов управления. Мы рекомендуем применить блокировку **CanNotDelete** к используемым политикам.

## <a name="core-networking-resources"></a>Основные сетевые ресурсы
Доступ к ресурсам может быть внутренним (внутри корпоративной сети) или внешним (через Интернет). Пользователи в вашей организации могут случайно помещать ресурсы в расположения, не предназначенные для них, тем самым потенциально открывая их для вредоносного доступа. Как и в случае локальных устройств, предприятия должны добавить соответствующие элементы управления, чтобы гарантировать, что пользователи Azure принимают правильные решения. Для управления подписками мы определяем основные ресурсы, обеспечивающие базовые элементы управления доступом. К основным ресурсам относятся следующие.

* **Виртуальные сети** представляют собой объекты контейнеров для подсетей. Хотя это не является обязательным, их часто используют при подключении приложений к внутренним корпоративным ресурсам.
* **Группы безопасности сети** действуют по принципу брандмауэра и задают правила взаимодействия с ресурсом по сети. Они обеспечивают детализированный контроль над тем, как и при каких условиях подсеть (или виртуальная машина) может подключаться к Интернету или другим подсетям в той же виртуальной сети.

![Основные сети](./media/resource-manager-subscription-governance/core-network.png)

> [!TIP]
> Для сетей:
> * Создайте выделенные виртуальные сети для внешних и внутренних рабочих нагрузок. Такой подход уменьшает вероятность случайного размещения виртуальных машин, которые предназначены для внутренних рабочих нагрузок, в пространстве для внешних рабочих нагрузок.
> * Настройте группы безопасности сети, чтобы ограничить доступ. Как минимум, заблокируйте доступ к Интернету из внутренних виртуальных сетей и заблокируйте доступ к корпоративной сети из внешних виртуальных сетей.
> 
> Эти советы помогут вам внедрить ресурсы, обеспечивающие безопасность работы в сети.

### <a name="automation"></a>Служба автоматизации
Управление ресурсами по отдельности отнимает массу времени и повышает вероятность ошибок при определенных операциях. Azure предоставляет различные возможности автоматизации, включая службу автоматизации Azure, Logic Apps и функции Azure. [Служба автоматизации Azure](../automation/automation-intro.md) позволяет администраторам создавать и определять модули Runbook для выполнения общих задач управления ресурсами. Создавать модули Runbook можно с помощью редактора кода PowerShell или графического редактора. Вы можете создавать сложные, многоэтапные рабочие процессы. Служба автоматизации Azure часто используется для выполнения таких общих задач, как завершение работы неиспользуемых ресурсов или создание ресурсов по определенному триггеру без необходимости вмешательства пользователя.

> [!TIP]
> Для службы автоматизации:
> * Создайте учетную запись службы автоматизации Azure и просмотрите доступные модули Runbook (графические и для командной строки), доступные в [коллекции модулей Runbook](../automation/automation-runbook-gallery.md).
> * Импортируйте и настройте ключевые модули Runbook для собственных нужд.
> 
> Распространенным применением является запуск или завершение работы виртуальных машин по расписанию. В коллекции доступны примеры модулей Runbook, которые реализуют этот сценарий и обучают его развертыванию.
> 
> 

## <a name="azure-security-center"></a>Центр безопасности Azure
Возможно, одним из самых серьезных препятствий для внедрения облака были вопросы безопасности. Отделам безопасности и управления рисками ИТ необходимо обеспечить защиту ресурсов в Azure. 

[Центр безопасности Azure](../security-center/security-center-intro.md) обеспечивает централизованное представление, отображающее состояние безопасности ресурсов в подписках, а также рекомендации, которые помогут избежать компрометации ресурсов. С его помощью можно включить более детализированные политики (например, применить для определенных групп ресурсов политики, которые позволяют предприятию адаптировать свою позицию по отношению к риску, регулируемому этими политиками). И, наконец, центр безопасности Azure — это открытая платформа, позволяющая партнерам корпорации Майкрософт и независимым поставщикам программного обеспечения создавать программное обеспечение, которое встраивается в центр безопасности Azure, расширяя его возможности. 

> [!TIP]
> Центр безопасности Azure включен по умолчанию в каждой подписке. Тем не менее необходимо включить сбор данных с виртуальных машин, чтобы разрешить центру безопасности Azure установить свой агент и начать сбор данных.
> 
> ![сбора данных;](./media/resource-manager-subscription-governance/data-collection.png)
> 
> 

## <a name="next-steps"></a>Дополнительная информация
* Теперь, когда вы узнали об управлении подписками, пришло время ознакомиться с этими рекомендациями на практике. Ознакомьтесь с разделом [Примеры реализации корпоративного каркаса Azure](resource-manager-subscription-examples.md).

