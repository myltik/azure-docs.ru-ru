---
title: Сценарии применения и примеры системы управления подписками | Документация Майкрософт
description: Содержит примеры реализации управления подписками Azure для распространенных сценариев.
services: azure-resource-manager
documentationcenter: na
author: rdendtler
manager: timlt
editor: tysonn
ms.assetid: e8fbeeb8-d7a1-48af-804f-6fe1a6024bcb
ms.service: azure-resource-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 01/03/2017
ms.author: rodend;karlku;tomfitz
ms.openlocfilehash: 2c16c0414ddf023e7055a8b57c514fc069f3112a
ms.sourcegitcommit: e14229bb94d61172046335972cfb1a708c8a97a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2018
---
# <a name="examples-of-implementing-azure-enterprise-scaffold"></a>Примеры реализации корпоративного каркаса Azure
В этой статье приведены примеры того, как предприятие может реализовать рекомендации по созданию [корпоративного каркаса Azure](resource-manager-subscription-governance.md). В нем на примере вымышленной компании Contoso приводятся рекомендации для распространенных сценариев.

## <a name="background"></a>Фоновый
Contoso — транснациональная компания, которая предоставляет клиентам решения для управления логистическими цепочками. Эти решения предоставляются на основе различных моделей (от "программы как услуги" до пакета, развертываемого локально).  Эта компания разрабатывает программное обеспечение по всему миру в крупных центрах разработки, расположенных в Индии, США и Канаде.

Часть компании, занимающаяся независимыми поставщиками программного обеспечения, состоит из нескольких независимых подразделений, которые управляют продуктами в крупных компаниях. Во всех подразделениях имеются собственные разработчики, менеджеры по продуктам и архитекторы.

Подразделение технологических услуг предприятия (ETS) предоставляет централизованную ИТ-инфраструктуру и управляет несколькими центрами обработки данных, в которых размещены приложения подразделений. Наряду с управлением центрами обработки данных, организация ETS предоставляет централизованные средства для совместной работы (например, электронную почту и веб-сайты), сети или телефонные службы, а также управляет ими. Кроме того, организация ETS управляет рабочими нагрузками клиентов в небольших подразделениях, не имеющих эксплуатационного персонала.

В этой статье используются имена, перечисленные ниже.

* Дэйв является администратором ETS Azure.
* Элис — директор по разработке в подразделении Contoso, отвечающем за логистические цепочки.

Contoso необходимо создать бизнес-приложение и приложение для клиентов. Было решено запустить приложения в Azure. Дэйв прочел статью [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md) (Корпоративный каркас Azure: рекомендуемая система управления подписками) и теперь готов реализовать приведенные в ней рекомендации.

## <a name="scenario-1-line-of-business-application"></a>Сценарий 1. Бизнес-приложение
Contoso создает систему управления исходным кодом (BitBucket), предназначенную для разработчиков по всему миру.  Это приложение использует модель "инфраструктура как услуга" (IaaS) для размещения и состоит из веб-серверов и сервера базы данных. Разработчики обращаются к серверам в своих средах разработки, но им не нужен доступ к серверам в Azure. Подразделение ETS компании Contoso хочет разрешить владельцу приложения и использующей его команде управлять приложением. Приложение доступно только в корпоративной сети Contoso. Дейву необходимо настроить подписку для этого приложения. В будущем подписка будет содержать и другое программное обеспечение, предназначенное для разработчиков.  

### <a name="naming-standards--resource-groups"></a>Стандарты именования и группы ресурсов
Дейв создает подписку для поддержки типовых инструментов разработки, которые используются во всех подразделениях. Ему нужно создать содержательные имена для подписки и групп ресурсов (для приложения и сетей). Он создает следующие группы ресурсов и подписку.

| Элемент | ИМЯ | ОПИСАНИЕ |
| --- | --- | --- |
| Подписка |Contoso ETS DeveloperTools Production |Поддерживает типовые инструменты разработки. |
| Группа ресурсов |bitbucket-prod-rg |Содержит веб-сервер и сервер базы данных приложения. |
| Группа ресурсов |corenetworks-prod-rg |Содержит виртуальные сети и подключение шлюза типа "сеть — сеть". |

### <a name="role-based-access-control"></a>Контроль доступа на основе ролей
После создания своей подписки Дэйв хочет убедиться, что у соответствующих команд и владельцев приложений имеется доступ к их ресурсам. Дейв понимает, что у всех команд разные требования. Он использует локальные группы Active Directory (AD) компании Contoso, которые были синхронизированы с Azure Active Directory, и предоставляет командам нужный уровень доступа.

Дейв назначает следующие роли для подписки.

| Роль | Кому назначено | ОПИСАНИЕ |
| --- | --- | --- |
| [Владелец](../role-based-access-control/built-in-roles.md#owner) |Управляемый идентификатор из AD компании Contoso. |Для управлением этим идентификатором используется доступ по схеме JIT с помощью инструмента управления удостоверениями Contoso. При этом гарантируется полный аудит доступа владельца подписки. |
| [Читатель безопасности](../role-based-access-control/built-in-roles.md#security-reader) |Отдел безопасности и управления рисками |Пользователи с этой ролью могут просматривать страницу центра безопасности Azure и состояние ресурсов. |
| [Участник сети](../role-based-access-control/built-in-roles.md#network-contributor) |Сетевая группа |Эта роль позволяет сетевой группе компании Contoso управлять VPN-подключениями типа "сеть — сеть" и виртуальными сетями. |
| *Настраиваемая роль* |Владелец приложения |Дейв создает роль, которая дает возможность изменять ресурсы в группе ресурсов. Дополнительные сведения см. в разделе [Пользовательские роли в Azure RBAC](../role-based-access-control/custom-roles.md). |

### <a name="policies"></a>Политики
Ниже перечислены требования Дейва к управлению ресурсами в подписке.

* Так как инструменты разработки поддерживают работу разработчиков по всему миру, он не хочет лишать пользователей возможности создавать ресурсы в любом регионе. Тем не менее ему нужно знать, где создаются ресурсы.
* Дейва заботят затраты. Следовательно, он хочет предотвратить создание владельцами приложений неоправданно дорогих виртуальных машин.  
* Так как это приложение обслуживает разработчиков в нескольких подразделениях, Дейв хочет добавить к каждому ресурсу теги подразделения и владельца приложения. Используя эти теги, подразделение ETS сможет выставлять счета соответствующим командам.

Он создает перечисленные ниже [политики Azure](../azure-policy/azure-policy-introduction.md):

| Поле | Результат | ОПИСАНИЕ |
| --- | --- | --- |
| location |audit |Аудит создания ресурсов в любом регионе. |
| Тип |deny |Запрет создания виртуальных машин серии G. |
| tags |deny |Требование наличия тега владельца приложения. |
| tags |deny |Требование наличия тега места возникновения затрат. |
| tags |append |Добавление имени тега **BusinessUnit** и значения тега **ETS** ко всем ресурсам. |

### <a name="resource-tags"></a>Теги ресурсов
Дейв понимает, что ему нужны специальные сведения о счете, чтобы определить место возникновения затрат для реализации BitBucket. Кроме того, Дэйв хочет знать, какими ресурсами владеет подразделение ETS.

Он добавляет приведенные ниже [теги](resource-group-using-tags.md) для групп ресурсов и ресурсов.

| Имя тега | Значение тега |
| --- | --- |
| ApplicationOwner |Имя пользователя, который управляет этим приложением. |
| CostCenter |Расположение, связанное с возникающими затратами группы, оплачивающей потребление ресурсов Azure. |
| BusinessUnit |Подразделение **ETS** (связанное с подпиской). |

### <a name="core-network"></a>Основная сеть
Команда безопасности и управления рисками подразделения ETS Contoso проверяет предлагаемый Дейвом план перемещения приложения в Azure. Они хотят убедиться, что приложение не будет доступно через Интернет.  У Дейва также есть приложения для разработчиков, которые в дальнейшем будут перенесены в Azure. Этим приложениям требуются общедоступные интерфейсы.  Для соблюдения этих требований Дейв предоставляет внутренние и внешние виртуальные сети, а также группу безопасности сети для ограничения доступа.

Он создает перечисленные ниже ресурсы.

| Тип ресурса | ИМЯ | ОПИСАНИЕ |
| --- | --- | --- |
| Виртуальная сеть |internal-vnet |Используется для приложения BitBucket и подключается к корпоративной сети Contoso через канал ExpressRoute.  Подсеть (`bitbucket`) предоставляет приложению определенное пространство IP-адресов. |
| Виртуальная сеть |external-vnet |Доступна для будущих приложений, которым понадобятся общедоступные конечные точки. |
| Группа безопасности сети |bitbucket-nsg |Гарантирует, что виды атак для этой рабочей нагрузки сведены к минимуму, разрешая подключения только через порт 443 для подсети, в которой расположены приложения (`bitbucket`). |

### <a name="resource-locks"></a>Блокировки ресурсов
Дейв понимает, что подключение между корпоративной сеть Contoso и внутренней виртуальной сетью требуется защитить от любых непредсказуемых сценариев или случайного удаления.

Он создает приведенную ниже [блокировку ресурса](resource-group-lock-resources.md).

| Тип блокировки | Ресурс | ОПИСАНИЕ |
| --- | --- | --- |
| **CanNotDelete** |internal-vnet |Запрещает пользователям удалять виртуальную сеть или подсети, но разрешает добавлять новые подсети. |

### <a name="azure-automation"></a>Служба автоматизации Azure
Дэйв не собирается что-либо автоматизировать для этого приложения. Несмотря на то, что он создал учетную запись службы автоматизации Azure, Дейв не будет сразу ее использовать.

### <a name="azure-security-center"></a>Центр безопасности Azure
ИТ-специалистам по управлению службами Contoso необходимо быстро выявлять угрозы и устранять их. Кроме того, им нужно понимать, какие проблемы могут возникнуть.  

Чтобы соблюсти эти требования, Дейв включает [центр безопасности Azure](../security-center/security-center-intro.md) и предоставляет доступ к роли читателя безопасности.

## <a name="scenario-2-customer-facing-app"></a>Сценарий 2. Приложение для клиентов
Бизнес-руководство в подразделении, отвечающем за логистические цепочки, выявило различные возможности для расширения сотрудничества с клиентами компании Contoso за счет карт постоянных клиентов. Команда Алисы должна создать это приложение. И она решает, что Azure дает дополнительные возможности для удовлетворения потребностей бизнеса. Алиса работает с Дэйвом из подразделения ETS, чтобы настроить две подписки для разработки и эксплуатации этого приложения.

### <a name="azure-subscriptions"></a>Подписки Azure
Дейв входит на корпоративный портал Azure и видит, что отдел управления логистическими цепочками поставок уже существует.  Однако, так как данный проект является первым проектом по разработке для команды управления логистическими цепочками в Azure, Дэйв осознает, что нужно создать новую учетную запись для команды разработчиков Алисы.  Он создает учетную запись R&D для команды Алисы и предоставляет ей доступ. Алиса входит на портал Azure и создает две подписки: первую — для серверов разработки, а вторую — для рабочих серверов.  При создании этих подписок она следует предварительно установленным стандартам именования.

| Назначение подписки | ИМЯ |
| --- | --- |
| Разработка |Contoso SupplyChain ResearchDevelopment LoyaltyCard Development |
| Производство |Contoso SupplyChain Operations LoyaltyCard Production |

### <a name="policies"></a>Политики
Дейв и Алиса обсуждают приложение и выясняют, что оно обслуживает только клиентов в регионе "Северная Америка".  Для создания приложения Алиса и ее команда планируют использовать среду службы приложений Azure и SQL Azure. Возможно, во время разработки им понадобится создать виртуальные машины.  Алиса хочет обеспечить своих разработчиков ресурсами, необходимыми для выявления и изучения проблем без привлечения сотрудников ETS.

Для **подписки разработки** они создают следующую политику.

| Поле | Результат | ОПИСАНИЕ |
| --- | --- | --- |
| location |audit |Аудит создания ресурсов в любом регионе. |

Тип SKU, создаваемых пользователем в процессе разработки, не ограничивается, и наличие тегов у каких-либо групп ресурсов или ресурсов не обязательно.

Для **рабочей подписки** они создают политики, указанные ниже.

| Поле | Результат | ОПИСАНИЕ |
| --- | --- | --- |
| location |deny |Запрещается создание любых ресурсов за пределами центров обработки данных, размещенных в США. |
| tags |deny |Требование наличия тега владельца приложения. |
| tags |deny |Требуется тег отдела. |
| tags |append |Добавление к каждой группе ресурсов тега, обозначающего рабочую среду. |

Тип SKU, который пользователь может создать в рабочей среде, не ограничивается.

### <a name="resource-tags"></a>Теги ресурсов
Дейв понимает, что ему необходимы определенные сведения, чтобы правильно определить бизнес-группы для выставления счетов и установления принадлежности. Для этого он определяет теги ресурсов для групп ресурсов и ресурсов.

| Имя тега | Значение тега |
| --- | --- |
| ApplicationOwner |Имя пользователя, который управляет этим приложением. |
| Department |Расположение, связанное с возникающими затратами группы, оплачивающей потребление ресурсов Azure. |
| EnvironmentType |**Production** (хотя в имени подписки имеется значение **Production**, добавление этого тега упрощает идентификацию при просмотре ресурсов на портале или в счете). |

### <a name="core-networks"></a>Основные сети
Команда безопасности и управления рисками подразделения ETS Contoso проверяет предлагаемый Дейвом план перемещения приложения в Azure. Ей нужно убедиться, что приложение Loyalty Card правильно изолировано и защищено в сети периметра.  Для выполнения этого требования Дэйв и Алиса создают внешнюю виртуальную сеть и группу безопасности сети, чтобы изолировать приложение Loyalty Card от корпоративной сети Contoso.  

Для **подписки разработки** они создают следующее.

| Тип ресурса | ИМЯ | ОПИСАНИЕ |
| --- | --- | --- |
| Виртуальная сеть |internal-vnet |Обслуживает среду разработки Loyalty Card компании Contoso и подключается к корпоративной сети Contoso с помощью ExpressRoute. |

Для **рабочей подписки** они создают следующие ресурсы.

| Тип ресурса | ИМЯ | ОПИСАНИЕ |
| --- | --- | --- |
| Виртуальная сеть |external-vnet |Содержит приложение Loyalty Card и не подключена напрямую к каналу ExpressRoute компании Contoso. Код передается через систему управления исходным кодом непосредственно в службы PaaS. |
| Группа безопасности сети |loyaltycard-nsg |Гарантирует, что виды атак для этой рабочей нагрузки сведены к минимуму, разрешая только входящий трафик через TCP-порт 443.  Компания Contoso также рассматривает возможность применения брандмауэра веб-приложения для усиления защиты. |

### <a name="resource-locks"></a>Блокировки ресурсов
Дейв и Алиса советуются и решают добавить блокировки для некоторых ключевых ресурсов в среде, чтобы предотвратить случайное удаление при отправке кода с ошибкой.

Они создают следующую блокировку.

| Тип блокировки | Ресурс | ОПИСАНИЕ |
| --- | --- | --- |
| **CanNotDelete** |external-vnet |Предотвращает удаление виртуальной сети или подсетей пользователями. Эта блокировка не предотвращает добавление новых подсетей. |

### <a name="azure-automation"></a>Служба автоматизации Azure
У Алисы и ее команды разработчиков имеется множество модулей Runbook для управления средой этого приложения. С их помощью можно добавлять или удалять узлы для приложения, а также выполнять другие задачи разработки.

Чтобы использовать эти модули Runbook, Алиса и ее команда включают [службу автоматизации](../automation/automation-intro.md).

### <a name="azure-security-center"></a>Центр безопасности Azure
ИТ-специалистам по управлению службами Contoso необходимо быстро выявлять угрозы и устранять их. Кроме того, им нужно понимать, какие проблемы могут возникнуть.  

Для удовлетворения этих требований Дэйв включает центр безопасности Azure. Он убеждается, что центр безопасности Azure отслеживает ресурсы, и предоставляет доступ команде DevOps и команде безопасности.

## <a name="next-steps"></a>Дополнительная информация
* Чтобы узнать о создании шаблонов Resource Manager, ознакомьтесь со статьей [Рекомендации по созданию шаблонов Azure Resource Manager](resource-manager-template-best-practices.md).
