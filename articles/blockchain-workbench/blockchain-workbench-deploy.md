---
title: Развертывание Azure Blockchain Workbench
description: Практическое руководство по развертыванию Azure Blockchain Workbench
services: azure-blockchain
keywords: ''
author: PatAltimore
ms.author: patricka
ms.date: 5/17/2018
ms.topic: article
ms.service: azure-blockchain
ms.reviewer: zeyadr
manager: femila
ms.openlocfilehash: 484c7a17fec4ee94e3170e93eb1438af688d101e
ms.sourcegitcommit: 688a394c4901590bbcf5351f9afdf9e8f0c89505
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/18/2018
ms.locfileid: "34303949"
---
# <a name="deploy-azure-blockchain-workbench"></a>Развертывание Azure Blockchain Workbench

Azure Blockchain Workbench развертывается с помощью шаблона решения в Azure Marketplace. Шаблон упрощает развертывание компонентов, необходимых для создания приложений блокчейна. После развертывания Blockchain Workbench предоставит доступ к приложению клиента для создания и управления пользователями и приложениями блокчейна.

Дополнительные сведения о компонентах Blockchain Workbench см. в статье [Azure Blockchain Workbench architecture](blockchain-workbench-architecture.md) (Архитектура Azure Blockchain Workbench).

## <a name="prepare-for-deployment"></a>Подготовка к развертыванию

Blockchain Workbench позволяет развернуть реестр блокчейна вместе с набором соответствующих служб Azure, с помощью которых чаще всего создаются приложения на основе блокчейна. В результате развертывания Blockchain Workchench в группе ресурсов в вашей подписке Azure подготавливаются следующие службы Azure.

* 1 раздел сетки событий.
* 1 пространство имен служебной шины.
* 1 приложение Application Insights.
* 1 база данных SQL ("Стандартный" S0).
* 2 службы приложений ("Стандартный").
* 2 хранилища Azure Key Vault.
* 2 учетные записи хранения Azure (LRS уровня "Стандартный").
* 2 масштабируемых набора виртуальных машин (для узла проверяющего элемента управления и рабочего узла).
* 2 виртуальных сети (в том числе подсистема балансировки нагрузки, группа безопасности сети и общедоступный IP-адрес для каждой виртуальной сети).
* Azure Monitor (необязательно).

Ниже приведен пример развертывания, созданного в группе ресурсов **myblockchain**.

![Пример развертывания](media/blockchain-workbench-deploy/example-deployment.png)

Стоимость Blockchain Workbench — это общая стоимость базовых служб Azure. Сведения о ценах для служб Azure можно вычислить с помощью [калькулятора цен](https://azure.microsoft.com/pricing/calculator/).

Для развертывания Azure Blockchain Workbench необходимо выполнить несколько предварительных условий. К ним относится настройка Azure AD и регистрация приложения.

### <a name="blockchain-workbench-api-app-registration"></a>Регистрация приложения Blockchain Workbench API

Для развертывания Blockchain Workbench необходима регистрация приложения в Azure AD. Чтобы зарегистрировать приложение, вам нужен клиент Azure Active Directory (Azure AD). Можно использовать существующий клиент или создать новый. Если использовать существующий клиент Azure AD, необходимо достаточно разрешений для регистрации приложения в клиенте Azure AD. Регистрация приложения должна проходить в клиенте администратора подписки, который, в свою очередь, находится в подписке, где развернут Workbench. Дополнительные сведения о клиентах Azure AD см. в статьях [Как получить клиент Azure Active Directory](../active-directory/develop/active-directory-howto-tenant.md) и [Интеграция приложений с Azure Active Directory](../active-directory/develop/active-directory-integrating-applications.md).

1. Войдите на [портале Azure](https://portal.azure.com).
2. В правом верхнем углу выберите свою учетную запись, а затем перейдите в нужный клиент Azure AD. Клиент должен находиться в клиенте администратора подписки, в которой развертывается Workbench, и иметь достаточные разрешения для регистрации приложения.
3. В области навигации слева выберите службу **Azure Active Directory**. Выберите **Регистрация приложений** > **Регистрация нового приложения**.

    ![Регистрация приложения](media/blockchain-workbench-deploy/app-registration.png)

4. Укажите **Имя** и **URL-адрес входа** для приложения. Так как значения заполнителей изменяются во время развертывания, их можно использовать. 

    ![Создание регистрации приложения](media/blockchain-workbench-deploy/app-registration-create.png)

    |Параметр  | Значение  |
    |---------|---------|
    |ИМЯ | `Blockchain API` |
    |Тип приложения |Веб-приложение или API|
    |URL-адрес входа | `https://blockchainapi` |

5. Чтобы зарегистрировать приложение Azure AD, выберите **Создать**.

### <a name="modify-application-manifest"></a>Изменение манифеста приложения

Затем необходимо изменить манифест приложения, чтобы использовать роли приложения вместе с Azure AD для указания администраторов Blockchain Workbench.  Дополнительные сведения о манифесте приложения см. в статье [Манифест приложения Azure Active Directory](../active-directory/develop/active-directory-application-manifest.md).

1. Для зарегистрированного приложения выберите **Манифест** на панели сведений о зарегистрированных приложениях.
2. Создайте GUID. Для создания идентификатора GUID можно использовать команду PowerShell `[guid]::NewGuid()` или онлайн-средства. 
3. Вы собираетесь обновить раздел манифеста **appRoles**. В области редактирования манифеста выберите **Изменить** и замените `"appRoles": []` на значение, предоставленное JSON. Обязательно замените значение поля **Идентификатор** значением, созданным GUID. 

    ``` json
    "appRoles": [
         {
           "allowedMemberTypes": [
             "User",
             "Application"
           ],
           "displayName": "Administrator",
           "id": "<A unique GUID>",
           "isEnabled": true,
           "description": "Blockchain Workbench administrator role allows creation of applications, user to role assignments, etc.",
           "value": "Administrator"
         }
       ],
    ```

    ![Изменение манифеста](media/blockchain-workbench-deploy/edit-manifest.png)

    > [!IMPORTANT]
    > Для определения администраторов Blockchain Workbench необходимо значение **Администратор**.

4.  Чтобы сохранить изменения манифеста приложения щелкните **Сохранить**.

### <a name="add-graph-api-required-permissions"></a>Добавление необходимых разрешений API Graph

Чтобы приложение API могло получить доступ к каталогу, ему необходимо запросить разрешение у пользователя. Для приложения API необходимо задать следующие требуемые разрешения:

1. При регистрации приложения Blockchain API выберите **Параметры > Требуемые разрешения > Выбор API > Microsoft Graph**.

    ![Выбор API](media/blockchain-workbench-deploy/client-app-select-api.png)

    Нажмите кнопку **Выбрать**.

2. В окне **Включить доступ** под **Разрешения приложения** установите флажок **Чтение полных профилей всех пользователей**.

    ![Разрешить доступ](media/blockchain-workbench-deploy/client-app-read-perms.png)

    Последовательно щелкните **Выбрать**, а затем **Готово**.

3. В разделе **Необходимые разрешения** выберите **Предоставление разрешений**, а затем для запроса проверки выберите **Да**.

   ![Предоставление разрешений](media/blockchain-workbench-deploy/client-app-grant-permissions.png)

   Предоставление разрешения позволяет Blockchain Workbench получать доступ к пользователям в каталоге. Для поиска и добавления членов в Blockchain Workbench требуется разрешение на чтение.

### <a name="add-graph-api-key-to-application"></a>Добавить ключ API Graph для приложения

Blockchain Workbench использует Azure AD как главную систему управлением взаимодействием пользователей с приложениями блокчейн. Чтобы Blockchain Workbench получало доступ к Azure AD и извлекало такие пользовательские сведения, как имена и электронные сообщения, необходимо добавить ключ доступа. Для аутентификации с помощью Azure AD в Blockchain Workbench используется ключ.

1. Для зарегистрированного приложения выберите **Параметры** на панели сведений о зарегистрированных приложениях.
2. Выберите **Ключи**.
3. Добавьте новый ключ, указав его в поле **Описание** и выбрав значения длительности в поле **Срок действия истекает**. 

    ![Создание ключа](media/blockchain-workbench-deploy/app-key-create.png)

    |Параметр  | Значение  |
    |---------|---------|
    | ОПИСАНИЕ | `Service` |
    | Expires | Выбор срока действия |

4. Щелкните **Сохранить**. 
5. Скопируйте значение ключа и сохраните его для дальнейшего использования. Оно вам понадобится для развертывания.

    > [!IMPORTANT]
    >  Если ключ не будет сохранен для развертывания, необходимо будет создать новый ключ. Позже невозможно будет получить значение ключа на портале.

### <a name="get-application-id"></a>Получение идентификатора приложения

Для развертывания необходимы сведения о клиенте и идентификатор приложения. Чтобы использовать сведения во время развертывания, их необходимо собрать и сохранить.

1. Для зарегистрированного приложения последовательно выберите **Параметры** > **Свойства**.
2.  Для последующего использования во время развертывания на панели **Свойства** скопируйте и сохраните следующие значения.

    ![Свойства приложения API](media/blockchain-workbench-deploy/app-properties.png)

    | Параметр для хранения  | Использование в развертывании |
    |------------------|-------------------|
    | Идентификатор приложения | Установка Azure Active Directory > идентификатор приложения |

### <a name="get-tenant-domain-name"></a>Получение доменного имени клиента

После завершения регистрации приложений необходимо собрать и сохранить клиентское имя домена Active Directory. 

В области навигации слева выберите службу **Azure Active Directory**. Выберите **Имена пользовательских доменов**. Скопируйте и сохраните доменное имя.

![Доменное имя](media/blockchain-workbench-deploy/domain-name.png)

## <a name="deploy-blockchain-workbench"></a>Развертывание Blockchain Workbench

После завершения обязательных шагов можно перейти к развертыванию Blockchain Workbench. В следующем разделе описывается, как развернуть платформу.

1.  Войдите на [портале Azure](https://portal.azure.com).
2.  В правом верхнем углу выберите свою учетную запись, а затем перейдите в нужный клиент Azure AD, в котором необходимо развернуть Azure Blockchain Workbench.
3.  В области слева выберите **Создать ресурс**. Поиск `Azure Blockchain Workbench` в поисковой строке **поиска в Marketplace**. 

    ![Панель поиска Marketplace](media/blockchain-workbench-deploy/marketplace-search-bar.png)

4.  Выберите **Azure Blockchain Workbench**.

    ![Результаты поиска Marketplace](media/blockchain-workbench-deploy/marketplace-search-results.png)

4.  Нажмите кнопку **Создать**.
5.  Выполните основные настройки.

    ![Создание Azure Blockchain Workbench](media/blockchain-workbench-deploy/blockchain-workbench-settings-basic.png)

    | Параметр | ОПИСАНИЕ  |
    |---------|--------------|
    | Префикс ресурса | Краткий уникальный идентификатор развертывания. Это значение используется в качестве основы для именования ресурсов. |
    | Имя пользователя виртуальной машины | Для всех виртуальных машин имя пользователя используется в качестве администратора. |
    | Authentication type (Тип проверки подлинности) | Выбирается, если нужно использовать пароль или ключ для соединения с виртуальными машинами. |
    | Пароль | Пароль используется для подключения к виртуальным машинам. |
    | SSH | Используйте открытый ключ RSA в однострочном формате, начиная с **ssh-rsa**, или используйте формат многострочного текста PEM. Ключи SSH можно создать с помощью `ssh-keygen` (в Linux и OS X) или PuTTYGen (в Windows). Дополнительные сведения о ключах SSH можно узнать в статье [Использование ключей SSH с Windows в Azure](../virtual-machines/linux/ssh-from-windows.md). |
    | Пароль базы данных или подтверждение пароля базы данных | Укажите пароль, который используется для доступа к созданной базе данных в ходе развертывания. |
    | Регион развертывания | Укажите место для развертывания ресурсов Blockchain Workbench. Для обеспечения высокой доступности оно должно соответствовать параметру **Расположение**. |
    | Подписка | Укажите подписку Azure, которую необходимо использовать для развертывания. |
    | Группы ресурсов | Для создания группы ресурсов выберите **Создать** и укажите уникальное имя группы ресурсов. |
    | Расположение | Укажите регион, в котором необходимо развернуть платформу. |

6.  Чтобы завершить раздел базовой настройки параметров, нажмите кнопку **OК**.

7.  Завершите **установку Azure Active Directory**.

    ![Установка Azure AD](media/blockchain-workbench-deploy/blockchain-workbench-settings-aad.png)

    | Параметр | ОПИСАНИЕ  |
    |---------|--------------|
    | Имя домена | Использование клиента Azure AD, собранного в предыдущем разделе [Получение доменного имени клиента](#get-tenant-domain-name). |
    | Идентификатор приложения | Использование идентификатора приложения от регистрации клиентского приложения Blockchain, собранного в предыдущем разделе [Получение идентификатора приложения](#get-application-id). |
    | Ключ приложения | Использование ключа приложения от регистрации клиентского приложения Blockchain, собранного в предыдущем разделе [Добавление ключа API Graph для приложения](#add-graph-api-key-to-application). |


8.  Чтобы завершить раздел настройки параметров Azure AD, нажмите кнопку **OК**.

9.  Завершение настроек **Network size and performance** (Размер и производительность сети).

    ![Настройки производительности и сети](media/blockchain-workbench-deploy/blockchain-workbench-settings-network.png)

    | Параметр | ОПИСАНИЕ  |
    |---------|--------------|
    | Число узлов блокчейна | Укажите количество узлов проверяющего элемента управления Ethereum PoA для развертывания в вашей сети. |
    | Хранение и производительность | Выберите предпочтительную производительность хранилища виртуальной машины для сети блокчейнов. |
    | размер виртуальной машины; | Выберите предпочтительный размер виртуальной машины для сети блокчейнов. |

10. Для завершения создания размера сети и раздела производительности нажмите кнопку **OK**.

11. Завершение настроек **Azure Monitor**.

    ![Azure Monitor](media/blockchain-workbench-deploy/blockchain-workbench-settings-oms.png)

    | Параметр | ОПИСАНИЕ  |
    |---------|--------------|
    | Мониторинг | Вы можете выбрать, должен ли Azure Monitor применяться для мониторинга сети блокчейнов. |
    | Подключение к имеющемуся экземпляру Log Analytics | Вы можете выбрать, следует ли использовать имеющийся экземпляр Log Analytics или создать новый. Если используется имеющийся экземпляр, укажите идентификатор рабочей области и первичный ключ. |

12. Чтобы завершить раздел Azure Monitor, нажмите кнопку **OК**.

13. Чтобы проверить, что параметры точны, необходимо проверить сводные данные.

    ![Сводка](media/blockchain-workbench-deploy/blockchain-workbench-summary.png)

14. Чтобы принять условия и развернуть Azure Blockchain Workbench, выберите **Создать**.

Развертывание может занять до 90 минут. Для отслеживания хода выполнения можно использовать портал Azure. Для просмотра состояния развернутых артефактов выберите **Развернутые приложения > Обзор** в новой группе ресурсов.

## <a name="blockchain-workbench-web-url"></a>URL-адрес Blockchain Workbench

После завершения развертывания Blockchain Workbench ресурсы Blockchain Workbench будут находиться в новой группе ресурсов. Службы Blockchain Workbench доступны через URL-адрес. Ниже описывается, как получить URL-адрес развернутой платформы.

1. Войдите на [портале Azure](https://portal.azure.com).
2. В области навигации слева выберите **Группы ресурсов**
3. Выберите имя группы ресурсов, указанное при развертывании Blockchain Workbench.
4. Щелкните заголовок столбца **Тип**, чтобы отсортировать список в алфавитном порядке.
5. Существует два ресурса с типом **Служба приложений**. Выберите тип ресурса **Служба приложений** *у которого отсутствует суффикс* -api.

    ![Список служб приложений](media/blockchain-workbench-deploy/resource-group-list.png)

6.  В разделе **Основные компоненты** службы приложений скопируйте значение **URL-адреса**, которое представляет URL-адрес вашего развернутого Blockchain Workbench.

    ![Основные компоненты служб приложений](media/blockchain-workbench-deploy/app-service.png)

Сведения о связывании имени личного домена с Blockchain Workbench см. в статье [Настройка личного доменного имени для веб-приложения в службе приложений Azure, использующей диспетчер трафика](../app-service/web-sites-traffic-manager-custom-domain-name.md).

## <a name="configuring-the-reply-url"></a>Настройка URL-адреса ответа

После развертывания в Blockchain Workbench необходимо убедиться, что клиентское приложение Azure Active Directory зарегистрировано в правильном **URL-адресе ответа** развернутого URL-адреса Blockchain Workbench.

1. Войдите на [портале Azure](https://portal.azure.com).
2. Убедитесь, что вы находитесь в клиенте, в котором было зарегистрировано клиентское приложение Azure AD.
3. В области навигации слева выберите службу **Azure Active Directory**. Щелкните **Регистрация приложений**.
4. Выберите клиентское приложение Azure AD, которое вы регистрировали в предыдущем разделе.
5. Последовательно выберите **Параметры > URL-адреса ответа**.
6. Укажите основной URL-адрес развертывания Azure Blockchain Workbench, который вы получили в разделе **Get the Azure Blockchain Workbench Web URL** (Получение URL-адреса Azure Blockchain Workbench). К URL-адресу ответа добавляется префикс `https://`. Например, `https://myblockchain2-7v75.azurewebsites.net`

    ![URL-адреса ответа](media/blockchain-workbench-deploy/configure-reply-url.png)

7. Чтобы обновить регистрацию клиента, выберите **Сохранить**.

## <a name="remove-a-deployment"></a>Удаление развертывания

Если развертывание больше не требуется, вы можете удалить его, удалив группу ресурсов Blockchain Workbench.

1. На портале Azure перейдите к **группам ресурсов** в области навигации слева и выберите группу ресурсов, которую необходимо удалить. 
2. Выберите **Удалить группу ресурсов**. Подтвердите удаление, введя имя группы ресурсов и выбрав **Удалить**.

    ![Удалить группу ресурсов](media/blockchain-workbench-deploy/delete-resource-group.png)

## <a name="next-steps"></a>Дополнительная информация

Работая с этой статьей, вы развернули Azure Blockchain Workbench. Сведения о создании блокчейн-приложения см. в следующей статье.

> [!div class="nextstepaction"]
> [Создание блокчейн-приложения в Azure Blockchain Workbench](blockchain-workbench-create-app.md)