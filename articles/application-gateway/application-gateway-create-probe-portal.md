---
title: Создание пользовательской пробы для шлюза приложений Azure с помощью портала Azure | Документация Майкрософт
description: Узнайте, как создать пользовательскую пробу для шлюза приложений с помощью портала.
services: application-gateway
documentationcenter: na
author: vhorne
manager: jpconnock
editor: ''
tags: azure-resource-manager
ms.assetid: 33fd5564-43a7-4c54-a9ec-b1235f661f97
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/26/2017
ms.author: victorh
ms.openlocfilehash: 45737c1c378ec56a5e2bedec8c1f7b7bc7ba6225
ms.sourcegitcommit: c47ef7899572bf6441627f76eb4c4ac15e487aec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33203921"
---
# <a name="create-a-custom-probe-for-application-gateway-by-using-the-portal"></a>Создание пользовательской пробы для шлюза приложений с помощью портала

> [!div class="op_single_selector"]
> * [портал Azure](application-gateway-create-probe-portal.md)
> * [PowerShell и диспетчер ресурсов Azure](application-gateway-create-probe-ps.md)
> * [Классическая модель — Azure PowerShell](application-gateway-create-probe-classic-ps.md)

Следуя инструкциям этой статьи вы добавите пользовательскую пробу в имеющийся шлюз приложений с помощью портала Azure. Пользовательские пробы полезны в приложениях с конкретной страницей проверки работоспособности или приложениях, не предоставляющих успешный ответ веб-приложению по умолчанию.

## <a name="before-you-begin"></a>Перед началом работы

Если у вас нет шлюза приложений, ознакомьтесь с [этой статьей](application-gateway-create-gateway-portal.md), чтобы создать его.

## <a name="createprobe"></a>Создание пробы

На портале пробы настраиваются в два этапа. Сначала нужно создать пробу. Затем следует добавить ее в параметры протокола HTTP серверной части приложения шлюза.

1. Войдите на [портал Azure](https://portal.azure.com). Если у вас нет учетной записи, вы можете зарегистрироваться для получения [бесплатной пробной версии на один месяц](https://azure.microsoft.com/free).

1. На портале Azure в области "Избранное" щелкните "Все ресурсы". Выберите шлюз приложений в колонке "Все ресурсы". Если выбранная подписка имеет несколько ресурсов, в поле "Фильтровать по имени..." введите partners.contoso.net, чтобы быстро получить доступ к необходимому шлюзу приложений.

1. Щелкните **Пробы** и нажмите кнопку **Добавить**, чтобы добавить новую пробу.

  ![Колонка добавления пробы с заполненной информацией][1]

1. В колонке **Добавление зонда работоспособности** введите необходимые сведения о пробе, затем нажмите кнопку **ОК**.

  |**Параметр** | **Значение** | **Дополнительные сведения**|
  |---|---|---|
  |**Имя**|customProbe|Понятное имя пробы, которое отображается на портале.|
  |**Протокол**|HTTP или HTTPS | Протокол, используемый пробой работоспособности.|
  |**Host**|Например, contoso.com|Имя узла, используемое для пробы. Применяется только в случае, когда в шлюзе приложений настроено многосайтовое подключение. В противном случае используется значение 127.0.0.1. Это значение отличается от имени узла виртуальной машины.|
  |**Путь**|/ или другой путь|Остальная часть полного URL-адреса пользовательской пробы. Путь должен начинаться с /. Для пути по умолчанию http://contoso.com просто используйте "/". |
  |**Интервал (с)**|30|Интервал между выполнением проб работоспособности. Не рекомендуется задавать значение менее 30 секунд.|
  |**Время ожидания (с)**|30|Время ожидания пробы. Интервал времени ожидания должен быть достаточно большим для выполнения HTTP-вызова, чтобы обеспечить доступность страницы с данными о работоспособности внутреннего сервера.|
  |**Пороговое значение сбоя**|3|Число неудачных попыток, после которых состояние считается неработоспособным. Пороговое значение 0 означает, что при сбое проверки работоспособности серверная часть немедленно будет определена как неработоспособная.|

  > [!IMPORTANT]
  > Имя узла не является именем сервера. Это имя виртуального узла, который выполняется на сервере приложений. Проба отправляется по адресу http://(имя_узла):(порт_из_параметров_HTTP)/urlPath.

## <a name="add-probe-to-the-gateway"></a>Добавление пробы в шлюз

После создания пробы пора добавить ее в шлюз. Настройки пробы задаются в параметрах протокола HTTP серверной части приложения шлюза.

1. Щелкните **Настройки HTTP** для шлюза приложения и откройте колонку конфигурации, выбрав текущие параметры HTTP серверной части в окне.

  ![Окно параметров HTTPS][2]

1. В колонке параметров **appGatewayBackEndHttpSettings** установите флажок **Использовать пользовательский зонд** и выберите пробу, созданную в разделе [Создание пробы](#createprobe), в раскрывающемся списке **Пользовательский зонд**.
По завершении нажмите кнопку **Сохранить**, и параметры будут применены.

Проба по умолчанию проверяет доступ по умолчанию к веб-приложению. После создания пользовательской пробы шлюз приложений использует определенный пользовательский путь для мониторинга работоспособности внутренних серверов. На основе определенных критериев шлюз приложений проверяет путь, указанный в пробе. Если вызов по адресу "узел:порт/путь" не возвращает ответ состояния "HTTP 200–399", то по достижении порогового значения неработоспособности сервер выводится из ротации. Выполнение проб неработоспособного экземпляра продолжается, чтобы определить, когда она снова станет работоспособен. После добавления экземпляра обратно в пул работоспособных серверов трафик снова начинает поступать к нему, и выполнение проб этого экземпляра продолжается в обычном режиме с указанным пользователем интервалом.

## <a name="next-steps"></a>Дополнительная информация

Сведения по настройке разгрузки SSL с использованием шлюза приложений Azure см. в статье [Настройка шлюза приложений для разгрузки SSL с помощью портала](application-gateway-ssl-portal.md)

[1]: ./media/application-gateway-create-probe-portal/figure1.png
[2]: ./media/application-gateway-create-probe-portal/figure2.png

