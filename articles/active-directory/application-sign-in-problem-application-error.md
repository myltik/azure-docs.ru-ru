---
title: Ошибка на странице приложения после входа | Документы Майкрософт
description: Устранение проблем со входом в Azure AD, когда само приложение выдает ошибку
services: active-directory
documentationcenter: ''
author: ajamess
manager: mtillman
ms.assetid: ''
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: asteen
ms.openlocfilehash: 02236e7f7ec6be0df5082d2cde3d616e628c3927
ms.sourcegitcommit: d87b039e13a5f8df1ee9d82a727e6bc04715c341
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2018
ms.locfileid: "29384911"
---
# <a name="error-on-an-applications-page-after-signing-in"></a>Ошибка на странице приложения после входа

В этом сценарии пользователь вошел в Azure AD, однако приложение отображает ошибку, не позволяя завершить процедуру входа. В этом случае приложение не принимает ответ от Azure AD.

Существует несколько возможных причин, по которым приложение не приняло ответ от Azure AD. Если ошибка в приложении недостаточно информативна, чтобы понять, что именно отсутствует в ответе, сделайте следующее:

-   Если приложение является коллекцией Azure AD, выполните все действия, описанные в статье [Отладка единого входа на основе SAML в приложения в Azure Active Directory](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging).

-   Используйте такое средство, как [Fiddler](http://www.telerik.com/fiddler), для захвата запроса, ответа и токена SAML.

-   Предоставьте ответ SAML поставщику приложения, чтобы узнать, чего именно не хватает.

## <a name="missing-attributes-in-the-saml-response"></a>Недостающие атрибуты в ответе SAML

Чтобы добавить атрибут в конфигурацию Azure AD для отправки в ответе Azure AD, сделайте следующее:

1.  Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как **глобальный администратор** или **соадминистратор**.

2.  Откройте **расширение Azure Active Directory**, щелкнув **Все службы** в верхней части главного меню навигации слева.

3.  В поле фильтра поиска введите **Azure Active Directory** и выберите элемент **Azure Active Directory**.

4.  В меню навигации Azure Active Directory слева выберите **Корпоративные приложения**.

5.  Щелкните **Все приложения**, чтобы открыть полный список приложений.

   * Если нужное приложение отсутствует в списке, в верхней части списка **Все приложения** воспользуйтесь элементом управления **Фильтр**, указав в нем для параметра **Показать** значение **Все приложения**.

6.  Выберите приложение, для которого нужно настроить единый вход.

7.  После загрузки приложения выберите пункт **Единый вход** в меню навигации этого приложения слева.

8.  Чтобы изменить атрибуты, которые будут отправлены приложению в токене SAML при входе пользователя в систему, в разделе **Атрибуты пользователя** щелкните **Просмотреть и изменить все другие атрибуты пользователей**.

   Чтобы добавить атрибут, выполните указанные ниже действия.

   * Нажмите кнопку **Добавить атрибут**. Введите **Имя** и выберите **Значение** из раскрывающегося списка.

   * Нажмите кнопку **Сохранить**. Новый атрибут появится в таблице.

9.  Сохраните конфигурацию.

При следующем входе пользователя в приложение Azure AD отправляет новый атрибут в ответе SAML.

## <a name="the-application-expects-a-different-user-identifier-value-or-format"></a>Приложение ожидает идентификатор пользователя с другим значением или в другом формате

Вход в приложение не удается выполнить, потому что в ответе SAML отсутствуют такие атрибуты, как роли, либо приложение ожидает другой формат для атрибута EntityID.

## <a name="add-an-attribute-in-the-azure-ad-application-configuration"></a>Добавление атрибута в конфигурацию приложения Azure AD

Чтобы изменить значение идентификатора пользователя, сделайте следующее:

1.  Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как **глобальный администратор** или **соадминистратор**.

2.  Откройте **расширение Azure Active Directory**, щелкнув **Все службы** в верхней части главного меню навигации слева.

3.  В поле фильтра поиска введите **Azure Active Directory** и выберите элемент **Azure Active Directory**.

4.  В меню навигации Azure Active Directory слева выберите **Корпоративные приложения**.

5.  Щелкните **Все приложения**, чтобы открыть полный список приложений.

   * Если нужное приложение отсутствует в списке, в верхней части списка **Все приложения** воспользуйтесь элементом управления **Фильтр**, указав в нем для параметра **Показать** значение **Все приложения**.

6.  Выберите приложение, для которого нужно настроить единый вход.

7.  После загрузки приложения выберите пункт **Единый вход** в меню навигации этого приложения слева.

8.  В разделе **Атрибуты пользователя** выберите уникальный идентификатор пользователя в раскрывающемся списке **Идентификатор пользователя**.

## <a name="change-entityid-user-identifier-format"></a>Изменение формата идентификатора EntityID (идентификатора пользователя)

В этом случае приложение ожидает другой формат для атрибута EntityID. Вы не можете изменить формат EntityID (идентификатора пользователя), который Azure AD отправляет приложению после проверки подлинности пользователя.

Azure AD выбирает формат атрибута NameID (идентификатор пользователя) на основе выбранного значения или формата, который был запрошен приложением в запросе проверки подлинности SAML. Дополнительные сведения см. в разделе NameIDPolicy статьи [Протокол единого входа SAML](https://docs.microsoft.com/azure/active-directory/develop/active-directory-single-sign-on-protocol-reference#authnrequest).

## <a name="the-application-expects-a-different-signature-method-for-the-saml-response"></a>Приложение ожидает другой метод подписи для ответа SAML

Нужно изменить, на какие именно части токена SAML Azure Active Directory ставит цифровую подпись. Выполните следующие действия.

1.  Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как **глобальный администратор** или **соадминистратор**.

2.  Откройте **расширение Azure Active Directory**, щелкнув **Все службы** в верхней части главного меню навигации слева.

3.  В поле фильтра поиска введите **Azure Active Directory** и выберите элемент **Azure Active Directory**.

4.  В меню навигации Azure Active Directory слева выберите **Корпоративные приложения**.

5.  Щелкните **Все приложения**, чтобы открыть полный список приложений.

  * Если нужное приложение отсутствует в списке, в верхней части списка **Все приложения** воспользуйтесь элементом управления **Фильтр**, указав в нем для параметра **Показать** значение **Все приложения**.

6.  Выберите приложение, для которого нужно настроить единый вход.

7.  После загрузки приложения выберите пункт **Единый вход** в меню навигации этого приложения слева.

8.  Щелкните **Показать дополнительные параметры подписывания сертификатов** в разделе **Сертификат подписи SAML**.

9.  Выберите тот **Вариант подписывания**, который ожидает приложение:

  * Ответ знака SAML

  * Ответ знака SAML и утверждение

  * Утверждение знака SAML

При следующем входе пользователя в приложение Azure AD подписывает выбранную часть ответа SAML.

## <a name="the-application-expects-the-signing-algorithm-to-be-sha-1"></a>Приложение ожидает алгоритм подписи SHA-1

По умолчанию Azure AD подписывает токен SAML с помощью наиболее безопасного алгоритма. Рекомендуется изменять алгоритм подписи на SHA-1 только тогда, когда это необходимо приложению.

Чтобы изменить алгоритм подписи, сделайте следующее:

1.  Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как **глобальный администратор** или **соадминистратор**.

2.  Откройте **расширение Azure Active Directory**, щелкнув **Все службы** в верхней части главного меню навигации слева.

3.  В поле фильтра поиска введите **Azure Active Directory** и выберите элемент **Azure Active Directory**.

4.  В меню навигации Azure Active Directory слева выберите **Корпоративные приложения**.

5.  Щелкните **Все приложения**, чтобы открыть полный список приложений.

   * Если нужное приложение отсутствует в списке, в верхней части списка **Все приложения** воспользуйтесь элементом управления **Фильтр**, указав в нем для параметра **Показать** значение **Все приложения**.

6.  Выберите приложение, для которого нужно настроить единый вход.

7.  После загрузки приложения выберите пункт **Единый вход** в меню навигации этого приложения слева.

8.  Щелкните **Показать дополнительные параметры подписывания сертификатов** в разделе **Сертификат подписи SAML**.

9.  Выберите SHA-1 в поле **Алгоритм подписи**.

При следующем входе пользователя в приложение Azure AD подписывает токен SAML с использованием алгоритма SHA-1.

## <a name="next-steps"></a>Дополнительная информация
[Отладка единого входа на основе SAML в приложения в Azure Active Directory](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging)
