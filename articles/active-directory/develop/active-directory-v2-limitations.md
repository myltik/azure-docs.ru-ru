---
title: Ограничения конечной точки Azure Active Directory версии 2.0 | Документация Майкрософт
description: Список ограничений для конечной точки Azure AD версии 2.0.
services: active-directory
documentationcenter: ''
author: CelesteDG
manager: mtillman
editor: ''
ms.assetid: a99289c0-e6ce-410c-94f6-c279387b4f66
ms.service: active-directory
ms.component: develop
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/01/2017
ms.author: celested
ms.reviewer: dastrock
ms.custom: aaddev
ms.openlocfilehash: e026fd7021b39905d5392be55dbf3862cd307360
ms.sourcegitcommit: e14229bb94d61172046335972cfb1a708c8a97a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2018
ms.locfileid: "34156397"
---
# <a name="should-i-use-the-v20-endpoint"></a>Следует ли мне использовать конечную точку версии 2.0?
При создании приложений, которые интегрируются с Azure Active Directory, необходимо решить, соответствуют ли требованиям конечная точка версии 2.0 и протоколы проверки подлинности. Исходная конечная точка Azure Active Directory по-прежнему полностью поддерживается и в некоторых отношениях является более функциональной, чем версия 2.0. Однако конечная точка версии 2.0 [представляет значительные преимущества](active-directory-v2-compare.md) для разработчиков.

Ниже приведены упрощенные рекомендации для разработчиков по состоянию на текущий момент.

* Если в приложении требуется поддержка личных учетных записей Майкрософт, используйте конечную точку версии 2.0. Но перед этим убедитесь, что вы понимаете ограничения, которые рассматриваются в этой статье.
* Если приложению требуется только поддержка рабочих и учебных учетных записей Майкрософт, не используйте конечную точку версии 2.0. Вместо этого обратитесь к [руководству разработчика по Azure AD](active-directory-developers-guide.md).

Со временем конечная точка версии 2.0 будет развиваться и поможет устранить эти ограничения, так что вам нужно будет использовать только ее. А пока эта статья поможет вам определить, подходит ли вам конечная точка версии 2.0. Мы продолжим обновлять эту статью, чтобы отражать текущее состояние конечной точки версии 2.0. Вы можете проверить ее на наличие изменений, чтобы повторно оценить свои требования и возможности версии 2.0.

Если у вас уже есть приложение Azure AD, в котором не используется конечная точка версии 2.0, нет необходимости начинать с нуля. В будущем мы предоставим способ использования конечной точки версии 2.0 существующими приложениями Azure AD.

## <a name="restrictions-on-app-types"></a>Ограничения для типов приложений
Перечисленные ниже типы приложений в настоящее время не поддерживаются конечной точкой версии 2.0. Описание поддерживаемых типов приложений см. в разделе [Типы приложений для конечной точки Azure Active Directory версии 2.0](active-directory-v2-flows.md).

### <a name="standalone-web-apis"></a>Автономные веб-API
Можно использовать конечную точку версии 2.0 для [создания веб-API, защищенного с помощью OAuth 2.0](active-directory-v2-flows.md#web-apis). Однако такой веб-API может получать маркеры только от приложения с тем же идентификатором приложения. Невозможно получить доступ к веб-API из клиента с другим идентификатором приложения. Этот клиент не сможет запрашивать или получать разрешения для веб-API.

Чтобы узнать, как создать веб-API, принимающий маркеры от клиента с тем же идентификатором приложения, ознакомьтесь с примерами веб-API конечной точки версии 2.0 в разделе [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).

## <a name="restrictions-on-app-registrations"></a>Ограничения регистрации приложений
В настоящее время для каждого приложения, которое нужно интегрировать с конечной точкой версии 2.0, необходимо создать регистрацию на новом [портале регистрации приложений Майкрософт](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList). Существующие приложения Azure AD или учетной записи Майкрософт не совместимы с конечной точкой версии 2.0. Приложения, которые зарегистрированы на любом другом портале, кроме портала регистрации приложений, несовместимы с конечной точкой версии 2.0. Мы планируем в будущем предоставить возможность использования существующих приложений в качестве приложений для версии 2.0. В настоящее время невозможно выполнить миграцию существующего приложения для использования конечной точки версии 2.0.

Кроме того, имеются следующие замечания к регистрациям приложений, созданным на [портале регистрации приложений](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).

* Для идентификатора приложения можно использовать только два секрета приложения.
* Просматривать регистрацию приложения (зарегистрированного пользователем с личной учетной записью Майкрософт) и управлять ею можно только с помощью одной учетной записи разработчика. Регистрацию не могут совместно использовать несколько разработчиков. Если вы хотите совместно использовать регистрацию приложения с несколькими разработчиками, можно создать приложение, выполнив вход на портал регистрации с учетной записью Azure AD.
* К формату универсального кода ресурса (URI) перенаправления применяется несколько ограничений. Дополнительные сведения об универсальных кодах ресурсов (URI) перенаправления см. в следующем разделе.

## <a name="restrictions-on-redirect-uris"></a>Ограничения для универсальных кодов ресурсов (URI) перенаправления
В настоящее время приложения, зарегистрированные на портале регистрации приложений, ограничены определенным набором значений универсального кода ресурса (URI) перенаправления. Универсальный код ресурса (URI) перенаправления для веб-приложений и служб должен начинаться со схемы `https`. Все его значения должны совместно использовать один домен DNS. Например, невозможно зарегистрировать веб-приложение с одним из следующих универсальных кодов ресурсов (URI) перенаправления.

`https://login-east.contoso.com`  
`https://login-west.contoso.com`

Система регистрации сравнивает полное DNS-имя имеющегося универсального кода ресурса (URI) перенаправления и DNS-имя добавляемого универсального кода ресурса (URI) перенаправления. Запрос на добавление DNS-имени завершится ошибкой при выполнении любого из следующих условий.  

* Если DNS-имя нового универсального кода ресурса (URI) перенаправления не соответствует DNS-имени существующего универсального кода ресурса (URI) перенаправления.
* Если DNS-имя нового универсального кода ресурса (URI) перенаправления не является поддоменом существующего универсального кода ресурса (URI) перенаправления.

Например, в приложении используется приведенный ниже универсальный код ресурса (URI) перенаправления.

`https://login.contoso.com`

Можно добавить его следующим образом.

`https://login.contoso.com/new`

В этом случае DNS-имя полностью совпадает. Или же можно сделать следующее.

`https://new.login.contoso.com`

В этом случае используется ссылка на поддомен DNS, login.contoso.com. Если необходимо создать приложение с универсальными кодами ресурсов (URI) перенаправления login-east.contoso.com и login-west.contoso.com, то нужно добавить следующие универсальные коды ресурсов (URI) перенаправления в указанном порядке.

`https://contoso.com`  
`https://login-east.contoso.com`  
`https://login-west.contoso.com`  

Два последних значения являются поддоменами первого универсального кода ресурса (URI) перенаправления (contoso.com), поэтому их можно добавить. Это ограничение будет снято в следующей версии.

Также обратите внимание, что у вас есть только 20 URL-адресов ответа для конкретного приложения.

Чтобы узнать, как зарегистрировать приложение на портале регистрации приложений, ознакомьтесь с разделом [Как зарегистрировать приложение с использованием конечной точки версии 2.0](active-directory-v2-app-registration.md).

## <a name="restrictions-on-libraries-and-sdks"></a>Ограничения для библиотек и пакетов SDK
Сейчас поддержка библиотек для конечной точки версии 2.0 ограничена. Если требуется использовать конечную точку версии 2.0 в рабочем приложении, доступны приведенные ниже варианты.

* Если вы создаете веб-приложение, то для выполнения входа и проверки маркеров можно спокойно использовать общедоступную версию серверного ПО промежуточного слоя Майкрософт. В нее входит ПО промежуточного слоя OWIN OpenID Connect для ASP.NET и подключаемый модуль NodeJS Passport. Примеры кода с использованием ПО промежуточного слоя Майкрософт доступны в разделе [Приступая к работе](active-directory-appmodel-v2-overview.md#getting-started).
* При создании классического или мобильного приложения можно использовать одну из библиотек проверки подлинности Майкрософт предварительной версии. Эти библиотеки находятся на стадии предварительной версии с поддержкой рабочей среды, поэтому использовать их в рабочих приложениях безопасно. Дополнительные сведения об условиях предварительной версии и доступных библиотеках см. в статье [Библиотеки проверки подлинности Azure Active Directory версии 2.0](active-directory-v2-libraries.md).
* Для платформ, не поддерживаемых библиотеками Майкрософт, можно выполнять интеграцию с конечной точкой версии 2.0, непосредственно отправляя и принимая сообщения протокола в коде приложения. Чтобы помочь вам выполнить такую интеграцию, [мы добавили детальную информацию](active-directory-v2-protocols.md) о протоколах OpenID Connect и OAuth для версии 2.0.
* Наконец, для интеграции с конечной точкой версии 2.0 вы можете использовать библиотеки с открытым кодом OpenID Connect и OAuth. Протокол версии 2.0 должен быть совместим со многими другими библиотеками протоколов с открытым кодом без существенных изменений. Наличие этих библиотек зависит от языка и платформы. На веб-сайтах [Open ID Connect](http://openid.net/connect/) и [OAuth 2.0](http://oauth.net/2/) можно ознакомиться со списком популярных реализаций. Дополнительные сведения, список клиентских библиотек с открытым кодом и примеры, проверенные с конечной точкой версии 2.0, доступны в статье [Azure Active Directory (AD) версии 2.0 и библиотеки аутентификации](active-directory-v2-libraries.md).

## <a name="restrictions-on-protocols"></a>Ограничения для протоколов
Конечная точка версии 2.0 не поддерживает SAML или WS-Federation. Она поддерживает только Open ID Connect и OAuth 2.0. В ней реализованы не все функции и возможности протоколов OAuth. В настоящее время в конечной версии 2.0 *недоступны* приведенные ниже функции и возможности протокола.

* Маркеры идентификации, выданные конечной точкой версии 2.0, не содержат утверждение `email` для пользователя, даже если получено разрешение от пользователя на просмотр его электронной почты.
* Конечная точка сведений о пользователе OpenID Connect не реализована в конечной точке версии 2.0. Тем не менее все данные профилей пользователей, которые может получить эта конечная точка, доступны в конечной точке `/me` Microsoft Graph.
* Конечная точка версии 2.0 не поддерживает выдачу утверждений ролей или групп в маркерах идентификации.
* Она не поддерживает [предоставление учетных данных владельца ресурса OAuth 2.0](https://tools.ietf.org/html/rfc6749#section-4.3).

Кроме того, конечная точка версии 2.0 не поддерживает протоколы SAML или WS-Federation ни в какой форме.

Чтобы лучше понять область действия функций протоколов, поддерживаемых в конечной точке версии 2.0, ознакомьтесь со [справочником по протоколам OpenID Connect и OAuth 2.0](active-directory-v2-protocols.md).

## <a name="restrictions-for-work-and-school-accounts"></a>Ограничения для рабочих и учебных учетных записей
При использовании библиотеки проверки подлинности Active Directory (ADAL) в приложениях для Windows вы могли воспользоваться преимуществом встроенной проверки подлинности Windows, которая использует предоставление утверждения языка разметки заявлений системы безопасности (SAML). С его помощью пользователи федеративных клиентов Azure AD могут проходить аутентификацию в локальном экземпляре Active Directory автоматически, без необходимости ввода учетных данных. На данный момент предоставление утверждения SAML не поддерживается в конечной точке версии 2.0.
