---
title: Сведения о протоколах авторизации, поддерживаемых Azure AD версии 2.0 | Документация Майкрософт
description: Руководство по протоколам, поддерживаемым конечной точкой Azure AD версии 2.0.
services: active-directory
documentationcenter: ''
author: CelesteDG
manager: mtillman
editor: ''
ms.assetid: 5fb4fa1b-8fc4-438e-b3b0-258d8c145f22
ms.service: active-directory
ms.component: develop
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/22/2018
ms.author: celested
ms.reviewer: hirsin
ms.custom: aaddev
ms.openlocfilehash: 7c6031bb135c48a8d58f61c3c96bf18e817809ba
ms.sourcegitcommit: e14229bb94d61172046335972cfb1a708c8a97a5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2018
ms.locfileid: "34156227"
---
# <a name="v20-protocols---oauth-20--openid-connect"></a>Протоколы версии 2.0: OAuth 2.0 и OpenID Connect
Конечная точка версии 2.0 может использовать Azure AD для предоставления "идентификации как услуги" с помощью стандартных отраслевых протоколов OpenID Connect и OAuth 2.0. Хотя эта служба соответствует стандартам, между любыми двумя реализациями этих протоколов могут быть незначительные различия. Сведения в этой статье могут оказаться полезными, если вы планируете писать код с использованием прямой отправки и обработки HTTP-запросов или сторонней библиотеки с открытым кодом вместо одной из наших [библиотек с открытым кодом](active-directory-v2-libraries.md).

> [!NOTE]
> Не все сценарии и компоненты Azure Active Directory поддерживаются конечной точкой версии 2.0. Чтобы определить, следует ли вам использовать конечную точку 2.0, ознакомьтесь с [ограничениями версии 2.0](active-directory-v2-limitations.md).
>
>

## <a name="the-basics"></a>Основы
Почти во всех потоках обмена данными в OAuth и OpenID Connect участвуют четыре стороны:

![Роли OAuth 2.0](../../media/active-directory-v2-flows/protocols_roles.png)

* **Сервер авторизации** — это конечная точка версии 2.0. Он отвечает за удостоверение пользователя, предоставление и блокировку доступа к ресурсам, а также предоставление маркеров. Кроме того, этот сервер выполняет роль поставщика удостоверений: он безопасным способом обрабатывает любые данные, связанные со сведениями о пользователе, его доступом и отношениями доверия между участниками потока.
* **Владелец ресурса** — это, как правило, конечный пользователь. Это сторона, владеющая данными, которая может предоставлять третьим сторонам доступ к этим данным или ресурсу.
* **Клиент OAuth** — это ваше приложение, определяемое идентификатором приложения. Обычно именно с этой стороной взаимодействует конечный пользователь. Она также запрашивает маркеры у сервера авторизации. Владелец ресурса должен предоставить клиенту разрешение на доступ к ресурсу.
* **Сервер ресурсов** — место размещения ресурса или данных. Он позволяет серверу авторизации выполнять безопасную проверку подлинности и авторизацию клиента OAuth и использует маркеры доступа носителя для обеспечения возможности предоставления доступа к ресурсу.

## <a name="app-registration"></a>Регистрация приложения
Каждое приложение, использующее конечную точку 2.0, необходимо зарегистрировать на сайте [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), прежде чем станет доступна возможность взаимодействия с помощью OAuth или OpenID Connect. В процессе регистрации для приложения будет собрано и назначено несколько значений:

* **Идентификатор приложения** , определяющий конкретное приложение.
* **Универсальный код ресурса (URI) перенаправления** или **Идентификатор пакета**, которые можно использовать для возврата ответов к приложению.
* Несколько других зависящих от сценария значений.

Дополнительные сведения см. в статье о [регистрации приложения](active-directory-v2-app-registration.md).

## <a name="endpoints"></a>Конечные точки
После регистрации приложение взаимодействует с Azure AD, отправляя запросы к конечной точке версии 2.0:

```
https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize
https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
```

Где `{tenant}` может принимать одно из четырех значений:

| Значение | ОПИСАНИЕ |
| --- | --- |
| `common` |Позволяет пользователям с личными учетными записями Майкрософт и рабочими учетными записями Azure Active Directory выполнять вход в приложение. |
| `organizations` |Позволяет выполнять вход в приложение только пользователям с рабочими учетными записями Azure Active Directory. |
| `consumers` |Позволяет выполнять вход в приложение только пользователям с личными учетными записями Майкрософт. |
| `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` или `contoso.onmicrosoft.com` |Позволяет выполнять вход в приложение только пользователям с рабочими учетными записями определенного клиента Azure Active Directory. Можно использовать понятное доменное имя клиента Azure AD или идентификатор GUID клиента. |

Чтобы получить дополнительные сведения о взаимодействии с этими конечными точками, выберите конкретный тип приложения ниже.

## <a name="tokens"></a>Маркеры
В реализации OAuth 2.0 и OpenID Connect в версии 2.0 широко используются маркеры носителя, включая маркеры носителя в виде JWT. Токен носителя — это упрощенный маркер безопасности, предоставляющий его носителя (предъявителю) доступ к защищенному ресурсу. В этом смысле предъявителем является любая сторона, которая может предъявить маркер. Несмотря на то, что для получения токена носителя сторона должны сначала пройти проверку подлинности в Azure AD, если действия, необходимые для защиты маркера при его передаче и хранении не выполняются, его может перехватить и использовать несанкционированная сторона. Хотя в некоторых маркерах безопасности для предотвращения несанкционированного использования применяется специальный встроенный механизм, в токенах носителя такого механизма нет, и они должны передаваться по защищенному каналу, например с использованием стандарта безопасности транспортного уровня (HTTPS). Если токен носителя передается в незашифрованном виде, злоумышленник может использовать атаку "злоумышленник в середине", чтобы получить токен и использовать его для несанкционированного доступа к защищенному ресурсу. Те же принципы безопасности применяются при сохранении или кэшировании токенов носителя для последующего использования. Необходимо всегда проверять, что приложение передает и сохраняет токены носителя безопасным образом. Дополнительные сведения о безопасности в случае применения токенов носителя см. в [RFC 6750, раздел 5](http://tools.ietf.org/html/rfc6750).

Дополнительные сведения о различных типах маркеров, используемых в конечной точке 2.0, можно найти в [справочнике по маркерам конечной точки 2.0](active-directory-v2-tokens.md).

## <a name="protocols"></a>Протоколы
Если вы готовы рассмотреть несколько примеров запросов, приступите к одному из учебников ниже. Каждый из них соответствует определенному сценарию аутентификации. Сведения о том, как выбрать правильный поток, см. в статье о [типах приложений, которые можно создать с помощью версии 2.0](active-directory-v2-flows.md).

* [Создание мобильного и собственного приложения с использованием OAuth 2.0](active-directory-v2-protocols-oauth-code.md)
* [Создание веб-приложений с использованием OpenID Connect](active-directory-v2-protocols-oidc.md)
* [Создание одностраничных приложений с использованием неявного потока OAuth 2.0](active-directory-v2-protocols-implicit.md)
* [Создание управляющих программ или серверных процессов с использованием потока учетных данных клиентов OAuth 2.0](active-directory-v2-protocols-oauth-client-creds.md)
* [Azure Active Directory v2.0 and OAuth 2.0 On-Behalf-Of flow](active-directory-v2-protocols-oauth-on-behalf-of.md) (Поток "От имени" Azure Active Directory версии 2.0 и OAuth 2.0)
