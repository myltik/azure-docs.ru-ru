---
title: Руководство по администрированию для подключаемого модуля единого входа Azure Active Directory | Документация Майкрософт
description: Узнайте, как настроить единый вход между Azure Active Directory, Jira и Confluence.
services: active-directory
documentationCenter: na
author: jeevansd
manager: femila
ms.reviewer: joflore
ms.assetid: 4b663047-7f88-443b-97bd-54224b232815
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/06/2018
ms.author: jeedes
ms.openlocfilehash: d34ff6021816c73fb064a3ce73b7fcf3ae22dbd1
ms.sourcegitcommit: 6fcd9e220b9cd4cb2d4365de0299bf48fbb18c17
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2018
---
# <a name="admin-guide-for-the-azure-active-directory-sso-plug-in"></a>Руководство по администрированию для подключаемого модуля единого входа Azure Active Directory

## <a name="overview"></a>Обзор

Подключаемый модуль единого входа Azure Active Directory (Azure AD) позволяет пользователям использовать рабочую или учебную учетную запись для входа в Atlassian Jira и продукты Confluence на основе сервера. Этот модуль реализует единый вход на основе SAML 2.0.

## <a name="how-it-works"></a>Принцип работы

При входе в приложение Atlassian Jira или Confluence пользователи видят кнопку **Login with Azure AD** (Войти с помощью Azure AD) на странице входа. Если они нажмут эту кнопку, им потребуется выполнить вход с помощью страницы для входа в Azure AD организации (то есть их рабочей или учебной учетной записи).

Пройдя аутентификацию, пользователи смогут войти в приложение. Если они уже прошли аутентификацию с помощью идентификатора и пароля для своей рабочей или учебной учетной записи, они выполняют вход в приложение напрямую. 

Вход в систему Jira и Confluence выполняется одновременно. Если пользователи вошли в приложение Jira и в окне того же браузера открыто приложение Confluence, не нужно снова предоставлять учетные данные для другого приложения. 

Пользователи также могут получить продукт Atlassian через My Apps, используя рабочую или учебную учетную запись. Вход в систему должен осуществляться без необходимости предоставления учетных данных.

> [!NOTE]
> Подготовка пользователей с помощью подключаемого модуля не выполняется.

## <a name="audience"></a>Аудитория

Администраторы Jira и Confluence могут использовать подключаемый модуль, чтобы включить единый вход с помощью Azure AD.

## <a name="assumptions"></a>Предположения

* Экземпляры Jira и Confluence поддерживают протокол HTTPS.
* Пользователи уже созданы в Jira или Confluence.
* Пользователям назначены роли в Jira или Confluence.
* Администраторы имеют доступ к информации, необходимой для настройки подключаемого модуля.
* Приложения Jira или Confluence также доступны вне сети компании.
* Подключаемый модуль работает только с локальными версиями Jira и Confluence.

## <a name="prerequisites"></a>предварительным требованиям

Прежде чем начать установку подключаемого модуля, убедитесь в выполнении следующих требований.

* Приложения Jira и Confluence установлены в 64-разрядной версии Windows.
* Версии Jira и Confluence поддерживают протокол HTTPS.
* Jira и Confluence доступны в Интернете.
* Имеются учетные данные администратора для Jira и Confluence.
* Имеются учетные данные администратора для Azure AD.
* Сеанс WebSudo отключен в Jira и Confluence.

## <a name="supported-versions-of-jira-and-confluence"></a>Поддерживаемые версии Jira и Confluence

Подключаемый модуль поддерживает следующие версии Jira и Confluence:

* Jira Core и Jira Software: 6.0–7.2.0;
* Jira Service Desk: версии с 3.0 по 3.2;
* Confluence: версии c 5.0 по 5.10

## <a name="installation"></a>Установка

Для установки подключаемого модуля сделайте следующее:

1. Войдите в свой экземпляр Jira или Confluence с правами администратора.
    
2. Откройте консоль администрирования Jira или Confluence и установите флажок **Надстройки**.
    
3. На сайте Atlassian Marketplace выполните поиск по запросу **Microsoft SAML SSO Plugin** (Подключаемый модуль единого входа SAML Microsoft).
 
   Соответствующая версия подключаемого модуля появится в результатах поиска.
 
5. Выберите подключаемый модуль. Универсальный диспетчер подключаемых модулей (UPM) установит его.
 
После установки подключаемый модуль появится в подразделе **User Installed Add-ons** (Пользовательские надстройки) раздела **Manage Add-ons** (Управление надстройками).
    
## <a name="plug-in-configuration"></a>Настройка подключаемого модуля

Прежде чем начать использовать подключаемый модуль, его необходимо настроить. Выберите подключаемый модуль, нажмите кнопку **Настроить** и предоставьте сведения о конфигурации.

На следующем изображении показан экран настройки в Jira и Confluence.
    
![Экран настройки подключаемого модуля](./media/ms-confluence-jira-plugin-adminguide/jira.png)

*   **URL-адрес метаданных**. URL-адрес для получения метаданных федерации из Azure AD.
 
*   **Идентификаторы**. URL-адрес, который используется в Azure AD для проверки источника запроса. Это поле соответствует элементу **Идентификатор** в Azure AD. Подключаемый модуль автоматически получает этот URL-адрес в формате https://*<домен:порт>*/.
 
*   **URL-адрес ответа**. URL-адрес ответа в поставщике удостоверений (IdP), который инициирует вход SAML. Это поле сопоставляется с элементом **URL-адрес ответа** в Azure AD. Подключаемый модуль автоматически получает этот URL-адрес в формате https://*<домен:порт>*/plugins/servlet/saml/auth.
 
*   **Sign On URL** (URL-адрес для входа). URL-адрес входа в поставщик удостоверений, который инициирует вход SAML. Он сопоставляется с элементом **Вход** в Azure AD. Подключаемый модуль автоматически получает этот URL-адрес в формате https://*<домен:порт>*/plugins/servlet/saml/auth.
 
*   **IdP Entity ID** (Идентификатор сущности IdP). Идентификатор сущности, который использует поставщик удостоверений. Это поле заполняется, если URL-адрес метаданных разрешен.
 
*   **URL-адрес входа**. URL-адрес входа, предоставленный поставщиком удостоверений. Это поле заполняется из Azure AD, если URL-адрес метаданных разрешен.
 
*   **URL-адрес выхода**. URL-адрес для выхода от поставщика удостоверений. Это поле заполняется из Azure AD, если URL-адрес метаданных разрешен.
 
*   **Сертификат X.509**. Сертификат X.509 от поставщика удостоверений. Это поле заполняется из Azure AD, если URL-адрес метаданных разрешен.
 
*   **Login Button Name** (Название кнопки для входа). Название кнопки для входа, которое будет отображаться для пользователей на странице входа.
 
*   **SAML User ID Locations** (Расположения идентификаторов пользователей в SAML). Предполагаемое расположение идентификатора пользователя Jira или Confluence в ответе SAML. Он может находиться в **NameID** или в имени настраиваемого атрибута.
 
*   **Имя атрибута**. Имя атрибута, в котором может находиться идентификатор пользователя.
 
*   **Enable Home Realm Discovery** (Включить обнаружение домашней области). Позволяет указать, использует ли компания вход на основе служб федерации Active Directory (AD FS).
 
*   **Доменное имя**. Доменное имя, если вход в систему осуществляется на основе служб федерации Active Directory (AD FS).
 
*   **Enable Single Signout** (Включение единого выхода). Позволяет выбрать, нужно ли выходить из Azure AD, когда пользователь выходит из системы Jira или Confluence.

## <a name="troubleshooting"></a>Устранение неполадок

* **Получено несколько ошибок сертификата**. Войдите в Azure AD и удалите несколько сертификатов, которые доступны для приложения. Оставьте только один сертификат.

* **Срок действия сертификата в Azure AD истекает**. Надстройки выполняют автоматическую замену сертификата. По истечении срока действия сертификата новый сертификат должен быть помечен как активный, а неиспользуемые сертификаты — удалены. Если в этом случае пользователь попытается войти в Jira, подключаемый модуль извлечет и сохранит новый сертификат.

* **Необходимо отключить WebSudo (отключение безопасного сеанса администратора)**.
    
  * Для Jira безопасные сеансы администратора (то есть подтверждение пароля перед доступом к функциям администрирования) включены по умолчанию. Если вы хотите удалить эту возможность в вашем экземпляре Jira, укажите следующую строку в файле jira-config.properties: `ira.websudo.is.disabled = true`
    
  * Для Confluence выполните действия, указанные на [сайте технической поддержки Confluence](https://confluence.atlassian.com/doc/configuring-secure-administrator-sessions-218269595.html).

* **Поля, которые должны быть заполнены URL-адресом метаданных, не заполняются**.
    
  * Проверьте правильность URL-адреса. Проверьте, сопоставили ли вы правильные идентификатор клиента и приложения.
    
  * Введите URL-адрес в браузер и посмотрите, получаете ли вы XML метаданных федерации.

* **Возникла внутренняя ошибка сервера**. Просмотрите журналы в каталоге журналов установки. Если вы получаете сообщение об ошибке при попытке входа в систему с помощью единого входа Azure AD, предоставьте доступ к журналам службе поддержки.

* **Возникла ошибка "User ID not found" (Идентификатор пользователя не найден) при попытке войти в систему**. Создайте идентификатор пользователя в Jira или Confluence.

* **Возникла ошибка "App not found" (Приложение не найдено) в Azure AD**. Проверьте, сопоставлен ли соответствующий URL-адрес с приложением в Azure AD.

* **Необходима поддержка**. Обратитесь к [команде интеграции единого входа Azure AD](<mailto:SaaSApplicationIntegrations@service.microsoft.com>). Вам ответят в течение 24–48 рабочих часов.
    
  Можно также создать обращение в службу поддержки корпорации Майкрософт через портал Azure.