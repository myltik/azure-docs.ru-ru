---
title: Перемещение локальных приложений AD FS в Azure. | Документация Майкрософт
description: Цель этой статьи — предоставить организациям сведения о перемещении локальных приложений в Azure AD, уделив особое внимание федеративным приложениям SaaS.
services: active-directory
author: billmath
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/02/2018
ms.author: billmath
ms.openlocfilehash: 6303fdce65e460489c9f66e388c28383b9942627
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
---
# <a name="migrate-ad-fs-on-premises-apps-to-azure"></a>Перемещение локальных приложений AD FS в Azure 

Эта статья содержит сведения о перемещении локальных приложений в Azure Active Directory (Azure AD). Особое внимание уделяется федеративным приложениям SaaS. 

Здесь не приведены пошаговые инструкции. Он представляет собой общее руководство по перемещению с описанием преобразования локальных конфигураций в Azure AD, а также содержит сведения о наиболее распространенных сценариях.

## <a name="introduction"></a>Введение

Если у вас есть локальный каталог, который содержит учетные записи пользователей, скорее всего, у вас есть по крайней мере одно или два приложения, получить доступ к которым можно через вход с помощью соответствующих удостоверений пользователей.

Если ваша организация подобна большинству, вероятнее всего, вы рассматриваете использование облачных приложений и удостоверений. Возможно, вы готовы к работе с Office 365 и Azure AD Connect. Кроме того, возможно, что вы установили облачные приложения SaaS для некоторых основных рабочих нагрузок.  

Многие организации объединили приложения SaaS или пользовательские бизнес-приложения (LOB) непосредственно с локальными службами входа, например службой федерации Active Directory (AD FS), а также приложениями Office 365 и Azure AD. В этом руководстве по перемещению описываются причины и способы миграции локальных приложений в Azure AD.

>[!NOTE]
>Оно включает подробные сведения о перемещении и конфигурации приложения SaaS, а также общие сведения о пользовательских бизнес-приложениях. Более подробное описание пользовательских бизнес-приложений планируется в будущем.

![Приложения, подключенные локально](media/migrate-adfs-apps-to-azure/migrate1.png)

![Приложения, объединенные через Azure AD](media/migrate-adfs-apps-to-azure/migrate2.png)

## <a name="reasons-for-migrating-apps-to-azure-ad"></a>Причины для переноса приложений в Azure AD

Для организаций, которые уже используют AD FS, Ping или другой локальный поставщик проверки подлинности, перемещение приложений в Azure AD дает такие преимущества:

**Более безопасный доступ**
- Детально настройте элементы управления доступом каждого приложения, включая многофакторную идентификацию Azure, с помощью [условного доступа Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-azure-portal). Политики можно применить к приложениям SaaS и пользовательским приложениям таким же образом, который известен на сегодня для Office 365.
- Для обнаружения угроз и защиты входа на основе машинного обучения и эвристики, идентифицирующих рискованный трафик, воспользуйтесь [Защитой идентификации Azure AD](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection).

**Служба совместной работы Azure AD B2B**
- Если вход в приложения SaaS выполняется на основе Azure AD, можно предоставить партнерам доступ к облачным ресурсам с помощью [службы совместной работы Azure AD B2B](https://docs.microsoft.com/azure/active-directory/active-directory-b2b-what-is-azure-ad-b2b).

**Упрощенная процедура администрирования и дополнительные возможности Azure AD**
- Как поставщик удостоверений для приложений SaaS, Azure AD поддерживает следующие дополнительные возможности:
  - Сертификаты для подписи маркера для каждого приложения.
  - [Настраиваемые даты истечения срока действия сертификатов](https://docs.microsoft.com/azure/active-directory/active-directory-sso-certs).
  - [Автоматическая подготовка](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning) учетных записей пользователя (в основных приложениях Azure Marketplace) на основе удостоверений Azure AD.

**Использование возможностей локального поставщика удостоверений**
- Преимущества Azure AD позволяют использовать локальное решение проверки подлинности. Это дает возможность использовать локальные решения многофакторной идентификации, ведение журналов и аудит. 

**Помощь в прекращении использования локального поставщика удостоверений**
- Для организаций, которые больше не хотят использовать локальный продукт проверки подлинности, перемещение приложений в Azure AD предоставляет возможность удобного перехода за счет получения некоторых дополнительных сведений. 

## <a name="mapping-types-of-apps-on-premises-to-types-of-apps-in-azure-ad"></a>Сопоставление типов приложений в локальной среде с типами приложений в Azure AD
Большинство приложений подразделяются на несколько категорий в зависимости от используемого типа входа. Эти категории определяют, каким образом приложение представлено в Azure AD.

Коротко говоря, приложения SAML 2.0 можно интегрировать с Azure AD через коллекцию приложений Azure AD в Marketplace или как приложения, не связанные с Marketplace. Приложения, использующие OAuth 2.0 или OpenID Connect, можно интегрировать с Azure AD так же, как и при *регистрации приложений*. Чтобы получить дополнительные сведения, читайте дальше.

### <a name="federated-saas-apps-vs-custom-lob-apps"></a>Сравнение федеративных приложений SaaS с пользовательскими бизнес-приложениями
Федеративные приложения включают приложения, которые делятся на следующие категории.

- Приложения SaaS 
    - Если пользователи входят в приложения SaaS, такие как Salesforce, ServiceNow или Workday, и вы выполняете интеграцию с локальным поставщиком удостоверений, таким как AD FS или Ping, значит вы используете федеративную проверку подлинности приложений SaaS.
    - Для федеративного входа приложения обычно используют протокол SAML 2.0.
    - Приложения, которые попадают в эту категорию, можно интегрировать с Azure AD как корпоративные приложения, из Marketplace или как приложения, не связанные с Marketplace.
- Пользовательские бизнес-приложения
    - К этой категории относятся другие приложения, а не SaaS, разработанные внутри организации или доступные как стандартный продукт в пакете, установленный в вашем центре обработки данных. Сюда входят приложения SharePoint и приложения, созданные на платформе Windows Identity Foundation.
    - Для федеративного входа приложения могут использовать SAML 2.0, WS-Federation, OAuth или OpenID Connect.
    - Пользовательские приложения, использующие OAuth 2.0, OpenID Connect или WS-Federation, можно интегрировать с Azure AD как регистрации приложения, а пользовательские приложения, использующие SAML 2.0 или WS-Federation, можно интегрировать как приложения, не связанные с Marketplace, в рамках корпоративных приложений.

### <a name="non-federated-apps"></a>Нефедеративные приложения
Вы можете интегрировать нефедеративные приложения с Azure AD с помощью прокси-сервера приложения Azure AD и связанных функций. К нефедеративным приложениям относятся:
- Приложения, использующие встроенную проверку подлинности непосредственно с помощью Active Directory. Вы можете интегрировать эти приложения с Azure AD через [Azure AD Application Proxy](https://docs.microsoft.com/azure/active-directory/application-proxy-publish-azure-portal).
- Приложения, которые интегрируются с поставщиком единого входа через агент и используют заголовки для авторизации. Локальные приложения, использующие установленный агент для входа и авторизацию на основе заголовка, можно настроить для входа на основе Azure AD с помощью Azure AD Application Proxy с [доступом Ping Access для Azure AD](https://blogs.technet.microsoft.com/enterprisemobility/2017/06/15/ping-access-for-azure-ad-is-now-generally-available-ga/).

## <a name="translating-on-premises-federated-apps-to-azure-ad"></a>Переход локальных федеративных приложений в Azure AD 
Службы AD FS и Azure AD работают похожим образом, поэтому понятия настройки отношения доверия, URL-адресов входа и выхода, а также идентификаторов можно применить для двух служб. Однако есть некоторые небольшие различия, с которыми необходимо ознакомиться в рамках перехода.

В таблицах ниже сопоставлено несколько ключевых идей, подходящих для приложений AD FS, Azure AD и SaaS. 

### <a name="representing-the-app-in-azure-ad-or-ad-fs"></a>Описание приложения в Azure AD или AD FS
Перемещение начинается с оценки настройки приложения в локальной среде и сопоставления этой конфигурации с Azure AD. В таблице ниже приведено сопоставление элементов конфигурации проверяющей стороны AD FS с соответствующими элементами в Azure AD.  
- Условие AD FS: проверяющая сторона или доверие проверяющей стороны.
- Условие Azure AD: корпоративное приложение или регистрация приложения (в зависимости от типа приложения).

|Элемент конфигурации приложения|ОПИСАНИЕ|Расположение в рамках конфигурации AD FS|Соответствующее расположение в конфигурации Azure AD|Элемент токена SAML|
|-----|-----|-----|-----|-----|
|URL-адрес входа приложения|URL-адрес страницы входа этого приложения. Это расположение, куда переходит пользователь для входа в приложение в потоке SAML, запущенном SP.|Недоступно|В Azure AD URL-адрес входа настроен на портале Azure в свойствах **единого входа** приложения как URL-адрес входа.</br></br>(Чтобы просмотреть URL-адрес входа, выберите **Показать дополнительные параметры URL-адресов**.)|Недоступно|
|URL-адрес ответа приложения|URL-адрес приложения с точки зрения поставщика удостоверений (IdP). Это расположение, откуда отправляются пользователь и токен после входа пользователя через поставщика удостоверений.</br></br> Иногда это расположение называют "конечной точкой потребителя утверждения SAML".|Элемент можно найти в доверии проверяющей стороны AD FS приложения. Щелкните проверяющую сторону правой кнопкой мыши и выберите **Свойства**, а затем откройте вкладку **Конечные точки**.|В Azure AD URL-адрес ответа настроен на портале Azure в свойствах **единого входа** приложения как URL-адрес ответа.</br></br>(Чтобы просмотреть URL-адрес ответа, выберите **Показать дополнительные параметры URL-адресов**.)|Сопоставляется с элементом **назначения** в токене SAML.</br></br> Пример значения: https://contoso.my.salesforce.com|
|URL-адрес выхода приложения|URL-адрес, на который отправляются запросы "очистки выхода" после выхода пользователя из приложения, чтобы выйти из всех остальных приложений, куда пользователь был направлен через поставщика удостоверений.|Элемент можно найти в управлении AD FS — **Отношения доверия проверяющей стороны**. Щелкните проверяющую сторону правой кнопкой мыши и выберите **Свойства**, а затем откройте вкладку **Конечные точки**.|Недоступно Azure AD не поддерживает единый выход, то есть выход всех приложений. Выполняется выход пользователя из Azure AD.|Недоступно|
|Идентификатор приложения|Идентификатор приложения с точки зрения поставщика удостоверений. Значение URL-адреса входа часто (но не всегда) используется для идентификатора.</br></br> Иногда приложение вызывает этот "идентификатор сущности".|В AD FS это идентификатор проверяющей стороны. Щелкните отношение доверия с проверяющей стороной правой кнопкой мыши, выберите **Свойства**, а затем откройте вкладку **Идентификаторы**.|В Azure AD идентификатор настроен на портале Azure в свойствах **единого входа** приложения как идентификатор в разделе **доменов и URL-адресов**. (Вы можете установить флажок **Показать дополнительные параметры URL-адресов**.)|Соответствует элементу **аудитории** в токене SAML.|
|Метаданные федерации приложения|Расположение метаданных федерации приложения. Поставщик удостоверений использует его для автоматического обновления определенных настроек конфигурации, например конечных точек или сертификатов шифрования.|URL-адрес метаданных федерации приложения можно найти в отношении доверия с проверяющей стороной AD FS. Щелкните правой кнопкой мыши отношение доверия, выберите **Свойства**, а затем откройте вкладку **Мониторинг**.|Недоступно Azure AD не поддерживает прямое использование метаданных федерации приложения.|Недоступно|
|Идентификатор пользователя или **имени**|Атрибут для уникального определения идентификатора пользователя из Azure AD или AD FS при входе в приложение.</br></br> Обычно этот атрибут представляет собой имя участника-пользователя или адрес электронной почты пользователя.|В AD FS он указывается как правило утверждения проверяющей стороны. В большинстве случаев именно это правило выдает утверждение с типом, который оканчивается на "идентификатор_имени".|В Azure AD идентификатор пользователя можно найти на портале Azure в свойствах **единого входа** приложения в **атрибутах пользователя** заголовка.</br></br>По умолчанию используется имя участника-пользователя.|Передается из поставщика удостоверений в приложение как элемент **идентификатора имени** в токене SAML.|
|Другие утверждения, отправляемые в приложение|Кроме идентификатора пользователя или **имени** из поставщика удостоверений в приложение обычно отправляются и другие сведения об утверждениях. Например, имя, фамилия, адрес электронной почты и список групп, участником которых является пользователь.|В AD FS этот элемент может представлять собой другие правила утверждения проверяющей стороны.|В Azure AD его можно найти на портале Azure в свойствах **единого входа** приложения в **атрибутах пользователя** заголовка. Выберите **Просмотр** и измените все другие атрибуты пользователя.|Недоступно|  

### <a name="representing-azure-ad-as-an-identity-provider-in-an-saas-app"></a>Azure AD как поставщик удостоверений в приложении SaaS
В процессе перемещения приложение необходимо настроить для точки в Azure AD (в отличие от локального поставщика удостоверений). В этом разделе внимание уделяется приложениям SaaS, использующим протокол SAML, а не пользовательским бизнес-приложениям. Тем не менее основные понятия также охватывают пользовательские бизнес-приложения. 

На высоком уровне есть некоторые ключевые элементы, которые стоит учесть при перемещении приложения SaaS в Azure AD.
- Издатель поставщика удостоверений: https://sts.windows.net/{tenant-id}/.
- URL-адрес входа поставщика удостоверений: https://login.microsoftonline.com/{tenant-id}/saml2.
- URL-адрес выхода поставщика удостоверений: https://login.microsoftonline.com/{tenant-id}/saml2. 
- Расположение метаданных федерации: https://login.windows.net/{tenant-id}/federationmetadata/2007-06/federationmetadata.xml?appid={<application-id}. 

Замените {tenant-id} своим идентификатором клиента, доступном на портале Azure: выберите **Azure Active Directory** >  в качестве **идентификатора каталога** выберите **Свойства**. Замените {application-id} идентификатором приложения, доступным в свойствах приложения как **идентификатор приложения**.

В таблице ниже приведены сведения об основных элементах конфигурации поставщика удостоверений для настройки параметров единого входа в приложении и их значений или расположений в AD FS и Azure AD. Структура таблицы подразумевает приложение SaaS, которому необходимо знать, куда отправлять запросы на проверку подлинности, а также способы проверки полученных токенов.

|Элемент конфигурации|ОПИСАНИЕ|AD FS|Azure AD|
|---|---|---|---|
|URL-адрес </br>входа поставщика удостоверений </br>URL-адрес|URL-адрес входа поставщика удостоверений с точки зрения приложения (расположение, откуда пользователь перенаправляется для входа в систему).|URL-адрес входа AD FS представляет собой имя службы федерации AD FS, за которым следует /adfs/ls/. Например: https://fs.contoso.com/adfs/ls/.|Соответствующее значение Azure AD отвечает шаблону, где {tenant-id} заменяется соответствующим идентификатором клиента. Он доступен на портале Azure. Выберите **Azure Active Directory** >  в качестве **идентификатора каталога** выберите **Свойства**.</br></br>Для приложений, использующих протокол SAML-P: https://login.microsoftonline.com/{tenant-id}/saml2 </br></br>Для приложений, использующих протокол WS-Federation: https://login.microsoftonline.com/{tenant-id}/wsfed|
|URL-адрес </br>Выход </br>URL-адрес|URL-адрес выхода поставщика удостоверений с точки зрения приложения (откуда перенаправляются пользователи при выходе из приложения).|Для AD FS URL-адрес выхода сходный с URL-адресом входа или URL-адресом с добавленным элементом wa=wsignout1.0. Например: https://fs.contoso.com/adfs/ls/?wa=wsignout1.0.|Соответствующее значение Azure AD зависит от того, поддерживает ли приложение выход SAML 2.0.</br></br>Если приложение поддерживает выход SAML, значение отвечает шаблону, где значение для {tenant-id} заменяется соответствующим идентификатором клиента. Он доступен на портале Azure. Выберите **Azure Active Directory**  >  в качестве **идентификатора каталога** выберите **Свойства**: https://login.microsoftonline.com/{tenant-id}/saml2</br></br>Если приложение не поддерживает выход SAML: https://login.microsoftonline.com/common/wsfederation?wa=wsignout1.0|
|по маркеру </br>Сертификат для подписи токена </br>на основе сертификата.|Сертификат, закрытый ключ которого использует поставщик удостоверений для подписи выданных токенов. Он проверяет, поступил ли токен от того же поставщика удостоверений, с которым у приложения настроено отношение доверия.|Сертификат для подписи маркера AD FS находится в управлении AD FS в разделе **Сертификаты**.|В Azure AD сертификат для подписи токена можно найти на портале Azure в свойствах **единого входа** приложения в заголовке **сертификатов для подписи токена SAML**. Здесь можно загрузить сертификат для передачи приложению.</br></br> Если приложение включает несколько сертификатов, их все можно найти в XML-файле метаданных федерации.|
|Идентификатор или</br>издатель|Идентификатор поставщика удостоверений с точки зрения приложения (иногда называется идентификатором издателя).</br></br>В токене SAML значение отображается как элемент **Издатель**.|Идентификатор AD FS обычно представляет собой идентификатор службы федерации в управлении AD FS: **Служба** > **Изменить свойства службы федерации**. Например: http://fs.contoso.com/adfs/services/trust|Соответствующее значение Azure AD отвечает шаблону, где значение {tenant-id} заменяется соответствующим идентификатором клиента. Он доступен на портале Azure. Выберите **Azure Active Directory**  >  в качестве **идентификатора каталога** выберите **Свойства**. https://sts.windows.net/{tenant-id}/|
|URL-адрес </br>URL-адрес метаданных федерации </br>metadata|Расположение общедоступных метаданных федерации поставщика удостоверений. (Некоторые приложения используют метаданные федерации как альтернативу отдельной настройке администратора URL-адресов, идентификатору и сертификату для подписи маркера.)|URL-адрес метаданных федерации AD FS находится в службе управления AD FS в разделе **Служба** > **Конечные точки** > **Метаданные** > **Тип: Метаданные федерации**. Например: https://fs.contoso.com/FederationMetadata/2007-06/FederationMetadata.xml|Нужное значение для Azure AD соответствует шаблону https://login.microsoftonline.com/{TenantDomainName}/FederationMetadata/2007-06/FederationMetadata.xml. Значение {TenantDomainName} заменяется именем вашего клиента в формате contoso.onmicrosoft.com. </br></br>Дополнительные сведения см. в статье [Метаданные федерации](https://docs.microsoft.com/azure/active-directory/develop/active-directory-federation-metadata).

## <a name="migrating-saas-apps"></a>Перемещение приложений SaaS
На сегодняшний день перемещение приложений SaaS из AD FS или другого поставщика удостоверений в Azure AD выполняется вручную. Дополнительные сведения об определенных приложениях см. в статье [Интеграция приложений SaaS с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list).

Сведения в этих руководствах по интеграции относятся к интеграции новых развертываний. Для соответствующего планирования, оценки, настройки и перемещения приложений есть несколько основных понятий, которые относятся к миграции и с которыми необходимо ознакомиться.  
- Некоторые приложения можно переместить без проблем. Приложениям с более комплексными требованиями, например пользовательскими утверждениями, может потребоваться дополнительная настройка в Azure AD или Azure AD Connect.
- В большинстве случаев приложению требуются только утверждение **NameId** и другие распространенные утверждения идентификатора пользователя. Чтобы определить, требуются ли какие-то дополнительные утверждения, проверьте, какие утверждения выдает AD FS или поставщик удостоверений стороннего производителя.
- Выяснив, что требуются дополнительные утверждения, следует проверить их доступность в Azure AD. Для синхронизации обязательного атрибута (например, **samAccountName**) с Azure AD необходимо настроить конфигурацию синхронизации Azure AD Connect.
- Как только атрибуты станут доступны в Azure AD, добавьте правила выдачи утверждений в Azure AD, чтобы включить эти атрибуты как утверждения в выданные токены. Добавьте эти правила в свойства **единого входа** приложения в Azure AD.

### <a name="assess-what-can-be-migrated"></a>Доступ к объектам, доступным для перемещения
Приложения SAML 2.0 можно интегрировать с Azure AD через коллекцию приложений Azure AD в Marketplace или как приложения, не связанные с Marketplace.  

Некоторые конфигурации требуют дополнительных действий по настройке в Azure AD, а некоторые на сегодняшний день не поддерживаются. Чтобы определить доступные для перемещения объекты, просмотрите текущую конфигурацию всех приложений. Уделите особое внимание следующему:
- настроенным правилам утверждений (правила преобразования выдачи);
- формату и атрибуту **NameID** SAML;
- выданным версиям токена SAML;
- другим конфигурациям, таким как правила авторизации выдачи, политики управления доступом и правила многофакторной идентификации (дополнительная проверка подлинности).

#### <a name="what-can-be-migrated-today"></a>Что доступно для перемещения на сегодняшний день
На сегодняшний день можно легко переместить приложения SAML 2.0, использующие стандартный набор элементов и утверждений конфигурации. Они могут включать:
- Имя участника-пользователя.
- Электронная почта.
- Заданное имя.
- Фамилию.
- Альтернативный атрибут, такой как **NameID** SAML, включая атрибуты электронной почты Azure AD, префикса электронной почты, идентификатор сотрудника и расширения 1–15, или локальный атрибут **SamAccountName**. Дополнительные сведения см. в статье [Настройка утверждений, выпущенных в токене SAML для корпоративных приложений в Azure Active Directory](./develop/active-directory-saml-claims-customization.md).
- Пользовательские утверждения. Дополнительные сведения о поддерживаемых сопоставлениях утверждений см. в статье [Сопоставление утверждений в Azure Active Directory (общедоступная предварительная версия)](active-directory-claims-mapping.md) и [Настройка утверждений, выпущенных в токене SAML для корпоративных приложений в Azure Active Directory](./develop/active-directory-saml-claims-customization.md).

Кроме пользовательских утверждений и элементов **NameID**, конфигурации, требующие дополнительных действий по настройке в Azure AD при перемещении, включают:
- Пользовательскую авторизацию или правила многофакторной идентификации в AD FS. Их можно настроить с помощью функции [условного доступа Azure AD](active-directory-conditional-access-azure-portal.md).
- Приложения с несколькими конечными точками SAML. Их можно настроить в Azure AD с помощью PowerShell. (Эта возможность недоступна на портале.)
- Приложения WS-Federation, например приложения SharePoint, которым требуются токены SAML версии 1.1. Их нужно настроить вручную с помощью PowerShell.

#### <a name="apps-and-configurations-not-supported-in-azure-ad-today"></a>Приложения и конфигурации, неподдерживаемые в Azure AD на сегодняшний день
Миграция приложений, которым требуются возможности ниже, пока недоступна. Если у вас есть приложения, которым требуются функции ниже, оставьте свой отзыв в разделе комментариев.
- Возможности протокола:
    - Поддержка единого выхода SAML (SLO) всех приложений, для которых выполнен вход.
    - Поддержка шаблона WS-Trust ActAs.
    - Разрешение артефактов SAML.
    - Проверка подписи запросов SAML. Обратите внимание, что подписанные запросы принимаются, но подпись не проверяется.
- Возможности токена: 
    - Шифрование токенов SAML. 
    - Токены SAML версии 1.1 в ответах протокола SAML. 
- Утверждения в возможностях токена:
    - Назначение локальных имен группы как утверждений.
    - Утверждения из хранилищ данных, отличных от Azure AD.
    - Комплексные правила преобразования выдачи утверждений. Дополнительные сведения о поддерживаемых сопоставлениях утверждений см. в статье [Сопоставление утверждений в Azure Active Directory (общедоступная предварительная версия)](https://docs.microsoft.com/azure/active-directory/active-directory-claims-mapping) и [Настройка утверждений, выпущенных в токене SAML для корпоративных приложений в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).
    - Назначение расширений каталога как утверждений.
    - Пользовательская спецификация формата **NameID**.
    - Выдача атрибутов с несколькими значениями.

>[!NOTE]
>Azure AD непрерывно развивается для добавления возможностей в эту область. Сведения в этой статье постоянно обновляются. 

### <a name="configure-azure-ad"></a>Настройка Azure AD    
#### <a name="configure-single-sign-on-sso-settings-for-the-saas-app"></a>Настройка параметров единого входа (SSO) для приложения SaaS

В Azure AD настройка входа SAML (в рамках требований приложения) выполняется в свойствах **единого входа** приложения в **атрибутах пользователя**.

![Свойства единого входа и раздел "Атрибуты пользователя"](media/migrate-adfs-apps-to-azure/migrate3.png)

Выберите **просмотр и изменение других атрибутов пользователя**, чтобы просмотреть атрибуты для отправки в виде утверждений в маркере безопасности.

![Список атрибутов](media/migrate-adfs-apps-to-azure/migrate4.png)

Щелкните определенную строку атрибута, чтобы изменить ее, или выберите **Добавить атрибут** для добавления нового атрибута.

![Область "Изменить атрибут"](media/migrate-adfs-apps-to-azure/migrate5.png)

#### <a name="assign-users-to-the-app"></a>Назначение пользователей приложению
Чтобы пользователи в Azure AD могли войти в приложение SaaS, необходимо предоставить им доступ.

Чтобы назначить пользователей на портале Azure AD, перейдите на страницу приложения SaaS и выберите **Пользователи и группы** на боковой панели. Чтобы добавить пользователя или группу, выберите **Добавить пользователя** в верхней части области. 

![Кнопка "Добавить пользователя" в разделе "Пользователи и группы"](media/migrate-adfs-apps-to-azure/migrate6.png) 

![Область "Добавление назначения"](media/migrate-adfs-apps-to-azure/migrate7.png)

Для проверки доступа пользователь должен увидеть приложение SaaS на [панели доступа](https://docs.microsoft.com/azure/active-directory/active-directory-saas-access-panel-introduction) при входе. Панель доступа можно найти по этому адресу http://myapps.microsoft.com. В этом примере пользователю успешно предоставлен доступ к Salesforce и ServiceNow.

![Пример панели доступа с приложениями Salesforce и ServiceNow](media/migrate-adfs-apps-to-azure/migrate8.png)

### <a name="configure-the-saas-app"></a>Настройка приложения SaaS
Процесс перехода из локальной федерации в Azure AD зависит от того, поддерживает ли приложение SaaS, с которым вы работаете, несколько поставщиков удостоверений. Ниже приведены некоторые распространенные вопросы о поддержке нескольких поставщиков удостоверений.

   **Вопрос. Что значит поддержка приложением нескольких поставщиков удостоверений?**
    
   Ответ. Приложения SaaS, которые поддерживают несколько поставщиков удостоверений, дают возможность вводить все необходимые сведения о новом поставщике (в нашем случае — Azure AD) перед применением изменений возможностей входа. После завершения конфигурации можно переключить конфигурацию проверки подлинности приложения для точки в Azure AD.

   **Вопрос. Почему важна поддержка нескольких поставщиков удостоверений?**

   Ответ. При отсутствии поддержки нескольких поставщиков удостоверений администратору необходимо зарезервировать некоторое время как время сбоя обслуживания или службы, во время которого он настроит Azure AD в качестве нового поставщика удостоверения. Во время этого сбоя пользователи получат уведомления о невозможности выполнить вход в учетную запись.

   Если приложение поддерживает несколько поставщиков удостоверений, дополнительный поставщик удостоверений можно настроить заранее. Затем администратор сможет переключить поставщика удостоверений во время перехода в Azure.

   Если приложение поддерживает несколько поставщиков удостоверений и вы выбираете их для одновременной обработки проверки подлинности входа, пользователь может выбрать поставщик для проверки подлинности на странице входа.

#### <a name="example-support-for-multiple-idps"></a>Пример: поддержка нескольких поставщиков удостоверений
Например, в Salesforce конфигурацию поставщика удостоверений можно найти здесь: **Параметры** > **Параметры компании** > **My Domain** (Мой домен) > **Authentication Configuration** (Конфигурация проверки подлинности).

![Раздел Authentication Configuration (Конфигурация проверки подлинности) в приложении Salesforce](media/migrate-adfs-apps-to-azure/migrate9.png)

Так как ранее мы создали конфигурацию в разделе **Удостоверение** > **Single sign-on settings** (Параметры единого входа), вы можете изменить поставщик удостоверений конфигурации проверки подлинности. Например, его можно изменить с AD FS на Azure AD. 

![Выбор Azure AD в качестве службы проверки подлинности](media/migrate-adfs-apps-to-azure/migrate10.png)

### <a name="optional-configure-user-provisioning-in-azure-ad"></a>Необязательно. Настройка подготовки пользователей в Azure AD
Если вы хотите, чтобы в Azure AD напрямую выполнялась обработка подготовки пользователей для приложения SaaS, ознакомьтесь со статьей [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning).

## <a name="next-steps"></a>Дополнительная информация

- [Управление приложениями с помощью Azure Active Directory](active-directory-enable-sso-scenario.md)
- [Управление доступом к приложениям](active-directory-managing-access-to-apps.md)
- [Azure AD Connect и федерация](active-directory-aadconnectfed-whatis.md)
