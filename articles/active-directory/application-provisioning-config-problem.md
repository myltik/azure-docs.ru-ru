---
title: Проблема при настройке подготовки пользователей для приложения из коллекции Azure AD | Документы Майкрософт
description: Решение распространенных проблем при настройке подготовки пользователей для приложения из коллекции приложений Azure AD
services: active-directory
documentationcenter: ''
author: ajamess
manager: mtillman
ms.assetid: ''
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: asteen
ms.openlocfilehash: 9fcfee9cbbeb01422e7d9e92d90b908e054f96da
ms.sourcegitcommit: 48ab1b6526ce290316b9da4d18de00c77526a541
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2018
ms.locfileid: "30160337"
---
# <a name="problem-configuring-user-provisioning-to-an-azure-ad-gallery-application"></a>Проблема при настройке подготовки пользователей для приложения из коллекции Azure AD

При настройке [автоматической подготовки пользователей](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning) для приложения (если она поддерживается) необходимо выполнить определенные инструкции для автоматической подготовки приложения. Затем можно настроить службу подготовки для синхронизации учетных записей пользователей для приложения на портале Azure.

Для начала следует найти руководство по настройке подготовки для вашего приложения. Затем выполните указанные в нем действия, чтобы создать подключение подготовки между приложением и Azure AD. Руководства по настройке для приложений можно найти в [Списке руководств по интеграции приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list).

## <a name="how-to-see-if-provisioning-is-working"></a>Как проверить, работает ли развертывание 

После настройки службы большую часть сведений о работе службы можно найти в двух местах:

-   **Журналы аудита** — в журналах аудита подготовки хранятся записи обо всех операциях, выполняемых службой подготовки, включая запросы Azure AD для назначенных пользователей, которые находятся в области для подготовки, запросы целевого приложения на наличие этих пользователей и сравнение объектов пользователя в разных системах. Затем добавьте, измените или отключите учетную запись пользователя в целевой системе на основе сравнения. Журналы аудита для подготовки можно открыть на портале Azure на вкладке **Azure Active Directory &gt; Корпоративные приложения &gt; \[Имя приложения\] &gt; Журналы аудита**. Чтобы просмотреть события подготовки только для этого приложения, отфильтруйте журналы по категории **Учетная запись подготовки**.

-   **Состояние подготовки** — общие сведения о последнем запуске подготовки для указанного приложения доступны в разделе **Azure Active Directory &gt; Корпоративные приложения &gt; \[имя приложения\] &gt;Подготовка** в нижней части экрана под настройками службы. В этом разделе указано количество пользователей (или групп), которые в настоящее время синхронизируются между двумя системами, а также указаны ошибки. Сведения об ошибке можно найти в журнале аудита. Обратите внимание, что состояние подготовки будет указано только после завершения одной полной начальной синхронизации между Azure AD и приложением.

## <a name="general-problem-areas-with-provisioning-to-consider"></a>Общие проблемные области при подготовке, которые необходимо учитывать

Ниже приведен список общих проблемных областей, в которые можно углубиться, если у вас есть какие-то идеи.

* [Служба подготовки не запускается](#provisioning-service-does-not-appear-to-start)
* [Не удалось сохранить конфигурацию из-за недействительных учетных данных приложения](#can’t-save-configuration-due-to-app-credentials-not-working)
* [Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены](#audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned)

## <a name="provisioning-service-does-not-appear-to-start"></a>Служба подготовки не запускается

Предположим, что вы установили параметр **Состояние подготовки** в значение **Вкл** в разделе **Azure Active Directory &gt; Корпоративные приложения &gt; \[имя приложения\] &gt;Подготовка** портала Azure. Однако при последующей перезагрузке никакие другие сведения о состоянии на этой странице не отображаются. Вероятно, что служба запущена, но первоначальная синхронизация еще не завершена. Проверьте **журналы аудита**, как описано выше, чтобы определить, какие операции выполняет служба и не возникают ли ошибки.

>[!NOTE]
>Первоначальная синхронизация может занять от 20 минут до нескольких часов, в зависимости от размера каталога Azure AD и количества пользователей в области подготовки. Последующие операции синхронизации занимают меньше времени, так как служба подготовки сохраняет "водяные знаки", которые представляют состояние обеих систем после начальной синхронизации. Это позволяет повысить скорость последующих операций синхронизации.
>
>

## <a name="cant-save-configuration-due-to-app-credentials-not-working"></a>Не удалось сохранить конфигурацию из-за недействительных учетных данных приложения

Для подготовки Azure AD требуются действительные учетные данные для подключения к API управления пользователями для этого приложения. Если эти учетные данные не работают или вы их не знаете, обратитесь к руководству по настройке этого приложения, приведенному выше.

## <a name="audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned"></a>Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены

Если пользователь отображается в журналах аудита как "пропущенный", очень важно ознакомиться с подробными сведениями об ошибке, чтобы определить причину. Ниже приведены распространенные причины и способы устранения ошибок:

-   **Настроен фильтр области** **, который фильтрует пользователей на основе значения атрибута**. Дополнительные сведения о фильтрах области см. по ссылке <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>.

-   **Пользователь "не имеет фактических прав".** Если вы видите это сообщение об ошибке, это свидетельствует о наличии проблемы с записью назначения пользователя, которая хранится в Azure AD. Для устранения этой проблемы отмените назначение пользователя (или группы) для приложения и повторно назначьте пользователя (или группу). Дополнительные сведения о назначении см. по ссылке <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>.

-   **Обязательный атрибут для пользователя отсутствует или его значение не указано.** При настройке подготовки важно просмотреть и настроить сопоставления атрибутов и рабочие процессы, которые определяют, какие свойства пользователя (или группы) передаются из Azure AD в приложение. К ним относится "свойство сопоставления", используемое для уникальной идентификации и сопоставления пользователей или групп между двумя системами. Дополнительные сведения об этом важном процессе см. по ссылке <https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings>.

   * **Сопоставление атрибутов для групп:** подготовка имени группы и сведений о группе наряду с ее участниками (если поддерживается для некоторых приложений). Вы можете включить или отключить эту функцию, включив или отключив **сопоставление** для объектов группы, отображаемых на вкладке **Подготовка**. Если подготовка групп включена, обязательно ознакомьтесь с атрибутами сопоставления, чтобы убедиться, что в качестве соответствующего идентификатора используется подходящее поле. В качестве этого поля может использоваться отображаемое имя или псевдоним электронной почты. Если соответствующее свойство для группы в Azure AD не указано или не заполнено, группа и ее участники не будут подготовлены.

## <a name="next-steps"></a>Дополнительная информация
[Автоматическая подготовка пользователей и ее отзыв для приложений SaaS в Azure Active Directory](active-directory-saas-app-provisioning.md)
