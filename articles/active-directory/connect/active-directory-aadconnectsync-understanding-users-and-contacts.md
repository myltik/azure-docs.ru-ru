---
title: 'Синхронизация Azure AD Connect: общие сведения о пользователях, группах и контактах | Документация Майкрософт'
description: Общие сведения о пользователях, группах и контактах в службе синхронизации Azure AD Connect.
services: active-directory
documentationcenter: ''
author: billmath
manager: mtillman
ms.assetid: 8d204647-213a-4519-bd62-49563c421602
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/15/2018
ms.component: hybrid
ms.author: markvi;andkjell
ms.openlocfilehash: 2e249fbf63adc459a29aa3e39e22f97b5769586a
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34593339"
---
# <a name="azure-ad-connect-sync-understanding-users-groups-and-contacts"></a>Синхронизация Azure AD Connect: общие сведения о пользователях, группах и контактах
Существует несколько разных причин, по которым нужно иметь несколько лесов Active Directory. Кроме того, существует несколько разных топологий развертывания. Распространенные модели включают развертывание ресурсов учетной записи и лесов с синхронизированным глобальным списком адресов после слияния и поглощения. Но даже при наличии чистых моделей гибридные модели не менее часто используются. Конфигурация по умолчанию в службе синхронизации Azure AD Connect не предполагает какой-то конкретной модели. Тем не менее, в зависимости от выбора сопоставления пользователей в руководстве по установке, можно наблюдать разное поведение.

В этом разделе будет рассмотрено поведение конфигурации по умолчанию в определенных топологиях. Мы изучим конфигурацию с помощью редактора правил синхронизации.

Конфигурация предполагает наличие нескольких общих правил.
* Конечный результат всегда должен быть одинаковым, независимо от используемого порядка импорта исходных каталогов Active Directory.
* Активная учетная запись всегда будет передавать данные для входа, включая атрибуты **userPrincipalName** и **sourceAnchor**.
* Если активная учетная запись не найдена, будут использованы атрибуты userPrincipalName и sourceAnchor из отключенной учетной записи, если только это не связанный почтовый ящик.
* Учетная запись со связанным почтовым ящиком никогда не будет использоваться для передачи атрибутов userPrincipalName и sourceAnchor. Предполагается, что активная учетная запись будет найдена позже.
* Контактный объект может быть подготовлен в Azure AD как контакт или пользователь. Фактически, это остается неизвестным до тех пор, пока не будут обработаны все исходные леса Active Directory.

## <a name="groups"></a>Группы
При синхронизации групп из Active Directory в Azure AD важно учитывать следующие моменты:

* Azure AD Connect не синхронизирует встроенные группы безопасности;

* Azure AD Connect не поддерживает синхронизацию [основных групп](https://technet.microsoft.com/library/cc771489(v=ws.11).aspx) в Azure AD;

* Azure AD Connect не поддерживает синхронизацию [динамических групп рассылки](https://technet.microsoft.com/library/bb123722(v=exchg.160).aspx) в Azure AD.

* Чтобы синхронизировать группу Active Directory в Azure AD как группу с поддержкой электронной почты, выполните следующие действия:

    * Если атрибут группы *proxyAddress* пуст, атрибут *mail* должен иметь значение.

    * Если атрибут *proxyAddress* группы не является пустым, он должен содержать хотя бы одно значение адреса прокси-сервера SMTP. Ниже приведены некоторые примеры:
    
      * Группа Active Directory, атрибут proxyAddress которой имеет значение *{"X500:/0=contoso.com/ou=users/cn=testgroup"}*, не будет поддерживать электронную почту в Azure AD. У нее нет SMTP-адреса.
      
      * Группа Active Directory, атрибут proxyAddress которой имеет значения *{"X500:/0=contoso.com/ou=users/cn=testgroup","SMTP:johndoe@contoso.com"}*, будет поддерживать электронную почту в Azure AD.
      
      * Группа Active Directory, атрибут proxyAddress которой имеет значения *{"X500:/0=contoso.com/ou=users/cn=testgroup","smtp:johndoe@contoso.com"}*, также будет поддерживать электронную почту в Azure AD.

## <a name="contacts"></a>Контакты
Наличие контактов, представляющих пользователя в разных лесах, — распространенное явление. Это происходит после слияния и поглощения, когда решение GALSync связывает два и более леса Exchange. Контактный объект всегда присоединяется из пространства соединителя к метавселенной с помощью атрибута mail. Если контактный объект или объект-пользователь с тем же адресом электронной почты уже существует, такие объекты объединяются. Это настраивается в правиле **In from AD — Contact Join**. Также существует правило с именем **In from AD — Contact Common** с потоком атрибутов в атрибут метавселенной **sourceObjectType** с константой **Contact**. Это правило имеет очень низкий приоритет. Поэтому, если любой объект пользователя присоединен к тому же объекту метавселенной, то правило **In from AD — User Common** передаст значение User этому атрибуту. Благодаря этому правилу атрибут получит значение Contact, если пользователь не был присоединен, а также значение User, если был найден хотя бы один пользователь.

Для подготовки объекта в Azure AD исходящее правило **Out to AAD — Contact Join** создаст объект-контакт, если атрибут метавселенной **sourceObjectType** имеет значение **Contact**. Если этот атрибут имеет значение **User**, тогда правило **Out to AAD — User Join** создаст объект-пользователя.
Повышение значения Contact до User возможно, если большее количество дополнительных исходных каталогов Active Directory будет импортировано и синхронизировано.

Например, в топологии GALSync мы найдем контактные объекты для всех во втором лесу при импорте первого леса. Это позволит разместить новые контактные объекты в соединителе AAD. При последующем импорте и синхронизации второго леса мы найдем реальных пользователей, которые будут присоединены к существующим объектам метавселенной. Затем мы удалим контактный объект в AAD и создадим вместо него новый объект-пользователь.

Если у вас есть топология, в которой пользователи представлены как контакты, убедитесь, что вы выбрали в руководстве по установке сопоставление пользователей по атрибуту почты (mail). Выбрав другой вариант, вы получите конфигурацию, зависящую от порядка. Контактные объекты всегда присоединяются по атрибуту mail. При этом объекты-пользователи будут присоединяться по атрибуту mail только в том случае, если этот вариант выбран в руководстве по установке. Если контактный объект импортирован до объекта-пользователя, вы можете получить два разных объекта в метавселенной с одинаковым атрибутом mail. Во время экспорта в Azure AD возникнет ошибка. Такое поведение является запланированным. Оно указывает на наличие неправильных данных или на неправильное определение топологии во время установки.

## <a name="disabled-accounts"></a>Отключенные учетные записи
Отключенные учетные записи также синхронизируются в Azure AD. Обычно отключенные учетные записи представляют ресурсы в Exchange, включая переговорные. Исключением являются пользователи со связанным почтовым ящиком. Как упоминалось выше, для них никогда не выполняется подготовка учетной записи в Azure AD.

Предполагается, что при обнаружении отключенной учетной записи пользователя другая активная учетная запись впоследствии найдена не будет. Поэтому объект будет подготовлен в Azure AD с найденными атрибутами userPrincipalName и sourceAnchor. Если присоединить другую активную учетную запись к этому же объекту метавселенной, будут использоваться его атрибуты userPrincipalName и sourceAnchor.

## <a name="changing-sourceanchor"></a>Изменение атрибута sourceAnchor
После экспорта объекта в Azure AD изменить атрибут sourceAnchor невозможно. При экспорте объекта атрибуту метавселенной **cloudSourceAnchor** присваивается значение **sourceAnchor**, принятое Azure AD. Если атрибут **sourceAnchor** изменен и не соответствует **cloudSourceAnchor**, то правило **Out to AAD — User Join** породит ошибку **sourceAnchor attribute has changed** (атрибут sourceAnchor изменен). В таком случае необходимо исправить конфигурацию или данные, чтобы в метавселенной снова был представлен прежний атрибут sourceAnchor, прежде чем объект снова можно будет синхронизировать.

## <a name="additional-resources"></a>Дополнительные ресурсы
* [Azure AD Connect Sync: настройка параметров синхронизации](active-directory-aadconnectsync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md)

