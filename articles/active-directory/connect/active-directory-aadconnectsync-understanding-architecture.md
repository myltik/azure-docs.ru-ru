---
title: 'Синхронизация Azure AD Connect: общие сведения об архитектуре | Документация Майкрософт'
description: В этой статье описывается архитектура синхронизации Azure AD Connect и объясняются используемые термины.
services: active-directory
documentationcenter: ''
author: billmath
manager: mtillman
editor: ''
ms.assetid: 465bcbe9-3bdd-4769-a8ca-f8905abf426d
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.component: hybrid
ms.author: billmath
ms.openlocfilehash: 079dfe772e6c189c0e81ea7af16d11a1c40f3ebe
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34593492"
---
# <a name="azure-ad-connect-sync-understanding-the-architecture"></a>Синхронизация Azure AD Connect: общие сведения об архитектуре
В этой статье описана базовая архитектура для синхронизации Azure AD Connect. Она во многом похожа на своих предшественниц MIIS 2003, ILM 2007 и FIM 2010. Синхронизация Azure AD Connect представляет собой следующую ступень развития этих технологий. Если вы знакомы с любой из этих более ранних технологий, содержимое этой статьи будет вам также знакомо. Если вы не знакомы с синхронизацией, вы найдете здесь все необходимые сведения. Тем не менее, чтобы успешно настроить синхронизацию Azure AD Connect (называемую здесь модулем синхронизации), не обязательно знать все подробности, содержащиеся в этой статье.

## <a name="architecture"></a>Архитектура
Модуль синхронизации создает интегрированное представление объектов, хранящихся в нескольких подключенных источниках данных, и управляет сведениями об удостоверениях в этих источниках данных. Это интегрированное представление определяется сведениями об удостоверениях, полученными из подключенных источников данных, и набором правил, определяющих способ обработки этих сведений.

### <a name="connected-data-sources-and-connectors"></a>Подключенные источники данных и соединители
Модуль синхронизации обрабатывает сведения об удостоверениях из разных хранилищ данных, например Active Directory или база данных SQL Server. Каждый репозиторий данных, который упорядочивает данные в формате базы данных и предоставляет стандартные методы доступа к этим данным, представляет собой потенциальный источник данных для модуля синхронизации. Репозитории данных, которые синхронизирует модуль синхронизации, называются **подключенными источниками данных** или **подключенными каталогами**.

Модуль синхронизации инкапсулирует взаимодействие с подключенным источником данных в модуль, называемый **соединителем**. Для каждого типа подключенного источника данных используется определенный соединитель. Соединитель преобразует требуемую операцию в формат, распознаваемый подключенным источником данных.

Соединители совершают вызовы API для обмена сведениями об удостоверениях (чтение и запись) с подключенным источником данных. Кроме того, можно добавить пользовательский соединитель с помощью расширяемой платформы подключения. На рисунке ниже показано, как соединитель устанавливает связь между подключенным источником данных и модулем синхронизации.

![Арх1](./media/active-directory-aadconnectsync-understanding-architecture/arch1.png)

Данные могут передаваться в любом направлении, но они не могут передаваться в обоих направлениях одновременно. Другими словами, соединитель можно настроить таким образом, чтобы данные передавались из подключенного источника данных в модуль синхронизации или в обратном направлении, но для одного объекта и атрибута в любой момент времени может выполняться только одна из этих операций. Для различных объектов и атрибутов направление может отличаться.

Чтобы настроить соединитель, необходимо указать типы объектов, которые требуется синхронизировать. Таким образом определяется область объектов, включаемых в процесс синхронизации. Затем следует выбрать атрибуты для синхронизации. Этот шаг называется составлением списка включения атрибутов. Эти параметры можно изменить в любое время в соответствии с изменениями бизнес-правил. При использовании мастера установки Azure AD Connect эти параметры настраиваются автоматически.

Чтобы экспортировать объекты в подключенный источник данных, необходимо добавить в список включения атрибутов хотя бы минимальное количество атрибутов, необходимых для создания объектов конкретного типа в подключенном источнике данных. Например, в список включения атрибутов необходимо добавить атрибут **sAMAccountName**, чтобы экспортировать объект пользователя в Active Directory, так как атрибут **sAMAccountName** должен быть определен для всех объектов пользователя в Active Directory. Опять же, настройку выполняет мастер установки.

Если подключенный источник данных использует структурные компоненты, например разделы или контейнеры, для упорядочивания объектов, можно ограничить области подключенного источника данных, используемые для данного решения.

### <a name="internal-structure-of-the-sync-engine-namespace"></a>Внутренняя структура пространства имен модуля синхронизации
Пространство имен модуля синхронизации состоит из двух пространств имен, в которых хранятся сведения об удостоверениях. Вот они:

* пространство соединителя;
* метавселенная.

**Пространство соединителя** — это промежуточная область, содержащая представления определенных объектов из подключенного источника данных и атрибуты, указанные в списке включения атрибутов. Модуль синхронизации использует пространство соединителя, чтобы определить изменения в подключенном источнике данных и поэтапно вносить входящие изменения. Кроме того, пространство соединителя используется для поэтапного внесения исходящих изменений при экспорте в подключенный источник данных. Модуль синхронизации обслуживает отдельное пространство соединителя как промежуточную область для каждого соединителя.

Благодаря промежуточной области модуль синхронизации не зависит от подключенных источников данных и их доступности. Таким образом, сведения об удостоверениях можно обрабатывать в любое время, используя данные в промежуточной области. Модуль синхронизации может запрашивать только изменения в подключенном источнике данных с момента завершения последнего сеанса связи или принудительно отправлять только изменения сведений об удостоверениях, которые еще не получил подключенный источник данных. Благодаря этому уменьшается объем сетевого трафика между модулем синхронизации и подключенным источником данных.

Кроме того, модуль синхронизации хранит сведения о состоянии всех объектов, размещаемых в пространстве соединителя. При получении новых данных модуль синхронизации всегда проверяет, синхронизированы ли они.

**Метавселенная** — это область хранения, которая содержит объединенные сведения об удостоверениях из нескольких подключенных источников данных и предоставляет единое глобальное интегрированное представление всех объектов. Объекты метавселенной создаются на основе сведений об удостоверениях, получаемых из подключенных источников данных, и набора правил, которые позволяют настраивать процесс синхронизации.

На следующем рисунке показано пространство имен соединителя и метавселенной в модуле синхронизации.

![Арх2](./media/active-directory-aadconnectsync-understanding-architecture/arch2.png)

## <a name="sync-engine-identity-objects"></a>Объекты удостоверений модуля синхронизации
Объекты в модуле синхронизации представляют объекты в подключенном источнике данных или интегрированное представление объектов в модуле синхронизации. Каждый объект модуля синхронизации должен иметь глобальный уникальный идентификатор (GUID). Идентификаторы GUID обеспечивают целостность данных и используются для установки связей между объектами.

### <a name="connector-space-objects"></a>Объекты пространства соединителя
При взаимодействии с подключенным источником данных модуль синхронизации считывает сведения об удостоверениях и использует их для создания представления объекта удостоверений в пространстве соединителя. Нельзя создавать или удалять эти объекты по одному. Однако можно вручную удалить все объекты в пространстве соединителя.

Все объекты в пространстве соединителя имеют два атрибута:

* глобальный уникальный идентификатор (GUID);
* различающееся имя.

Если подключенный источник данных присваивает объекту уникальный атрибут, объекты в пространстве соединителя могут также иметь атрибут привязки. Атрибут привязки однозначно определяет объект в подключенном источнике данных. Модуль синхронизации использует привязку, чтобы найти соответствующее представление этого объекта в подключенном источнике данных. Модуль синхронизации предполагает, что привязка объекта никогда не меняется в течение времени существования объекта.

Множество соединителей используют известный уникальный идентификатор для автоматического создания привязки при импорте объекта. Например, соединитель Active Directory использует атрибут **objectGUID** в качестве привязки. Для подключенных источников данных, которые не предоставляют четко определенный уникальный идентификатор, можно указать создание привязки в ходе настройки соединителя.

В этом случае привязка создается на основе одного или нескольких неизменяемых уникальных атрибутов объекта, которые однозначно определяют объект в пространстве соединителя (например, код сотрудника или идентификатор пользователя).

Объект пространства соединителя может быть одного из следующих типов:

* промежуточный объект;
* заполнитель.

### <a name="staging-objects"></a>Промежуточные объекты
Промежуточный объект представляет экземпляр объектов определенных типов из подключенного источника данных. Помимо GUID и различающегося имени промежуточный объект всегда имеет значение, указывающее на тип объекта.

Импортированным промежуточным объектам всегда присваивается значение атрибута привязки. У промежуточных объектов, которые недавно подготовил модуль синхронизации и которые создаются в подключенном источнике данных, отсутствуют значения атрибута привязки.

Промежуточные объекты также содержат текущие значения бизнес-атрибутов и оперативные сведения, необходимые модулю синхронизации для выполнения процесса синхронизации. Оперативные сведения содержат пометки, указывающие на тип обновлений, которые размещены в промежуточном объекте. Если промежуточный объект получил новые необработанные сведения об удостоверениях из подключенного источника данных, объект помечается как **ожидающий импорта**. Если промежуточный объект содержит новые сведения об удостоверениях, которые не экспортированы в подключенный источник данных, он помечается как **ожидающий экспорта**.

Промежуточный объект может быть объектом импорта или экспорта. Модуль синхронизации создает объект импорта, используя сведения об объекте, полученные из подключенного источника данных. При получении сведений о существовании нового объекта, соответствующего одному из типов объектов, выбранных в соединителе, модуль синхронизации создает в пространстве соединителя объект импорта в качестве представления объекта в подключенном источнике данных.

На следующем рисунке показан объект импорта, который представляет объект в подключенном источнике данных.

![Арх3](./media/active-directory-aadconnectsync-understanding-architecture/arch3.png)

Модуль синхронизации создает объект экспорта, используя сведения об объекте в метавселенной. Объекты экспорта экспортируются в подключенный источник данных во время следующего сеанса связи. С точки зрения модуля синхронизации объекты экспорта еще не существуют в источнике данных. Поэтому атрибут привязки недоступен для объекта экспорта. После получения объекта из модуля синхронизации подключенный источник данных создает уникальное значение для атрибута привязки объекта.

На рисунке ниже показано создание объекта экспорта с помощью сведений об удостоверениях в метавселенной.

![Арх4](./media/active-directory-aadconnectsync-understanding-architecture/arch4.png)

Модуль синхронизации подтверждает экспорт объекта путем повторного импорта объекта из подключенного источника данных. Объекты экспорта становятся объектами импорта, как только модуль синхронизации получает их во время следующего импорта из подключенного источника данных.

### <a name="placeholders"></a>Заполнители
Для хранения объектов модуль синхронизации использует одноуровневое пространство имен. Однако некоторые подключенные источники данных, такие как Active Directory, используют иерархическое пространство имен. Чтобы преобразовать сведения из иерархического пространства имен в сведения одноуровневого пространства имен, модуль синхронизации использует заполнители, позволяющие сохранить иерархию.

Каждый заполнитель представляет собой компонент (например, подразделение) иерархического имени объекта, который не импортирован в модуль синхронизации, но требуется для создания иерархического имени. Они заполняют пробелы в пространстве соединителя, созданные ссылками на объекты, которые не являются промежуточными, в подключенном источнике данных.

Модуль синхронизации также использует заполнители для хранения не импортированных объектов, на которые указывают ссылки. Например, если синхронизация настроена на включение атрибута диспетчера для объекта *Abbie Spencer*, а полученное значение представляет собой не импортированный объект, например *CN=Lee Sperry,CN=Users,DC=fabrikam,DC=com*, то сведения о диспетчере хранятся в качестве заполнителей в пространстве соединителя. Если объект диспетчера импортируется позже, объект заполнителя перезаписывается промежуточным объектом, который представляет диспетчер.

### <a name="metaverse-objects"></a>Объекты метавселенной
Объект метавселенной содержит объединенное представление промежуточных объектов модуля синхронизации в пространстве соединителя. Модуль синхронизации создает объекты метавселенной, используя сведения в объектах импорта. Несколько объектов пространства соединителя могут быть связаны с одним объектом метавселенной, но объект пространства соединителя не может быть связан с несколькими объектами метавселенной.

Объекты метавселенной нельзя создать или удалить вручную. Модуль синхронизации автоматически удаляет объекты метавселенной, которые не связаны с объектами в пространстве соединителя.

Чтобы сопоставить объекты в подключенном источнике данных с объектом соответствующего типа в метавселенной, модуль синхронизации предоставляет расширяемую схему с предопределенным набором типов объектов и связанных с ними атрибутов. Для объектов метавселенной можно создавать новые типы объектов и атрибуты. Атрибуты могут иметь одно или несколько значений, а также могут быть таких типов, как строки, ссылки, числа и логические значения.

### <a name="relationships-between-staging-objects-and-metaverse-objects"></a>Связи между промежуточными объектами и объектами метавселенной
В пространстве имен модуля синхронизации передачу данных обеспечивает связь между промежуточными объектами и объектами метавселенной. Промежуточный объект, связанный с объектом метавселенной, называется **присоединенным объектом** (или **объектом соединителя**). Промежуточный объект, не связанный с объектом метавселенной, называется **отсоединенным объектом** (или **объектом разъединителя**). Не следует путать термины "присоединенный" и "отсоединенный" с соединителями, отвечающими за импорт и экспорт данных в подключенном каталоге.

Заполнители никогда не связывают с объектом метавселенной.

Присоединенный объект состоит из промежуточного объекта и связи с одним объектом метавселенной. Присоединенные объекты используются для синхронизации значений атрибутов между объектом пространства соединителя и объектом метавселенной.

Если при синхронизации промежуточный объект становится присоединенным объектом, атрибуты могут передаваться между промежуточным объектом и объектом метавселенной. Атрибуты передаются в двух направлениях. Передача настраивается с помощью правил атрибутов импорта и экспорта.

Один объект пространства соединителя можно связать только с одним объектом метавселенной. Тем не менее каждый объект метавселенной можно связать с несколькими объектами в том же или другом пространстве соединителя, как показано на следующем рисунке.

![Арх5](./media/active-directory-aadconnectsync-understanding-architecture/arch5.png)

Связь между промежуточным объектом и объектом метавселенной постоянная. Ее можно разорвать только с помощью заданных правил.

Отсоединенным объектом выступает промежуточный объект, не связанный с объектом метавселенной. Значения атрибутов отсоединенного объекта не обрабатываются в метавселенной. Модуль синхронизации не обновляет значения атрибутов соответствующего объекта в подключенном источнике данных.

Используя отсоединенные объекты, можно хранить сведения об удостоверениях в модуле синхронизации, что позволяет обрабатывать их позже. Хранение промежуточных объектов в качестве отсоединенных объектов в пространстве соединителя имеет множество преимуществ. Так как система уже разместила необходимые сведения об этом объекте, при следующем импорте из подключенного источника данных не требуется создавать его представление. Таким образом, модуль синхронизации всегда обладает полным моментальным снимком подключенного источника данных, даже если подключение к подключенному источнику данных отсутствует в данный момент. Отсоединенные объекты можно преобразовать в присоединенные объекты и наоборот в зависимости от указанных правил.

Объект импорта создается как отсоединенный объект. Объект экспорта должен быть присоединенным объектом. Логика системы применяет это правило и удаляет каждый объект экспорта, который не является присоединенным.

## <a name="sync-engine-identity-management-process"></a>Процесс управления удостоверениями модуля синхронизации
Процесс управления удостоверениями определяет способ обновления сведений об удостоверениях в различных подключенных источниках данных. Управление удостоверениями состоит из трех этапов:

* Импорт
* Синхронизация
* экспорт.

Во время импорта модуль синхронизации оценивает входящие сведения об удостоверениях из подключенного источника данных. При обнаружении изменений он создает новые промежуточные объекты или обновляет существующие промежуточные объекты в пространстве соединителя для синхронизации.

Во время синхронизации модуль синхронизации обновляет метавселенную, чтобы отразить изменения в пространстве соединителя, и пространство соединителя, чтобы отразить изменения в метавселенной.

Во время экспорта модуль синхронизации отправляет изменения, которые размещены в промежуточных объектах и помечены как ожидающие экспорта.

На следующем рисунке показано, где выполняется каждый процесс при передаче сведений об удостоверениях из одного источника данных в другой.

![Арх6](./media/active-directory-aadconnectsync-understanding-architecture/arch6.png)

### <a name="import-process"></a>Этап импорта
Во время импорта модуль синхронизации оценивает обновления сведений об удостоверениях. Он сравнивает сведения об удостоверениях, полученные из подключенного источника данных, со сведениями об удостоверениях промежуточных объектов и определяет, требуется ли обновить промежуточный объект. Если нужно обновить промежуточный объект новыми данными, он помечается как ожидающий импорта.

Помещая объекты на промежуточное хранение и обработку в пространстве соединителя до синхронизации, модуль синхронизации может обрабатывать только измененные сведения об удостоверениях. Такой процесс обеспечивает следующие преимущества:

* **Эффективность синхронизации**. Объем данных, обрабатываемых в ходе синхронизации, сокращается до минимума.
* **Эффективность повторной синхронизации**. Можно изменить способ обработки сведений об удостоверениях модуля синхронизации без повторного подключения модуля синхронизации к источнику данных.
* **Возможность предварительного просмотра синхронизации**. Можно предварительно просмотреть синхронизацию, чтобы проверить правильность своих предположений о процессе управления удостоверениями.

Для каждого объекта, указанного в соединителе, модуль синхронизации сначала пытается найти соответствующее представление в пространстве соединителя. Модуль синхронизации проверяет все промежуточные объекты в пространстве соединителя и пытается найти промежуточный объект с соответствующим атрибутом привязки. Если такой объект отсутствует, модуль синхронизации пытается найти соответствующий промежуточный объект с таким же различающимся именем.

Если модуль синхронизации обнаруживает промежуточный объект, совпадающий по различающемуся имени, но не по привязке, выполняются следующие операции:

* Если объект в пространстве соединителя не имеет привязки, модуль синхронизации удаляет его из пространства соединителя и помечает объект метавселенной, с которым он связан, как такой, для которого следует **повторить подготовку при следующей синхронизации**. Затем он создает объект импорта.
* Если объект в пространстве соединителя имеет привязку, модуль синхронизации предполагает, что этот объект переименован или удален в подключенном каталоге. Он назначает объекту пространства соединителя новое временное различающееся имя, чтобы в нем можно было разместить входящий объект. Старый объект становится **временным**и ожидает, пока соединитель не импортирует сведения о процессах переименования или удаления, чтобы устранить проблему.

Если модуль синхронизации находит промежуточный объект, соответствующий объекту, который указан в соединителе, он определяет изменения, которые нужно внести. Например, модуль синхронизации может переименовать или удалить объект в подключенном источнике данных или только обновить значения атрибутов объекта.

Промежуточные объекты с обновленными данными помечаются как ожидающие импорта. Доступны различные типы объектов, ожидающих импорта. В зависимости от результата импорта промежуточный объект в пространстве соединителя имеет одно из следующих типов ожидания импорта:

* **None**. Изменения атрибутов промежуточного объекта недоступны. Модуль синхронизации не помечает такой тип как ожидающий импорта.
* **Добавление**. Промежуточный объект представляет собой новый объект импорта в пространстве соединителя. Модуль синхронизации помечает его как ожидающий импорта для дополнительной обработки в метавселенной.
* **Обновление**. Модуль синхронизации находит соответствующий промежуточный объект в пространстве соединителя и помечает этот тип как ожидающий импорта для обработки обновлений атрибутов в метавселенной. Обновления включают в себя переименование объектов.
* **Удалить**. Модуль синхронизации находит соответствующий промежуточный объект в пространстве соединителя и помечает этот тип как ожидающий импорта для удаления присоединенного объекта.
* **Удаление или добавление**. Модуль синхронизации находит соответствующий промежуточный объект в пространстве соединителя, но типы объектов не совпадают. В этом случае изменение размещается с удалением или добавлением. Изменение с удалением или добавлением указывает модулю синхронизации, что нужно провести полную повторную синхронизацию этого объекта, так как при изменении его типа применяются другие наборы правил.

Указав состояние ожидания импорта для промежуточного объекта, можно значительно уменьшить объем данных, обрабатываемых в ходе синхронизации, так как в этом случае система обрабатывает только объекты с обновленными данными.

### <a name="synchronization-process"></a>Этап синхронизации
Синхронизация состоит из двух связанных процессов:

* Входящая синхронизация, при которой содержимое метавселенной обновляется данными в пространстве соединителя.
* Исходящая синхронизация, при которой содержимое пространства соединителя обновляется данными в метавселенной.

При входящей синхронизации в метавселенной создается интегрированное представление данных, хранящихся в подключенном источнике данных. При этом используются сведения, размещенные в пространстве соединителя. Объединяются все промежуточные объекты или только объекты со сведениями, ожидающими импорта, в зависимости от того, как настроены правила.

При исходящей синхронизации объекты экспорта обновляются, если объекты метавселенной изменяются.

При входящей синхронизации в метавселенной создается интегрированное представление сведений об удостоверениях, полученных из подключенных источников данных. Модуль синхронизации может в любое время обработать сведения об удостоверениях, используя последние сведения об удостоверениях из подключенного источника данных.

**Входящая синхронизация**

При входящей синхронизации выполняются следующие процессы:

* **Подготовка** (также называемая **проекцией**, если нужно отделить этот процесс от подготовки при исходящей синхронизации). Модуль синхронизации создает новый объект метавселенной на основе промежуточного объекта и связывает их. Подготовка выполняется на уровне объектов.
* **Присоединение**. Модуль синхронизации связывает промежуточный объект с существующим объектом метавселенной. Присоединение выполняется на уровне объектов.
* **Поток атрибутов импорта**. Модуль синхронизации обновляет значения атрибутов в объекте метавселенной. Этот процесс называется потоком атрибутов. Поток атрибутов импорта выполняется на уровне атрибутов. Для него требуется связь между промежуточным объектом и объектом метавселенной.

Только при подготовке создаются объекты в метавселенной. Подготовка затрагивает только те объекты импорта, которые являются отсоединенными. Во время подготовки модуль синхронизации создает объект метавселенной, соответствующий типу объекта импорта, и устанавливает связь между этими объектами. Таким образом создается присоединенный объект.

При присоединении также устанавливается связь между объектами импорта и объектом метавселенной. Различие между присоединением и подготовкой состоит в том, что при присоединении требуется, чтобы объект импорта был связан с существующим объектом метавселенной, а при подготовке создается новый объект метавселенной.

Модуль синхронизации пытается присоединить объект импорта к объекту метавселенной, используя критерии, указанные в конфигурации правил синхронизации.

Во время подготовки и присоединения модуль синхронизации устанавливает связь между отсоединенным объектом и объектом метавселенной. Таким образом они становятся связанными. После завершения этих операций, выполняемых на уровне объектов, модуль синхронизации может обновить значения атрибутов связанного объекта метавселенной. Этот процесс называется потоком атрибутов импорта.

Поток атрибутов импорта происходит во всех объектах импорта, которые используются для передачи новых данных и связаны с объектом метавселенной.

**Исходящая синхронизация**

При исходящей синхронизации объекты экспорта обновляются, если объект метавселенной изменяется, но не удаляется. Цель исходящей синхронизации — оценить, нужно ли обновить промежуточные объекты в пространствах соединителя из-за изменений в объектах метавселенной. В некоторых случаях из-за изменений требуется обновить промежуточные объекты во всех пространствах соединителя. Измененные промежуточные объекты помечаются как ожидающие экспорта и становятся таким образом объектами экспорта. Впоследствии эти объекты экспорта передаются в подключенный источник данных при экспорте.

При исходящей синхронизации выполняются три процесса:

* **Подготовка**
* **отзыв;**
* **поток атрибутов экспорта.**

Подготовка и отзыв выполняются на уровне объектов. Отзыв зависит от подготовки, так как только подготовка может запустить этот процесс. Отзыв инициируется, когда при подготовке удаляется связь между объектом метавселенной и объектом экспорта.

Подготовка всегда выполняется при применении изменений к объектам в метавселенной. При внесении изменений в объекты метавселенной модуль синхронизации может выполнить любую из следующих задач в рамках процесса подготовки:

* создание присоединенных объектов, при котором объект метавселенной связывается с новым объектом экспорта;
* переименовывание присоединенного объекта;
* удаление связей между объектом метавселенной и промежуточными объектами, при котором создается отсоединенный объект.

Если при подготовке требуется, чтобы модуль синхронизации создал новый объект соединителя, промежуточный объект, с которым связан объект метавселенной, должен всегда быть объектом экспорта, так как объект еще не существует в подключенном источнике данных.

Если при подготовке требуется, чтобы модуль синхронизации отсоединил присоединенный объект, чтобы создать отсоединенный объект, инициируется отзыв. При отзыве объект удаляется.

Во время отзыва при удалении объекта экспорта он не удаляется физически. Объект помечается как **удаленный**. Это означает, что операция удаления размещена в объекте.

Поток атрибутов экспорта также осуществляется во время исходящей синхронизации, подобно потоку атрибутов импорта во время входящей синхронизации. Поток атрибутов экспорта осуществляется только между связанными объектами метавселенной и объектами экспорта.

### <a name="export-process"></a>Процесс экспорта
Во время экспорта модуль синхронизации проверяет все объекты экспорта, помеченные как ожидающие экспорта, в пространстве соединителя, а затем отправляет обновления в подключенный источник данных.

Модуль синхронизации может определить успешное выполнение экспорта, но не может в достаточной мере определить завершение операции управления удостоверениями. Объекты в подключенном источнике данных могут всегда измениться при выполнении других процессов. Так как для модуля синхронизации невозможно установить постоянное подключение к подключенному источнику данных, предположения о свойствах объекта в подключенном источнике данных, основанные лишь на уведомлении об успешной операции экспорта, не могут быть точными.

Например, при выполнении процесса в подключенном источнике данных атрибуты объекта могут измениться и вернуться к исходным значениям (то есть подключенный источник данных может перезаписать значения сразу после того, как модуль синхронизации отправит данные и они успешно применятся в подключенном источнике данных).

Модуль синхронизации хранит сведения о состоянии экспорта и импорта для каждого промежуточного объекта. Если значения атрибутов, указанные в списке включения атрибутов, изменились с момента последнего экспорта, хранилище сведений о состояниях операций импорта и экспорта позволяет модулю синхронизации отреагировать соответствующим образом. Модуль синхронизации использует процесс импорта для подтверждения значений атрибутов, экспортированных в подключенный источник данных. Сравнение сведений об импорте и экспорте, как показано на следующем рисунке, позволяет модулю синхронизации определить, успешно ли выполнена операция экспорта или нужно ли ее выполнить повторно.

![Арх7](./media/active-directory-aadconnectsync-understanding-architecture/arch7.png)

Например, если модуль синхронизации экспортирует атрибут C со значением 5 в подключенный источник данных, он сохраняет значение C=5 в памяти состояний экспорта. При каждом дополнительном экспорте для этого объекта выполняется попытка экспортировать значение C=5 в подключенный источник данных, так как модуль синхронизации предполагает, что это значение не применялось к объекту на регулярной основе (то есть, если другое значение не было недавно импортировано из подключенного источника данных). Память экспорта очищается при получении значения C=5 во время импорта в объекте.

## <a name="next-steps"></a>Дополнительная информация
Узнайте больше о настройке [службы синхронизации Azure AD Connect](active-directory-aadconnectsync-whatis.md) .

Узнайте больше об [интеграции локальных удостоверений с Azure Active Directory](active-directory-aadconnect.md).

