---
title: "Сбой доступа к корпоративному приложению при использовании приложения прокси приложения | Документация Майкрософт"
description: "Устранение распространенных проблем доступа в приложениях прокси приложения Azure AD."
services: active-directory
documentationcenter: 
author: ajamess
manager: mtillman
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: asteen
ms.openlocfilehash: 479bb75a336d17814fc439717cd59f96dab67d32
ms.sourcegitcommit: e266df9f97d04acfc4a843770fadfd8edf4fa2b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2017
---
# <a name="cant-access-this-corporate-application-error-when-using-an-application-proxy-application"></a>Ошибка "Can't Access this Corporate Application" (Не удается обратиться к этому корпоративному приложению) при использовании приложения прокси приложения

Эта статья помогает устранять распространенные проблемы при появлении ошибки "This corporate app can't be accessed" (Доступ к этому корпоративному приложению невозможен) в приложении прокси приложения Azure AD.

## <a name="overview"></a>Обзор
При появлении этой ошибки на странице также указывается код состояния. Этот код, скорее всего, является одним из следующих:

-   **Истекло время ожидания шлюза**: прокси-службе приложения не удается подключиться к соединителю. Это обычно указывает на проблему с назначением соединителя, самим соединителем либо связанными с ним сетевыми правилами.

-   **Недопустимый шлюз**: соединителю не удается связаться с серверным приложением. Это может указывать на неправильную настройку приложения.

-   **Запрещено**: пользователь не авторизован для доступа к приложению. Это может произойти, если пользователь не назначен приложению в Azure Active Directory или если в серверной части у пользователя нет разрешения на доступ к приложению.

Чтобы найти код, просмотрите текст в поле "Код состояния", находящемся в нижнем левом углу сообщения об ошибке. Кроме того, ознакомьтесь с примечаниями в самом конце страницы, которые могут содержать дополнительные советы.

   ![Ошибка при истечении времени ожидания шлюза](./media/application-proxy/connection-problem.png)

Сведения об устранении первопричины этих ошибок и рекомендуемых исправлениях см. в соответствующем разделе ниже.

## <a name="gateway-timeout-errors"></a>Ошибки при истечении времени ожидания шлюза

Время ожидания шлюза истекает, когда службе не удается связаться с соединителем в течение определенного периода. Обычно это вызвано тем, что приложение назначено группе соединителей без работающих соединителей либо закрыты некоторые необходимые соединителю порты.


## <a name="bad-gateway-errors"></a>Ошибки с недопустимым шлюзом

Ошибка с недопустимым шлюзом указывает, что соединителю не удается связаться с серверным приложением. Убедитесь, что опубликовано нужное приложение. Распространенные ошибки, вызывающие эту ошибку:

-   Опечатка или ошибка во внутреннем URL-адресе

-   Исключение корневого каталога приложения из публикации. Например, публикуется <http://expenses/reimbursement>, а обращение выполняется к <http://expenses>

-   Проблемы с конфигурацией ограниченного делегирования Kerberos (KCD)

-   Проблемы с серверным приложением

## <a name="forbidden-errors"></a>Ошибка с запретом

Если вы видите ошибку с запретом, значит пользователь не назначен этому приложению. Это может быть либо в Azure Active Directory, либо в серверном приложении.

Чтобы узнать, как назначить пользователям приложению в Azure, см. [документацию по конфигурации](https://docs.microsoft.com/azure/active-directory/application-proxy-publish-azure-portal#add-a-test-user).

Если вы подтверждаете, что пользователь назначен приложению в Azure, проверьте конфигурацию пользователей в серверном приложении. При использовании ограниченного делегирования Kerberos или встроенной проверки подлинности Windows некоторые рекомендации можно получить на странице устранения неполадок с KCD.

## <a name="check-the-applications-internal-url"></a>Проверка внутреннего URL-адреса приложения

В качестве первого шага перепроверьте и исправьте внутренний URL-адрес, открыв приложение через функцию **Корпоративные приложения**, а затем выбрав меню **Прокси приложения**. Убедитесь, что это правильный внутренний URL-адрес — тот, который используется из локальной сети для доступа к приложению.

## <a name="check-the-application-is-assigned-to-a-working-connector-group"></a>Проверка назначения приложения рабочей группе соединителей

Убедитесь, что приложение назначено рабочей группе соединителей:

1.  Откройте приложение на портале, перейдя в **Azure Active Directory** и выбрав **Корпоративные приложения** и затем **Все приложения.** Откройте приложение, а затем выберите **Прокси приложения** в меню слева.

2.  Взгляните на поле "Группа соединителей". Если в группе нет активных соединителей, отображается предупреждение. Если предупреждения отсутствуют, переходите к пункту с проверкой внесения нужных портов в список разрешений.

3.  Если это неправильная группа соединителей, выберите подходящую группу с помощью раскрывающегося списка и убедитесь, что предупреждения больше не отображаются. Если это нужная группа соединителей, щелкните предупреждение, чтобы открыть страницу с функциями управления соединителями.

4.  Здесь работу можно продолжить несколькими способами:

  * Переместите активный соединитель в группу: если у вас есть активный соединитель, который должен принадлежать к группе и находится в прямой видимости для серверного приложения, можно перенести соединитель в назначенную группу. Для этого щелкните соединитель. В раскрывающемся списке "Группа соединителя" выберите соответствующую группу и нажмите кнопку "Сохранить".

  * Скачайте новый соединитель для этой группы: на этой странице можно получить ссылку для [скачивания нового соединителя](https://download.msappproxy.net/Subscription/d3c8b69d-6bf7-42be-a529-3fe9c2e70c90/Connector/Download). Соединитель нужно установить на компьютере, находящемся в прямой видимости для серверного приложения, и обычно соединитель размещается на том же сервере, что и приложение. Используйте ссылку на скачивание соединителя, чтобы скачать соединитель на целевой компьютер. Далее щелкните соединитель и укажите подходящую группу соединителей в раскрывающемся списке "Группа соединителей".

  * Проверка неактивного соединителя: если соединитель отображается как неактивный, значит ему не удалось подключиться к службе. Обычно это вызвано тем, что заблокированы некоторые необходимые порты. Для решения проблемы переходите к пункту с проверкой внесения нужных портов в список разрешений.

Выполнив эти действия по назначению приложения группе с работающими соединителями, проверьте приложение еще раз. Если оно по-прежнему не работает, перейдите к следующему разделу.

## <a name="check-all-required-ports-are-whitelisted"></a>Проверка внесения нужных портов в список разрешений

Чтобы убедиться, что открыты все необходимые порты, см. нашу документацию по открытию портов. Если все нужные порты открыты, перейдите к следующему разделу.

## <a name="check-for-other-connector-errors"></a>Проверка других ошибок соединителя

Если ничего из приведенного выше не позволяет устранить неполадку, нужно искать проблемы или ошибки в самом соединителе. Некоторые распространенные ошибки приведены в [документе по устранению неполадок](https://docs.microsoft.com/azure/active-directory/active-directory-application-proxy-troubleshoot#connector-errors). 

Для выявления ошибок можно просмотреть журналы соединителя. Многие из наших сообщений об ошибках содержат более конкретные рекомендации по устранению неполадок. Чтобы научиться просматривать журналы, см. [нашу документацию по соединителям](https://docs.microsoft.com/azure/active-directory/application-proxy-understand-connectors#under-the-hood).

## <a name="additional-resolutions"></a>Дополнительные ресурсы

Если приведенные выше сведения не позволили устранить проблему, существует еще несколько возможных причин. Для определение проблемы сделайте следующее:

Если приложение настроено для использования встроенной проверки подлинности Windows, протестируйте приложение без единого входа. В противном случае перейдите к следующему абзацу. Чтобы проверить приложение без единого входа, откройте приложение с помощью функции **Корпоративные приложения** и перейдите в меню **Единый вход**. В раскрывающемся списке измените значение "Встроенная проверка подлинности Windows" на "Единый вход Azure AD отключен". 

Откройте браузер и попробуйте обратиться к приложению еще раз. При этом должен появиться запрос проверки подлинности с последующим входом в приложение. Если это работает, проблема связана с конфигурацией ограниченного делегирования Kerberos (KCD), которая обеспечивает единый вход. См. страницу об устранении неполадок ограниченного делегирования Kerberos.

Если эта ошибка продолжает отображаться, перейдите на компьютер, где установлен соединитель, откройте браузер и попытайтесь подключиться по внутреннему URL-адресу, используемому для приложения. Соединитель выступает в качестве другого клиента с того же компьютера. Если обратиться к приложению не удается, выясните, почему компьютеру не удается получить доступ к приложению, или используйте соединитель на сервере, который способен обратиться к приложению.

Если вы можете связаться с приложением с этого компьютера, нужно искать проблемы или ошибки в самом соединителе. Некоторые распространенные ошибки приведены в [документе по устранению неполадок](https://docs.microsoft.com/azure/active-directory/active-directory-application-proxy-troubleshoot#connector-errors). Для выявления ошибок можно просмотреть журналы соединителя. Многие из наших сообщений об ошибках содержат более конкретные рекомендации по устранению неполадок. Чтобы научиться просматривать журналы, см. [нашу документацию по соединителям](https://docs.microsoft.com/azure/active-directory/application-proxy-understand-connectors#under-the-hood).

## <a name="next-steps"></a>Дополнительная информация
[Сведения о соединителях прокси приложения Azure AD](application-proxy-understand-connectors.md)
