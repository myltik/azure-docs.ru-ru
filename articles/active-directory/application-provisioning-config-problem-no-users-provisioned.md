---
title: Пользователи для приложения в коллекции Azure AD не подготавливаются | Документы Майкрософт
description: В этой статье описаны способы решения распространенных проблем, при которых пользователи, для которых была настроена подготовка в Azure AD, не появляются в приложении в коллекции Azure AD.
services: active-directory
documentationcenter: ''
author: ajamess
manager: mtillman
ms.assetid: ''
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: asteen
ms.openlocfilehash: a36d60b8915ae0b46226bb2127829a8f1767daba
ms.sourcegitcommit: e266df9f97d04acfc4a843770fadfd8edf4fa2b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2017
ms.locfileid: "26734298"
---
# <a name="no-users-are-being-provisioned-to-an-azure-ad-gallery-application"></a>Пользователи для приложения в коллекции Azure AD не подготавливаются

Настройте автоматическую подготовку для приложения (проверив действительность учетных данных, с помощью которых Azure AD подключается к приложению). Пользователи и (или) группы, которые подготавливаются для приложения, определяются следующими критериями.

-   Какие пользователи и группы были **назначены** приложению. Дополнительные сведения о назначении см. в разделе [Назначение пользователя или группы корпоративному приложению в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal).

-   Было ли **сопоставление атрибутов** включено и настроено для синхронизации допустимых атрибутов из Azure AD в приложение. Дополнительные сведения о сопоставлении атрибутов см. в разделе [Настройка сопоставления атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).

-   Используется ли **фильтр области**, который фильтрует пользователей на основе значений указанных атрибутов. Дополнительные сведения о фильтрах области см. в статье [Подготовка приложений на основе атрибутов с использованием фильтров области](https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters).

Обнаружив, что пользователи не подготавливаются, обратитесь к журналам аудита в Azure AD и попробуйте найти записи журнала для указанного пользователя.

Журналы аудита для подготовки можно открыть на портале Azure на вкладке **Azure Active Directory &gt; Корпоративные приложения &gt; \[Имя приложения\] &gt; Журналы аудита**. Чтобы просмотреть события подготовки только для этого приложения, отфильтруйте журналы по категории **Учетная запись подготовки**. Найти пользователей можно по "идентификатору сопоставления", который был назначен для этих пользователей в сопоставлениях атрибутов. Предположим, что в качестве атрибута сопоставления для пользователя, для которого не выполняется подготовка, в Azure AD выбран атрибут "имя участника-пользователя" или "адрес электронной почты", и этот атрибут имеет значение "audrey@contoso.com". В этом случае попробуйте найти "audrey@contoso.com" в журналах аудита и просмотрите результаты поиска.

В журналах аудита подготовки хранятся записи обо всех операциях, выполняемых службой подготовки, включая запросы Azure AD для назначенных пользователей, которые находятся в области для подготовки, запросы целевого приложения на наличие этих пользователей и сравнение объектов пользователя в разных системах. Затем добавьте, измените или отключите учетную запись пользователя в целевой системе на основе сравнения.

## <a name="general-problem-areas-with-provisioning-to-consider"></a>Общие проблемные области при подготовке, которые необходимо учитывать

Ниже приведен список общих проблемных областей, в которые можно углубиться, если у вас есть какие-то идеи.

* [Служба подготовки не запускается](#provisioning-service-does-not-appear-to-start)
* [Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены](#audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned)

## <a name="provisioning-service-does-not-appear-to-start"></a>Служба подготовки не запускается

Предположим, что вы установили параметр **Состояние подготовки** в значение **Вкл** в разделе **Azure Active Directory &gt; Корпоративные приложения &gt; \[Имя приложения\] &gt;Подготовка** портала Azure. Однако при последующей перезагрузке никакие другие сведения о состоянии на этой странице не отображаются. Вероятно, что служба запущена, но первоначальная синхронизация еще не завершена. Проверьте **журналы аудита**, как описано выше, чтобы определить, какие операции выполняет служба и не возникают ли ошибки.

>[!NOTE]
>Первоначальная синхронизация может занять от 20 минут до нескольких часов, в зависимости от размера каталога Azure AD и количества пользователей в области подготовки. Последующие операции синхронизации занимают меньше времени, так как служба подготовки сохраняет "водяные знаки", которые представляют состояние обеих систем после начальной синхронизации. Это позволяет повысить скорость последующих операций синхронизации.
>
>

## <a name="audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned"></a>Судя по журналам аудита, пользователи не подготовлены, несмотря на то, что они назначены

Если пользователь отображается в журналах аудита как "пропущенный", очень важно ознакомиться с подробными сведениями об ошибке, чтобы определить причину. Ниже приведены распространенные причины и способы устранения ошибок:

-   **Настроен фильтр области** **, который фильтрует пользователей на основе значения атрибута**. Дополнительные сведения о фильтрах области см. в разделе <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>.

-   **Пользователь "не имеет фактических прав".** Если вы видите это сообщение об ошибке, это свидетельствует о наличии проблемы с записью назначения пользователя, которая хранится в Azure AD. Для устранения этой проблемы отмените назначение пользователя (или группы) для приложения и повторно назначьте пользователя (или группу). Дополнительные сведения о назначении см. в разделе <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>.

-   **Обязательный атрибут для пользователя отсутствует или его значение не указано.** При настройке подготовки важно просмотреть и настроить сопоставления атрибутов и рабочие процессы, которые определяют, какие свойства пользователя (или группы) передаются из Azure AD в приложение. К ним относится "свойство сопоставления", используемое для уникальной идентификации и сопоставления пользователей или групп между двумя системами. Дополнительные сведения об этом важном процессе см. в разделе [Настройка сопоставления атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings).

  * **Сопоставление атрибутов для групп:** подготовка имени группы и сведений о группе наряду с ее участниками (если поддерживается для некоторых приложений). Вы можете включить или отключить эту функцию, включив или отключив **сопоставление** для объектов группы, отображаемых на вкладке **Подготовка**. Если подготовка групп включена, обязательно ознакомьтесь с атрибутами сопоставления, чтобы убедиться, что в качестве соответствующего идентификатора используется подходящее поле. В качестве этого поля может использоваться отображаемое имя или псевдоним электронной почты. Если соответствующее свойство для группы в Azure AD не указано или не заполнено, группа и ее участники не будут подготовлены.

## <a name="next-steps"></a>Дополнительная информация
[Служба синхронизации Azure AD Connect: общие сведения о декларативной подготовке](active-directory-aadconnectsync-understanding-declarative-provisioning.md)

