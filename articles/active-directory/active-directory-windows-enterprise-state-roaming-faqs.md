---
title: Часто задаваемые вопросы о перемещении параметров и данных | Документация Майкрософт
description: В статье содержится информация о синхронизации параметров и данных приложений, которая может быть полезной для ИТ-администраторов.
services: active-directory
keywords: параметры enterprise state roaming, облако windows, часто задаваемые вопросы о решении enterprise state roaming
documentationcenter: ''
author: tanning
manager: mtillman
editor: curtand
ms.assetid: c0824f5c-129b-4240-969f-921f6a64eae7
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/14/2017
ms.author: markvi
ms.openlocfilehash: 0aac3a9d3595ea0e761ba14070bf7cff4d4b264c
ms.sourcegitcommit: d1f35f71e6b1cbeee79b06bfc3a7d0914ac57275
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/22/2018
---
# <a name="settings-and-data-roaming-faq"></a>Часто задаваемые вопросы о перемещении параметров и данных
В этой статье содержится информация о синхронизации параметров и данных приложений, которая может быть полезной для ИТ-администраторов.

## <a name="what-data-roams"></a>Какие данные перемещаются?
**Параметры Windows**: параметры компьютера, встроенные в операционную систему Windows. В целом, эти параметры позволяют настроить компьютер в соответствии с вашими предпочтениями. Они включают такие основные категории:

* *Тема*— функции, такие как тема рабочего стола и параметры панели задач.
* *Параметры Internet Explorer*— недавно открытые вкладки и избранное.
* *Параметры браузера Microsoft Edge*— параметры, такие как избранное и список для чтения.
* *Пароли* — пароли для доступа в Интернет, профили Wi-Fi и т. д.
* *Языковые параметры* — параметры раскладки клавиатуры, системный язык, дата и время и т. д.
* *Специальные возможности*— функции, такие как высококонтрастная тема, экранный диктор и экранная лупа.
* *Другие параметры Windows* — параметры командной строки, список приложений и т. д.

**Данные приложения** — универсальные приложения для Windows могут записывать данные параметров в папку Roaming. Все данные, записанные в эту папку, будут автоматически синхронизироваться. Такую возможность можно предусмотреть для приложения еще на этапе его проектирования. Дополнительные сведения о разработке универсальных приложений для Windows с поддержкой перемещения см. в статье об [API хранилища данных приложения](https://msdn.microsoft.com/library/windows/apps/mt299098.aspx) и в [блоге разработчиков Windows 8 о перемещении данных приложения](http://blogs.msdn.com/b/windowsappdev/archive/2012/07/17/roaming-your-app-data.aspx).

## <a name="what-account-is-used-for-settings-sync"></a>Какая учетная запись используется для синхронизации параметров?
В Windows 8 и Windows 8.1 при синхронизации параметров всегда использовались учетные записи Майкрософт. Корпоративные пользователи могли настроить синхронизацию параметров, подключив учетную запись Майкрософт к учетной записи домена Active Directory. В Windows 10 вместо приема с подключением учетной записи Майкрософт используются основная и дополнительная учетные записи.

Основная учетная запись — это учетная запись, используемая для входа в Windows. Это может быть учетная запись Майкрософт, учетная запись Azure Active Directory (Azure AD), учетная запись локальной службы Active Directory или локальная учетная запись. Кроме основной учетной записи пользователи Windows 10 могут добавить в своем устройстве одну или несколько дополнительных облачных учетных записей. Дополнительной учетной записью может быть учетная запись Майкрософт, учетная запись Azure AD или какая-то другая (например Gmail или Facebook). Хотя такие учетные записи и предоставляют доступ к дополнительным функциям и службам, включая единый вход и Магазин Windows, они не поддерживают синхронизацию параметров.

В Windows 10 для синхронизации параметров используется только основная учетная запись на устройстве (ознакомьтесь с разделом [Как перейти от синхронизации параметров учетной записи Майкрософт в Windows 8 к синхронизации параметров Azure AD в Windows 10?](active-directory-windows-enterprise-state-roaming-faqs.md#how-do-i-upgrade-from-microsoft-account-settings-sync-in-windows-8-to-azure-ad-settings-sync-in-windows-10)).

Данные разных учетных записей на одном устройстве никогда не смешиваются. Параметры синхронизируются по следующим правилам:

* параметры Windows всегда перемещаются с помощью основной учетной записи;
* данные приложения будут отнесены к учетной записи, используемой для получения приложения. Синхронизироваться будут данные только тех приложений, которые содержат информацию об основной учетной записи. Принадлежность приложения к той или иной учетной записи определяется при его загрузке с помощью Магазина Windows или средств управления мобильными устройствами (MDM).

Если определить принадлежность приложения не удается, для перемещения данных используется основная учетная запись. Если устройство обновляется с Windows 8 или Windows 8.1 до Windows 10, то все приложения будут помечаться как приобретенные с помощью учетной записи Майкрософт. Это объясняется тем, что большинство пользователей приобретают приложения с помощью Магазина Windows, который не поддерживался для учетных записей Azure AD до появления Windows 10. Если приложение устанавливается в автономном режиме с использованием лицензии, приложение будет отнесено к основной учетной записи на устройстве.

> [!NOTE]
> Учетные записи Майкрософт корпоративных устройств Windows 10, подключенных к службе Azure AD, больше не смогут подключаться к учетной записи домена. Возможность подключить учетную запись Майкрософт к учетной записи домена для синхронизации всех данных пользователя с учетной записью Майкрософт (что является перемещением данных в учетной записи Майкрософт посредством ее подключения к учетной записи Active Directory) не поддерживается на устройствах с Windows 10, подключенных к среде Active Directory или Azure AD.
>
>

## <a name="how-do-i-upgrade-from-microsoft-account-settings-sync-in-windows-8-to-azure-ad-settings-sync-in-windows-10"></a>Как перейти от синхронизации параметров учетной записи Майкрософт в Windows 8 к синхронизации параметров Azure AD в Windows 10?
Если вы подключаетесь к домену Active Directory, работающему под управлением Windows 8 или Windows 8.1, используя свою учетную запись Майкрософт, то синхронизация параметров выполняется с помощью этой учетной записи. После обновления до Windows 10 параметры пользователя будут и дальше синхронизироваться через учетную запись Майкрософт при условии, что вы остаетесь подключенным к домену пользователем, а домен Active Directory не подключен к Azure AD.

Если локальный домен Active Directory подключен к Azure AD, то устройство будет пытаться синхронизировать параметры с помощью подключенной учетной записи Azure AD. Если администратор Azure AD не включит службу Enterprise State Roaming, то подключенная учетная запись Azure AD не сможет синхронизировать параметры. Если вы являетесь пользователем Windows 10 и вошли в систему, используя учетные данные Azure AD, то синхронизация параметров Windows начнется, как только ваш администратор разрешит синхронизацию параметров через Azure AD.

Если вы храните личные данные на своих корпоративных устройствах, то помните, что параметры Windows и данные приложений будут синхронизироваться в среду Azure AD. Вот что из этого следует.

* Параметры личных учетных записей Майкрософт будут со временем отличаться от параметров соответствующих рабочих или учебных учетных записей Azure AD. Это объясняется тем, что при синхронизации параметров учетных записей Майкрософт и Azure AD теперь используются отдельные учетные записи.
* Личные данные, такие как пароли Wi-Fi, данные для доступа в Интернет или избранное браузера Internet Explorer, которые ранее синхронизировались через подключенную учетную запись Майкрософт, теперь будут синхронизироваться через Azure AD.

## <a name="how-do-microsoft-account-and-azure-ad-enterprise-state-roaming-interoperability-work"></a>Как взаимодействуют между собой учетная запись Майкрософт и служба Enterprise State Roaming в Azure AD?
В выпуске Windows 10 за ноябрь 2015 г. и более поздних выпусках службу Enterprise State Roaming одновременно можно использовать только в рамках одной учетной записи. Если вы войдете в Windows с помощью рабочей или учебной учетной записи Azure AD, то все данные будут синхронизироваться через Azure AD. Если вы войдете в Windows с помощью личной учетной записи Майкрософт, то все данные будут синхронизироваться через учетную запись Майкрософт. Данные универсального приложения будут перемещаться только с использованием основной учетной записи на устройстве, и только если лицензия приложения принадлежит этой учетной записи. Данные универсальных приложений, которые принадлежат дополнительным учетным записям, не будут синхронизироваться.

## <a name="do-settings-sync-for-azure-ad-accounts-from-multiple-tenants"></a>Поддерживается ли синхронизация параметров для учетных записей Azure AD из нескольких клиентов?
Если на устройстве есть несколько учетных записей Azure AD из разных клиентов Azure AD, то необходимо обновить реестр устройства, чтобы каждый клиент Azure AD смог обмениваться данными со службой Azure Rights Management (Azure RMS).  

1. Найдите идентификатор GUID для каждого клиента Azure AD. Перейдите на портал Azure и выберите клиент Azure AD. Идентификатор GUID для клиента можно найти на странице свойств выбранного клиента (https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Properties). Он снабжен меткой **Идентификатор каталога**. 
2. После того, как найден GUID, необходимо добавить раздел реестра **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\SettingSync\WinMSIPC\<GUID_клиента>**.
   Из раздела **GUID_клиента** создайте новое многострочное значение (REG-MULTI-SZ) **AllowedRMSServerUrls**. В качестве его данных укажите URL-адреса точек распространения лицензий других клиентов Azure, к которым обращается устройство.
3. Чтобы получить URL-адреса точек распространения лицензий, выполните командлет **Get-AadrmConfiguration** . Если значения **LicensingIntranetDistributionPointUrl** и **LicensingExtranetDistributionPointUrl** отличаются, укажите оба эти значения. Если значения совпадают, достаточно указать значение один раз.

## <a name="what-are-the-roaming-settings-options-for-existing-windows-desktop-applications"></a>Каковы доступные варианты перемещения параметров существующих классических приложений Windows?
Перемещать можно только универсальные приложения Windows. Для существующих классических приложений Windows перемещение можно настроить двумя способами.

* С помощью [моста для классических приложений](https://aka.ms/desktopbridge) можно перенести классические приложения Windows на универсальную платформу Windows. В этом случае для перемещения данных приложения в Azure AD нужно внести минимальные изменения в код. Мост для классических приложений присваивает вашим приложениям удостоверения приложений, позволяя включить перемещение данных приложений для существующих классических приложений.
* [User Experience Virtualization (UE-V)](https://technet.microsoft.com/library/dn458947.aspx) можно создать шаблон пользовательских параметров для существующих классических приложений Windows и включить перемещение для приложений Win32. При использовании этого варианта разработчику приложений не нужно изменять код приложений. Пользователи UE-V, которые приобрели пакет Microsoft Desktop Optimization Pack, могут перемещать данные только в локальной среде Active Directory.

Администраторы могут настроить UE-V для перемещения данных классических приложений для Windows. Для этого они должны изменить перемещение параметров операционной системы Windows и данных универсальных приложений с помощью [групповых политик UE-V](https://technet.microsoft.com/itpro/mdop/uev-v2/configuring-ue-v-2x-with-group-policy-objects-both-uevv2). К ним относятся:

* групповая политика "Перемещать параметры Windows";
* групповая политика "Не синхронизировать приложения Windows";
* перемещение Internet Explorer в разделе приложений.

В будущем мы, возможно, подумаем над глубокой интеграцией UE-V в ОС Windows, чтобы реализовать возможность перемещения параметров через облако Azure AD.

## <a name="can-i-store-synced-settings-and-data-on-premises"></a>Можно ли хранить синхронизируемые параметры и данные локально?
Служба Enterprise State Roaming хранит все синхронизированные данные в облаке Azure. А UE-V — это локальное средство перемещения.

## <a name="who-owns-the-data-thats-being-roamed"></a>Кому принадлежат перемещаемые данные?
Данные, перемещаемые с помощью службы Enterprise State Roaming, принадлежат предприятиям. Данные хранятся в центре обработки данных Azure. Все данные пользователя шифруются как при передаче, так и при хранении в облаке с помощью службы Azure RMS. Это гораздо лучше синхронизации параметров с использованием учетной записи Майкрософт, во время которой перед передачей с устройства шифруются только определенные конфиденциальные данные, например учетные данные пользователя.

Корпорации Майкрософт очень серьезно относится к вопросу защиты пользовательских данных. Данные параметров корпоративного пользователя автоматически шифруются с помощью Azure RMS перед передачей с устройства Windows 10. Это предотвращает считывание данных другими пользователями. Если у вашей организации есть платная подписка на Azure RMS, вы можете использовать другие функции этой службы, а именно: отслеживать и отзывать документы, автоматически защищать сообщения электронной почты с конфиденциальными сведениями, а также управлять собственными ключами (BYOK). Дополнительные сведения об этих функциях и принципах работы Azure RMS см. в статье [Что такое управление правами Azure?](https://technet.microsoft.com/jj585026.aspx)

## <a name="can-i-manage-sync-for-a-specific-app-or-setting"></a>Можно ли управлять синхронизацией конкретного приложения или параметра?
В Windows 10 не предусмотрено использование MDM или параметров групповых политик, которые позволили бы отключить перемещение для отдельного приложения. Администраторы клиентов могут отключить синхронизацию данных только для всех приложений на управляемом устройстве. Более гибкого способа управления перемещением (на уровне приложения или в пределах приложения) нет.

## <a name="how-can-i-enable-or-disable-roaming"></a>Как включить или отключить перемещение?
В разделе **Параметры** выберите **Учетные записи** > **Синхронизация параметров**. На этой странице можно увидеть, какая учетная запись используется для перемещения параметров, а также включить или отключить отдельные группы перемещаемых настроек.

## <a name="what-is-microsofts-recommendation-for-enabling-roaming-in-windows-10"></a>Какие решения Майкрософт рекомендует использовать для перемещения в Windows 10?
Майкрософт предлагает несколько решений для перемещения параметров, включая перемещаемые профили пользователей, UE-V и Enterprise State Roaming.  Корпорация Майкрософт планирует реализовать решение Roaming User Profiles в будущих версиях Windows. Если перемещение данных в облако по каким-то причинам не подходит для вашей организации, то мы рекомендуем использовать решение UE-V в качестве основной технологии перемещения. Если вашей организации требуется поддержка перемещения для существующих классических приложений Windows, но она планирует переходить к перемещению в облако, то мы рекомендуем использовать оба решения: Enterprise State Roaming и UE-V. Хотя технологии UE-V и Enterprise State Roaming очень похожи, они не заменяют друг друга, а являются взаимодополняющими. Эти решения гарантируют, что ваша организация предоставит пользователям необходимые им способы перемещения.  

При одновременном использовании решений Enterprise State Roaming и UE-V действуют следующие правила.

* Enterprise State Roaming выступает в роли основного агента перемещения на устройстве. UE-V используется в качестве дополнения для работы с данными приложений Win32.
* Перемещение параметров Windows и данных современных приложений UWP необходимо отключить при использовании групповых политик UE-V. Эти функции уже обеспечивает служба Enterprise State Roaming.

## <a name="how-does-enterprise-state-roaming-support-virtual-desktop-infrastructure-vdi"></a>Как Enterprise State Roaming поддерживает инфраструктуру виртуальных рабочих столов (VDI)?
Enterprise State Roaming поддерживается для SKU клиентов Windows 10, но не поддерживается для SKU серверов. Если виртуальная машина клиента размещена на компьютере с гипервизором, а вы выполняете вход на виртуальную машину удаленно, то ваши данные будут перемещены. Если несколько пользователей используют одну операционную систему и удаленно выполняют вход на сервер, чтобы использовать все возможности рабочего стола, то не исключено, что перемещение данных работать не будет. Такой сценарий официально не поддерживается.

## <a name="what-happens-when-my-organization-purchases-azure-rms-after-using-roaming"></a>Что происходит, когда организация, в которой уже работает перемещение данных и настроек, приобретает службу Azure RMS?
Если ваша организация уже использует возможности перемещения в Windows 10 в рамках ограниченной бесплатной подписки на Azure RMS, приобретение платной подписки на Azure RMS не повлияет на работу функции перемещения. ИТ-администратору даже не придется изменять настройки.

## <a name="known-issues"></a>Известные проблемы
Список известных проблем см. в документации статьи об [устранении неполадок](active-directory-windows-enterprise-state-roaming-troubleshooting.md). 

## <a name="related-topics"></a>Связанные разделы
* [Обзор службы Enterprise State Roaming](active-directory-windows-enterprise-state-roaming-overview.md)
* [Включение службы Enterprise State Roaming в Azure Active Directory](active-directory-windows-enterprise-state-roaming-enable.md)
* [Group policy and MDM settings for settings sync (Параметры групповой политики и управления мобильными устройствами)](active-directory-windows-enterprise-state-roaming-group-policy-settings.md)
* [Справочник по перемещаемым параметрам в Windows 10](active-directory-windows-enterprise-state-roaming-windows-settings-reference.md)
* [Устранение неполадок](active-directory-windows-enterprise-state-roaming-troubleshooting.md)
