---
title: Архивация и восстановление базы данных Azure Analysis Services | Документы Майкрософт
description: Описывает, как выполнять архивацию и восстановление базы данных Analysis Services Azure.
author: minewiskan
manager: kfile
ms.service: azure-analysis-services
ms.topic: conceptual
ms.date: 04/12/2018
ms.author: owend
ms.reviewer: minewiskan
ms.openlocfilehash: 07b2cebde40983955c5244ac2b7f0b759dcdbd14
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34597303"
---
# <a name="backup-and-restore"></a>Архивация и восстановление

Архивация баз данных табличной модели в Azure Analysis Services во многом аналогична процедуре для локальных служб Analysis Services. Основное различие заключается в расположении для хранения архивных файлов. Архивные файлы следует сохранять в контейнер в [учетной записи хранения Azure](../storage/common/storage-create-storage-account.md). Можно использовать уже имеющиеся учетную запись хранения и контейнер либо создать их при настройке параметров хранилища для сервера.

> [!NOTE]
> Создание учетной записи хранения может привести к дополнительным расходам. Дополнительные сведения см. на [странице с ценами на службу хранилища Azure](https://azure.microsoft.com/pricing/details/storage/blobs/).
> 
> 

Архивные копии сохраняются с расширением ABF. Для табличных моделей в памяти сохраняются как данные, так и метаданные модели. Для табличных моделей с прямым запросом (DirectQuery) сохраняются только метаданные моделей. В зависимости от выбранных вами параметров архивные копии могут быть сжаты и зашифрованы. 



## <a name="configure-storage-settings"></a>Настройка параметров хранения
Перед архивацией нужно настроить для сервера параметры хранения.


### <a name="to-configure-storage-settings"></a>Порядок настройки параметров хранения
1.  На портале Azure выберите **Параметры** и щелкните **Архивация**.

    ![Архивация в параметрах](./media/analysis-services-backup/aas-backup-backups.png)

2.  Щелкните **Включено**, а затем — **Параметры хранилища**.

    ![Включение](./media/analysis-services-backup/aas-backup-enable.png)

3. Выберите имеющуюся учетную запись хранения или создайте новую.

4. Выберите контейнер или создайте новый.

    ![Выбор контейнера](./media/analysis-services-backup/aas-backup-container.png)

5. Сохраните параметры архивации.

    ![Сохранение параметров архивации](./media/analysis-services-backup/aas-backup-save.png)

## <a name="backup"></a>Azure Backup

### <a name="to-backup-by-using-ssms"></a>Архивация с помощью SSMS

1. В среде SSMS щелкните правой кнопкой мыши базу данных и выберите **Архивировать**.

2. В разделе **Резервное копирование базы данных** > **Файл резервной копии** нажмите кнопку **Обзор**.

3. В диалоговом окне **Сохранить файл как** проверьте путь к папке, а затем введите имя для архивного файла. 

4. Выберите параметры в диалоговом окне **Резервное копирование базы данных**.

    **Разрешить перезапись файлов** —выберите этот параметр, чтобы перезаписывать архивные файлы с тем же именем. Если этот параметр не выбран, сохраняемый файл не может иметь то же имя, что и файл, который уже существует в этом расположении.

    **Применить сжатие** — выберите этот параметр, чтобы сжать архивный файл. Сжатые архивные файлы экономят место на диске, но немного повышают использование ЦП. 

    **Зашифровать файл резервной копии** — выберите этот параметр, чтобы зашифровать архивный файл. Этот параметр требует от пользователя ввести пароль для защиты файла. Пароль не позволяет считать архивный файл иными способами, кроме операции восстановления. Если вы решили шифровать архивные копии, сохраните пароль в безопасном месте.

5. Нажмите кнопку **ОК** для создания и сохранения архивного файла.


### <a name="powershell"></a>PowerShell
Используйте командлет [Backup-ASDatabase](https://docs.microsoft.com/sql/analysis-services/powershell/backup-asdatabase-cmdlet).

## <a name="restore"></a>восстановление;
При восстановлении файл архивной копии должен находиться в учетной записи хранения, настроенной для вашего сервера. Если нужно переместить файл архивной копии из локального расположения в учетную запись хранилища, используйте [обозреватель хранилищ Microsoft Azure](https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer) или служебную программу командной строки [AzCopy](../storage/common/storage-use-azcopy.md). 



> [!NOTE]
> Если вы выполняете восстановление с локального сервера, нужно сначала удалить всех пользователей домена из ролей модели, а затем снова добавить их в роли в качестве пользователей Azure Active Directory.
> 
> 

### <a name="to-restore-by-using-ssms"></a>Восстановление с помощью SSMS

1. В среде SSMS щелкните правой кнопкой мыши базу данных и выберите **Восстановить**.

2. В разделе **Файл резервной копии** диалогового окна **Резервное копирование базы данных** нажмите кнопку **Обзор**.

3. В диалоговом окне **Расположение файлов базы данных** выберите файл, который требуется восстановить.

4. В области **Восстановление базы данных** выберите базу данных.

5. Укажите параметры. Параметры безопасности должны соответствовать параметрам, использовавшимся при архивации.


### <a name="powershell"></a>PowerShell

Используйте командлет [Restore-ASDatabase](https://docs.microsoft.com/sql/analysis-services/powershell/restore-asdatabase-cmdlet).


## <a name="related-information"></a>Связанные сведения

[Учетные записи хранения Azure](../storage/common/storage-create-storage-account.md)  
[Высокая доступность](analysis-services-bcdr.md)     
[Управление службами Azure Analysis Services](analysis-services-manage.md)
