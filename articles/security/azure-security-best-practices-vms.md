---
title: Рекомендации по обеспечению безопасности виртуальных машин Azure
description: В этой статье представлены различные рекомендации по обеспечению безопасности виртуальных машин, размещенных в Azure.
services: security
documentationcenter: na
author: barclayn
manager: mbaldwin
editor: ''
ms.assetid: 5e757abe-16f6-41d5-b1be-e647100036d8
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/26/2018
ms.author: barclayn
ms.openlocfilehash: 409ed4618b8ddf022cfc3457851cf434ba810b94
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
---
# <a name="best-practices-for-azure-vm-security"></a>Рекомендации по обеспечению безопасности виртуальных машин Azure

В большинстве сценариев инфраструктуры как услуги (IaaS) [виртуальные машины (ВМ) Azure](https://docs.microsoft.com/azure/virtual-machines/) являются основной рабочей нагрузкой для организаций, использующих облачные вычисления. Этот особенно заметно в [гибридных сценариях](https://social.technet.microsoft.com/wiki/contents/articles/18120.hybrid-cloud-infrastructure-design-considerations.aspx), в которых организациям необходимо медленно переносить рабочие нагрузки в облако. В таких случаях необходимо следовать [общим рекомендациям по обеспечению безопасности для IaaS](https://social.technet.microsoft.com/wiki/contents/articles/3808.security-considerations-for-infrastructure-as-a-service-iaas.aspx), а также выполнять рекомендации по обеспечению безопасности на всех виртуальных машинах.

В этой статье рассматриваются различные рекомендации по обеспечению безопасности виртуальных машин, созданные на основе опыта наших клиентов, а также нашего собственного опыта работы с виртуальными машинами.

Рекомендации основаны на общем мнении и подходят для работы с текущими возможностями и наборами функций платформы Azure. Так как со временем мнения и технологии могут меняться, мы планируем постоянно обновлять эту статью, чтобы отражать такие изменения.

В рамках каждой рекомендации объясняется следующее:

* в чем заключается рекомендация;
* почему ее следует применять;
* как научиться применять эту рекомендацию;
* что может случиться, если не применить ее;
* возможные альтернативы рекомендации.

В статье рассматриваются следующие рекомендации по обеспечению безопасности виртуальных машин:

* проверка подлинности виртуальной машины и управление доступом к ней;
* доступность виртуальной машины и ее доступ к сети;
* защита неактивных данных, хранящихся на виртуальных машинах, с применением шифрования;
* управление обновлением виртуальной машины;
* управление уровнем безопасности виртуальной машины;
* мониторинг производительности виртуальной машины.

## <a name="vm-authentication-and-access-control"></a>Проверка подлинности виртуальной машины и управление доступом к ней

Для защиты виртуальной машины в первую очередь необходимо предоставить возможность настройки новых виртуальных машин только авторизованным пользователям. С помощью [политик Azure](../azure-policy/azure-policy-introduction.md) можно настраивать соглашения, касающиеся ресурсов в организации, создавать настраиваемые политики и применять их к ресурсам, например к [группам ресурсов](../azure-resource-manager/resource-group-overview.md).

Виртуальные машины, которые относятся к группе ресурсов, наследуют ее политики. Этот способ является предпочтительным для управления виртуальными машинами, но вы также можете контролировать доступ к политикам для отдельных виртуальных машин с помощью [управления доступом на основе ролей (RBAC)](../role-based-access-control/role-assignments-portal.md).

Применяя политики Resource Manager и RBAC для управления доступом к виртуальной машине, вы повышаете общую безопасность виртуальной машины. Мы рекомендуем объединять виртуальные машины с одинаковым жизненным циклом в одну группу ресурсов. С помощью групп ресурсов можно развертывать и отслеживать ресурсы, а также получать сводную информацию о затратах на ресурсы. Чтобы пользователи могли получать доступ к виртуальным машинам и настраивать их, используйте [принцип минимальных прав](https://technet.microsoft.com/windows-server-docs/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models). А при предоставлении прав пользователям используйте следующие встроенные роли Azure:

- [Участник виртуальных машин](../role-based-access-control/built-in-roles.md#virtual-machine-contributor) — может управлять виртуальными машинами, но не виртуальными сетями и учетными записями хранения, к которым они подключены.
- [Участник классических виртуальных машин](../role-based-access-control/built-in-roles.md#classic-virtual-machine-contributor) — может управлять виртуальными машинами, созданными с помощью классической модели развертывания, но не может управлять виртуальными сетями и учетными записями хранения, к которым подключены виртуальные машины.
- [Диспетчер безопасности](../role-based-access-control/built-in-roles.md#security-manager) — может управлять компонентами безопасности, политиками безопасности и виртуальными машинами.
- [Пользователь DevTest Labs](../role-based-access-control/built-in-roles.md#devtest-labs-user) — может просматривать все, а также подключать, запускать, перезапускать виртуальные машины и завершать их работу.

Не предоставляйте администраторам одни и те же учетные записи и пароли, а также не используйте пароли повторно для нескольких учетных записей или служб, особенно пароли для доступа к социальным сетям или для выполнения других действий, не связанных c администрированием. В идеале для безопасной настройки виртуальных машин следует использовать шаблоны [Azure Resource Manager](../azure-resource-manager/resource-group-authoring-templates.md). С помощью такого подхода можно ограничить выбор вариантов развертывания и принудительно применить к развертыванию параметры безопасности.

Если организация не применяет такие возможности, как RBAC, для контроля доступа к данным, пользователям будет предоставлено больше привилегий, чем необходимо для выполнения назначенных им задач. Ненадлежащий доступ пользователей к определенным данным может привести к компрометации данных.

## <a name="vm-availability-and-network-access"></a>Доступность виртуальной машины и ее доступ к сети

Если на виртуальной машине выполняются критически важные приложения, которым требуется высокий уровень доступности, настоятельно рекомендуем использовать несколько виртуальных машин. Для повышения уровня доступности создайте в [группе доступности](../virtual-machines/windows/tutorial-availability-sets.md) не менее двух виртуальных машин.

Для службы [Azure Load Balancer](../load-balancer/load-balancer-overview.md) также необходимо, чтобы виртуальные машины с балансировкой нагрузки входили в одну группу доступности. Если к этим виртуальным машинам требуется доступ из Интернета, необходимо настроить [подсистему балансировки нагрузки для Интернета](../load-balancer/load-balancer-internet-overview.md).

Когда виртуальные машины доступны через Интернет, необходимо [контролировать поток сетевого трафика с помощью групп безопасности сети (NSG)](../virtual-network/virtual-networks-nsg.md). Так как группы безопасности сети могут применяться к подсетям, количество таких групп можно свести к минимуму. Для этого ресурсы следует сгруппировать по подсетям, а затем применить к подсетям группы NSG. Цель состоит в том, чтобы создать уровень сетевой изоляции, а в Azure это возможно благодаря правильной настройке функций [безопасности сети](../best-practices-network-security.md).

Вы также можете использовать функцию оперативного (JIT) доступа к виртуальной машине из центра безопасности Azure, чтобы управлять тем, кто будет иметь удаленный доступ к определенной виртуальной машине и на какой срок.

Организации, которые не применяют ограничения доступа к сети для виртуальных машин, доступных через Интернет, подвержены рискам для системы безопасности, таким как атака методом подбора с применением протокола удаленного рабочего стола (RDP).

## <a name="protect-data-at-rest-in-your-vms-by-enforcing-encryption"></a>Защита неактивных данных, хранящихся на виртуальных машинах, с применением шифрования

[Шифрование неактивных данных](https://blogs.microsoft.com/cybertrust/2015/09/10/cloud-security-controls-series-encrypting-data-at-rest/) является обязательным шагом для защиты данных, соответствия стандартам и обеспечения конфиденциальности данных. [Шифрование дисков Azure](../security/azure-security-disk-encryption.md) позволяет ИТ-администраторам шифровать диски виртуальных машин IaaS под управлением Windows и Linux. Шифрование дисков объединяет стандартные для отрасли функции BitLocker для Windows и dm-crypt для Linux, которые обеспечивают шифрование томов для дисков операционной системы и дисков данных.

Шифрование дисков можно использовать для защиты данных в соответствии с применяемыми в вашей организации требованиями к безопасности и соответствию. Также с помощью шифрования организация может снизить риски, связанные с несанкционированным доступом к данным. Кроме того, рекомендуется шифровать диски до записи конфиденциальных данных на них.

Обязательно зашифруйте тома данных виртуальной машины, чтобы защитить неактивные тома данных в учетной записи хранения Azure. Защитите ключи шифрования и секрет с помощью [Azure Key Vault](https://azure.microsoft.com/documentation/articles/key-vault-whatis/).

Если организация не применяет шифрование данных, повышается вероятность потери целостности данных. Например, неавторизованные или недобросовестные пользователи могут похитить данные с помощью скомпрометированных учетных записей или получить несанкционированный доступ к данным, закодированным в формате ClearFormat. Помимо управления такими рисками, чтобы соответствовать отраслевым нормам, компании должны показать, что они проявляют осмотрительность и используют правильные средства управления безопасностью для повышения безопасности своих данных.

Дополнительные сведения о шифровании дисков см. в статье [Дисковое шифрование Azure для виртуальных машин IaaS под управлением Windows и Linux](azure-security-disk-encryption.md).


## <a name="manage-your-vm-updates"></a>Управление обновлением виртуальной машины

Виртуальными машинами Azure, как и всеми локальными виртуальными машинами, управляют пользователи, поэтому Azure не передает обновления Windows для них. При этом рекомендуется оставить включенной функцию автоматического обновления Windows. Другой вариант — развернуть на другой виртуальной машине или локальном сервере [службы Windows Server Update Services (WSUS)](https://technet.microsoft.com/windowsserver/bb332157.aspx) или другой подходящий продукт для управления обновлениями. Как WSUS, так и Центр обновления Windows обеспечивают актуальность виртуальных машин. Также рекомендуется использовать продукт для сканирования, чтобы обеспечить актуальность всех виртуальных машин IaaS.

Готовые образы, предоставляемые Azure, регулярно обновляются и включают в себя все последние обновления Windows. Однако нет никакой гарантии, что на момент развертывания образы будут актуальны. Возможна небольшая задержка (не более чем на несколько недель) с момента выхода общедоступных выпусков. Проверка наличия и установки всех обновлений Windows должна быть первым шагом при каждом развертывании. Она особенно важна при развертывании ваших собственных образов или образов из вашей библиотеки. Образы, которые входят в состав Azure Marketplace, по умолчанию обновляются автоматически.

Организации, которые не применяют политики обновления программного обеспечения, больше подвержены угрозам, связанным с использованием известных уязвимостей, которые были устранены ранее. Помимо управления такими рисками, чтобы соответствовать отраслевым нормам, компании должны показать, что они проявляют осмотрительность и используют правильные средства управления безопасностью, обеспечивая безопасность рабочей нагрузки, находящейся в облаке.

Важно подчеркнуть, что рекомендации по обновлению программного обеспечения для традиционных центров обработки данных и Azure IaaS имеют много общего. Поэтому мы рекомендуем проанализировать текущие политики обновления программного обеспечения, чтобы добавить в них виртуальные машины.

## <a name="manage-your-vm-security-posture"></a>Управление системой безопасности виртуальной машины

Киберугрозы эволюционируют, и для защиты виртуальных машин требуются более широкие возможности мониторинга, способные быстро выявить угрозы, предотвратить несанкционированный доступ к ресурсам, активировать оповещения и сократить число ложных срабатываний. Обеспечение безопасности для такой рабочей нагрузки включает в себя все аспекты безопасности виртуальной машины, начиная с управления обновлениями и заканчивая защитой доступа к сети.

Для мониторинга состояния безопасности виртуальных машин под управлением [Windows](../security-center/security-center-virtual-machine.md) и [Linux](../security-center/security-center-linux-virtual-machine.md) можно использовать [центр безопасности Azure](../security-center/security-center-intro.md). В центре безопасности Azure можно защитить виртуальные машины, используя следующие возможности:

* применение параметров безопасности операционной системы в соответствии с рекомендуемыми правилами конфигурации;
* идентификация и загрузка отсутствующих обновлений системы безопасности и критических обновлений;
* рекомендации по развертыванию защиты конечных точек от вредоносных программ;
* проверка шифрования диска;
* оценка и исправление уязвимостей;
* Обнаружение угроз

Центр безопасности может активно отслеживать угрозы, а потенциальные угрозы будут отображаться в разделе **Оповещения системы безопасности**. Коррелированные угрозы будут собраны в одном представлении, которое называется **Инцидент безопасности**.

Чтобы понять, как с помощью центра безопасности выявлять потенциальные угрозы на виртуальных машинах, размещенных в Azure, просмотрите следующее видео.

>[!VIDEO https://channel9.msdn.com/Blogs/Azure-Security-Videos/Azure-Security-Center-in-Incident-Response/player]

Организации, которые не обеспечивают надежную защиту для виртуальных машин, не знают о потенциальных попытках неавторизованных пользователей обойти установленные средства управления безопасностью.

## <a name="monitor-vm-performance"></a>Мониторинг производительности виртуальной машины

Применение ресурсов не по назначению (например, когда процессы на виртуальной машине потребляют больше ресурсов, чем положено) может стать проблемой. Снижение производительности виртуальной машины может привести к прерыванию работы служб, что в свою очередь нарушает доступность, являющуюся одним из основных принципов безопасности. Поэтому крайне важно не только контролировать доступ к виртуальным машинам в случае возникновения проблем, но и заранее отслеживать базовые показатели производительности в периоды штатного функционирования.

Анализируя [диагностические файлы журналов Azure](https://azure.microsoft.com/blog/windows-azure-virtual-machine-monitoring-with-wad-extension/), можно отслеживать ресурсы виртуальной машины и выявлять потенциальные проблемы, которые могут снизить производительность и доступность. Расширение системы диагностики Azure позволяет использовать возможности мониторинга и диагностики на виртуальных машинах под управлением Windows. Чтобы использовать эти возможности, необходимо включить расширение в [шаблон Azure Resource Manager](../virtual-machines/windows/extensions-diagnostics-template.md).

Для получения сведений о работоспособности ресурсов можно также использовать [Azure Monitor](../monitoring-and-diagnostics/monitoring-overview-metrics.md).

Организации, которые не отслеживают производительность виртуальных машин, не способны определить, являются ли определенные изменения в показателях производительности нормальными или аномальными. Если виртуальная машина потребляет больше ресурсов, чем обычно, это может свидетельствовать о потенциальной атаке, совершаемой с внешнего ресурса, или о скомпрометированном процессе, выполняемом на виртуальной машине.
