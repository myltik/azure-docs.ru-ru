---
title: Шаблон мультитенантного веб-приложения | Документация Майкрософт
description: Найдите обзоры архитектуры и шаблоны разработки, описывающие, как реализовать мультитенантное веб-приложение в Azure.
services: ''
documentationcenter: .net
author: wadepickett
manager: wpickett
editor: ''
ms.assetid: 4f0281d2-1555-42b0-a99d-1222fade0b0f
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/05/2015
ms.author: wpickett
ms.openlocfilehash: 57ba0e46139bda2d74c9f7db0ffab2f2122b0df2
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
ms.locfileid: "23013029"
---
# <a name="multitenant-applications-in-azure"></a>Мультитенантные приложения Azure
Мультитенантное приложение – это общий ресурс, который позволяет разделять пользователей или "клиентов" для просмотра приложения, как будто каждый пользователь является его владельцем. Типичный сценарий, связанный с мультитенатным приложением: все пользователи приложения могут настроить под себя интерфейс, однако во всем остальном приложение должно соответствовать одним и тем же бизнес-требованиям. Примерами крупных мультитенатных приложений являются Office 365, Outlook.com и visualstudio.com.

С точки зрения поставщика приложения преимущества мультитенантности связаны в основном с оптимизацией работы и расходов. Одна версия приложения может соответствовать потребностям многих клиентов/заказчиков, что позволяет консолидировать задачи системного администрирования, такие как мониторинг, настройка производительности, поддержка программного обеспечения и резервное копирование данных.

Ниже приведен список наиболее значимых целей и требований с точки зрения поставщика.

* **Подготовка.** Необходимо иметь возможность подготавливать новых клиентов для приложения.  Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.
* **Возможность поддержки.** Необходимо иметь возможность обновить приложение и выполнить другие задачи поддержки во время использования приложения несколькими клиентами.
* **Мониторинг.** Необходимо иметь возможность постоянного мониторинга приложения для определения любых проблем и их эффективного устранения. Это включает мониторинг использования приложения каждым клиентом.

Правильно реализованного мультитенантное приложение предоставляет пользователям следующие преимущества.

* **Изоляция.** Действия отдельных клиентов не влияют на использование приложения другими клиентами. Клиенты не могут получить доступ к данным друг друга. С точки зрения клиента он имеет эксклюзивный доступ к приложению.
* **Доступность.** Отдельные клиенты нуждаются в постоянной доступности приложения, возможно, с определением гарантии в соглашении об уровне обслуживания. Опять же, действия других клиентов не должны влиять на доступность приложения.
* **Масштабируемость.** Приложение масштабируется для соответствия требованиям отдельных клиентов. Присутствие и действия других клиентов не должны влиять на производительность приложения.
* **Расходы.** Расходы ниже, чем при использовании выделенного для одного клиента приложения, так как мультитенантность обеспечивает совместное использование ресурсов.
* **Возможность настройки**. Возможность настройки приложения для отдельного клиента различными способами, например путем добавления и удаления функциональных возможностей, изменения цветов и логотипов или даже добавления собственного кода или сценария.

В целом, для предоставления масштабируемой службы следует учитывать различные факторы, однако существует также ряд целей и требований, которые являются общими для многих мультитенатных приложений. Некоторые могут не быть связаны с определенными сценариями, а важность отдельных целей и требований будут различаться в каждом сценарии. Как поставщик мультитенатных приложений вы также будете иметь определенные цели и требования, такие как выполнение требований клиентов, обеспечение прибыли, выставление счетов, предоставление различных уровней обслуживаний, подготовка, поддержка, мониторинг и автоматизация.

Дополнительные сведения о дополнительных аспектах разработки мультитенантного приложения см. в статье [Размещение мультитенантного приложения в Azure][Hosting a Multi-Tenant Application on Azure]. Сведения о распространенных шаблонах архитектуры данных для мультитенантных приложений базы данных SaaS см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием базы данных Azure SQL](sql-database/sql-database-design-patterns-multi-tenancy-saas-applications.md). 

Azure предоставляет различные функциональные возможности, которые позволяют устранить основные проблемы, возникающие при разработке мультитенантной системы.

**Изоляция**

* Сегментация клиентов веб-сайта с помощью заголовков узла как при использовании SSL-подключений, так и при их отсутствии.
* Сегментация клиентов веб-сайтов с помощью параметров запросов.
* Веб-службы в рабочих ролях.
  * Рабочие роли которые, как правило, обрабатывают данные в серверной части приложения.
  * Веб-роли, которые, как правило, функционируют как интерфейсные части приложений.

**Хранилище**

Управление данными, такое как база данных SQL Azure, или службы хранилища Azure, такие как служба таблиц, которая предоставляет службы хранилища для больших объемов неструктурированных данных, и служба BLOB-объектов, которая предоставляет возможности хранения больших объемов неструктурированных текстовых или двоичных данных, таких как видео, аудио и изображения.

* Обеспечение защиты мультитенантных данных в базе данных SQL в соответствии с учетными данными входа каждого клиента на сервер SQL Server.
* Использование таблиц Azure для ресурсов приложения. Путем определения политики доступа на уровне контейнера можно регулировать разрешения без необходимости формирования нового URL-адреса для ресурсов, защищенных подписями общего доступа.
* Очереди Azure для ресурсов приложения. Очереди Azure часто используются для выполнения обработки от имени клиентов, однако также могут быть использованы для распределения работы, необходимой для подготовки и управления.
* Очереди Service Bus для ресурсов приложения, которые передают работу в общую службу. Можно использовать отдельную очередь, где каждый клиент-отправитель может иметь разрешения (по требованиям ACS) только на передачу данных в эту очередь, тогда как только получатели из службы могут иметь разрешение на прием из очереди данных, поступающих от нескольких клиентов.

**Службы подключения и безопасности**

* Azure Service Bus — это инфраструктура обмена сообщениями, которая размещается между приложениями и позволяет им обмениваться сообщениями в слабосвязанной конфигурации для улучшения масштабирования и устойчивости.

**Сетевые службы**

Azure предоставляет несколько сетевых служб, поддерживающих проверку подлинности и повышающих управляемость размещенных приложений. В число этих служб входят следующие:

* Виртуальная сеть Azure позволяет подготавливать виртуальные частные сети (VPN) в Azure, управлять ими, а также обеспечить безопасный канал с локальной ИТ-инфраструктурой.
* Диспетчер трафика (Traffic Manager) виртуальных сетей обеспечивает балансировку нагрузки по входящему трафику между несколькими размещенными службами Azure независимо от того, работают они в одном центре обработки данных или распределены по всему миру.
* Azure Active Directory (Azure AD) — это современная служба на основе интерфейса REST, которая предоставляет возможности для управления идентификацией и доступом в облачных приложениях. Использование Azure AD для ресурсов приложения Azure AD для предоставления простого способа проверки подлинности и авторизации пользователей для получения доступа к веб-приложениям и службам, одновременно позволяя реализовывать функциональные возможности проверки подлинности и авторизации в своем коде.
* Azure Service Bus предоставляет возможность безопасного обмена сообщениями и передачи данных для распределенных и гибридных приложений, например связи между размещенными в Azure приложениями и локальными приложениями и службами без необходимости в использовании комплексных инфраструктур брандмауэра и безопасности. С помощью ретранслятора служебной шины для ресурсов приложений. Службы, которые являются конечными точками, могут принадлежать клиенту (например, размещаться вне системы, в локальной среде) или подготавливаться специально для клиента (так как между ними передаются конфиденциальные данные, относящиеся к клиенту).

**Подготовка ресурсов**

Azure предоставляет ряд способов подготовки новых клиентов приложения. Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.

* Рабочие роли позволяют подготовить и отменить подготовку ресурсов для каждого клиента (например, при регистрации или отмене регистрации клиентов), собирать показатели для использования этих данных, а также управлять масштабированием по определенному расписанию или в ответ на пересечение порогового значения или ключевого показателя производительности. Эта же роль может использоваться для передачи обновлений и модернизаций в решение.
* BLOB-объекты Azure могут использоваться для подготовки вычислительных ресурсов или предварительно инициализированных ресурсов хранения для новых клиентов, обеспечивая при этом политики доступа на уровне контейнера для защиты пакетов, VHD-образов и других ресурсов вычислительных служб.
* Возможности подготовки ресурсов баз данных SQL для клиентов включают следующие:
  
  * DDL в сценариях или в виде встроенных ресурсов в сборках
  * Пакеты SQL Server 2008 R2, развернутые программными средствами.
  * Копирование из главной справочной базы данных
  * Использование импорта и экспорта базы данных для подготовки новых баз данных из файла.

<!--links-->

[Hosting a Multi-Tenant Application on Azure]: http://msdn.microsoft.com/library/hh534480.aspx
[Designing Multitenant Applications on Azure]: http://msdn.microsoft.com/library/windowsazure/hh689716
