---
title: Использование устройств Azure IoT Edge в качестве шлюзов | Документация Майкрософт
description: Используйте Azure IoT Edge для создания прозрачного, непрозрачного устройства шлюза или устройства шлюза прокси-сервера, который отправляет данные из нескольких подчиненных устройств в облако или обрабатывает их локально.
author: kgremban
manager: timlt
ms.author: kgremban
ms.date: 11/27/2017
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: ff5e50df1f7a9059bf37fe99d89050a48aa6e64e
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34631604"
---
# <a name="how-an-iot-edge-device-can-be-used-as-a-gateway---preview"></a>Использование устройства IoT Edge в качестве шлюза (предварительная версия)

Назначение шлюзов в решениях Интернета вещей зависит от решения и сочетает возможности взаимодействия устройства с пограничной аналитикой. Azure IoT Edge может использоваться для удовлетворения всех потребностей шлюза Интернета вещей независимо от того, связаны ли они с подключением, удостоверением или пограничной аналитикой. Шаблоны шлюза в этой статье относятся только к характеристикам подключения к нисходящему устройству и идентификации устройства, а не как данные устройства обрабатываются на шлюзе.

## <a name="patterns"></a>Шаблоны
Есть три шаблона для использования устройства IoT Edge в качестве шлюза: прозрачный, преобразование протоколов и преобразование удостоверения.
* **Прозрачный**. Устройства, которые теоретически могут подключиться к Центру Интернета вещей, могут вместо этого подключиться к шлюзу устройства. Это означает, что подчиненные устройства имеют собственные удостоверения Центра Интернета вещей и используют любые протоколы MQTT, AMQP или HTTP. Шлюз просто передает связь между устройствами и концентратором Центра Интернета вещей. Устройства не знают, что они взаимодействуют с облаком через шлюз, а пользователь, взаимодействующий с устройствами в Центре Интернета вещей, не знает о промежуточном устройстве шлюза. Таким образом шлюз является прозрачным. Дополнительные сведения о том, как использовать устройство IoT Edge в качестве прозрачного шлюза, см. в статье [Создание устройства IoT Edge, выступающего в роли прозрачного шлюза (предварительная версия)][lnk-iot-edge-as-transparent-gateway].
* **Преобразование протокола**. Устройства, не поддерживающие MQTT, AMQP или HTTP, используют устройство шлюза для отправки данных в Центр Интернета вещей. У шлюза достаточно возможностей, чтобы понять, что протокол используется подчиненными устройствами, однако это единственное устройство с удостоверением в Центре Интернета вещей. Вся информация выглядит так, будто она поступает с одного устройства, шлюза. Это означает, что подчиненные устройства должны внедрять дополнительные идентификационные сведения в свои сообщения, если облачные приложения хотят делать выводы о данных для каждого устройства. Кроме того, примитивы Центра Интернета вещей, такие как двойники и методы, доступны только для устройства шлюза, а не для подчиненных устройств.
* **Преобразование удостоверения**. Устройства, которые не могут подключиться к Центру Интернета вещей, подключаются к устройству шлюза, которое предоставляет удостоверение Центра Интернета вещей и преобразование протокола от имени подчиненных устройств. У шлюза достаточно возможностей, чтобы понять протокол, используемый подчиненными устройствами, предоставить им удостоверение и преобразовать примитивы Центра Интернета вещей. Подчиненные устройства отображаются в Центре Интернета вещей как устройства первого уровня с двойниками и методами. Пользователь может взаимодействовать с устройствами в Центре Интернета вещей и ничего не знать о промежуточном устройстве шлюза.

![Диаграммы шаблонов шлюза][1]

## <a name="use-cases"></a>Варианты использования
Все шаблоны шлюза предоставляют следующие преимущества:
* **Пограничная аналитика**. Использует службы искусственного интеллекта локально, чтобы обрабатывать данные, поступающие с подчиненных устройств, без отправки телеметрии с полным соответствием в облако. Находите данные и реагируйте на запросы локально, а также отправляйте подмножество данных в Центр Интернета вещей. 
* **Изоляция подчиненного устройства.** Устройство шлюза может обеспечить всем подчиненным устройствам безопасность в Интернете. Оно может находиться между сетью OT без возможности подключения и IT-сетью, которая обеспечивает доступ к сети. 
* **Мультиплексирование подключения**. Все устройства, подключающиеся к Центру Интернета вещей через устройство IoT Edge, будут использовать одно и то же базовое подключение.
* **Сглаживание трафика**. Устройство IoT Edge будет автоматически реализовывать экспоненциальное откладывание в случае регулирования Центра Интернета вещей при сохранении сообщений на локальном компьютере. Это позволит сделать ваше решение устойчивым к пикам трафика.
* **Ограниченная автономная поддержка**. Устройство шлюза будет хранить локальные сообщения и операции обновления двойников, которые невозможно доставить в Центр Интернета вещей.

Шлюз, выполняющий преобразование протокола, также может выполнять пограничную аналитику, изоляцию устройства, сглаживание трафика и автономную поддержку имеющихся устройств и новых устройств с ограниченными ресурсами. Многие имеющиеся устройства производят данные, которые могут предоставить бизнес-аналитику, однако они не были разработаны с учетом возможности подключения к облаку. Непрозрачные шлюзы позволяют разблокировать эти данные и использовать их в комплексном решении Интернета вещей.

Шлюз, который преобразует удостоверение, предоставляет преимущества преобразования протокола и дополнительно позволяет полностью управлять подчиненными устройствами из облака. Все устройства решения Интернета вещей отображаются в Центре Интернета вещей независимо от используемого протокола.

## <a name="cheat-sheet"></a>Краткий справочник
Ниже приведена краткая памятка, в которой сравниваются примитивы Центра Интернета вещей при использовании прозрачного и непрозрачного шлюза и шлюза прокси-сервера.

| &nbsp; | Прозрачный шлюз | Преобразование протоколов | Преобразование удостоверения |
|--------|-------------|--------|--------|
| Удостоверения, хранящиеся в реестре удостоверений Центра Интернета вещей | Удостоверения всех подключенных устройств | Только удостоверение устройства шлюза | Удостоверения всех подключенных устройств |
| "Двойник" устройства | У каждого подключенного устройства есть свой собственный двойник устройства | Только у шлюза есть двойники устройства и модуля | У каждого подключенного устройства есть свой собственный двойник устройства |
| Прямые методы и сообщения, передающиеся из облака на устройства | Данные могут передаваться из облака на каждое подключенное устройство по отдельности | Данные могут передаваться из облака только в шлюз | Данные могут передаваться из облака на каждое подключенное устройство по отдельности |
| [Регуляторы и квоты Центра Интернета вещей][lnk-iothub-throttles-quotas] | Применяется к каждому устройству | Применяется к устройству шлюза | Применяется к каждому устройству |

При использовании модели непрозрачного шлюза (преобразование протоколов) все устройства, подключающиеся через шлюз, совместно используют одну очередь из облака на устройство, которая может содержать не более 50 сообщений. Из этого следует, что шаблон непрозрачного шлюза должен использоваться только в том случае, если через шлюз каждого поля подключается небольшое число устройств и их трафик из облака на устройство низкий.

## <a name="next-steps"></a>Дополнительная информация
Используйте устройство IoT Edge в качестве [прозрачного шлюза][lnk-iot-edge-as-transparent-gateway]. 

[lnk-iot-edge-as-transparent-gateway]: ./how-to-create-transparent-gateway.md
[lnk-iothub-throttles-quotas]: ../iot-hub/iot-hub-devguide-quotas-throttling.md

[1]: ./media/iot-edge-as-gateway/edge-as-gateway.png
