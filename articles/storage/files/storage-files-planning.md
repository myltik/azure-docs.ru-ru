---
title: Планирование развертывания службы файлов Azure | Документы Майкрософт
description: Узнайте, что необходимо учесть при планировании развертывания службы файлов Azure.
services: storage
author: wmgries
manager: jeconnoc
ms.service: storage
ms.topic: article
ms.date: 03/06/2018
ms.author: wgries
ms.openlocfilehash: 017dd79e2d15fdd98ea020c686857d282bad244e
ms.sourcegitcommit: fa493b66552af11260db48d89e3ddfcdcb5e3152
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2018
---
# <a name="planning-for-an-azure-files-deployment"></a>Планирование развертывания службы файлов Azure
[Служба файлов Azure](storage-files-introduction.md) предлагает полностью управляемые общие файловые ресурсы в облаке, доступ к которым можно получить с помощью стандартного отраслевого протокола SMB. Так как служба файлов Azure является полностью управляемой, ее развертывание в рабочих сценариях гораздо проще развертывания файлового сервера или устройства NAS и управления им. В этой статье рассматриваются аспекты, которые следует учитывать при развертывании файлового ресурса Azure для использования в рабочей среде вашей организации.

## <a name="management-concepts"></a>Основные принципы управления
 На схеме ниже показаны компоненты управления службой файлов Azure.

![Структура файла](./media/storage-files-introduction/files-concepts.png)

* **Учетная запись хранения**. Весь доступ к хранилищу Azure осуществляется с помощью учетной записи хранения. Сведения о емкости учетной записи хранения см. в статье [о целевых показателях масштабируемости и производительности службы хранилища Azure](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

* **Общая папка.** Общая папка хранилища файлов представляет собой общую папку с файлами в Azure, использующую протокол SMB. Все каталоги и файлы должны быть созданы в родительской общей папке. Учетная запись может содержать любое количество общих папок, а общая папка может содержать любое количество файлов, общий размер которых не превышает 5 ТБ.

* **Каталог.** Необязательная иерархия каталогов.

* **Файл.** Файл в совместно используемом ресурсе. Файлы могут иметь размер до 1 ТБ.

* **Формат URL-адреса**. В запросах к файловому ресурсу Azure, выполненных с помощью протокола REST, к файлам можно обращаться, используя URL-адреса в следующем формате:

    ```
    https://<storage account>.file.core.windows.net/<share>/<directory>/directories>/<file>
    ```

## <a name="data-access-method"></a>Метод доступа к данным
Служба файлов Azure предлагает два встроенных удобных метода доступа к данным, которые можно использовать по отдельности или в сочетании друг с другом.

1. **Прямой доступ к облаку**. Файловый ресурс Azure можно подключить к [Windows](storage-how-to-use-files-windows.md), [macOS](storage-how-to-use-files-mac.md) и (или) [Linux](storage-how-to-use-files-linux.md) с помощью протокола SMB или File REST API. При использовании SMB операции чтения и записи выполняются непосредственно в файловом ресурсе в Azure. Для подключения к виртуальной машине в Azure клиент SMB в операционной системе должен поддерживать по меньшей мере протокол SMB 2.1. Для локального подключения, например к рабочей станции пользователя, клиент SMB на рабочей станции должен поддерживать по меньшей мере протокол SMB 3.0 (с шифрованием). Кроме SMB, новые приложения или службы могут напрямую обращаться к файловому ресурсу посредством File REST, который является простым и масштабируемым API-интерфейсом для разработки программного обеспечения.
2. **Служба синхронизации Azure файлов** (предварительная версия). С помощью службы синхронизации файлов Azure можно реплицировать файловые ресурсы на локальные серверы Windows Server или в Azure. Ваши пользователи могут получить доступ к файловому ресурсу через Windows Server, например через общий ресурс SMB или NFS. Это полезно в сценариях, когда доступ к данным и их изменения выполняются далеко за пределами центров обработки данных Azure, например как в сценарии с филиалом. Данные можно реплицировать между несколькими конечными точками Windows Server, например между несколькими филиалами. Наконец, данные могут быть размещены на нескольких уровнях в службе файлов Azure так, что они по-прежнему будут доступны через сервер, однако на сервере отсутствует полная копия данных. Данные можно легко извлечь при открытии пользователем.

В следующей таблице показано, как пользователи и приложения могут получить доступ к файловому ресурсу Azure.

| | Прямой доступ к облаку | Служба синхронизации файлов Azure |
|------------------------|------------|-----------------|
| Какие протоколы необходимо использовать? | Служба файлов Azure поддерживает SMB 2.1, SMB 3.0 и File REST API. | Доступ к файловым ресурсам Azure с помощью любого поддерживаемого протокола в Windows Server (SMB, NFS, FTPS и т. д.) |  
| Где выполняется рабочая нагрузка? | **В Azure**. Служба файлов Azure обеспечивает прямой доступ к данным. | **В локальной среде с медленным сетевым подключением**. Клиенты Windows, Linux и macOS могут подключить локальный файловый ресурс Windows в качестве быстрого кэша файлового ресурса Azure. |
| Какой уровень списков ACL требуется? | Уровень общего доступа и уровень файла. | Уровень общего доступа, уровень файла и уровень пользователя. |

## <a name="data-security"></a>Защита данных
Служба файлов Azure предлагает несколько встроенных возможностей для обеспечения безопасности данных.

* Поддержка шифрования для протоколов сетевой передачи: шифрование SMB 3.0 и File REST по HTTPS. По умолчанию: 
    * Клиенты, которые поддерживают шифрование SMB 3.0, отправляют и получают данные по зашифрованному каналу.
    * Клиенты, которые не поддерживают SMB 3.0, могут взаимодействовать внутри ЦОД по протоколам SMB 2.1 или SMB 3.0 без шифрования. Обратите внимание, что клиенты не могут взаимодействовать между ЦОД по протоколам SMB 2.1 или SMB 3.0 без шифрования.
    * Клиенты могут взаимодействовать через File REST по протоколу HTTP или HTTPS.
* Шифрование неактивных данных ([Шифрование службы хранилища Azure](../common/storage-service-encryption.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json)). Шифрование службы хранилища (SSE) включено по умолчанию для всех учетных записей хранения. Неактивные данные шифруются с помощью полностью управляемых ключей. Шифрование неактивных данных не увеличивает затраты на хранение и не снижает производительность. 
* Необязательное требование к зашифрованным данным во время передачи: если выбран этот вариант, служба файлов Azure запретит доступ к данным по незашифрованным каналам. В частности, будут разрешены только подключения по протоколам HTTPS и SMB 3.0 с шифрованием. 

    > [!Important]  
    > Необходимость безопасной передачи данных приведет к сбою старых клиентов SMB, не поддерживающих взаимодействие с SMB 3.0 с шифрованием. Дополнительные сведения см. в статьях [Подключение в Windows](storage-how-to-use-files-windows.md), [Подключение в Linux](storage-how-to-use-files-linux.md), [Подключение в macOS](storage-how-to-use-files-mac.md).

Для обеспечения максимальной безопасности настоятельно рекомендуется всегда включать шифрование данных при хранении и шифрование данных во время передачи при каждом использовании современных клиентов для доступа к данным. Например, если необходимо подключить общую папку в виртуальной машине с Windows Server 2008 R2, которая поддерживает только SMB 2.1, необходимо разрешить передачу незашифрованного трафика в хранилище, так как SMB 2.1 не поддерживает шифрование.

Если для доступа к файловому ресурсу Azure вы используете службу синхронизации файлов Azure, всегда будут использоваться протоколы HTTPS и SMB 3.0 с шифрованием для синхронизации данных с серверами Windows Server независимо от требования шифрования хранящихся данных.

## <a name="data-redundancy"></a>Избыточность данных
Служба файлов Azure поддерживает три варианта избыточности данных: локально избыточное хранилище (LRS), хранилище, избыточное в пределах зоны, (ZRS) и геоизбыточное хранилище (GRS). В следующих разделах описаны различия между разными вариантами обеспечения избыточности.

### <a name="locally-redundant-storage"></a>Локально избыточное хранилище
[!INCLUDE [storage-common-redundancy-LRS](../../../includes/storage-common-redundancy-LRS.md)]

### <a name="zone-redundant-storage"></a>Хранилище, избыточное в пределах зоны
[!INCLUDE [storage-common-redundancy-ZRS](../../../includes/storage-common-redundancy-ZRS.md)]

### <a name="geo-redundant-storage"></a>Геоизбыточное хранилище
[!INCLUDE [storage-common-redundancy-GRS](../../../includes/storage-common-redundancy-GRS.md)]

## <a name="data-growth-pattern"></a>Модель роста данных
Сейчас максимальный размер файлового ресурса Azure составляет 5 Тебибайт, включая папку моментальных снимков. В связи с этим текущим ограничением при развертывании файлового ресурса Azure следует учитывать ожидаемый рост данных. Обратите внимание, что учетная запись хранения Azure может хранить несколько файловых ресурсов общим объемом 500 Тебибайт.

Служба синхронизации файлов позволяет синхронизировать несколько файловых ресурсов Azure с одним файловым сервером Windows. В этом случае старые и очень большие файловые ресурсы, размещенные в локальных средах, можно ввести под контроль службы синхронизации файлов Azure. Дополнительные сведения см. в статье [Планирование развертывания службы синхронизации файлов Azure](storage-files-planning.md).

## <a name="data-transfer-method"></a>Метод передачи данных
Существует множество простых вариантов массовой передачи данных из существующего файлового ресурса, такого как файловый ресурс в локальной среде, в службу файлов Azure. В число распространенных методов входят следующие (список не является исчерпывающим).

* **Служба синхронизации файлов Azure**. В ходе первой синхронизации между файловым ресурсом Azure ("облачная конечная точка") и пространством имен каталогов Windows ("серверная конечная точка") служба синхронизации файлов Azure реплицирует все данные из существующего файлового ресурса в службу файлов Azure.
* **[Служба "Импорт и экспорт Azure"](../common/storage-import-export-service.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json)**. Эта служба позволяет безопасно переносить большие объемы данных в файловый ресурс Azure, отправляя жесткие диски в центр обработки данных Azure. 
* **[Robocopy](https://technet.microsoft.com/library/cc733145.aspx)**. Это хорошо известное средство копирования, которое входит в состав Windows и Windows Server. Robocopy можно применять для передачи данных в службу файлов Azure путем локального подключения файлового ресурса и последующего использования подключенного расположения в качестве назначения в команде Robocopy.
* **[AzCopy](../common/storage-use-azcopy.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json#upload-files-to-an-azure-file-share)** — это служебная программа командной строки. Она предназначена для копирования данных из службы файлов Azure, хранилища BLOB-объектов Azure и обратно с помощью простых команд, обеспечивающих оптимальную производительность. Эта программа доступна для Windows и Linux.

## <a name="next-steps"></a>Дополнительная информация
* [Planning for an Azure File Sync Deployment](storage-sync-files-planning.md) (Планирование развертывания службы синхронизации файлов Azure)
* [Deploying Azure Files](storage-files-deployment-guide.md) (Развертывание службы файлов Azure)
* [Развертывание службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-deployment-guide.md)