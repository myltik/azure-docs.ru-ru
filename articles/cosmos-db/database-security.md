---
title: Безопасность базы данных в Azure Cosmos DB | Документация Майкрософт
description: Узнайте, как Azure Cosmos DB обеспечивает защиту базы данных и данных.
keywords: безопасность базы данных nosql, защита информации, безопасность данных, шифрование базы данных, защита базы данных, политики безопасности, тестирование безопасности
services: cosmos-db
author: SnehaGunda
manager: kfile
documentationcenter: ''
ms.assetid: a02a6a82-3baf-405c-9355-7a00aaa1a816
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/15/2017
ms.author: sngun
ms.openlocfilehash: a873aa9835ffab8b0d195d9fc9588167ea134128
ms.sourcegitcommit: 5b2ac9e6d8539c11ab0891b686b8afa12441a8f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
# <a name="azure-cosmos-db-database-security"></a>Безопасность базы данных в Azure Cosmos DB

В этой статье представлены рекомендации по обеспечению безопасности, а также основные возможности, предлагаемые Azure Cosmos DB для предотвращения и обнаружения нарушений в работе баз данных и реагирования на эти нарушения.
 
## <a name="whats-new-in-azure-cosmos-db-security"></a>Новые возможности безопасности в Azure Cosmos DB

Шифрование неактивных данных теперь доступно для документов и резервных копий, хранящихся в Azure Cosmos DB во всех регионах Azure. Шифрование неактивных данных применяется в этих регионах автоматически как для новых, так и для существующих клиентов. Настраивать ничего не нужно. Уровень задержки, пропускной способности, доступности и функциональности сохраняется, но при этом вы получаете преимущество более высокой защищенности данных.

## <a name="how-do-i-secure-my-database"></a>Как защитить свою базу данных? 

Ответственность за безопасность данных лежит как на клиенте, так и на поставщике базы данных. В зависимости от выбранного поставщика базы данных доля ответственности клиента может меняться. Если выбрать локальное решение, то клиент должен предоставить все — от защиты конечной точки до физической безопасности оборудования, а это непростая задача. Если выбрать поставщик облачной базы данных PaaS, например Azure Cosmos DB, то обязанности клиента значительно сокращаются. На следующем рисунке, взятом из технического документа корпорации Майкрософт [Shared Responsibilities for Cloud Computing](https://aka.ms/sharedresponsibility) (Разделяемые обязанности в облачных вычислениях), показано, как с применением поставщика PaaS, такого как Azure Cosmos DB, сокращается ответственность клиента.

![Ответственность клиента и поставщика базы данных](./media/database-security/nosql-database-security-responsibilities.png)

На предыдущей схеме видны высокоуровневые компоненты безопасности в облаке, но о каких элементах необходимо позаботиться конкретно для решения вашей базы данных? И как сравнить решения между собой? 

Мы рекомендуем сравнить системы баз данных с помощью следующего контрольного списка требований:

- Параметры безопасности сети и брандмауэра
- Аутентификация пользователей и детальные пользовательские элементы управления
- Возможность глобальной репликации данных в случае регионального сбоя
- Возможность отработки отказа с одного центра обработки данных на другой
- Репликация локальных данных в рамках центра обработки данных
- Автоматическая архивация данных
- Восстановление удаленных данных из архива
- Защита и изолирование конфиденциальных данных
- Мониторинг атак
- Реагирование на атаки
- Возможность защитить данные в пределах геозоны в соответствии с ограничениями, установленными для управления данными
- Физическая защита серверов в защищенных центрах обработки данных

И хотя это может показаться очевидным, но последние [крупномасштабные нарушения в работе баз данных](http://thehackernews.com/2017/01/mongodb-database-security.html) напоминают нам о простых, но критических важных требованиях, которые необходимо выполнять:
- На серверах устанавливаются исправления и поддерживается их актуальность
- Шифрование HTTPS по умолчанию или SSL-шифрование
- Административные учетные записи с надежными паролями

## <a name="how-does-azure-cosmos-db-secure-my-database"></a>Каким образом Azure Cosmos DB обеспечивает защиту базы данных?

Давайте еще раз рассмотрим приведенный выше список. Сколько из этих требований к безопасности выполняется Azure Cosmos DB? Абсолютно все.

Рассмотрим каждое из них подробнее.

|Требование к безопасности|Подход к обеспечению безопасности Azure Cosmos DB|
|---|---|---|
|Безопасность сети|Использование брандмауэра для IP-адресов — первый уровень защиты базы данных. Для поддержки входящего трафика брандмауэра база данных Azure Cosmos DB использует политики контроля доступа на основе IP-адресов. Эти политики контроля доступа на основе IP-адресов похожи на правила брандмауэра, используемые традиционными системами баз данных, но они имеют расширенные возможности, позволяющие настроить доступ к учетной записи базы данных Azure Cosmos DB только из утвержденных компьютеров или облачных служб. <br><br>Azure Cosmos DB позволяет включить определенный IP-адрес (168.61.48.0), диапазон IP-адресов (168.61.48.0/8), а также сочетания IP-адресов и диапазонов. <br><br>Все запросы, полученные от компьютеров, IP-адреса которых не входят в этот список разрешенных, блокируются Azure Cosmos DB. Затем запросы из утвержденных компьютеров и облачных служб должны пройти процесс аутентификации, чтобы получить право на контроль доступа к ресурсам.<br><br>Дополнительные сведения см. на странице о [поддерживаемых брандмауэрах в Azure Cosmos DB](firewall-support.md).|
|Авторизация|Azure Cosmos DB использует для авторизации код проверки подлинности сообщения на основе хэша (HMAC). <br><br>Каждый запрос хэшируется с помощью секретного ключа учетной записи, а затем хэш в кодировке Base-64 отправляется с каждым вызовом в Azure Cosmos DB. Чтобы проверить запрос, служба Azure Cosmos DB использует соответствующий секретный ключ и свойства для создания хэша, а затем сравнивает это значение со значением в запросе. Если эти два значения совпадают, то операция авторизуется и запрос обрабатывается. В противном случае происходит ошибка авторизации и запрос отклоняется.<br><br>Для обеспечения детального управления доступом к ресурсу, например документу, можно использовать [главный ключ](secure-access-to-data.md#master-keys) или [маркер ресурса](secure-access-to-data.md#resource-tokens).<br><br>Дополнительные сведения см. в статье о [защите доступа к ресурсам Azure Cosmos DB](secure-access-to-data.md).|
|Пользователи и разрешения|С помощью [главного ключа](#master-key) для учетной записи можно создавать в базе данных ресурсы пользователей и разрешений. [Маркер ресурса](#resource-token) связан с разрешением в базе данных и определяет, имеет ли пользователь доступ (на чтение и запись, только на чтение, или не имеет доступа) к ресурсу приложения в базе данных. К ресурсам приложения относятся коллекции, документы, вложения, хранимые процедуры, триггеры и определяемые пользователем функции (UDF). Затем маркер ресурса используется во время аутентификации, чтобы предоставить или запретить доступ к ресурсу.<br><br>Дополнительные сведения см. в статье о [защите доступа к ресурсам Azure Cosmos DB](secure-access-to-data.md).|
|Интеграция с Active Directory (RBAC)| Вы также можете предоставить доступ к учетной записи базы данных с помощью управления доступом (IAM) на портале Azure, как показано на снимке экрана после этой таблицы. IAM обеспечивает управление доступом на основе ролей и интегрируется с Active Directory. Вы можете использовать встроенные или пользовательские роли для отдельных пользователей и групп, как показано на следующем рисунке.|
|Глобальная репликация|Azure Cosmos DB предлагает готовое к использованию глобальное распространение, что позволяет реплицировать данные в любой из центров обработки данных Azure по всему миру одним щелчком. Глобальная репликация позволяет осуществлять глобальное масштабирование, обеспечивая низкую задержку при обращении к данным по всему миру.<br><br>В контексте безопасности глобальная репликация обеспечивает защиту данных от региональных сбоев.<br><br>Дополнительные сведения см. в статье [DocumentDB — глобально распределенная служба базы данных в Azure](distribute-data-globally.md).|
|Отработка отказа между регионами|Если вы реплицировали данные в нескольких центрах обработки данных, то Azure Cosmos DB автоматически переключит операции на другой центр, как только будет утрачена связь с региональным центром обработки данных. Вы можете создать список расположенных по приоритетам регионов отработки отказа, используя регионы, в которых реплицируются ваши данные. <br><br>Дополнительные сведения см. в статье об [отработке отказа между регионами в Azure Cosmos DB](regional-failover.md).|
|Локальная репликация|Даже в пределах одного центра обработки данных Azure Cosmos DB автоматически реплицирует данные для обеспечения высокой доступности, предоставляя выбор [уровней согласованности](consistency-levels.md). Таким образом гарантируется [доступность на уровне 99,99 %](https://azure.microsoft.com/support/legal/sla/cosmos-db) в соответствии с соглашением об уровне обслуживания для всех учетных записей в пределах одного и нескольких регионов с нестрогой согласованностью и доступность для чтения на уровне 99,999 % для всех учетных записей базы данных в пределах нескольких регионов.|
|Автоматическая оперативная архивация|Базы данных Azure Cosmos DB регулярно архивируются и хранятся в геоизбыточном хранилище. <br><br>Дополнительные сведения см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](online-backup-and-restore.md).|
|Восстановление удаленных данных|Автоматическая оперативная архивация может использоваться для восстановления данных, которые были случайно удалены. Это можно сделать максимум через 30 дней после события. <br><br>Дополнительные сведения см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](online-backup-and-restore.md).|
|Защита и изолирование конфиденциальных данных|Ко всем данным, перечисленным в разделе [Новые возможности](#whats-new), теперь применяется шифрование неактивных данных.<br><br>Личные сведения и другие конфиденциальные данные можно изолировать в определенных коллекциях, а доступ для чтения и записи или только для чтения можно ограничить определенным списком пользователей.|
|Мониторинг атак|С помощью [ведения журнала аудита и журналов действий](logging.md) можно отслеживать учетную запись на наличие аномальной активности. Вы можете просматривать, какие операции выполнялись с ресурсами, кто инициировал эти операции, время их выполнения, состояние операций и многое другое, как показано на снимке экрана после этой таблицы.|
|Реагирование на атаки|Когда вы обращаетесь в службу поддержки Azure и сообщаете о возможной атаке, запускается 5-этапная процедура реагирования на инцидент. Целью этой 5-этапной процедуры является как можно быстрее восстановить нормальную защиту и функционирование службы. Выполняется обнаружение проблемы и расследование инцидента.<br><br>Дополнительные сведения см. в статье [Microsoft Azure Security Response in the Cloud](https://aka.ms/securityresponsepaper) (Реагирование на нарушения безопасности в облаке Microsoft Azure).|
|Установка геозон|Azure Cosmos DB обеспечивает управление данными и соответствие требованиям для отдельных регионов (например, Германия, Китай или US Gov).|
|Защищенное оборудование|Данные в Azure Cosmos DB хранятся на твердотельных накопителях SSD в защищенных центрах обработки данных Azure.<br><br>Дополнительные сведения о глобальных центрах обработки данных корпорации Майкрософт см. на [этой странице](https://www.microsoft.com/en-us/cloud-platform/global-datacenters).|
|Шифрование HTTPS, SSL и TLS|Все взаимодействия между клиентом и службой в Azure Cosmos DB принудительно осуществляются по протоколу SSL/TLS 1.2. Кроме того, любая репликация внутри центра обработки данных или между центрами также выполняется по протоколу SSL/TLS 1.2.|
|Шифрование при хранении|Все данные, хранимые в Azure Cosmos DB, хранятся в зашифрованном виде. Дополнительные сведения см. в статье [Шифрование неактивных данных базы данных в Azure Cosmos DB](.\database-encryption-at-rest.md).|
|Установка исправлений на серверы|Являясь управляемой базой данных, Azure Cosmos DB избавляет от необходимости управлять серверами и устанавливать на них исправления. Это делается автоматически.|
|Административные учетные записи с надежными паролями|Пожалуй, даже не нужно упоминать об этом требовании, но, в отличие от некоторых наших конкурентов, в Azure Cosmos DB не может быть учетной записи администратора без пароля.<br><br> Для обеспечения безопасности в службу по умолчанию интегрированы функции SSL и аутентификации на основе секрета HMAC.|
|Сертификаты безопасности и защиты данных|Служба Azure Cosmos DB сертифицирована в соответствии со стандартами [ISO 27001](https://www.microsoft.com/en-us/TrustCenter/Compliance/ISO-IEC-27001), [EUMC (European Model Clauses)](https://www.microsoft.com/en-us/TrustCenter/Compliance/EU-Model-Clauses) и [HIPAA](https://www.microsoft.com/en-us/TrustCenter/Compliance/HIPAA). Дополнительные сертификаты находятся в стадии получения.|

На следующем снимке экрана показана интеграция Active Directory (RBAC) с помощью управления доступом (IAM) на портале Azure: ![управления доступом (IAM) на портале Azure, демонстрация безопасности базы данных](./media/database-security/nosql-database-security-identity-access-management-iam-rbac.png)

На следующем снимке экрана показано, как можно выполнять мониторинг учетной записи с помощью журналов аудита и действий: ![журналы действий для Azure Cosmos DB](./media/database-security/nosql-database-security-application-logging.png)

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о главных ключах и маркерах ресурсов см. в статье о [защите доступа к ресурсам Azure Cosmos DB](secure-access-to-data.md).

Дополнительные сведения о ведении журнала аудита см. в разделе [Ведение журнала диагностики Azure Cosmos DB](logging.md).

Дополнительные сведения о сертификатах Майкрософт см. в [центре управления безопасностью Azure](https://azure.microsoft.com/support/trust-center/).
