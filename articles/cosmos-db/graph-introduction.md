---
title: "Знакомство с API-интерфейсами Graph базы данных Azure Cosmos DB | Документация Майкрософт"
description: "Узнайте, как можно использовать базу данных Azure Cosmos DB, чтобы хранить, запрашивать и передавать массивные графы с минимальной задержкой с помощью языка запросов графа Gremlin в Apache TinkerPop."
services: cosmos-db
author: arramac
documentationcenter: 
ms.assetid: b916644c-4f28-4964-95fe-681faa6d6e08
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 05/21/2017
ms.author: arramac
ms.translationtype: Human Translation
ms.sourcegitcommit: db18dd24a1d10a836d07c3ab1925a8e59371051f
ms.openlocfilehash: 4ee52c2665d5856cb0022365edf0485458b629fe
ms.contentlocale: ru-ru
ms.lasthandoff: 06/15/2017


---
# <a name="introduction-to-azure-cosmos-db-graph-api"></a>Знакомство с базой данных Azure Cosmos DB. API Graph

[Azure Cosmos DB](introduction.md) — это глобально распределенная, многомодельная служба базы данных Майкрософт, необходимая для работы с критически важными приложениями. Эта служба базы данных обеспечивает [готовое к использованию глобальное распределение](distribute-data-globally.md), [гибкое масштабирование пропускной способности и хранилища](partition-data.md) по всему миру, задержки менее 10 миллисекунд на уровне 99-го процентиля, [пять четко определенных уровней согласованности](consistency-levels.md), а также гарантированную высокую доступность — все это согласно [ведущим в отрасли соглашениям об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/cosmos-db/). Azure Cosmos DB [автоматически индексирует данные](http://www.vldb.org/pvldb/vol8/p1668-shukla.pdf) без необходимости управлять схемой и индексом. Так как эта база данных является многомодельной, она поддерживает модели данных документа, "ключ — значение", графа и столбчатые модели данных.

![База данных Azure Cosmos DB, граф и Gremlin](./media/graph-introduction/graph-gremlin.png)

API Graph для базы данных Azure Cosmos DB предоставляет:

- Моделирование графов.
- Обходные API-интерфейсы.
- Готовое к использованию глобальное распределение.
- Эластичное масштабирование хранилища и пропускной способности с задержкой операций чтения менее 10 мс и операций записи менее 15 мс на уровне 99-го процентиля.
- Автоматическое индексирование с мгновенной доступностью запросов.
- Настраиваемые уровни согласованности.
- Комплексное соглашение об уровне обслуживания, включая доступность на уровне 99,99 %.

Для создания запроса к Azure Cosmos DB можно использовать язык обхода графа [Apache TinkerPop](http://tinkerpop.apache.org), [Gremlin](http://tinkerpop.apache.org/docs/current/reference/#graph-traversal-steps) или другие совместимые с TinkerPop системы графов, такие как [Apache Spark GraphX](spark-connector-graph.md).

В этой статье содержатся сведения об API Graph для Azure DB Cosmos и объясняется, как его использовать для хранения больших графов с миллиардами вершин и ребер. Вы также узнаете о выполнении запросов с миллисекундными задержками и простой разработке структуры и схемы графа.

## <a name="graph-database"></a>Базы данных графов
В реальном мире все данные связаны естественным образом. Традиционное моделирование данных ориентировано на сущности. Для многих приложений необходимо моделировать сущности и взаимосвязи между ними.

[Граф](http://mathworld.wolfram.com/Graph.html) — это структура, состоящая из [вершин](http://mathworld.wolfram.com/GraphVertex.html) и [ребер](http://mathworld.wolfram.com/GraphEdge.html). Вершины и ребра могут содержать произвольное число свойств. Вершины обозначают дискретные объекты, например пользователя, место или событие. Ребра указывают взаимосвязи между вершинами. Например, пользователь может знать другого пользователя, участвовать в событии или посетить мероприятие. Свойства выражают сведения о вершинах и ребрах. Примеры свойств вершины — имя и возраст, а ребра — метка времени или вес. Более формально эта модель называется [графом свойства](http://tinkerpop.apache.org/docs/current/reference/#intro). База данных Azure Cosmos DB поддерживает модель графа свойства.

Например, ниже представлен пример графа, в котором показаны взаимосвязи между людьми, их интересами, мобильными устройствами и операционными системами.

![Пример базы данных, в котором показаны люди, их интересы и устройства](./media/graph-introduction/sample-graph.png)

Графы удобны для понимания множества наборов данных в науке, технологиях и бизнесе. Наборы данных графа позволяют эффективно моделировать и хранить графы естественным образом, благодаря чему их можно применить для различных сценариев. Базы данных графа обычно представляют собой базы данных NoSQL, так как для использования последних часто требуются быстрая итерация и гибкость схемы.

Графы предлагают новаторскую эффективную технологию моделирования данных. Эту технологию саму по себе нельзя назвать весомой причиной для использования базы данных графа. Для многих шаблонов и случаев использования, которые включают обходы графа, графы более эффективны (на несколько порядков), чем традиционные базы данных SQL и NoSQL. При передаче более одной связи, такой как связь "друг 1-го друга", эта разница в производительности в дальнейшем усиливается.

Вы можете объединить быстрые обходы, обеспечиваемые базами данных графа, с такими его алгоритмами, как первый поиск глубины и ширины, алгоритм Дейкстры и т. д., чтобы решить проблемы в различных областях, например социальные сети, управление содержимым, рекомендации.

## <a name="planet-scale-graphs-with-azure-cosmos-db"></a>Глобальные графы и база данных Azure Cosmos DB
База данных Azure Cosmos DB является полностью управляемой базой данных графа, которая обеспечивает глобальное распределение, гибкое масштабирование хранилища и пропускной способности, автоматическое индексирование и возможность выполнять запросы, настраиваемые уровни согласованности, а также поддержку стандартной платформы вычисления графа TinkerPop.  

![Архитектура графа базы данных Azure Cosmos DB](./media/graph-introduction/cosmosdb-graph-architecture.png)

База данных Azure Cosmos DB предлагает следующие отличительные возможности по сравнению с другими базами данных графа, представленными на рынке:

* Гибко масштабируемая пропускная способность и хранилище

 На практике графы должны масштабироваться за пределы емкости одного сервера. С базой данных Azure Cosmos DB вы можете быстро и эффективно масштабировать графы на нескольких серверах. Вы также можете масштабировать пропускную способность графа на основе шаблонов доступа. База данных Azure Cosmos DB поддерживает базы данных графа, которые можно масштабировать, достигая практически неограниченных размеров хранилища и подготовленной пропускной способности.

* Репликация между несколькими регионами

 База данных Azure Cosmos DB прозрачно реплицирует данные графа во все регионы, связанные с вашей учетной записью. Репликация позволяет разрабатывать приложения, которым требуется глобальный доступ к данным. При этом нужно идти на компромиссы, выбирая между согласованностью, доступностью и производительностью, с соответствующими гарантиями. Azure Cosmos DB обеспечивает прозрачную отработку отказа между регионами с помощью API-интерфейсов с поддержкой множественной адресации. Вы сможете гибко масштабировать пропускную способность и размер хранилища по всему миру.

* Быстрое выполнение запросов и обходов с помощью знакомого синтаксиса Gremlin

 Храните разные типы вершин и ребер, а также выполняйте запросы этих документов через знакомый синтаксис Gremlin. База данных Azure Cosmos DB использует безблокировочную технологию индексирования с высокой степенью параллелизма и структурированием журналов для автоматического индексирования всего содержимого. Это дает возможность формировать многофункциональные запросы и обходы в режиме реального времени без необходимости указывать подсказки для схемы, вторичные индексы или представления. Дополнительные сведения см. в руководстве о [поддержке графа для языка Gremlin в базе данных Cosmos Azure](gremlin-support.md).

* Полная управляемость

 Azure Cosmos DB устраняет необходимость управления базой данных и вычислительными ресурсами. В полностью управляемой службе Microsoft Azure вам не нужно заниматься управлением виртуальными машинами, развертыванием и настройкой программного обеспечения или масштабированием или иметь дело со сложными обновлениями на уровне данных. Каждый граф автоматически сохраняется и защищается от региональных сбоев. Вы можете легко добавлять учетные записи Azure Cosmos DB и подготавливать требуемую емкость по мере необходимости, позволяя сосредоточиться на приложении, а не на вопросах эксплуатации и управления базой данных.

* Автоматическая индексация

 По умолчанию база данных Azure Cosmos DB автоматически индексирует все свойства в узлах и ребрах в графе, не ожидая и не требуя наличия какой-либо схемы или создания дополнительных индексов.

* Совместимость с Apache TinkerPop

 База данных Azure Cosmos DB изначально поддерживает стандартный язык TinkerPop с открытым кодом, а также может интегрироваться с другими системами графа, совместимыми с этим языком. Таким образом, вы можете легко перемещаться из другой базы данных графа, например Titan или Neo4j, или же использовать базу данных Azure Cosmos DB с платформами аналитики графа, такими как [Apache Spark GraphX](spark-connector-graph.md).

* Настраиваемые уровни согласованности.

 Вам доступны на выбор пять четко определенных уровней согласованности для достижения оптимального соотношения между согласованностью и производительностью. Для запросов и операций чтения служба Azure Cosmos DB предлагает пять отдельных уровней согласованности — сильный, с ограниченным устареванием, сеансовый, с согласованностью префиксов и согласованный в конечном счете. Эти разделенные, четко определенные уровни согласованности позволяют принимать обоснованные компромиссы между показателями согласованности, доступности и задержки. Дополнительные сведения см. в статье [Уровни согласованности в DocumentDB](consistency-levels.md).

База данных Azure Cosmos DB также позволяет использовать несколько моделей, например документа и графа, в тех же контейнерах или базах данных. Вы можете использовать коллекцию документов, чтобы хранить данные графа параллельно с ними. Кроме того, можно использовать SQL-запросы для JSON и запросы Gremlin для выполнения тех же запросов, что и для графа.

## <a name="getting-started"></a>Приступая к работе
Учетные записи базы данных Azure Cosmos DB можно создать с помощью Azure CLI, Azure Powershell или же портала Azure с поддержкой API Graph. После создания учетных записей портал Azure предоставляет конечную точку службы, например `https://<youraccount>.graphs.azure.com`, предоставляющую внешний интерфейс WebSocket для языка Gremlin. Вы можете настроить средства, совместимые с TinkerPop, например [консоль Gremin](http://tinkerpop.apache.org/docs/current/reference/#gremlin-console), чтобы подключиться к этой конечной точке, а также создать приложения на Java, Node.js или любом другом клиентском драйвере Gremlin.

В таблице ниже приведены распространенные драйверы Gremlin, которые вы можете использовать для базы данных Azure Cosmos DB.

| Загрузить | Документация |
| --- | --- |
| [Java](https://mvnrepository.com/artifact/com.tinkerpop.gremlin/gremlin-java) |[Документация по Gremlin для Java](http://tinkerpop.apache.org/javadocs/current/full/) |
| [Node.js](https://www.npmjs.com/package/gremlin) |[Gremlin для JavaScript в Github](https://github.com/jbmusso/gremlin-javascript) |
| [Консоль Gremlin](https://tinkerpop.apache.org/downloads.html) |[Документация по TinkerPop](http://tinkerpop.apache.org/docs/current/reference/#gremlin-console) |

База данных Azure Cosmos DB также предоставляет библиотеку .NET с методами расширения Gremlin на основе [пакетов SDK базы данных Azure Cosmos DB](documentdb-sdk-dotnet.md) через NuGet. Эта библиотека обеспечивает "внутрипроцессный" сервер Gremlin, который может использоваться для подключения напрямую к секциям данных DocumenDB.

| Загрузить | Документация |
| --- | --- |
| [.NET](https://www.nuget.org/packages/Microsoft.Azure.Graphs/) |[Microsoft.Azure.Graphs](https://msdn.microsoft.com/library/azure/dn948556.aspx) |

С помощью [эмулятора базы данных Azure Cosmos DB](local-emulator.md) вы можете выполнять разработку и тестирование локально с помощью API Graph, не создавая подписку Azure и без каких-либо затрат. Если приложение в эмуляторе работает правильно, вы можете использовать учетную запись базы данных Azure Cosmos DB в облаке.

## <a name="scenarios-for-graph-support-of-azure-cosmos-db"></a>Сценарии для поддержки Graph базы данных Azure Cosmos DB
Ниже приведены некоторые примеры использования поддержки графа базы данных Azure Cosmos DB:

* Социальные сети

 Объединяя данные о клиентах и их взаимодействиях с другими людьми, вы можете разработать персонализированные средства, предугадать поведение клиента или объединить людей на основе их интересов. Базу данных Azure Cosmos DB можно использовать для управления социальными сетями и отслеживания данных о клиенте и его предпочтениях.

* Системы рекомендаций

 Широко используется в сфере розничной торговли. Объединяя сведения о продукции, пользователях и операциях пользователей, например приобретении, поиске и оценке товара, вы можете создать пользовательские рекомендации. База данных Azure Cosmos DB с минимальной задержкой, гибким масштабированием и встроенной поддержкой графа представляет собой идеальный вариант моделирования этих взаимосвязей.

* Геопространственные данные

 Многим приложениям в сферах телекоммуникаций, логистики и туристического планирования требуется поиск интересующего расположения в регионе или же обнаружение самого короткого (оптимального) пути между двумя расположениями. База данных Azure Cosmos DB поможет легко справиться с этими задачами.

* Интернет вещей

 С помощью сети и подключений между устройствами Интернета вещей, смоделированных как граф, вы можете лучше разобраться с состоянием и ресурсами, а также узнать, как изменения в одной части сети могут повлиять на другую часть.

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о поддержке графа в базе данных Azure Cosmos DB см. в следующих ресурсах:

* [Azure Cosmos DB. Создание приложения .NET с помощью API Graph](create-graph-dotnet.md)
* [Поддержка графа Gremlin в базе данных Azure Cosmos DB](gremlin-support.md)

