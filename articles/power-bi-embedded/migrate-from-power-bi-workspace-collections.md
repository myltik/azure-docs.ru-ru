---
title: Перенос содержимого коллекции рабочих областей Power BI в Power BI Embedded | Документация Майкрософт
description: Сведения о переносе из коллекций рабочих областей Power BI в Power BI Embedded и использовании возможностей внедрения в приложения.
services: power-bi-embedded
documentationcenter: ''
author: markingmyname
manager: kfile
editor: ''
tags: ''
ms.service: power-bi-embedded
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 09/28/2017
ms.author: maghan
ms.openlocfilehash: d138b0c26ffc0a44947f79811fd586dda7df4509
ms.sourcegitcommit: 9cdd83256b82e664bd36991d78f87ea1e56827cd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
ms.locfileid: "31419103"
---
# <a name="how-to-migrate-power-bi-workspace-collection-content-to-power-bi-embedded"></a>Перенос содержимого коллекции рабочих областей Power BI в Power BI Embedded

Узнайте, как перенести содержимое коллекций рабочих областей Power BI в Power BI Embedded. В этой статье приводятся инструкции по переносу из коллекций рабочих областей Azure Power BI в Power BI Embedded. Мы также рассмотрим ожидаемые изменения приложений.

Ресурсы коллекций рабочих областей Power BI по-прежнему доступны в течение ограниченного периода времени после выпуска общедоступной версии Power BI Premium. Клиенты в рамках соглашения Enterprise имеют доступ к существующим коллекциям рабочих областей до истечения срока действия их имеющихся соглашений. Клиентам, которые приобрели коллекции рабочих областей Power BI через каналы Direct или CSP, предоставляется доступ на один год из общедоступной версии Power BI Premium.

> [!IMPORTANT]
> Тогда как перенос зависит от службы Power BI, пользователи вашего приложения, которые используют **маркер внедрения**, не зависят от Power BI. Им не нужно регистрироваться в Power BI для просмотра внедренного содержимого в вашем приложении. Этот подход с внедрением Power BI можно использовать для ваших клиентов.

![Поток Power BI Embedded](media/migrate-from-power-bi-workspace-collections/powerbi-embed-flow.png)

## <a name="prepare-for-the-migration"></a>Подготовка к переносу

Для подготовки к переносу из службы коллекций рабочих областей Power BI в Power BI Embedded необходимо сделать несколько вещей. Вам понадобится доступный клиент, а также пользователь с лицензией на Power BI Pro.

1. Убедитесь в наличии доступа к клиенту Azure Active Directory (Azure AD).

    Какой клиент использовать?

    * Использовать имеющийся корпоративный клиент Power BI?
    * Использовать отдельный клиент для приложения?
    * Использовать отдельный клиент для каждого пользователя?

    Если вы решили создать клиент для своего приложения или каждого пользователя, см. одну из следующих статей:

    * [Создание клиента Azure Active Directory для использования с Power BI](https://powerbi.microsoft.com/documentation/powerbi-developer-create-an-azure-active-directory-tenant/)
    * [Как получить клиент Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-howto-tenant)

2. Создайте пользователя в этом новом клиенте, который выполняет роль "главной" учетной записи приложения. Эту учетную запись необходимо зарегистрировать в службе Power BI, а также нужно назначить ей лицензию на Power BI Pro.

## <a name="accounts-within-azure-ad"></a>Учетные записи в Azure AD

В вашем клиенте должны быть следующие учетные записи.

> [!NOTE]
> В этих учетных записях должны быть лицензии на Power BI Pro для использования рабочих областей приложения.

1. Администратор клиента.

    Мы рекомендуем, чтобы во внедренной рабочей области приложения учетная запись администратора клиента была указана в качестве участника.

2. Учетные записи для специалистов по анализу, которые создают содержимое.

    Эти пользователи должны быть назначены рабочим областям приложения при необходимости.

3. *Главная* учетная запись пользователя приложения или учетная запись службы.

    В серверной части приложений хранятся учетные данные для этой учетной записи. Используйте *главную* учетную запись, чтобы получить маркер Azure AD для использования с REST API Power BI. Эта учетная запись используется для создания маркера внедрения для приложения. *Главная* учетная запись должна иметь права администратора рабочих областей приложения, созданных для внедрения.

    **Это обычная учетная запись пользователя в вашей организации, используемая для внедрения.**

## <a name="app-registration-and-permissions"></a>Регистрация приложения и разрешения

Для вызовов REST API зарегистрируйте приложение в Azure AD. В дополнение к странице регистрации приложения Power BI на портале Microsoft Azure применяется дополнительная конфигурация. Дополнительные сведения см. в статье [Регистрация приложения Azure AD для внедрения содержимого Power BI](https://powerbi.microsoft.com/documentation/powerbi-developer-register-app/).

Мы советуем зарегистрировать приложение, используя **главную** учетную запись приложения.

## <a name="create-app-workspaces-required"></a>Создание рабочих областей приложения (обязательно)

Если приложение обслуживает несколько клиентов, можно воспользоваться преимуществами рабочих областей приложения, чтобы обеспечить лучшую изоляцию. Панели мониторинга и отчеты будут изолированы от пользователей. Можно также использовать учетную запись Power BI в каждой рабочей области приложения, чтобы еще больше изолировать работу с приложением между пользователями, но чтобы упростить этот процесс, можно использовать всего одну учетную запись.

> [!IMPORTANT]
> Вы не можете выполнять внедрение для ваших клиентов, используя личную рабочую область ("Моя рабочая область").

Для создания рабочей области приложения в Power BI понадобится пользователь с лицензией на Power BI Pro. Пользователь Power BI, который создает рабочую область приложения, имеет права администратора этой рабочей области по умолчанию. ***Главная* учетная запись приложения должна иметь права администратора в рабочей области.**

## <a name="content-migration"></a>Перенос содержимого

Перенос содержимого из коллекций рабочих областей в Power BI Embedded может выполняться параллельно с работой вашего текущего решения и не вызывает простоев.

**Средство миграции** можно использовать, чтобы упростить копирование содержимого из коллекций рабочих областей Power BI в Power BI Embedded. Это особенно актуально при наличии большого количества отчетов. Дополнительные сведения см. в разделе [Использование средства миграции Power BI Embedded](migrate-tool.md).

Перенос содержимого в основном зависит от двух API.

1. API загрузки PBIX. Этот API может загружать PBIX-файлы, которые были переданы в Power BI после октября 2016 г.
2. API импорта PBIX. Этот API передает любой PBIX-файл в Power BI.

Некоторые связанные фрагменты кода приведены в статье [Фрагменты кода для переноса содержимого из коллекций рабочих областей Power BI](migrate-code-snippets.md).

### <a name="report-types"></a>Типы отчетов

Есть несколько типов отчетов, каждому из которых требуется различный поток переноса.

#### <a name="cached-dataset-and-report"></a>Кэшированный набор данных и отчет

Кэшированные наборы данных ссылаются на PBIX-файлы, которые импортировали данные, в отличие от активного подключения или подключения DirectQuery.

**Поток**

1. Вызовите API загрузки PBIX-файлов в рабочей области коллекции рабочих областей Power BI.
2. Сохраните PBIX-файл.
3. Вызовите API импорта PBIX-файлов для рабочей области Power BI Embedded.

#### <a name="directquery-dataset-and-report"></a>Набор данных и отчет DirectQuery

**Поток**

1. Вызовите GET https://api.powerbi.com/v1.0/collections/{collection_id}/workspaces/{wid}/datasets/{dataset_id}/Default.GetBoundGatewayDataSources и сохраните полученную строку подключения.
2. Вызовите API загрузки PBIX-файлов в рабочей области коллекции рабочих областей Power BI.
3. Сохраните PBIX-файл.
4. Вызовите API импорта PBIX-файлов для рабочей области Power BI Embedded.
5. Обновите строку подключения, вызвав POST https://api.powerbi.com/v1.0/myorg/datasets/{dataset_id}/Default.SetAllConnections.
6. Получите идентификатор шлюза и источника данных, вызвав GET https://api.powerbi.com/v1.0/myorg/datasets/{dataset_id}/Default.GetBoundGatewayDataSources.
7. Обновите учетные данные пользователя, вызвав PATCH https://api.powerbi.com/v1.0/myorg/gateways/{gateway_id}/datasources/{datasource_id}.

#### <a name="old-dataset-and-reports"></a>Старые наборы данных и отчеты

Отчеты, загруженные до октября 2016 г., не поддерживают возможность загрузки PBIX-файлов.

**Поток**

1. Получите PBIX-файлы из среды разработки (внутренняя система управления версиями).
2. Вызовите API импорта PBIX-файлов для рабочей области Power BI Embedded.

#### <a name="push-dataset-and-report"></a>Отправка набора данных и отчета

Загрузка PBIX-файлов не поддерживает наборы данных *API push-уведомлений*. Данные набора данных API push-уведомлений невозможно перенести из коллекций рабочих областей Power BI в Power BI Embedded.

**Поток**

1. Вызовите API "Создать набор данных" с помощью JSON набора данных, чтобы создать набор данных для рабочей области Power BI Embedded.
2. Перестройте отчет для созданного набора данных*.

Чтобы перенести отчет API push-уведомлений из коллекций рабочих областей Power BI в Power BI Embedded, можно использовать некоторые обходные пути, а именно:

1. Отправьте некоторые фиктивные PBIX-файлы в рабочую область коллекции рабочих областей Power BI.
2. Клонируйте отчет API push-уведомлений и привяжите его к фиктивному PBIX-файлу из шага 1.
3. Загрузите отчет API push-уведомлений с фиктивным PBIX-файлом.
4. Отправьте фиктивный PBIX-файл в рабочую область Power BI Embedded.
5. Создайте набор данных Push API в рабочей области Power BI Embedded.
6. Повторно привяжите отчет к набору данных API push-уведомлений.

## <a name="create-and-upload-new-reports"></a>Создание и отправка новых отчетов

В дополнение к содержимому, которое можно перенести из коллекций рабочих областей Power BI, вы можете создавать отчеты и наборы данных с помощью Power BI Desktop, а затем публиковать их в рабочей области приложения. Конечный пользователь, публикующий отчеты, должен иметь лицензию на Power BI Pro для публикации в рабочей области приложения.

## <a name="rebuild-your-application"></a>Перестройка приложения

1. Измените приложение, чтобы использовать REST API Power BI, и расположение отчета на сайте powerbi.com.

2. Перестройте проверку подлинности AuthN/AuthZ, используя *главную* учетную запись для приложения. Вы можете воспользоваться преимуществами [маркера внедрения](https://msdn.microsoft.com/library/mt784614.aspx), чтобы разрешить этому пользователю действовать от имени других пользователей.

3. Внедрите отчеты из Power BI Embedded в свое приложение. Дополнительные сведения см. в статье [Внедрение панелей мониторинга, отчетов и плиток Power BI](https://powerbi.microsoft.com/documentation/powerbi-developer-embedding-content/).

## <a name="map-your-users-to-a-power-bi-user"></a>Сопоставление пользователей с пользователем Power BI

В вашем приложении вы можете сопоставлять пользователей, которыми вы управляете в приложении, с учетными данными *главной* учетной записи Power BI для приложения. Учетные данные для этой *главной* учетной записи Power BI хранятся в приложении и могут использоваться для создания маркеров внедрения.

## <a name="what-to-do-when-you-are-ready-for-production"></a>Действия при готовности к рабочей среде

Когда будете готовы к переносу в рабочую среду, необходимо сделать следующее:

- Если вы используете отдельный клиент для разработки, необходимо убедиться в том, что рабочие области приложения, а также панели мониторинга и отчеты доступны в рабочей среде. Для этого необходимо создать приложение в Azure AD для рабочего клиента и назначить соответствующие разрешения приложения, как указано на шаге 1.

- Приобретите емкость, которая соответствует вашим требованиям. Вы можете воспользоваться [техническим документом по планированию емкости внедренной аналитики](https://aka.ms/pbiewhitepaper), чтобы узнать, что может потребоваться. Когда будете готовы к покупке, ресурс Power BI Embedded можно приобрести на портале Azure.

- Измените рабочую область приложения и назначьте ей емкость в разделе "Дополнительно".

    ![Назначение рабочей области приложения емкости на сайте powerbi.com](media/migrate-from-power-bi-workspace-collections/embedded-capacity.png)

- Разверните обновленное приложение в рабочей среде и приступите к внедрению отчетов из Power BI Embedded.

## <a name="after-migration"></a>После переноса

В коллекциях рабочих областей Power BI понадобится удалить некоторые файлы.

- Удалите все рабочие области за пределами развернутого решения в службе Azure коллекций рабочих областей Power BI.
- Удалите все коллекции рабочих областей в Azure.

## <a name="next-steps"></a>Дополнительная информация

Поздравляем! Теперь приложение перенесено в Power BI Embedded. Сведения о том, как внедрить панели мониторинга, отчеты и наборы данных Power BI, см. в статье [Внедрение панелей мониторинга, отчетов и плиток Power BI](https://powerbi.microsoft.com/documentation/powerbi-developer-embedding-content/).

У вас имеются и другие вопросы? [Задайте их в сообществе Power BI](http://community.powerbi.com/).