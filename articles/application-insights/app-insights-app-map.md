---
title: Схема сопоставления приложений в Azure Application Insights | Документация Майкрософт
description: Мониторинг топологий сложных приложений с помощью схемы приложения
services: application-insights
documentationcenter: ''
author: mrbullwinkle
manager: carmonm
ms.assetid: 3bf37fe9-70d7-4229-98d6-4f624d256c36
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: conceptual
ms.date: 03/14/2017
ms.reviewer: Soubhagya.Dash
ms.author: mbullwin
ms.openlocfilehash: 539becf272194a116355c6a0491042d40e1e7494
ms.sourcegitcommit: 6f6d073930203ec977f5c283358a19a2f39872af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35293968"
---
# <a name="application-map-triage-distributed-applications"></a>Схема приложений: рассмотрение распределенных приложений
Схема приложений позволяет выявлять сбои и проблемы с производительностью во всех компонентах распределенного приложения. Каждый узел на схеме представляет компонент приложения или его зависимости с такими данными, отображая КПЭ работоспособности и состояние оповещений. Вы можете щелкнуть любой компонент, чтобы получить более подробные диагностические данные (например, события Application Insights). Если приложение использует службы Azure, то можно также выбрать данные системы диагностики Azure, например рекомендации Помощника по базам данных SQL.

## <a name="what-is-a-component"></a>Что такое компонент?

Компоненты — это независимо развертываемые части распределенного приложения или приложения для микрослужб. Разработчики и операционные команды могут просматривать данные телеметрии, созданные компонентами приложения, на уровне кода. 

* Компоненты отличаются от наблюдаемых внешних зависимостей, таких как база данных SQL или концентратор событий, к которым команды или организации могут не иметь доступа (код или данные телеметрии).
* Компоненты выполняются на любом количестве экземпляров серверов, ролей или контейнеров.
* К компонентам могут относиться отдельные ключи инструментирования Application Insights (даже из разных подписок) или разные роли, относящиеся к одному такому ключу. В предварительной версии схемы компоненты отображаются, независимо от того, как они настроены.

## <a name="composite-application-map-preview"></a>Схема составных приложений (предварительная версия)
*Это ранняя предварительная версия. Мы добавим больше возможностей в эту схему. Мы будем рады получить ваши отзывы о новом интерфейсе. Вы можете легко переключаться с интерфейса предварительной версии на классический интерфейс.*

Включите компонент "Схема сопоставления составных приложений" в [списке предварительных версий](app-insights-previews.md) или щелкните переключатель "Предварительная версия схемы сопоставления" в правом верхнем углу. Вы можете использовать этот переключатель, чтобы вернуться в классический интерфейс.
![Включение схемы в режиме предварительной версии](media/app-insights-app-map/preview-from-classic.png)

>[!Note]
Эта предварительная версия заменяет предыдущую предварительную версию компонента "Схема приложений с несколькими ролями". Сейчас этом компонент используется для просмотра всей топологии на нескольких уровнях зависимостей компонентов приложения. Оставьте свой отзыв. Мы добавим больше возможностей, аналогичных тем, которые поддерживаются в классической схеме.

Вы увидите все данные топологии на нескольких уровнях компонентов, связанных с приложением. Компонентами могут быть различные ресурсы Application Insights или различные роли в одном ресурсе. Схема приложений находит компоненты, отслеживая HTTP-вызовы зависимостей, выполняемые между серверами, на которых установлен пакет SDK для Application Insights. 

В этом интерфейсе сначала осуществляется последовательное обнаружение компонентов. При первой загрузке предварительной версии активируется набор запросов, который позволяет обнаружить компоненты, относящиеся к этому компоненту. Возле кнопки в верхнем левом углу будет обновляться число компонентов приложения по мере их обнаружения. 
![Схема в режиме предварительной версии](media/app-insights-app-map/preview.png)

Если вы нажмете кнопку "Обновить компоненты сопоставления", схема обновится со всеми компонентами, обнаруженными до этого момента.
![Загруженная схема в режиме предварительной версии](media/app-insights-app-map/components-loaded-hierarchical.png)

Если все компоненты представляют собой роли в одном ресурсе Application Insights, этот шаг обнаружения не требуется. При начальной загрузке такого приложения загрузятся и все его компоненты.

Одной из ключевых задач нового интерфейса является возможность визуализировать сложные топологии с сотнями компонентов. В новом интерфейсе поддерживается изменение масштаба и добавление сведений при его увеличении. Вы можете уменьшать масштаб, чтобы сразу увидеть больше компонентов, а также выявлять компоненты с более высокой частотой сбоев. 

![Уровни масштаба](media/app-insights-app-map/zoom-levels.png)

Щелкните любой компонент, чтобы просмотреть соответствующие данные аналитики и перейти к интерфейсу для рассмотрения производительности и сбоев этого компонента.

![Всплывающий элемент](media/app-insights-app-map/preview-flyout.png)


## <a name="classic-application-map"></a>Классическая схема приложений

На схеме показаны:

* Тесты доступности
* компонент на стороне клиента (отслеживаемый с помощью пакета SDK для JavaScript);
* компонент на стороне сервера;
* зависимости клиентских и серверных компонентов.

![Схема сопоставления приложений](./media/app-insights-app-map/02.png)

Можно разворачивать и сворачивать группы ссылок зависимостей:

![Свертывание](./media/app-insights-app-map/03.png)

Если есть большое количество однотипных зависимостей (например, SQL, HTTP и пр.), они могут группироваться. 

![Сгруппированные зависимости](./media/app-insights-app-map/03-2.png)

## <a name="spot-problems"></a>Выявление проблем
Каждый узел имеет соответствующие показатели эффективности, например нагрузки, производительности и частоты сбоев для определенного компонента. 

Предупреждающие значки указывают на возможные проблемы. Оранжевое предупреждение означает сбои в запросах, представлении страниц или вызовах зависимостей. Красное предупреждение указывает на риск сбоя с вероятностью более 5 %. Откройте "Параметры", чтобы изменить эти пороговые значения.

![Значки, указывающие на сбои](./media/app-insights-app-map/04.png)

Тут же отображаются активные оповещения: 

![Активные оповещения](./media/app-insights-app-map/05.png)

При использовании SQL Azure вы увидите соответствующий значок, информирующий о наличии рекомендаций по улучшению производительности. 

![Рекомендации Azure](./media/app-insights-app-map/06.png)

Щелкните любой значок, чтобы просмотреть подробные данные:

![Рекомендации Azure](./media/app-insights-app-map/07.png)

## <a name="diagnostic-click-through"></a>Просмотр данных диагностики
Каждый из узлов на схеме позволяет просматривать определенные данные диагностики. Параметры различаются в зависимости от типа узла.

![Параметры сервера](./media/app-insights-app-map/09.png)

Для компонентов, которые размещаются в Azure, доступны прямые ссылки.

## <a name="filters-and-time-range"></a>Фильтры и диапазон времени
По умолчанию на схеме представлены все данные, доступные для выбранного диапазона времени. Однако можно отфильтровать только имена конкретных операций или зависимостей.

* Имя операции: сюда входят запросы просмотров страниц и запросы сервера. Этот параметр позволяет отобразить на схеме ключевые показатели эффективности на узле сервера или клиента только для отдельных операций. Будут показаны зависимости, вызванные в контексте этих конкретных операций.
* Базовое имя зависимости: сюда входят зависимости обозревателя AJAX и сервера. Если вы включите в отчет данные телеметрии настраиваемых зависимостей с помощью API TrackDependency, они также будут показаны здесь. Можно выбирать зависимости, которые будут отображены на схеме. Обратите внимание, что сейчас запросы на стороне сервера или просмотры страниц на стороне клиента не фильтруются.

![Настройка фильтров](./media/app-insights-app-map/11.png)

## <a name="save-filters"></a>Сохранение фильтров
Чтобы сохранить примененные фильтры, закрепите отфильтрованный вид на [панели мониторинга](app-insights-dashboards.md).

![Закрепить на панели мониторинга](./media/app-insights-app-map/12.png)

## <a name="error-pane"></a>Область ошибок
Если щелкнуть узел в схеме, справа отобразится область ошибок, содержащая краткую информацию о сбоях этого узла. Сбои группируются сначала по идентификатору операции, затем — по идентификатору проблемы.

![Область ошибок](./media/app-insights-app-map/error-pane.png)

Если щелкнуть сбой, можно перейти к последнему экземпляру этого сбоя.

## <a name="resource-health"></a>Работоспособность ресурса
Для некоторых типов ресурсов в верхней части области ошибок отображается работоспособность ресурса. Например, если щелкнуть узел SQL, отобразится состояние базы данных и все оповещения, которые были активированы.

![Работоспособность ресурса](./media/app-insights-app-map/resource-health.png)

Можно щелкнуть имя ресурса, чтобы просмотреть стандартные общие метрики для этого ресурса.

## <a name="video"></a>Видео

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player] 

## <a name="feedback"></a>Отзыв
Оставьте свой отзыв на портале.

![Изображение MapLink-1](./media/app-insights-app-map/13.png)


## <a name="next-steps"></a>Дополнительная информация

* [портал Azure](https://portal.azure.com)
