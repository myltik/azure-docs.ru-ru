---
title: Поиск в Azure Application Insights | Документация Майкрософт
description: Поиск и фильтрация необработанных данных телеметрии, отправляемых веб-приложением.
services: application-insights
documentationcenter: ''
author: mrbullwinkle
manager: carmonm
ms.assetid: 2a437555-8043-45ec-937a-225c9bf0066b
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: conceptual
ms.date: 03/14/2017
ms.author: mbullwin
ms.openlocfilehash: c6a94fd1cebff4aa657ad5293715550161003d21
ms.sourcegitcommit: 6f6d073930203ec977f5c283358a19a2f39872af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35294390"
---
# <a name="using-search-in-application-insights"></a>Поиск в Application Insights
Поиск — это функция [Application Insights](app-insights-overview.md), которая позволяет искать и изучать отдельные элементы телеметрии, например просмотры страниц, исключения и веб-запросы. Также можно просматривать журнал трассировки и события, которые были закодированы.

(Для более сложных запросов к данным используйте [Analytics](app-insights-analytics-tour.md).)

## <a name="where-do-you-see-search"></a>Как найти функцию поиска?
### <a name="in-the-azure-portal"></a>На портале Azure
Поиск по журналу диагностики можно открыть в колонке "Обзор" Application Insights вашего приложения:

![Откройте поиск по журналу диагностики](./media/app-insights-diagnostic-search/01-open-Diagnostic.png)

Она также открывается при щелчке некоторых диаграмм и элементов сетки. В этом случае ее фильтры предварительно настраиваются так, чтобы сфокусироваться на типе выбранного элемента. 

Например, в колонке "Обзор" есть линейчатая диаграмма запросов, классифицированных по времени ответа. Выберите диапазон производительности, чтобы просмотреть список отдельных запросов в этом диапазоне времени ответа:

![Выбор производительности запроса](./media/app-insights-diagnostic-search/07-open-from-filters.png)

Основная часть колонки поиска по диагностическим данных — это список элементов телеметрии: запросы сервера, просмотры страниц, пользовательские события, которые были закодированы, и т. д. В верхней части списка находится сводная диаграмма, отображающая количество событий в динамике.

Нажмите кнопку "Обновить", чтобы просмотреть новые события.

### <a name="in-visual-studio"></a>В Visual Studio

В Visual Studio также есть окно поиска по Application Insights. Его удобно использовать для отображения событий телеметрии, созданных отлаживаемым приложением. Оно также может показывать события, собранные из опубликованного приложения на портале Azure.

Откройте окно "Поиск" в Visual Studio.

![Как открыть окно "Поиск по Application Insights" в Visual Studio](./media/app-insights-diagnostic-search/32.png)

Функции в окне поиска схожи с функциями на веб-портале:

![Окно "Поиск по Application Insights" в Visual Studio](./media/app-insights-diagnostic-search/34.png)

Вкладка Track Operation (Отслеживание операции) отображается при открытии запроса или представления страницы. Операция — это последовательность событий, связанных с отдельным запросом или представлением страницы. В одну операцию могут входить, например, вызовы зависимостей, исключения, журналы трассировки и пользовательские события. На вкладке Track Operation (Отслеживание операции) графически показано время и продолжительность этих событий относительно запроса или представления страницы. 

## <a name="inspect-individual-items"></a>Проверка отдельных элементов
Выберите любой элемент телеметрии для просмотра ключевых полей и связанных элементов. Чтобы увидеть полный набор полей, нажмите кнопку "...". 

![Щелкните "Создать рабочий элемент", отредактируйте поля и нажмите кнопку "ОК".](./media/app-insights-diagnostic-search/10-detail.png)

## <a name="filter-event-types"></a>Фильтрация по типам событий
Откройте колонку "Фильтр" и выберите типы событий, которые требуется просмотреть. (Если впоследствии потребуется восстановить фильтры, с которыми вы открыли колонку, нажмите кнопку сброса).

![Щелкните "Фильтр" и укажите типы элементов телеметрии](./media/app-insights-diagnostic-search/02-filter-req.png)

Ниже приведены типы событий.

* **Трассировка**  -  [журналы диагностики](app-insights-asp-net-trace-logs.md), в том числе TrackTrace, log4Net, NLog и вызовы System.Diagnostic.Trace.
* **Запрос** — HTTP-запросы, полученные серверным приложением, включая страницы, скрипты, изображения, файлы стилей и данные. Эти события используются для создания обзорных диаграмм запросов и ответов.
* **Просмотр страницы**  -  [элемент телеметрии, отправляемый веб-клиентом](app-insights-javascript.md) и используемый для создания отчетов о просмотрах страниц. 
* **Пользовательское событие** — при вставке в код вызовов TrackEvent() для [отслеживания использования](app-insights-api-custom-events-metrics.md) эти вызовы можно найти здесь.
* **Исключение** — неперехваченные [исключения на сервере](app-insights-asp-net-exceptions.md) и те, которые зарегистрированы с помощью метода TrackException().
* **Зависимость**  -  [вызовы из серверного приложения](app-insights-asp-net-dependencies.md) к другим службам, таким как интерфейсы REST API или базы данных, а также вызовы AJAX из [клиентского кода](app-insights-javascript.md).
* **Доступность** — результаты [тестов доступности](app-insights-monitor-web-app-availability.md).

## <a name="filter-on-property-values"></a>Фильтрация на основе значений свойств
Можно фильтровать события по значениям их свойств. Доступные свойства зависят от выбранных типов событий. 

Например, можно выбрать запросы с определенным кодом ответа. 

![Разверните свойство и выберите значение](./media/app-insights-diagnostic-search/03-response500.png)

Если не выбрать ни одно из значений конкретного свойства, эффект будет таким же, как и при выборе всех значений. Фильтрация по этому свойству будет отключена.

### <a name="narrow-your-search"></a>Сужение области поиска
Обратите внимание, что счетчики справа от значений фильтра показывают число вхождений в текущем отфильтрованном наборе. 

В этом примере ясно, что запрос Rpt/Employees вернул в большинстве случаев ошибку с кодом 500:

![Разверните свойство и выберите значение](./media/app-insights-diagnostic-search/04-failingReq.png)




## <a name="find-events-with-the-same-property"></a>Поиск событий с одним и тем же свойством
Поиск всех элементов с одинаковым значением свойства:

![Щелкните правой кнопкой мыши свойство](./media/app-insights-diagnostic-search/12-samevalue.png)


## <a name="search-the-data"></a>Поиск данных

> [!NOTE]
> Чтобы написать более сложный запрос, щелкните [**Аналитика**](app-insights-analytics-tour.md) в верхней части колонки "Поиск".
> 

В любом из значений свойств можно искать слова. Это особенно полезно, если вы написали [пользовательские события](app-insights-api-custom-events-metrics.md) со значениями свойств. 

Можно задать временной диапазон, так как поиск в более коротком диапазоне выполняется быстрее. 

![Откройте поиск по журналу диагностики](./media/app-insights-diagnostic-search/appinsights-311search.png)

Выполните поиск по полным словам, а не по подстрокам. Специальные символы заключайте в кавычки.

| строка | *не* найдена по словам | но найдена по словам |
| --- | --- | --- |
| HomeController.About |home<br/>controller<br/>out | homecontroller<br/>about<br/>"homecontroller.about"|
|США|Сое<br/>диненные|соединенные<br/>штаты<br/>соединенные AND штаты<br/>"соединенные штаты"

Вот доступные поисковые выражения:

| Пример запроса | Результат |
| --- | --- |
| `apple` |Поиск всех событий в диапазоне времени, поля которых включают слово "apple". |
| `apple AND banana` |Поиск событий, содержащих оба слова. Используйте "AND" заглавными буквами, а не "and". |
| `apple OR banana`<br/>`apple banana` |Поиск событий, содержащих любое из этих слов. Используйте «OR» заглавными буквами, а не «or».<br/>Короткая форма. |
| `apple NOT banana` |Поиск событий, содержащих только одно из этих слов, но не содержащих другое. |



## <a name="sampling"></a>Выборка
Если приложение генерирует много данных телеметрии (а вы используете пакет SDK ASP.NET 2.0.0-beta3 или более поздней версии), модуль адаптивной выборки автоматически сокращает объем отправляемых на портал данных, пересылая только репрезентативную часть событий. При этом связанные с тем же запросом события отбираются как группа, что позволяет перемещаться между связанными событиями. 

[Дополнительная информация о выборке](app-insights-sampling.md).



## <a name="create-work-item"></a>Создание рабочего элемента
Можно зарегистрировать ошибку на сайте GitHub или в Visual Studio Team Services, указав сведения из любого элемента телеметрии. 

![Щелкните "Создать рабочий элемент", отредактируйте поля и нажмите кнопку "ОК".](./media/app-insights-diagnostic-search/42.png)

Когда вы это делаете в первый раз, предлагается настроить ссылку на учетную запись Team Services и проект.

![Введите URL-адрес сервера Team Services и имя проекта, затем нажмите кнопку "Авторизовать".](./media/app-insights-diagnostic-search/41.png)

(Можно также настроить ссылку в колонке "Рабочие элементы".)

## <a name="save-your-search"></a>Сохранение результатов поиска
После задания всех нужных фильтров параметры поиска можно сохранить как избранное. Если вы используете учетную запись организации, можно выбрать, будут ли другие члены команды иметь к ним доступ.

![Щелкните "Избранное", задайте имя и нажмите кнопку "Сохранить"](./media/app-insights-diagnostic-search/08-favorite-save.png)

Чтобы восстановить параметры поиска, **перейдите в колонку обзора** и откройте избранное:

![Плитка "Избранное"](./media/app-insights-diagnostic-search/09-favorite-get.png)

Если сохранение было выполнено с относительным временным диапазоном, повторно открытая колонка будет содержать самые последние данные. Если сохранение было выполнено с абсолютным временным диапазоном, каждый раз будут отображаться одни и те же данные. (Если относительный временной диапазон недоступен при сохранении в избранное, выберите "Диапазон времени" в заголовке и установите диапазон времени, не являющийся настраиваемым.)

## <a name="send-more-telemetry-to-application-insights"></a>Передача дополнительных элементов телеметрии в Application Insights
В дополнение к стандартным элементам телеметрии, передаваемым пакетом SDK Application Insights, можно сделать следующее.

* Выполнять трасcировку журналов, используя избранную платформу ведения журнала в [.NET](app-insights-asp-net-trace-logs.md) или [Java](app-insights-java-trace-logs.md). Благодаря этому можно будет выполнить поиск в журнале трассировки и сопоставить результаты с просмотрами страниц, исключениями и другими событиями. 
* [Создавать код](app-insights-api-custom-events-metrics.md) для отправки пользовательских событий, сведений о просмотрах страниц и исключениях. 

[Подробнее об отправке журналов и пользовательских данных телеметрии в Application Insights](app-insights-asp-net-trace-logs.md).

## <a name="questions"></a>Вопросы и ответы
### <a name="limits"></a>Какой объем данных сохраняется?

Ознакомьтесь со [сводной таблицей ограничений](app-insights-pricing.md#limits-summary).

### <a name="how-can-i-see-post-data-in-my-server-requests"></a>Как просмотреть данные POST в запросах к серверу?
Мы не заносим в журнал данные POST автоматически, но вы можете использовать [вызовы TrackTrace или вызовы журнала](app-insights-asp-net-trace-logs.md). Поместите данные POST в параметр сообщения. Сообщения нельзя отфильтровать тем же способом, как это делается для свойств, но предельный размер больше.

## <a name="video"></a>Видео

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="add"></a>Дальнейшие действия
* [Создание сложных запросов в Analytics](app-insights-analytics-tour.md)
* [Журналы, исключения и пользовательские средства диагностики для ASP.NET в Application Insights](app-insights-asp-net-trace-logs.md)
* [Наблюдение за доступностью и скоростью реагирования веб-сайта](app-insights-monitor-web-app-availability.md)
* [Устранение неполадок](app-insights-troubleshoot-faq.md)
