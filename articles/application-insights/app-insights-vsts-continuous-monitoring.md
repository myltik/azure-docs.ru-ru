---
title: "Непрерывный мониторинг конвейера выпуска DevOps с помощью VSTS и Azure Application Insights | Документация Майкрософт"
description: "Инструкции по быстрой настройке непрерывного мониторинга в Application Insights."
services: application-insights
keywords: 
author: mrbullwinkle
ms.author: mbullwin
ms.date: 11/13/2017
ms.service: application-insights
ms.topic: article
manager: carmonm
ms.openlocfilehash: 6ced5941d06c02a2576bf7f561bd535810e7ffd9
ms.sourcegitcommit: 9a61faf3463003375a53279e3adce241b5700879
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2017
---
# <a name="add-continuous-monitoring-to-your-release-pipeline"></a>Добавление постоянного мониторинга к конвейеру выпуска

Вы можете интегрировать Visual Studio Team Services (VSTS) с Azure Application Insights, чтобы организовать постоянный мониторинг конвейера выпуска DevOps на всем протяжении жизненного цикла разработки программного обеспечения. 

Теперь VSTS поддерживает постоянный мониторинг, который позволяет внедрить в конвейеры выпуска данные мониторинга от Application Insights и других ресурсов Azure. Когда срабатывает оповещение Application Insights, развертывание можно приостановить или откатить до устранения причин этого оповещения. Когда все проверки будут успешно пройдены, без дополнительных вмешательств автоматически возобновится весь процесс развертывания, от тестирования до ввода в эксплуатацию. 

## <a name="configure-continuous-monitoring"></a>Настройка непрерывного мониторинга

1. Выберите существующий проект VSTS.

2. Наведите указатель мыши на элемент **Сборка и выпуск**, затем выберите **Выпуски** и щелкните **+** > **Создать определение выпуска**. Найдите здесь элементы **Мониторинг** > **Azure App Service Deployment with Continuous Monitoring** (Развертывания службы приложений Azure с постоянным мониторингом).

   ![Новое определение выпуска VSTS](.\media\app-insights-continuous-monitoring\001.png)

3. Нажмите кнопку **Применить**.

4. Щелкните синий текст рядом с красным восклицательным знаком, чтобы открыть **Просмотр задач окружения**.

   ![Просмотр задач окружения](.\media\app-insights-continuous-monitoring\002.png)

   Откроется окно настроек, в котором нужно заполнить все поля в соответствии с таблицей ниже.

    | Параметр        | Значение |
   | ------------- |:-----|
   | **Имя среды**      | Имя, описывающее среду определения выпуска |
   | **Подписка Azure.** | Раскрывающийся список, заполненный подписками Azure, связанными с учетной записью VSTS|
   | **Имя службы приложений** | В зависимости от значений других параметров здесь может потребоваться ручной ввод нового значения |
   | **Группа ресурсов**    | Раскрывающийся список, заполненный доступными группами ресурсов |
   | **Имя ресурса Application Insights** | Раскрывающийся список, заполненный всеми ресурсами Application Insights, которые соответствуют выбранной выше группе ресурсов.

5. Выберите **Настройка оповещений Application Insights**

6. Чтобы сохранить установленные по умолчанию правила генерации оповещений, нажмите кнопку **Сохранить**, введите текстовое описание и нажмите кнопку **ОК**.

## <a name="modify-alert-rules"></a>Изменение правил генерации оповещений

1. Чтобы изменить стандартные параметры оповещений, щелкните поле с многоточием **...** справа от элемента **Правила генерации оповещений.**

   По умолчанию здесь указаны четыре правила генерации оповещений: доступность, сбои запросов, время ответа сервера, исключения сервера.

2. Щелкните символ раскрывающегося списка рядом с элементом **Доступность**.

3. Измените **пороговое значение** доступности в соответствии с нужным уровнем обслуживания.

   ![Изменение оповещений](.\media\app-insights-continuous-monitoring\003.png)

4. Выберите **ОК** > **Сохранить**, введите текстовое описание и нажмите кнопку **ОК**.

## <a name="add-deployment-conditions"></a>Добавление условий развертывания

1. Щелкните **Конвейер**, выберите символ **Условия перед развертыванием** или **Условия после развертывания** в зависимости от того, на каком этапе вы хотите организовать непрерывный мониторинг.

   ![Условия перед развертыванием](.\media\app-insights-continuous-monitoring\004.png)

2. В области **Шлюзы** выберите **Включено** > **Approval gates** (Шлюзы утверждения) и щелкните **Добавить**.

3. Выберите **Azure Monitor** (этот вариант позволяет использовать предупреждения от Azure Monitor и от Application Insights).

    ![Azure Monitor](.\media\app-insights-continuous-monitoring\005.png)

4. Введите значение **Gates timeout** (Время ожидания для шлюза).

5. Введите **интервал выборки**.

## <a name="deployment-gate-status-logs"></a>Журналы состояния шлюза развертывания

После того как вы добавите шлюз развертывания, оповещение о превышении заданного порогового значения в Application Insights будет предотвращать нежелательное распространение нового выпуска вашего развертывания. После устранения причины этого оповещения развертывание автоматически продолжит работу.

Чтобы пронаблюдать этот процесс, выберите **Выпуски**, щелкните имя выпуска правой кнопкой мыши **и выберите действие** > **Журналы.**

![Журналы](.\media\app-insights-continuous-monitoring\006.png)

## <a name="next-steps"></a>Дальнейшие действия

Чтобы получить сведения о компоненте VSTS "Сборка и выпуск", изучите эти [краткие руководства](https://docs.microsoft.com/en-us/vsts/build-release/).
