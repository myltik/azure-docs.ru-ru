---
title: "Анализ событий Azure Service Fabric с помощью OMS | Документы Майкрософт"
description: "Ознакомьтесь со сведениями о визуализации и анализе событий с использованием OMS для мониторинга и диагностики кластеров Azure Service Fabric."
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 10/15/2017
ms.author: dekapur
ms.openlocfilehash: 977c5d64a32157b39aa6b618196dde20c4c3cc8e
ms.sourcegitcommit: 922687d91838b77c038c68b415ab87d94729555e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2017
---
# <a name="event-analysis-and-visualization-with-oms"></a>Анализ и визуализация событий с помощью OMS

Operations Management Suite (OMS) — это набор служб управления, которые помогают в мониторинге и диагностике приложений и служб, размещенных в облаке. Более подробные сведения о наборе OMS и его возможностях см. в статье [Что такое Operations Management Suite (OMS)?](../operations-management-suite/operations-management-suite-overview.md)

## <a name="log-analytics-and-the-oms-workspace"></a>Служба Log Analytics и рабочая область OMS

Служба Log Analytics собирает данные из управляемых ресурсов, включая таблицу или агент службы хранилища Azure, и сохраняет их в центральном репозитории. Эти данные далее могут использоваться для анализа, оповещения, визуализации или последующего экспорта. Log Analytics поддерживает события, данные производительности, а также любые иные пользовательские данные.

Если набор OMS настроен, вы получаете доступ к определенной *рабочей области OMS*, из которой данные можно запрашивать и визуализировать на панелях мониторинга.

После получения данных службой Log Analytics можно применять ряд *решений для управления* из состава набора OMS для отслеживания входящих данных. Эти решения оптимизированы для нескольких сценариев. К ним относятся *Аналитика Service Fabric* и *Контейнеры* — два наиболее важных решения для диагностики и мониторинга кластеров Service Fabric. Есть и другие решения, достойные рассмотрения. Кроме того, OMS позволяет создавать пользовательские решения, о чем можно больше узнать [здесь](../operations-management-suite/operations-management-suite-solutions.md). Все решения, которые вы выбираете для кластера, настраиваются в одной рабочей области OMS вместе с Log Analytics. Рабочие области обеспечивают использование пользовательских панелей мониторинга, визуализацию данных и изменение данных, которые необходимо собирать, обрабатывать и анализировать.

## <a name="setting-up-an-oms-workspace-with-the-service-fabric-analytics-solution"></a>Настройка рабочей области OMS в решении "Аналитика Service Fabric"
Мы рекомендуем включить в рабочую область OMS решение Service Fabric, которое включает панель мониторинга с входящими каналами журналов от уровней платформы и приложений и дает возможность запрашивать данные из определенных журналов Service Fabric. Так выглядит сравнительно простое решение Service Fabric с одним приложением, развернутым в кластере:

![Решение OMS Service Fabric](media/service-fabric-diagnostics-event-analysis-oms/service-fabric-solution.png)

Сведения о том, как начать работу с этим решением в своем кластере, см. в статье [Set up OMS Log Analytics for a cluster](service-fabric-diagnostics-oms-setup.md) (Настройка OMS Log Analytics для кластера).

## <a name="using-the-oms-agent"></a>Использование агента OMS

В качестве решений для статистической обработки рекомендуется использовать EventFlow и WAD, так как они обеспечивают более модульный подход к диагностике и мониторингу. Например, если необходимо изменить выходные данные из EventFlow, изменение фактического инструментирования не потребуется. Нужно будет всего лишь внести небольшое изменение в файл конфигурации. Если вы решите использовать OMS Log Analytics, следует настроить [агент OMS](../log-analytics/log-analytics-windows-agent.md). При развертывании контейнеров в кластер используйте агент OMS, как описано ниже. 

Описание шагов см. в статье [Добавление агента OMS в кластер](service-fabric-diagnostics-oms-agent.md).

Ниже перечислены преимущества такого подхода.

* Более подробные данные счетчиков производительности и метрик.
* Из кластера собираются метрики, которые вы можете легко настроить, не меняя конфигурацию кластера. Изменения в параметры агента можно внести с помощью портала OMS. Агент автоматически перезапустится с новой требуемой конфигурацией. Чтобы настроить агент OMS для выбора конкретных счетчиков производительности, откройте рабочую область **Главная > Параметры > Данные > Счетчики производительности Windows** и выберите данные, которые следует собирать.
* Данные отображаются быстрее, чем при сохранении перед сбором OMS и службой Log Analytics.
* Отслеживать контейнеры гораздо проще, так как имеется возможность сбора журналов (stdout, stderr) и статистики (метрик производительности на уровнях контейнеров и узлов) для контейнеров Docker.

Но нужно учитывать то, что агент развертывается в кластере вместе с приложениями и несколько снижает их производительность.

## <a name="monitoring-containers"></a>Отслеживание контейнеров

При развертывании контейнеров в кластере Service Fabric рекомендуется установить в кластере агент OMS и добавить решение "Контейнеры" в рабочую область OMS, чтобы обеспечить мониторинг и диагностику. Вот как выглядит решение "Контейнеры" в рабочей области:

![Основная панель мониторинга OMS](./media/service-fabric-diagnostics-event-analysis-oms/oms-containers-dashboard.png)

Агент обеспечивает сбор нескольких журналов, относящихся к контейнерам, которые могут запрашиваться в OMS или использоваться для визуализации показателей эффективности. Собираются следующие типы журналов.

* ContainerInventory — отображает информацию о местонахождении контейнера, имени и образах.
* ContainerImageInventory — информация о развернутых образах, в том числе их идентификаторы или размеры.
* ContainerLog — журналы конкретных ошибок, журналы Docker (StdOut и т. д.) и другие записи.
* ContainerServiceLog — выполнявшиеся команды управляющей программы Docker.
* Perf — счетчики производительности контейнера, в том числе ЦП, память, сетевой трафик, операции ввода и вывода на диске и пользовательские метрики с компьютеров узла.

В статье [Monitor containers with OMS Log Analytic](service-fabric-diagnostics-oms-containers.md) (Мониторинг контейнеров с OMS Log Analytics) рассматриваются шаги, необходимые для настройки мониторинга контейнера в кластере. Дополнительные сведения о решении OMS "Контейнеры" см. в [документации](../log-analytics/log-analytics-containers.md) по решению.

## <a name="next-steps"></a>Дополнительная информация

Изучите перечисленные ниже средства и параметры OMS, чтобы настроить рабочую область в соответствии с вашими потребностями.

* Для локальных кластеров OMS предлагает шлюз (прокси-сервер переадресации HTTP), который можно использовать для отправки данных в OMS. Дополнительные сведения см. в разделе [Подключения компьютеров к OMS с помощью шлюза OMS без доступа к Интернету](../log-analytics/log-analytics-oms-gateway.md).
* Настройте OMS, чтобы настроить [автоматические оповещения](../log-analytics/log-analytics-alerts.md), которые помогают выполнять обнаружение и диагностику.
* Ознакомьтесь с функциями [поиска по журналам и запросов к журналам](../log-analytics/log-analytics-log-searches.md), которые являются частью решения Log Analytics.