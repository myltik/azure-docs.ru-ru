---
title: Мониторинг приложений и ресурсов в Azure
description: Обзор функциональных возможностей и служб Майкрософт, которые являются частью стратегии мониторинга ваших служб и приложений в Azure.
author: rboucher
services: azure-monitor
ms.service: azure-monitor
ms.topic: overview
ms.date: 03/05/2018
ms.author: robb,bwren
ms.component: ''
ms.openlocfilehash: e6adcc136c273210cc40d23ed2cb177287654005
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35265138"
---
# <a name="monitoring-azure-applications-and-resources"></a>Мониторинг приложений и ресурсов в Azure

Мониторинг — это процесс сбора и анализа данных для определения производительности, работоспособности и доступности вашего бизнес-приложения и ресурсов, от которых оно зависит. Эффективная стратегия мониторинга предоставляет возможность подробной проверки работы различных компонентов вашего приложения. Она также позволяет продлить время непрерывной работы за счет предупреждений о важных проблемах, чтобы вы могли решить их до того, как они приведут к сбоям.

Azure предлагает несколько служб, которые по отдельности выполняют определенную роль или задачу в пространстве мониторинга. Вместе эти службы предоставляют комплексное решение для сбора, анализа и использования телеметрии из вашего приложения и ресурсов Azure, которые их поддерживают. Они также могут выполнять мониторинг критически важных локальных ресурсов и предоставлять гибридную среду мониторинга. Понимание имеющихся инструментов и данных является первым шагом в разработке комплексной стратегии мониторинга для вашего приложения.

На диаграмме ниже приведено концептуальное представление компонентов, которые совместно выполняют мониторинг ресурсов Azure. В следующих разделах представлены их описания со ссылками на подробные технические сведения.

![Обзор мониторинга](media/monitoring-overview/monitoring-products-overview.png)


## <a name="shared-capabilities"></a>Общие возможности
Следующие функциональные возможности реализованы в службах базового и сложного мониторинга одинаково.

### <a name="alerts"></a>Оповещения
Решение [Оповещения Azure](../monitoring-and-diagnostics/monitoring-overview-alerts.md) заранее уведомляет вас о критически важных неполадках и может предпринимать корректирующие действия. Правила генерации оповещений могут использовать данные из нескольких источников, включая метрики и журналы. Они используют [группы действий](../monitoring-and-diagnostics/monitoring-action-groups.md), которые содержат уникальные наборы получателей и действия в ответ на предупреждение. В соответствии с требованиями можно настроить выполнение внешних действий после получения оповещений с помощью веб-перехватчиков и интеграцию с инструментами ITSM.

### <a name="dashboards"></a>Панели мониторинга
[Панели мониторинга Azure](../azure-portal/azure-portal-dashboards.md) можно использовать для объединения различных видов данных в одну панель на [портале Azure](https://portal.azure.com). Вы также можете предоставить общий доступ к этой панели другим пользователям Azure.

Например, можно создать панель мониторинга, которая объединяет:
- плитки, показывающие график метрик;
- таблицу журналов действий;
- диаграмму использования из Application Insights;
- результаты поиска по журналам в Log Analytics.

Кроме того, можно экспортировать данные Log Analytics в [Power BI](https://docs.microsoft.com/power-bi/), чтобы воспользоваться дополнительными визуализациями. Также можно сделать данные доступными для других пользователей в вашей организации и за ее пределами.

### <a name="metrics-explorer"></a>Обозреватель метрик
[Метрики](../monitoring-and-diagnostics/monitoring-overview-metrics.md) — это числовые значения, создаваемые ресурсами Azure, которые помогают понять работу и производительность ресурса. С помощью обозревателя метрик вы можете отправлять метрики в Log Analytics для анализа с данными из других источников.


## <a name="core-monitoring"></a>Базовый мониторинг
Базовый мониторинг обеспечивает основные функции обязательного мониторинга для ресурсов Azure. Эти службы требуют минимальной конфигурации и собирают основные данные телеметрии, которые используются службами мониторинга уровня "Премиум".    

### <a name="azure-monitor"></a>Azure Monitor
[Azure Monitor](../monitoring-and-diagnostics/monitoring-overview-azure-monitor.md) обеспечивает базовый мониторинг служб Azure, позволяя собирать [метрики](../monitoring-and-diagnostics/monitoring-overview-metrics.md), [журналы действий](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md) и [журналы диагностики](../monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs.md). Например, журнал действий содержит сведения о создании ресурсов или их изменении.

Доступны метрики, которые предоставляют статистику производительности разных ресурсов, а также операционной системы в виртуальной машине. Вы можете просмотреть эти данные с помощью нескольких инструментов на портале Azure, а также создать предупреждения на базе этих метрик. Монитор Azure гарантирует самую высокую скорость конвейера метрик (до 5 минут или даже до 1 минуты), и мы рекомендуем использовать его для оповещений и уведомлений, для которых время критически важно.

Вы также можете передать эти метрики и журналы в Log Analytics для анализа тенденций и подробного анализа или создать дополнительные правила генерации оповещений, которые будут предупреждать вас о важных проблемах заранее, на основе анализа тенденций.  

> [!NOTE]
> Отправка многомерных метрик в Log Analytics с помощью параметров диагностики сейчас не поддерживается. Метрики с измерениями экспортируются как преобразованные в плоскую структуру одномерные метрики, агрегированные по значениям измерений.
>
> *Пример.* Метрику "Входящие сообщения" в концентраторе событий можно изучить и вывести в виде диаграммы на уровне очереди. Но при экспорте в Log Analytics метрика будет представлена в виде всех входящих сообщений для всех очередей концентратора событий.
>
>

### <a name="azure-advisor"></a>Помощник по Azure
[Помощник по Azure](../advisor/advisor-overview.md) постоянно контролирует вашу конфигурацию ресурсов и телеметрию использования. Он также предоставляет персонализированные рекомендации. Следующие рекомендации помогут вам повысить производительность, улучшить безопасность и доступность ресурсов, поддерживающих ваши приложения.

### <a name="service-health"></a>Работоспособность службы
Работоспособность вашего приложения зависит от используемых служб Azure. [Работоспособность служб Azure](../service-health/service-health-overview.md) идентифицирует любые проблемы со службами Azure, которые могут повлиять на приложение. Также с помощью этой службы вы можете запланировать обслуживание.

### <a name="activity-log"></a>Журнал действий
[Журналы действий](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md) предоставляют данные об операциях с ресурсами Azure. Эти данные включают:
- изменения конфигурации ресурса;
- инциденты, связанные с обслуживанием;
- рекомендации по более эффективному использованию ресурса;
- данные, связанные с автоматическим масштабированием.

Вы можете просматривать журналы определенного ресурса на его странице на портале Azure или просматривать журналы из нескольких ресурсов в обозревателе журналов действий.

Вы также можете отправлять записи из журнала действий в Log Analytics. В этой службе вы можете анализировать их вместе с данными, собранными с помощью решений по управлению, агентов на виртуальных машинах и других источников.

## <a name="deep-monitoring-services"></a>Службы сложного мониторинга
Следующие службы Azure предоставляют широкие возможности для сбора и анализа данных мониторинга на более глубоком уровне. Они являются расширением службы базового мониторинга и используют общие функциональные возможности Azure. Эти службы обеспечивают подробную аналитику на базе собранных данных, чтобы вы могли управлять своими приложениями и инфраструктурой. Они представляют данные в контексте сценариев, ориентированных на разные аудитории.

## <a name="deep-application-monitoring"></a>Сложный мониторинг приложений
### <a name="application-insights"></a>Application Insights
[Azure Application Insights](http://azure.microsoft.com/documentation/services/application-insights) можно использовать для мониторинга доступности, производительности и использования вашего приложения независимо от того, размещено ли оно в облачной или локальной среде.

Предоставив приложению возможность работы с Application Insights, вы получите детальную аналитику и поддержку сценариев DevOps. Вы сможете быстро идентифицировать и диагностировать ошибки, не дожидаясь, пока о них сообщит пользователь. Собранные данные позволят сделать осознанный выбор в отношении обслуживания и улучшений вашего приложения.

Application Insights предоставляет обширные инструменты для взаимодействия с собираемыми данными. Эта служба хранит свои данные в общем репозитории. Она также использует общие функции, такие как оповещения, панели мониторинга и детальный анализ с помощью языка запросов Log Analytics.

## <a name="deep-infrastructure-monitoring"></a>Инфраструктура сложного мониторинга
### <a name="log-analytics"></a>Log Analytics
[Log Analytics](http://azure.microsoft.com/documentation/services/log-analytics) служит фундаментом для мониторинга Azure, собирая в один репозиторий данные из разных ресурсов (в том числе от средств сторонних поставщиков). В этом репозитории вы можете анализировать данные с помощью эффективного языка запросов.

Application Insights и центр безопасности Azure хранят свои данные в хранилище данных Log Analytics и используют аналитический модуль. Данные также собираются из Azure Monitor, решений по управлению и агентов, установленных на виртуальных машинах в локальной среде или в облаке. Такие общие функции позволяют составить полную картину всей среды.

### <a name="management-solutions"></a>Решения для управления
[Решения по управлению](../log-analytics/log-analytics-add-solutions.md) — это упакованные наборы логики, предоставляющие данные по конкретному приложению или службе. Они используют Log Analytics для хранения и анализа данных мониторинга, которые они собирают.

Доступны партнерские решения по управлению и решения от корпорации Майкрософт, чтобы обеспечить мониторинг различных служб Azure и служб сторонних производителей. Примеры решений для мониторинга:
* [Мониторинг контейнеров](../log-analytics/log-analytics-containers.md) позволяет просматривать узлы контейнеров и управлять ими.
* [Аналитика SQL Azure](../log-analytics/log-analytics-azure-sql.md) собирает и визуализирует метрики производительности баз данных SQL Azure.

Вы можете просмотреть все доступные решения управления в разделе *Мониторинг* на портале Azure.

### <a name="network-monitoring"></a>Мониторинг сетей
Существует несколько средств, совместно обеспечивающих возможность мониторинга за разными аспектами сети (локально и в Azure).  

[Наблюдатель за сетями](../network-watcher/network-watcher-monitoring-overview.md) обеспечивает мониторинг на основе сценариев и диагностику различных сетевых сценариев в Azure. Эта служба хранит данные в метриках и диагностических сведениях Azure для дальнейшего анализа. Она также взаимодействует со следующими решениями для мониторинга различных параметров сети.

[Монитор производительности сети (NPM)](../log-analytics/log-analytics-network-performance-monitor.md) — облачное решение для мониторинга сети, которое отслеживает доступность публичных облаков, центров обработки данных и локальных сред.

[Монитор ExpressRoute](../expressroute/how-to-npm.md) — функция NPM, которая отслеживает сквозную доступность и производительность каналов Azure ExpressRoute.

[Аналитика DNS](../log-analytics/log-analytics-dns.md) — решение, которое предоставляет данные о безопасности, производительности и операциях для ваших DNS-серверов.

[Мониторинг конечных точек службы](../networking/network-monitoring-overview.md) проверяет доступность приложений и выявляет узкие места производительности в локальных сетях, сетях операторов, а также в облачных или частных центрах обработки данных.


### <a name="service-map"></a>Схема услуги
Решение [Сопоставление служб](../operations-management-suite/operations-management-suite-service-map.md) позволяет получить представление о вашей среде IaaS, анализируя виртуальные машины с различными процессами и зависимостями от других компьютеров и внешних процессов. Оно объединяет события, данные о производительности и решения по управлению в Log Analytics. Благодаря этому вы можете просматривать эти данные в контексте каждого компьютера и его связи с остальной средой.

Решение "Сопоставление служб" похоже на [схему приложений в Application Insights](../application-insights/app-insights-app-map.md). Но это решение уделяет основное внимание компонентам инфраструктуры, которые поддерживают ваши приложения.


## <a name="example-scenarios"></a>Примеры сценариев
Ниже приведены подробные примеры, которые иллюстрируют, как использовать различные средства мониторинга в Azure для разных сценариев.

### <a name="monitoring-a-web-application"></a>Мониторинг веб-приложения
Рассмотрим веб-приложение, развернутое в Azure, используя службу приложений Azure, службу хранилища Azure и базу данных SQL. Сначала получите доступ к [метрикам](../monitoring-and-diagnostics/monitoring-overview-metrics.md) и [журналам действий](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md) для этих ресурсов на их страницах на портале Azure. Выполните поиск критически важных сведений, таких как количество запросов к приложению и среднее время запроса. Также идентифицируйте любые изменения конфигурации.

Затем перейдите к монитору на портале, чтобы просмотреть метрики и журналы разных ресурсов. Определив стандартные параметры метрик, создайте [правила генерации оповещений](../monitoring-and-diagnostics/monitoring-overview-unified-alerts.md). Благодаря этим правилам вы заранее получите уведомление, когда, например, среднее время отклика выйдет за пределы порогового значения. Чтобы быстро просматривать ежедневную производительность приложения, создайте панель управления Azure для отображения графиков метрик, представляющих критически важные ключевые показатели эффективности.

Чтобы выполнить более глубокий мониторинг своего приложения, [настройте его для Application Insights](../application-insights/quick-monitor-portal.md). Теперь вы можете собирать дополнительные данные, чтобы лучше понять работу и производительность своего приложения. Application Insights обнаруживает базовые связи между компонентами приложения. Это позволяет создать визуальное представление с помощью [схемы приложений](../application-insights/app-insights-app-map.md) в сочетании со [сквозной трассировкой](../application-insights/app-insights-transaction-diagnostics.md) для точной диагностики компонента, зависимости или исключения, в котором возникла проблема.

Создайте [тесты доступности](../application-insights/app-insights-monitor-web-app-availability.md), чтобы заранее протестировать свое приложение из разных регионов. [Включите профилировщик](../application-insights/enable-profiler-compute.md) для своих разработчиков, чтобы отслеживать запросы и любые исключения до определенной строки кода. Чтобы получить дополнительные сведения о службах, используемых в вашем приложении, добавьте [решение SQL Analytics](../log-analytics/log-analytics-azure-sql.md) для сбора дополнительных данных в Log Analytics.

Через некоторое время вы решите исследовать первопричину уменьшения производительности сайта ниже порогового значения во время определенных периодов. Напишите запрос, используя Log Analytics. Вы сможете сопоставить данные об использовании и производительности, собранные Application Insights, с данными о конфигурации и производительности ресурсов Azure, которые поддерживают работу приложения.


### <a name="monitoring-virtual-machines"></a>Мониторинг виртуальных машин
В Azure запущены виртуальные машины Windows и Linux. Используйте Azure Monitor для просмотра [журналов действий](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md) и [метрик уровня узла](../monitoring-and-diagnostics/monitoring-overview-metrics.md). Добавьте [расширение системы диагностики Azure](../virtual-machines/linux/tutorial-monitoring.md#install-diagnostics-extension) к виртуальным машинам, чтобы получать метрики из операционной системы на виртуальной машине. Затем создайте [правила генерации оповещений](../monitoring-and-diagnostics/monitoring-overview-unified-alerts.md), чтобы заранее получать уведомления, если основные метрики, такие как использование процессора и памяти, превышают пороговые значения.

Чтобы получить подробные сведения о виртуальных машинах, на которых выполняется бизнес-приложение, [создайте рабочую область Log Analytics и включите расширение для виртуальных машин](../log-analytics/log-analytics-quick-collect-azurevm.md) на каждом компьютере. Настройте [получение различных источников данных](../log-analytics/log-analytics-data-sources.md) для своего приложения и [создайте представления](../log-analytics/log-analytics-view-designer.md), чтобы получать данные о его ежедневной работе и производительности. Затем [создайте правила оповещения](../monitoring-and-diagnostics/monitoring-overview-unified-alerts.md), благодаря которым вы будете получать уведомления о получении определенных событий ошибки.

Чтобы постоянно контролировать работоспособность установленного агента, добавьте [решение по управлению "Работоспособность агентов"](../operations-management-suite/oms-solution-agenthealth.md). Чтобы получить более полное представление о приложении, [добавьте агент зависимостей](../operations-management-suite/operations-management-suite-service-map-configure.md) на виртуальные машины для добавления их в [Сопоставление служб](../operations-management-suite/operations-management-suite-service-map.md). "Сопоставление служб" обнаруживает критически важные процессы и идентифицирует подключения между компьютерами и другими службами.

После сообщения о возникновении сбоя используйте "Сопоставление служб" для проведения экспертизы, чтобы определить конкретные компьютеры, которые столкнулись с этой проблемой. Затем создайте [запрос на получение данных из Log Analytics](../log-analytics/log-analytics-log-search-new.md), чтобы определить проблему в будущем. Создайте правило генерации оповещений, чтобы заранее получать оповещения об обнаружении условия.



## <a name="next-steps"></a>Дополнительная информация
См. также:

* [Azure Monitor](https://azure.microsoft.com/services/monitor/) поможет начать работу с метриками и предупреждениями базового мониторинга.
* [Application Insights](https://azure.microsoft.com/documentation/services/application-insights/), если вы пытаетесь диагностировать проблемы в работе веб-приложения службы приложений.
* [Log Analytics](https://azure.microsoft.com/documentation/services/log-analytics/) полезен для анализа собранных данных и журналов мониторинга.
