---
title: Обзор метрик в Microsoft Azure | Документация Майкрософт
description: Обзор метрик и их использования в Microsoft Azure
author: anirudhcavale
manager: orenr
editor: ''
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 405ec51c-0946-4ec9-b535-60f65c4a5bd1
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/19/2018
ms.author: ancav
ms.openlocfilehash: 4598267e92716529774f42d22ab7c47d944d4495
ms.sourcegitcommit: 20d103fb8658b29b48115782fe01f76239b240aa
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2018
---
# <a name="overview-of-metrics-in-microsoft-azure"></a>Обзор метрик в Microsoft Azure
Из этой статьи вы узнаете, что такое метрики в Microsoft Azure, какими преимуществами они обладают и как ими пользоваться.  

## <a name="what-are-metrics"></a>Что такое метрики
Azure Monitor позволяет использовать данные телеметрии, чтобы получать сведения о производительности и работоспособности рабочих нагрузок в Azure. Наиболее важным типом данных телеметрии Azure являются метрики (также называемые счетчиками производительности), создаваемые большинством ресурсов Azure. Azure Monitor предоставляет несколько способов настройки и использования этих метрик для мониторинга и устранения неполадок.

## <a name="what-can-you-do-with-metrics"></a>Что можно делать с помощью метрик
Метрики — ценный источник данных телеметрии. С помощью метрик можно решать следующие задачи:

* **Отслеживать производительность** ресурса (например, виртуальной машины, веб-сайта или приложения логики), создав на портале диаграмму соответствующих метрик. Эту диаграмму можно закрепить на панели мониторинга.
* **Получать уведомления о проблемах**, влияющих на производительность ресурсов, когда значения метрик достигают определенных пороговых значений.
* **Настраивать автоматизированные действия**, например автомасштабирование ресурса или запуск модуля Runbook, когда значение метрики достигает определенного порогового значения.
* **Выполнять расширенную аналитику** или создавать подробные отчеты о производительности ресурсов или тенденциях их использования.
* **Архивировать** журналы производительности и работоспособности ресурсов **для соответствия с требованиям или проведения аудита**.

## <a name="what-are-the-characteristics-of-metrics"></a>Характеристики метрик
Метрики обладают следующими характеристиками.

* Все метрики обновляются **один раз в минуту** (если в определении метрики не указано иное). Вы получаете значение метрики от ресурса каждую минуту, что позволяет в близком к реальному времени отслеживать его состояние и работоспособность.
* Метрики **доступны сразу же**. Вам не нужно что-либо настраивать или устанавливать дополнительные средства диагностики.
* Для каждой метрики доступен **журнал за последние 93 дня**. Можно быстро взглянуть на последние и ежемесячные тенденции производительности и работоспособности ресурса.
* Некоторые метрики могут иметь атрибуты в виде пары "имя — значение", называемые **измерениями**. Это позволяет дополнительно разделить и изучить метрику более конструктивным образом.

Также можно:

* Настраивать для метрик **правила генерации оповещений, которые отправляют уведомления или выполняют автоматизированные действия**, когда значение метрики достигает определенного порогового значения. Автомасштабирование — это специальное автоматизированное действие, которое позволяет развернуть ресурс для обработки дополнительных входящих запросов, а также возросшей нагрузки на веб-сайт или вычислительные ресурсы. Для автомасштабирования можно настроить правило, которое будет разворачивать и сворачивать ресурсы при достижении определенного порогового значения метрики.

* **Направлять** все метрики в Application Insights или Log Analytics (OMS), чтобы использовать возможности мгновенной аналитики, поиска и пользовательских оповещений на основе данных метрик, поступающих от ресурсов. Вы также можете использовать потоковую передачу метрик в концентратор событий. Это позволяет перенаправлять их в службу Azure Stream Analytics или в пользовательские приложения для оперативного анализа. Потоковую передачу в концентратор событий можно настроить с помощью параметров диагностики.

* **Архивировать** метрики для длительного хранения или использования в автономных отчетах. При настройке параметров диагностики ресурса можно настроить отправку метрик в хранилище BLOB-объектов.

* Быстро находить, открывать и **просматривать все метрики** на портале Azure, выбрав ресурс и отобразив данные на диаграмме.

* **Использовать** метрики через новые интерфейсы REST API в Azure Monitor.

* **Запрашивать** метрики, используя командлеты PowerShell или кроссплатформенный интерфейс REST API.

  ![Перенаправление метрик в Azure Monitor](./media/monitoring-overview-metrics/Metrics_Overview_v4.png)

## <a name="access-metrics-via-the-portal"></a>Доступ к метрикам через портал
Ниже мы вкратце рассмотрим, как создать диаграмму метрик на портале Azure.

### <a name="to-view-metrics-after-creating-a-resource"></a>Просмотр метрик после создания ресурса
1. Перейдите на портал Azure.
2. Создайте веб-сайт службы приложений Azure.
3. Создав веб-сайт, откройте колонку **Обзор**.
4. Новые метрики можно просмотреть на плитке **Мониторинг**. Эту плитку можно изменить и добавить на нее дополнительные метрики.

   ![Метрики ресурсов в Azure Monitor](./media/monitoring-overview-metrics/MetricsOverview1.png)

### <a name="to-access-all-metrics-in-a-single-place"></a>Централизованный доступ ко всем метрикам
1. Перейдите на портал Azure.
2. Перейдите на новую вкладку **Монитор** и щелкните **Метрики**.
3. В раскрывающемся списке выберите свою подписку, группу ресурсов и имя ресурса.
4. Просмотрите список доступных метрик. Выберите интересующую вас метрику и добавьте ее на график.
5. Диаграмму можно закрепить на панели мониторинга, щелкнув значок булавки в правом верхнем углу.

   ![Доступ ко всем метрикам в одной области в Azure Monitor](./media/monitoring-overview-metrics/MetricsOverview2.png)

> [!NOTE]
> Без дополнительных настроек диагностики доступны метрики уровня узла, передаваемые виртуальными машинами (на основе Azure Resource Manager) и масштабируемыми наборами виртуальных машин. Эти новые метрики доступны для экземпляров Windows и Linux. Эти метрики не следует путать с метриками уровня гостевой ОС, которые вам доступны при включении системы диагностики Azure в виртуальных машинах или масштабируемых наборах виртуальных машин. Дополнительные сведения о настройке системы диагностики Microsoft Azure см. [здесь](../azure-diagnostics.md).
>
>

Azure Monitor также имеет новые метрики построения диаграмм, которые сейчас находятся в предварительной версии. Это позволяет пользователям накладывать метрики разных типов ресурсов на одной диаграмме. Пользователи также могут создавать, разделять и фильтровать многомерные метрики с помощью метрик построения диаграмм. Для получения дополнительных сведений щелкните [здесь](https://aka.ms/azuremonitor/new-metrics-charts).

## <a name="access-metrics-via-the-rest-api"></a>Доступ к метрикам через REST API
К метрикам Azure можно обращаться через API-интерфейсы Azure Monitor. Есть два API-интерфейса для поиска метрик и доступа к ним:

* [REST API определений метрик Azure Monitor](https://docs.microsoft.com/rest/api/monitor/metricdefinitions) используется для доступа к списку метрик и любых измерений, которые доступны для службы.
* [REST API метрик Azure Monitor](https://docs.microsoft.com/rest/api/monitor/metrics) используется для сегментирования и фильтрации данных метрик, а также для доступа к ним.

> [!NOTE]
> В этой статье описывается работа с метриками с помощью [нового API для метрик](https://docs.microsoft.com/rest/api/monitor/) ресурсов Azure. Версия нового API метрик и определений метрик — 2018-01-01. Для доступа к устаревшим метрикам и их определениям используйте API версии 2014-04-01.
>
>

Подробные инструкции см. в [пошаговом руководстве по REST API Azure Monitor](monitoring-rest-api-walkthrough.md).

## <a name="export-metrics"></a>Экспорт метрик
Откройте колонку **Параметры системы диагностики** на вкладке **Монитор** и просмотрите варианты экспорта метрик. Метрики (и журналы диагностики) можно перенаправлять в хранилище BLOB-объектов, концентраторы событий Azure или консоль OMS, где их можно использовать, как описано выше.

 ![Параметры экспорта метрик в Azure Monitor](./media/monitoring-overview-metrics/MetricsOverview3.png)

Экспорт метрик можно настроить с помощью шаблонов Resource Manager, [PowerShell](insights-powershell-samples.md), [интерфейса командной строки Azure](insights-cli-samples.md) или [интерфейсов REST API](https://msdn.microsoft.com/library/dn931943.aspx).

## <a name="take-action-on-metrics"></a>Действия с метриками
Чтобы получать уведомления или выполнять автоматизированные действия на основе полученных данных метрик, можно настроить правила генерации оповещений или параметры автомасштабирования.

### <a name="configure-alert-rules"></a>Настройка правил генерации оповещений
На основе метрик можно настроить правила генерации оповещений. Эти правила проверяют, достигла ли та или иная метрика определенного порогового значения. Azure Monitor предлагает две возможности оповещений на основе метрик.

Оповещения на основе метрик. Они могут отправлять вам на электронную почту уведомления или активировать объект webhook, который может запускать пользовательские скрипты. Объект webhook может также использоваться для настройки интеграции с продуктами сторонних производителей.

 ![Метрики и правила генерации оповещений в Azure Monitor](./media/monitoring-overview-metrics/MetricsOverview4.png)

Новые оповещения на основе метрик могут отслеживать несколько метрик и пороговые значения ресурса, а затем отправлять вам уведомления с помощью [группы действий](/monitoring-action-groups.md). Дополнительные сведения см. в статье [Использование новых оповещений метрик для служб Azure на портале Azure](https://aka.ms/azuremonitor/near-real-time-alerts).


### <a name="autoscale-your-azure-resources"></a>Автомасштабирование ресурсов Azure
Некоторые ресурсы Azure поддерживают разворачивание и сворачивание экземпляров для обработки рабочих нагрузок. Автомасштабирование применяется к службе приложений (веб-приложения), масштабируемым наборам виртуальных машин и классическим облачным службам Azure. Вы можете настроить правила автомасштабирования, которые будут разворачивать или сворачивать ресурсы, когда определенная метрика, влияющая на рабочую нагрузку, достигает заданного порогового значения. Дополнительные сведения см. в статье [Обзор автомасштабирования в виртуальных машинах, облачных службах и веб-приложениях Microsoft Azure](monitoring-overview-autoscale.md).

 ![Метрики и автомасштабирование в Azure Monitor](./media/monitoring-overview-metrics/MetricsOverview5.png)

## <a name="learn-about-supported-services-and-metrics"></a>Поддерживаемые службы и метрики
Подробный список поддерживаемых служб и их метрики см. в статье [Метрики, поддерживаемые Azure Monitor](monitoring-supported-metrics.md).

## <a name="next-steps"></a>Дополнительная информация
Перейдите по ссылкам в этой статье. Кроме того, ознакомьтесь со следующими материалами:  

* [Общие метрики автомасштабирования Azure Monitor](insights-autoscale-common-metrics.md)
* [Создание оповещений для служб Azure с помощью портала Azure](insights-alerts-portal.md)
* [Сбор журналов и метрик для служб Azure для использования в Log Analytics](../log-analytics/log-analytics-azure-storage.md)
