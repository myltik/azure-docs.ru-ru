---
title: Сеть Azure | Документация Майкрософт
description: Сведения о сетевых службах Azure и их возможностях.
services: networking
documentationcenter: na
author: jimdial
manager: timlt
editor: ''
tags: azure-resource-manager
ms.assetid: ''
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/19/2017
ms.author: jdial
ms.openlocfilehash: 2e5862e99b3e883554b42341d2c1dbe9d8b8ec72
ms.sourcegitcommit: b6319f1a87d9316122f96769aab0d92b46a6879a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/20/2018
ms.locfileid: "34366986"
---
# <a name="azure-networking"></a>Сети Azure

Azure предоставляет широкий набор сетевых возможностей, которые можно использовать вместе или по отдельности. Щелкните одну из приведенных ниже ключевых возможностей, чтобы подробнее узнать о ней.
- [Подключение между ресурсами Azure.](#connectivity) Устанавливайте подключение между ресурсами Azure в безопасной частной виртуальной сети в облаке.
- [Подключение к Интернету.](#internet-connectivity) Настройте взаимодействие с ресурсами Azure через Интернет.
- [Локальное подключение.](#on-premises-connectivity) Подключайте локальные сети к ресурсам Azure через виртуальную частную сеть в Интернете или выделенное подключение к Azure.
- [Направление трафика и балансировка нагрузки.](#load-balancing) Реализуйте балансировку нагрузки трафика на серверы в том же расположении или передачу трафика на серверы в разных расположениях.
- [Безопасность.](#security) Реализуйте фильтрацию сетевого трафика между подсетями в сети или отдельными виртуальными машинами.
- [Маршрутизация.](#routing) Используйте маршрутизацию по умолчанию или полностью управляйте маршрутизацией между Azure и локальными ресурсами.
- [Управляемость.](#manageability) Выполняйте мониторинг сетевых ресурсов Azure и управляйте ими.
- [Средства развертывания и настройки.](#tools) Развертывайте и настраивайте сетевые ресурсы с помощью кроссплатформенных программ командной строки и средств веб-портала.

## <a name="Connectivity"></a>Подключение между ресурсами Azure

Ресурсы Azure, такие как Виртуальные машины, облачные службы, масштабируемые наборы виртуальных машин и среды службы приложений Azure, могут в частном порядке взаимодействовать друг с другом через виртуальную сеть Azure. Виртуальная сеть представляет собой логическую изоляцию облака Azure, выделенного для вашей [подписки](../azure-glossary-cloud-terminology.md?toc=%2fazure%2fnetworking%2ftoc.json). Вы можете реализовать несколько виртуальных сетей в пределах подписки и [региона](https://azure.microsoft.com/regions) Azure. Виртуальные сети изолированы друг от друга. Вот что можно сделать для каждой из них:

- Указать пользовательское пространство частных IP-адресов, в котором используются общедоступные и частные адреса (RFC 1918). Azure назначает ресурсам, подключенным к виртуальной сети, частный IP-адрес из определенного адресного пространства.
- Разделить виртуальную сеть на подсети и выделить каждой из них часть адресного пространства виртуальной сети.
- Использовать разрешение имен Azure или указать собственный DNS-сервер, который будут использовать ресурсы, подключенные к виртуальной сети.

Дополнительные сведения о службе виртуальной сети Azure см. в [этой статье](../virtual-network/virtual-networks-overview.md?toc=%2fazure%2fnetworking%2ftoc.json). Виртуальные сети можно подключать между собой. Таким образом ресурсы в этих виртуальных сетях смогут взаимодействовать. Чтобы подключить виртуальные сети между собой, воспользуйтесь одним или обоими способами:

- **Пиринг.** Позволяет взаимодействовать ресурсам, подключенным к разным виртуальным сетям Azure, в одном регионе Azure. Значения пропускной способности и задержки виртуальных сетей совпадают, как и при подключении ресурсов к одной виртуальной сети. Дополнительные сведения о пиринге между виртуальными сетями см. в [этой статье](../virtual-network/virtual-network-peering-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **VPN-шлюз.** Позволяет взаимодействовать ресурсам, подключенным к разным виртуальным сетям Azure, в разных регионах Azure. Трафик между виртуальными сетями проходит через VPN-шлюз Azure. Пропускная способность между виртуальными сетями ограничена пропускной способностью шлюза. Дополнительные сведения о подключении виртуальных сетей с помощью VPN-шлюза см. в [этой статье](../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md?toc=%2fazure%2fnetworking%2ftoc.json).

## <a name="internet-connectivity"></a>Подключение к Интернету

По умолчанию все ресурсы Azure, подключенные к виртуальной сети, имеют исходящее подключение к Интернету. Частный IP-адрес ресурса методом SNAT преобразовывается в общедоступный IP-адрес в инфраструктуре Azure. Дополнительные сведения об исходящих интернет-подключениях см. в статье [Общие сведения об исходящих подключениях в Azure](../load-balancer/load-balancer-outbound-connections.md?toc=%2fazure%2fnetworking%2ftoc.json).

Для входящего подключения к ресурсам Azure из Интернета или исходящего подключения к Интернету без SNAT ресурсу необходимо назначить общедоступный IP-адрес. Дополнительные сведения об общедоступных IP-адресах см. в [этой статье](../virtual-network/virtual-network-public-ip-address.md?toc=%2fazure%2fnetworking%2ftoc.json).

## <a name="on-premises-connectivity"></a>Локальные подключения

Вы можете получить безопасный доступ к ресурсам виртуальной сети через VPN-подключение или прямое частное подключение. Для обмена сетевым трафиком между виртуальной сетью Azure и локальной сетью необходимо создать шлюз для виртуальной сети. В параметрах шлюза можно задать необходимый тип подключения: VPN или ExpressRoute.

Локальную сеть можно подключить к виртуальной, используя сочетание следующих способов:

**Подключения типа "точка — сеть" (VPN-подключения по протоколу SSTP)**

На следующей схеме показаны отдельные подключения "точка — сеть" между несколькими компьютерами и виртуальной сетью:

!["точка — сеть";](./media/networking-overview/point-to-site.png)

Это подключение устанавливается между отдельным компьютером и виртуальной сетью. Этот тип подключения идеально подходит для новичков, не умеющих работать в Azure, или для разработчиков, так как при его использовании существующую сеть почти не нужно менять. Его также удобно использовать при подключении из удаленного расположения, например конференции или дома. Подключение типа "точка — сеть" часто связано с подключением типа "сеть — сеть" через один шлюз виртуальной сети. Подключение осуществляется по протоколу SSTP для обеспечения зашифрованного обмена данными между компьютером и виртуальной сетью через Интернет. Задержку VPN типа "точка — сеть" невозможно спрогнозировать, так как трафик проходит через Интернет.

**Подключение типа "сеть — сеть" (через VPN-туннель IPsec/IKE)**

![Подключение типа "сайт — сайт"](./media/networking-overview/site-to-site.png)

Это подключение устанавливается между локальным VPN-устройством и VPN-шлюзом Azure. Используя этот тип подключения, авторизованные локальные ресурсы могут получить доступ к виртуальной сети. Это VPN-подключение по протоколу IPSec/IKE, благодаря которому локальные устройства и VPN-шлюз Azure могут взаимодействовать по зашифрованному каналу через Интернет. Вы можете подключить несколько локальных сайтов к одному VPN-шлюзу. Локальное VPN-устройство должно иметь на каждом сайте внешний общедоступный IP-адрес, который находится в пределах NAT. Задержку VPN типа "сеть — сеть" невозможно спрогнозировать, так как трафик проходит через Интернет.

**ExpressRoute (выделенное частное подключение)**

![ExpressRoute](./media/networking-overview/expressroute.png)

Этот тип подключения устанавливается между вашей сетью и Azure через партнера ExpressRoute. Это подключение является закрытым. Трафик не передается через Интернет. Задержку для подключения ExpressRoute можно спрогнозировать, так как трафик не передается через Интернет. Подключение ExpressRoute можно использовать с подключением типа "сеть — сеть".

Дополнительные сведения о предыдущих способах подключения см. в разделе [Схемы топологий подключения](../vpn-gateway/vpn-gateway-about-vpngateways.md?toc=%2fazure%2fnetworking%2ftoc.json).

## <a name="load-balancing"></a>Направление трафика и балансировка нагрузки

Microsoft Azure включает несколько служб, управляющих распределением сетевого трафика и балансировкой нагрузки. Вы можете использовать следующие возможности вместе или по отдельности.

**Балансировка нагрузки на уровне DNS**

Служба диспетчера трафика Azure выполняет глобальную балансировку нагрузки на уровне DNS. Диспетчер трафика отвечает на запросы клиентов с IP-адресом работоспособной конечной точки, используется один из следующих методов маршрутизации:
- **Географическая.** Клиенты направляются на определенные конечные точки (Azure, внешние или вложенные) в зависимости от географического расположения, из которого исходит их запрос DNS. Это позволяет реализовать сценарии, в которых важно знать географический регион клиентов и направлять их на основе этих данных. К примерам относятся соблюдение предписаний независимости данных, локализация содержимого и взаимодействия с пользователем, а также измерение трафика из разных регионов.
- **Производительность.** Клиенту возвращается "ближайший" IP-адрес. Под ближайшей конечной точкой не обязательно подразумевается та, которая ближе всего географически. Вместо этого при определении расстояния к этой конечной точке используются характеристики задержки сети. Диспетчер трафика ведет собственную таблицу задержек Интернета, в которой сохраняет время кругового пути между диапазонами IP-адресов и центрами обработки данных Azure.
- **По приоритету.** Трафик направляется в первичную конечную точку (с наивысшим приоритетом). Если основная конечная точка недоступна, диспетчер трафика направляет трафик на вторую конечную точку. Если и первичная, и вторичная конечные точки становятся недоступны, трафик направляется к третьей и т. д. Доступность конечной точки определяется по указанному для нее состоянию (включена или отключена) и данным мониторинга конечных точек.
- **Взвешенная маршрутизация с циклическим перебором.** Для каждого полученного запроса диспетчер трафика случайным образом выбирает доступную конечную точку. Вероятность выбора конечной точки определяется сочетанием весовых коэффициентов всех доступных конечных точек. Если для всех конечных точек используются одинаковые коэффициенты, трафик будет распределяться между ними равномерно. Если задать больший (или меньший) вес для определенных конечных точек, они будут чаще (или реже) возвращаться в ответах DNS.

На схеме ниже показан запрос, направленный в конечную точку веб-приложения. Конечными точками также могут быть другие службы Azure, такие как Виртуальные машины и облачные службы.

![Диспетчер трафика](./media/networking-overview/traffic-manager.png)

Клиент подключается напрямую к указанной конечной точке. Если конечная точка неработоспособна, диспетчер трафика Azure обнаружит это и перенаправит клиентов в другую работоспособную конечную точку. Дополнительные сведения о диспетчере трафика см. в [этой статье](../traffic-manager/traffic-manager-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).

**Балансировка нагрузки приложений**

Служба шлюза приложений Azure предоставляет контроллер доставки приложений в виде службы. Шлюз приложений предлагает различные возможности балансировки нагрузки уровня 7 (HTTP/HTTPS), в том числе брандмауэр веб-приложения, для устранения уязвимости веб-приложений и защиты их от эксплойтов. Кроме того, он позволяет оптимизировать производительность веб-фермы за счет выполнения операции завершения SSL-запросов, требующей интенсивного использования ЦП, на шлюзе приложений. 

Кроме того, пользователи получают другие возможности маршрутизации уровня 7, включая циклическое распределение входящего трафика, соответствие сеансу на основе файлов cookie, маршрутизацию на основе URL-путей и возможность размещения нескольких веб-сайтов за одним шлюзом приложений. Шлюз приложений можно настроить как шлюз с доступом в Интернет, внутренний шлюз или же как сочетание этих вариантов. Шлюз приложений полностью управляется Azure. Он является масштабируемым и обладает высоким уровнем доступности. Для более эффективного управления предоставляется широкий набор возможностей ведения журнала и диагностики. Дополнительные сведения о шлюзе приложений см. в [этой статье](../application-gateway/application-gateway-introduction.md?toc=%2fazure%2fnetworking%2ftoc.json).

На схеме ниже показана маршрутизация трафика на основе URL-адресов при использовании шлюза приложений.

![Шлюз приложений](./media/networking-overview/application-gateway.png)

**Балансировка сетевой нагрузки**

Azure Load Balancer обеспечивает высокую производительность и балансировку нагрузки уровня 4 с низкой задержкой для всех протоколов UDP и TCP. Она управляет и входящими, и исходящими подключениями. Вы можете настроить общедоступные и внутренние конечные точки с балансировкой нагрузки, а также определить правила для сопоставления входящих подключений к внутреннему пулу, используя параметры проверки состояний TCP и HTTP, чтобы управлять доступностью служб. Дополнительные сведения о Load Balancer см. в [этой статье](../load-balancer/load-balancer-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).

На схеме ниже показано многоуровневое приложение с доступом к Интернету, использующее внешние и внутренние балансировщики нагрузки:

![Подсистема балансировки нагрузки](./media/networking-overview/load-balancer.png)

## <a name="security"></a>Безопасность

Входящий и исходящий трафик ресурсов Azure можно фильтровать следующими способами:

- **Сеть.** Для фильтрации входящего и исходящего трафика ресурсов Azure можно реализовать группы безопасности сети. Каждая группа безопасности сети содержит одно или несколько правил входящего и исходящего трафика. Каждое правило определяет исходные IP-адреса, конечные IP-адреса, порт и протокол, на основе которых выполняется фильтрация трафика. Группы безопасности сети можно применить к отдельным подсетям и виртуальным машинам. Дополнительные сведения о группах безопасности сети см. в статье [Фильтрация сетевого трафика с помощью групп безопасности сети](../virtual-network/security-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Приложение.** Используя шлюз приложений с брандмауэром веб-приложения, вы можете устранить уязвимости веб-приложений и защитить их от эксплойтов. Типичными примерами являются атаки путем внедрения кода SQL, межсайтовые сценарии и неправильно сформированные заголовки. Шлюз приложений фильтрует этот трафик и предотвращает его попадание на веб-серверы. Вы можете настроить правила, которые хотите включить. Благодаря возможности настроить политики согласования SSL вы можете отключить определенные политики. Дополнительные сведения о брандмауэре веб-приложения см. в [этой статье](../application-gateway/application-gateway-web-application-firewall-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).

Если вам нужны сетевые возможности, не предоставляемые Azure, или вы хотите использовать приложения сети, доступные в локальной среде, реализуйте эти продукты на виртуальных машинах и подключите их к своей виртуальной сети. В [Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/category/networking?page=1&subcategories=appliances) доступны несколько виртуальных машин с приложениями сети, которые вы можете в настоящее время использовать. Эти предварительно настроенные виртуальные машины обычно называются виртуальными сетевыми модулями. Они поставляются с такими приложениями, как брандмауэр и приложения, оптимизирующие глобальную сеть.

## <a name="routing"></a>Маршрутизация

Azure создает стандартные таблицы маршрутов, используя которые ресурсы, подключенные к любой подсети в любой сети, могут взаимодействовать. Чтобы переопределить маршруты по умолчанию, создаваемые в Azure, используйте следующие типы маршрутов:
- **Определяемые пользователем маршруты.** Вы можете создать пользовательские таблицы маршрутов с маршрутами, определяющими направление передачи трафика для каждой подсети. Дополнительные сведения об определяемых пользователем маршрутах см. в [этой статье](../virtual-network/virtual-networks-udr-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Протокол BGP.** При подключении виртуальной сети к локальной сети с помощью VPN-шлюза или канала ExpressRoute Azure вы можете распространить маршруты BGP в виртуальных сетях. Стандартный протокол маршрутизации BGP обычно используется в Интернете для обмена данными о маршрутизации и доступности между двумя или несколькими сетями. В контексте виртуальных сетей Azure протокол BGP используется VPN-шлюзами Azure и локальными VPN-устройствами (так называемые узлы BGP) для обмена данными о маршрутах. Это позволяет информировать участников обмена о доступности и возможности передавать префиксы через шлюзы или маршрутизаторы. Также BGP позволяет передавать трафик транзитом через несколько сетей. Для этого шлюз BGP распространяет на все известные ему узлы BGP информацию о маршрутах, полученную от остальных узлов BGP. Дополнительные сведения о протоколе BGP см. в статье [Обзор использования BGP с VPN-шлюзами Azure](../vpn-gateway/vpn-gateway-bgp-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).

## <a name="manageability"></a>Управляемость

Azure предоставляет следующие средства мониторинга сети и управления ею:
- **Журналы действий.** Все ресурсы Azure имеют журналы действий, в которых содержатся сведения о выполненных операциях, их состоянии и пользователе, который их инициировал. Дополнительные сведения о журналах действий см. в [этой статье](../monitoring-and-diagnostics/monitoring-overview-activity-logs.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Журналы диагностики.** Периодические и спонтанные события, создаваемые сетевыми ресурсами, регистрируются в журналах в учетных записях службы хранилища Azure, отправляются в концентратор событий Azure или в Log Analytics. Эти журналы содержат подробные сведения о работоспособности ресурса. Журналы диагностики доступны для Load Balancer (с выходом в Интернет), групп безопасности сети, маршрутов и шлюза приложений. Дополнительные сведения о журналах диагностики см. в статье [Сбор и использование диагностических данных из ресурсов Azure](../monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Метрики.** Метрики представляют собой измерения производительности и счетчики, значения которых собираются за определенный период времени в ресурсах. Метрики можно использовать для активации оповещений на основе пороговых значений. Сейчас метрики доступны в шлюзе приложений. Дополнительные сведения о метриках см. в [этой статье](../monitoring-and-diagnostics/monitoring-overview-metrics.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Устранение неполадок.** Сведения об устранении неполадок можно просмотреть непосредственно на портале Azure. Эти сведения позволяют устранять распространенные проблемы с ExpressRoute, VPN-шлюзом, шлюзом приложений, журналами безопасности сети, маршрутами, DNS, Load Balancer и диспетчером трафика.
- **Управление доступом на основе ролей (RBAC).** Благодаря этой возможности вы можете управлять разрешениями на создание и администрирование сетевых ресурсов. Дополнительные сведения о RBAC см. в статье [Начало работы с управлением доступом на основе ролей на портале Azure](../role-based-access-control/overview.md?toc=%2fazure%2fnetworking%2ftoc.json). 
- **Запись пакетов.** Служба Наблюдателя за сетями Azure позволяет выполнять запись пакетов через расширение виртуальной машины. Эта возможность доступна на виртуальных машинах Linux и Windows. Дополнительные сведения о возможностях записи пакетов см. в [этой статье](../network-watcher/network-watcher-packet-capture-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Проверка IP-потоков.** Наблюдатель за сетями позволяет проверять IP-потоки между виртуальной машиной Azure и удаленным ресурсом, чтобы определить, разрешены или запрещены пакеты. Эта возможность помогает администраторам быстро определять проблемы с подключением. Дополнительные сведения о проверке IP-потоков см. в [этой статье](../network-watcher/network-watcher-ip-flow-verify-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Устранение неполадок с VPN-подключением.** Средство устранения проблем с VPN-подключениями в Наблюдателе за сетями позволяет отправлять запросы на подключение или к шлюзу, а также проверять работоспособность ресурсов. Дополнительные сведения об устранении неполадок с VPN-подключениями см. в [этой статье](../network-watcher/network-watcher-troubleshoot-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).
- **Просмотр топологии сети.** Наблюдатель за сетями позволяет просматривать графическое представление сетевых ресурсов в виртуальной сети. Дополнительные сведения о просмотре топологии сети см. в [этой статье](../network-watcher/network-watcher-topology-overview.md?toc=%2fazure%2fnetworking%2ftoc.json).

## <a name="tools"></a>Средства развертывания и настройки

Чтобы развернуть и настроить сетевые ресурсы Azure, используйте любое из этих средств:

- **Портал Azure.** Графический пользовательский интерфейс, выполняемый в браузере. Откройте [портал Azure](http://portal.azure.com).
- **Azure PowerShell.** Программы командной строки для управления Azure на компьютерах с Windows. Дополнительные сведения об Azure PowerShell см. в [этой статье](/powershell/azure/overview?view=azurermps-3.8.0?toc=%2fazure%2fnetworking%2ftoc.json).
- **Интерфейс командной строки Azure (Azure CLI).** Программы командной строки для управления Azure на компьютерах с Linux, macOS и Windows. Дополнительные сведения об Azure CLI см. в [этой статье](/cli/azure/get-started-with-azure-cli?toc=%2fazure%2fnetworking%2ftoc.json).
- **Шаблоны Azure Resource Manager.** Файл (в формате JSON), определяющий инфраструктуру и конфигурацию решения Azure. Этот шаблон можно использовать, чтобы повторно развертывать решение на протяжении всего его жизненного цикла и гарантировать, что ресурсы развертываются в согласованном состоянии. Дополнительные сведения и рекомендации по созданию шаблонов см. в [этой статье](../azure-resource-manager/resource-manager-template-best-practices.md?toc=%2fazure%2fnetworking%2ftoc.json). Шаблоны можно развертывать с помощью портала Azure, интерфейса командной строки или PowerShell. Чтобы немедленно приступить к работе с шаблонами, разверните один из предварительно настроенных шаблонов в библиотеке [шаблонов быстрого запуска Azure](https://azure.microsoft.com/resources/templates/?term=network). 

## <a name="pricing"></a>Цены

Некоторые сетевые службы Azure тарифицируются, а другие предоставляются бесплатно. Дополнительные сведения см. на страницах цен на [виртуальную сеть](https://azure.microsoft.com/pricing/details/virtual-network), [VPN-шлюз](https://azure.microsoft.com/pricing/details/vpn-gateway), [шлюз приложений](https://azure.microsoft.com/pricing/details/application-gateway/), [Load Balancer](https://azure.microsoft.com/pricing/details/load-balancer), [Наблюдатель за сетями](https://azure.microsoft.com/pricing/details/network-watcher), [DNS](https://azure.microsoft.com/pricing/details/dns), [диспетчер трафика](https://azure.microsoft.com/pricing/details/traffic-manager) и [ExpressRoute](https://azure.microsoft.com/pricing/details/expressroute).

## <a name="next-steps"></a>Дополнительная информация

- Создайте первую виртуальную сеть и подключите к ней несколько виртуальных машин, выполнив действия, описанные в [этой статье](../virtual-network/quick-create-portal.md?toc=%2fazure%2fnetworking%2ftoc.json).
- Подключите свой компьютер к виртуальной сети, выполнив действия, описанные в статье [Настройка подключения типа "точка — сеть" к виртуальной сети с помощью портала Azure](../vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal.md?toc=%2fazure%2fnetworking%2ftoc.json).
- Реализуйте балансировку интернет-трафика на общедоступные серверы, выполнив действия, описанные в статье [Создание подсистемы балансировки нагрузки для Интернета на портале Azure](../load-balancer/load-balancer-get-started-internet-portal.md?toc=%2fazure%2fnetworking%2ftoc.json).
