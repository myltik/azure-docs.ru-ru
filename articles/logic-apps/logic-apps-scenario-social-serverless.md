---
title: Сценарий создания панели мониторинга сведений о клиентах с использованием беcсерверных средств в Azure | Документация Майкрософт
description: Сведения о том, как можно управлять отзывами от клиентов, данными социальных сетей и многим другим, создав панель мониторинга с помощью Функций Azure и Azure Logic Apps.
keywords: ''
services: logic-apps
author: jeffhollan
manager: jeconnoc
editor: ''
documentationcenter: ''
ms.assetid: d565873c-6b1b-4057-9250-cf81a96180ae
ms.service: logic-apps
ms.workload: logic-apps
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/15/2018
ms.author: jehollan; LADocs
ms.openlocfilehash: 3ee3ec3107cf8aad834e8201405c9aa833d838af
ms.sourcegitcommit: 6f6d073930203ec977f5c283358a19a2f39872af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35299966"
---
# <a name="create-a-streaming-customer-insights-dashboard-with-azure-logic-apps-and-azure-functions"></a>Создание панели мониторинга потоковой передачи сведений о клиентах с помощью Функций Azure и Azure Logic Apps.

Azure предлагает беcсерверные средства для быстрого создания и размещения приложений в облаке, не задумываясь об инфраструктуре. В этом руководстве мы создадим панель мониторинга, которая будет запускаться при получении отзывов от клиентов, анализировать отзывы с помощью машинного обучения и публиковать аналитику в источник, например Power BI или Azure Data Lake.

Для этого решения вы используете такие ключевые компоненты Azure для бессерверных приложений: [Функции Azure](https://azure.microsoft.com/services/functions/) и [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).
Azure Logic Apps представляет беcсерверный обработчик рабочего процесса в облаке, поэтому вы можете создавать оркестрации бессерверных компонентов и подключаться к более чем 200 службам и API. Функции Azure предоставляют беcсерверные вычисления в облаке. В этом решении Функции Azure используются для пометки пользовательских твитов на основе предопределенных ключевых слов.

В этом случае вы создаете приложение логики, которое запускает поиск отзывов клиентов. К некоторым соединителям, которые помогают реагировать на отзывы от клиентов, относятся Outlook.com, Office 365, Survey Monkey, Twitter и [HTTP-запрос из веб-формы](https://blogs.msdn.microsoft.com/logicapps/2017/01/30/calling-a-logic-app-from-an-html-form/). Рабочий процесс, который вы создаете, отслеживает хэштег в Twitter.

Вы можете [создать все решение в Visual Studio](../logic-apps/quickstart-create-logic-apps-with-visual-studio.md) и [развернуть решение с помощью шаблона Azure Resource Manager](../logic-apps/logic-apps-create-deploy-template.md). Пошаговые инструкции по созданию этого решения см. [в этом видео Channel 9](http://aka.ms/logicappsdemo). 

## <a name="trigger-on-customer-data"></a>Триггер, срабатываемый при получении данных клиента

1. На портале Azure или в Visual Studio создайте пустое приложение логики. 

   Если вы не знакомы с приложениями логики, перейдите к [краткому руководству по его созданию на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md) или [в Visual Studio](../logic-apps/quickstart-create-logic-apps-with-visual-studio.md).

2. В конструкторе приложений логики найдите и добавьте триггер Twitter, в котором есть действие **When a new tweet is posted** (При публикации нового твита).

3. Настройте триггер для прослушивания твитов по ключевому слову или хэштегу.

   Свойство повторения определяет, как часто приложение логики будет проверять наличие новых элементов с помощью триггеров на основе опроса, таких как триггер Twitter.

   ![Пример триггера Twitter][1]

Это приложение логики реагирует на все новые твиты. Затем вы можете взять и проанализировать данные твита, чтобы лучше понять настроение отзыва. 

## <a name="analyze-tweet-text"></a>Анализ текста твита

Чтобы понять настроение исходя из текста, вы можете использовать [Azure Cognitive Services](https://azure.microsoft.com/services/cognitive-services/).

1. В конструкторе приложений логики выберите для созданного триггера пункт **Новый шаг**.

2. Найдите соединитель **Текстовая аналитика**.

3. Выберите действие **Detect Sentiment** (Определение тональности).

4. При запросе введите допустимый ключ Cognitive Services для службы текстовой аналитики.

5. В разделе **Текст запроса** выберите поле **Текст твита**, которое содержит текст в качестве входных данных для анализа.

После того, как вы получите данные твита и его аналитику, можно использовать несколько других соответствующих соединителей и их действия:

* **Power BI. Добавление строк в набор данных потоковой передачи**. Входящие твиты можно просматривать на панели мониторинга Power BI.
* **Azure Data Lake. Добавление файла**. Данные клиента добавляются в набор данных Azure Data Lake для включения в задания аналитики.
* **SQL. Добавление строк**. Данные можно сохранить в базе данных для последующего извлечения.
* **Slack. Отправка сообщения**. Канал Slack получает оповещение об отрицательном отзыве, для которого нужно предпринять действие.

Можно также создать Функцию Azure, чтобы иметь возможность выполнять пользовательскую обработку данных. 

## <a name="process-data-with-azure-functions"></a>Обработка данных с помощью Функций Azure

Перед созданием функции создайте приложение-функцию в вашей подписке Azure. Кроме того, чтобы ваше приложение логики могло непосредственно вызывать функцию, она должна иметь привязку триггера HTTP, например, используйте шаблон **HttpTrigger**. Узнайте, [как создать свое первое приложение-функцию и функцию на портале Azure](../azure-functions/functions-create-first-azure-function-azure-portal.md).

Для этого сценария используйте текст твита в качестве текста запроса для вашей функции Azure. В коде функции задайте логику, определяющую, что содержит текст твита: ключевое слово или фразу. Используйте простую или сложную функцию в зависимости от реализуемого сценария.
В конце функции верните в приложение логики ответ с данными, например, простое логическое значение, такое как `containsKeyword`, или cоставной объект.

> [!TIP]
> При доступе к сложному ответу от функции в приложении логики **используйте действие "Анализ JSON"**.

Когда вы закончите, сохраните функцию, а затем добавьте ее в качестве действия в приложение логики, которое вы создаете.

## <a name="add-azure-function-to-logic-app"></a>Добавление функции Azure в приложение логики

1. В конструкторе приложений логики в действии **Определить тональность** выберите **Новый шаг**.

2. Найдите соединитель **Функции Azure**, а затем выберите созданную функцию.

3. В поле **Текст запроса** выберите **Текст твита**.

![Настройка шага Функции Azure][2]

## <a name="run-and-monitor-your-logic-app"></a>Запуск и мониторинг приложения логики

Чтобы просмотреть текущие или предыдущие запуски приложения логики, вы можете использовать расширенные возможности отладки и мониторинга, которые Azure Logic Apps предоставляет на портале Azure, в Visual Studio или с помощью интерфейсов API и пакетов SDK для Azure REST.

Чтобы легко протестировать приложение логики, в конструкторе приложений логики выберите **Запустить триггер**. Триггер выполняет опрос твитов на основе указанного расписания, пока не будет найден твит, который соответствует указанным критериям. Конструктор отображает актуальное представление этого запуска в ходе его выполнения.

Чтобы просмотреть предыдущие журналы запусков в Visual Studio или на портале Azure: 

* Откройте Visual Studio Cloud Explorer. Найдите ваше приложение логики и откройте контекстное меню приложения. Щелкните **Открыть журнал запусков**.

* Найдите приложение логики на портале Azure. В меню приложения логики щелкните **Обзор**. 

## <a name="create-automated-deployment-templates"></a>Создание шаблонов для автоматического развертывания

После создания решения приложения логики вы можете сохранить и развернуть его в качестве [шаблона Azure Resource Manager](../azure-resource-manager/resource-group-overview.md#template-deployment) в любом регионе Azure в мире. Вы можете использовать эту возможность, чтобы изменить параметры как для создания различных версий вашего приложения, так и для интеграции вашего решения в конвейер сборки и выпуска. Функции Azure также можно включить в шаблон развертывания таким образом, чтобы всем решением вместе со всеми зависимостями можно было управлять как одним шаблоном. Дополнительные сведения см. в статье [Создание шаблонов для развертывания приложений логики и управления выпусками](../logic-apps/logic-apps-create-deploy-template.md).

Пример шаблона развертывания с функцией Azure можно найти в [репозитории шаблонов быстрого запуска Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/101-function-app-create-dynamic).

## <a name="next-steps"></a>Дополнительная информация

* [Распространенные сценарии, примеры, учебники и пошаговые руководства для Azure Logic Apps](logic-apps-examples-and-scenarios.md)

<!-- Image References -->
[1]: ./media/logic-apps-scenario-social-serverless/twitter.png
[2]: ./media/logic-apps-scenario-social-serverless/function.png