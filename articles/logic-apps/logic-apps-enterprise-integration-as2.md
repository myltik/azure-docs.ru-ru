---
title: Использование сообщений AS2 для интеграции с предприятием B2B в Azure Logic Apps | Документация Майкрософт
description: Обмен сообщениями AS2 для интеграции с предприятием B2B с помощью Azure Logic Apps
services: logic-apps
documentationcenter: .net,nodejs,java
author: divyaswarnkar
manager: jeconnoc
editor: ''
ms.assetid: c9b7e1a9-4791-474c-855f-988bd7bf4b7f
ms.service: logic-apps
ms.workload: integration
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/08/2017
ms.author: LADocs; divswa
ms.openlocfilehash: 8984b76c68ebd562ce9e5af9bded859b38d498da
ms.sourcegitcommit: 6f6d073930203ec977f5c283358a19a2f39872af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35298245"
---
# <a name="exchange-as2-messages-for-enterprise-integration-with-logic-apps"></a>Обмен сообщениями AS2 для интеграции с предприятием с помощью приложений логики

Прежде чем вы начнете обмениваться сообщениями AS2 с помощью Azure Logic Apps, нужно создать соглашение AS2 и сохранить его в вашей учетной записи интеграции. Ниже описаны действия по созданию соглашения AS2.

## <a name="before-you-start"></a>Перед началом работы

Вам понадобится следующее:

* [учетная запись интеграции](../logic-apps/logic-apps-enterprise-integration-accounts.md), которая уже определена и связана с подпиской Azure;
* как минимум два [партнера](logic-apps-enterprise-integration-partners.md), уже определенные в учетной записи интеграции и настроенные с квалификатором AS2 в разделе **бизнес-идентификаторов**.

> [!NOTE]
> При создании соглашения содержимое его файла должно соответствовать типу соглашения.    

После [создания учетной записи интеграции](../logic-apps/logic-apps-enterprise-integration-accounts.md) и [добавления партнеров](logic-apps-enterprise-integration-partners.md) вы можете создать соглашение AS2. Следуйте действиям, описанным ниже.

## <a name="create-an-as2-agreement"></a>Создание соглашения AS2

1.  Войдите на [портал Azure](http://portal.azure.com "Портал Azure").  

2. В главном меню Azure выберите **Все службы**. Введите в поле поиска "интеграция" и выберите в результатах поиска **Учетные записи интеграции**.

   ![Поиск учетной записи интеграции](./media/logic-apps-enterprise-integration-as2/overview-1.png)

   > [!TIP]
   > Если раздел **Все службы** не отображается, разверните меню. В верхней области свернутого меню выберите действие **Показать текстовые подписи**.

3. В разделе **Учетные записи интеграции** выберите учетную запись интеграции, в которой нужно создать соглашение.

   ![Выбор учетной записи интеграции для создания соглашения](./media/logic-apps-enterprise-integration-overview/overview-3.png)

4. Щелкните плитку **Соглашения**. Если плитка "Соглашения" отсутствует, добавьте ее.

    ![Выбор плитки "Соглашения"](./media/logic-apps-enterprise-integration-as2/agreement-1.png)

5. В разделе **Соглашения** щелкните **Добавить**.

    ![Кнопка "Добавить"](./media/logic-apps-enterprise-integration-as2/agreement-2.png)

6. В колонке **Добавить** введите **имя** соглашения. Для **типа соглашения** выберите **AS2**. Заполните поля **Главный партнер**, **Главный идентификатор**, **Гостевой партнер** и **Гостевой идентификатор**.

    ![Сведения о соглашении](./media/logic-apps-enterprise-integration-as2/agreement-3.png)  

    | Свойство | ОПИСАНИЕ |
    | --- | --- |
    | ИМЯ |Имя соглашения |
    | Тип соглашения | AS2 |
    | "Host Partner" (Главный партнер) |Для соглашения нужно указать главного партнера и партнера-гостя. Главный партнер представляет организацию, которая настраивает соглашение. |
    | "Host Identity" (Идентификатор главного партнера) |Идентификатор главного партнера. |
    | "Guest Partner" (Партнер-гость) |Для соглашения нужно указать главного партнера и партнера-гостя. Партнер-гость представляет организацию, которая имеет деловые отношения с главным партнером. |
    | Guest Identity |Идентификатор гостевого партнера |
    | "Receive Settings" (Параметры получения) |Эти свойства применяются ко всем сообщениям, получаемым посредством соглашения. |
    | "Send Settings" (Параметры отправки) |Эти свойства применяются ко всем сообщениям, отправляемым посредством соглашения. |

## <a name="configure-how-your-agreement-handles-received-messages"></a>Настройка обработки полученных сообщений соглашением

После определения свойств соглашения вы можете настроить идентификацию и обработку входящих сообщений, полученных от партнера, с помощью этого соглашения.

1.  В колонке **Добавить** выберите **Настройки получения**.
Настройте эти свойства в соответствии с вашим соглашением с партнером, с которым вы будете обмениваться сообщениями. Ниже представлена таблица с описанием свойств раздела настроек получения.

    ![Раздел "Настройки получения"](./media/logic-apps-enterprise-integration-as2/agreement-4.png)

2. При необходимости можно переопределить свойства входящих сообщений, установив флажок **Переопределить свойства сообщения**.

3. Чтобы требовать наличия подписи во всех входящих сообщениях, установите флажок **Сообщение должно быть подписано**. Для проверки подписи сообщений выберите существующий [открытый сертификат для гостевого партнера](../logic-apps/logic-apps-enterprise-integration-certificates.md) в списке **Сертификат**. Если у вас нет сертификата, создайте его.

4.  Чтобы требовать шифрования всех входящих сообщений, установите флажок **Сообщение должно быть зашифровано**. Для расшифровки входящих сообщений выберите существующий [закрытый сертификат для главного партнера](../logic-apps/logic-apps-enterprise-integration-certificates.md) в списке **Сертификат**. Если у вас нет сертификата, создайте его.

5. Чтобы требовать сжатия сообщений, установите флажок **Сообщение должно быть сжато**.

6. Чтобы отправлять синхронное уведомление о состоянии сообщения (MDN) для полученных сообщений, установите флажок **Отправить MDN**.

7. Чтобы отправлять подписанные уведомления о состоянии полученных сообщений, установите флажок **Отправить подписанное MDN**.

8. Чтобы отправлять асинхронные уведомления о состоянии полученных сообщений, установите флажок **Отправить асинхронное MDN**.

9. После выполнения описанных выше действий нажмите кнопку **ОК**, чтобы сохранить заданные параметры.

Ваше соглашение готово к обработке входящих сообщений, соответствующих выбранным параметрам.

| Свойство | ОПИСАНИЕ |
| --- | --- |
| Override message properties |Указывает, что свойства в полученных сообщениях могут быть переопределены. |
| Message should be signed |Указывает, что сообщения должны содержать цифровую подпись в сообщениях. Настройте общий сертификат гостевого партнера для проверки подписи.  |
| Message should be encrypted |Указывает, что сообщения должны быть зашифрованы. Незашифрованные сообщения будут отклонены. Настройте закрытый сертификат главного партнера для расшифровки сообщений.  |
| Message should be compressed |Указывает, что сообщения должны быть сжаты. В противном случае сообщения будут отклонены. |
| "MDN Text" (Текст MDN) |Уведомление о состоянии сообщения (MDN) по умолчанию, отправляемое отправителю сообщения. |
| "Send MDN" (Отправлять MDN) |Указывает, что должны отправляться уведомления о состоянии сообщения. |
| "Send signed MDN" (Отправлять MDN с подписью) |Указывает, что уведомления о состоянии сообщения должны быть подписаны. |
| "MIC Algorithm" (Алгоритм контроля целостности учетных данных) |Выберите алгоритм для подписания сообщений. |
| "Send asynchronous MDN" (Отправлять асинхронные MDN) | Указывает, что сообщения должны отправляться асинхронно. |
| URL-адрес | Укажите URL-адрес для отправки уведомлений о состоянии сообщений (MDN). |

## <a name="configure-how-your-agreement-sends-messages"></a>Настройка отправки сообщений соглашением

Вы можете настроить идентификацию и обработку исходящих сообщений, которые вы отправляете партнерам, с помощью этого соглашения.

1.  В колонке **Добавить** выберите **Настройки отправки**.
Настройте эти свойства в соответствии с вашим соглашением с партнером, с которым вы будете обмениваться сообщениями. Ниже представлена таблица с описанием свойств раздела настроек отправки.

    ![Задание свойств "Настройки отправки"](./media/logic-apps-enterprise-integration-as2/agreement-51.png)

2. Чтобы отправлять партнеру подписанные сообщения, установите флажок **Включить подпись сообщений**. Для подписи сообщений в списке **Алгоритм MIC** выберите *алгоритм MIC закрытого сертификата для главного партнера*. В списке **Сертификат** выберите существующий [закрытый сертификат для главного партнера](../logic-apps/logic-apps-enterprise-integration-certificates.md).

3. Чтобы отправлять партнеру зашифрованные сообщения, установите флажок **Включить шифрование сообщений**. Для шифрования сообщений в списке **Алгоритм шифрования** выберите *алгоритм открытого сертификата для гостевого партнера*.
В списке **Сертификат** выберите существующий [открытый сертификат для гостевого партнера](../logic-apps/logic-apps-enterprise-integration-certificates.md).

4. Для сжатия сообщений установите флажок **Включить сжатие сообщений**.

5. Чтобы разворачивать HTTP-заголовки Content-Type в одну строку, установите флажок **Раскрыть заголовки HTTP**.

6. Чтобы получать синхронные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить MDN**.

7. Чтобы получать подписанные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить подписанное MDN**.

8. Чтобы получать асинхронные уведомления о состоянии сообщения для отправленных сообщений, установите флажок **Запросить асинхронное MDN**. При выборе этого параметра введите URL-адрес, куда будут отправляться уведомления о состоянии сообщения.

9. Чтобы требовать невозможности отказа от получения, установите флажок **Включить NRR**.  

10. Чтобы задать формат алгоритма для использования контроля целостности учетных данных или входа в исходящие заголовки сообщения AS2 или MDN, выберите **Формат алгоритма SHA2**.  

11. После выполнения описанных выше действий нажмите кнопку **ОК**, чтобы сохранить заданные параметры.

Ваше соглашение готово к обработке исходящих сообщений, соответствующих выбранным параметрам.

| Свойство | ОПИСАНИЕ |
| --- | --- |
| "Enable message signing" (Включить подписание сообщений) |Указывает, что все сообщения, отправляемые посредством соглашения, должны быть подписаны. |
| "MIC Algorithm" (Алгоритм контроля целостности учетных данных) |Алгоритм, используемый для подписания сообщений. Позволяет настроить алгоритм контроля целостности учетных данных закрытого сертификата главного партнера, используемый для подписывания сообщений. |
| Сертификат |Выберите сертификат, используемый для подписания сообщений. Позволяет настроить закрытый сертификат главного партнера, используемый для подписывания сообщений. |
| "Enable message encryption" (Включить шифрование сообщений) |Указывает, что все сообщения, отправляемые посредством соглашения, должны быть зашифрованы. Позволяет настроить алгоритм открытого сертификата гостевого партнера, используемый для шифрования сообщений. |
| "Encryption Algorithm" (Алгоритм шифрования) |Алгоритм, используемый для шифрования сообщений. Позволяет настроить открытый сертификат гостевого партнера, используемый для шифрования сообщений. |
| Сертификат |Сертификат, используемый для шифрования сообщений. Позволяет настроить закрытый сертификат гостевого партнера, используемый для шифрования сообщений. |
| Включить сжатие сообщений |Указывает, что все сообщения, отправляемые посредством соглашения, должны быть сжаты. |
| "Unfold HTTP headers" (Развернуть заголовки HTTP) |Позволяет разворачивать заголовки HTTP Content-Type в одну строку. |
| "Request MDN" (Запрашивать MDN) |Указывает, что для всех сообщений, отправляемые посредством соглашения, требуется уведомление о состоянии сообщения. |
| "Request signed MDN" (Запрашивать подписанные MDN) |Указывает, что все уведомления о состоянии сообщения, отправляемые для соглашения, должны быть подписаны. |
| "Request asynchronous MDN" (Запрашивать асинхронные MDN) |Указывает, что для этого соглашения требуются асинхронные уведомления о состоянии сообщения. |
| URL-адрес |Укажите URL-адрес для отправки уведомлений о состоянии сообщений (MDN). |
| "Enable NRR" (Включить NRR) |Указывает, что требуется использовать неотрекаемость от получения (NRR). Это атрибут связи, который предоставляет свидетельство того, что данные были доставлены куда следует. |
| Параметр "Формат алгоритма SHA2" |Выберите формат алгоритма для использования контроля целостности учетных данных или входа в исходящие заголовки сообщения AS2 или MDN. |

## <a name="find-your-created-agreement"></a>Поиск созданного соглашения

1. Настроив все свойства соглашения, нажмите кнопку **ОК** на странице **Добавить**, чтобы завершить создание соглашения и вернуться в учетную запись интеграции.

    В списке **Соглашения** появится созданное соглашение.

2. Вы также можете просмотреть соглашения в обзоре учетной записи интеграции. В меню учетной записи интеграции выберите **Обзор**, а затем щелкните плитку **Соглашения**. 

   ![Выбор плитки "Соглашения" для просмотра всех соглашений](./media/logic-apps-enterprise-integration-as2/agreement-6.png)

## <a name="view-the-swagger"></a>Просмотр Swagger
Ознакомьтесь с [дополнительными сведениями о Swagger](/connectors/as2/). 

## <a name="next-steps"></a>Дополнительная информация
* [Обзор пакета интеграции Enterprise](logic-apps-enterprise-integration-overview.md "Обзор пакета интеграции Enterprise")  
