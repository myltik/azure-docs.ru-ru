---
title: "Использование веб-службы Машинного обучения Azure с шаблоном веб-приложения | Документация Майкрософт"
description: "Использование шаблона веб-приложения в Azure Marketplace для использования прогнозной веб-службы в машинном обучении Azure."
keywords: "веб-служба, ввод в эксплуатацию, REST API, машинное обучение"
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: e0d71683-61b9-4675-8df5-09ddc2f0d92d
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/20/2017
ms.author: garye;raymondl
ms.openlocfilehash: 1c182403409966923440f359cb2514af7b7df9f3
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
---
# <a name="consume-an-azure-machine-learning-web-service-with-a-web-app-template"></a>Использование веб-службы машинного обучения Azure с шаблоном веб-приложения

Разработав прогнозную модель и развернув ее в виде веб-службы Azure при помощи Студии машинного обучения или таких средств, как R или Python, вы можете обращаться к рабочей модели с помощью REST API.

Существует несколько способов использования REST API и доступа к веб-службе. Например, можно создать приложение в C#, R или Python, используя образец кода, созданного при развертывании веб-службы (доступен на [портале веб-служб машинного обучения](https://services.azureml.net/quickstart) или на панели мониторинга веб-службы в Студии машинного обучения). Кроме того, можно использовать одновременно созданный для вас образец книги Microsoft Excel.

Но самым быстрым и легким способом доступа к веб-службе является доступ через шаблоны веб-приложений, доступные в [Azure Web App Marketplace](https://azure.microsoft.com/marketplace/web-applications/all/).

[!INCLUDE [machine-learning-free-trial](../../../includes/machine-learning-free-trial.md)]

## <a name="the-azure-machine-learning-web-app-templates"></a>Шаблоны веб-служб машинного обучения Azure
С помощью шаблонов веб-служб, доступных в Azure Marketplace, можно создать пользовательское веб-приложение, которое «знает» входные данные вашей веб-службы и ожидаемые результаты. Вам нужно всего лишь предоставить веб-приложению доступ к веб-службе и данным, а шаблон выполнит все остальные действия.

Доступны два шаблона:

* [шаблон веб-приложения службы «запрос — ответ» Azure ML;](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlaspnettemplateforrrs/)
* [шаблон веб-приложения службы пакетного выполнения Azure ML.](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlbeswebapptemplate/)

Каждый шаблон создает образец приложения ASP.NET, используя URI API и ключ для вашей веб-службы, и развертывает его как веб-сайт в Azure. Шаблон службы «запрос — ответ» (RRS) создает веб-приложение, которое позволяет отправлять одну строку данных в веб-службу для получения одного результата. Шаблон службы пакетного выполнения (BES) создает веб-приложение, которое позволяет отправлять несколько строк данных, чтобы получить несколько результатов.

Для использования этих шаблонов не требуется создавать код. Вы просто предоставляете ключ API и универсальный код ресурса (URI), а шаблон создается в приложении.

Чтобы получить ключ API и URI запроса для веб-службы, выполните следующие действия:

1. Для новой веб-службы на [портале веб-служб](https://services.azureml.net/quickstart) в верхнем меню щелкните **Веб-службы**. А для классической веб-службы щелкните **Classic Web Services** (Классические веб-службы).
2. Щелкните веб-службу, к которой необходимо получить доступ.
3. Для классической веб-службы щелкните конечную точку, к которой необходимо получить доступ.
4. В верхней части экрана щелкните **Consume** (Использовать).
5. Скопируйте и сохраните значение первичного (**Primary**) или вторичного ключа (**Secondary Key**).
6. При создании шаблона службы "запрос-ответ" (RRS) скопируйте универсальный код ресурса (URI) **Request-Response** (Запрос-ответ) и сохраните его. При создании шаблона службы пакетного выполнения (BES) скопируйте универсальный код ресурса (URI) **Batch Requests** (Пакетные запросы) и сохраните его.


## <a name="how-to-use-the-request-response-service-rrs-template"></a>Использование шаблона службы «запрос-ответ» (RRS)
Выполните эти действия, чтобы использовать шаблон веб-приложения RRS, как показано на схеме ниже.

![Использование веб-шаблона RRS][image1]


<!--    ![API Key][image3] -->

<!-- This value will look like this:
   
        https://ussouthcentral.services.azureml.net/workspaces/<workspace-id>/services/<service-id>/execute?api-version=2.0&details=true
   
    ![Request URI][image4] -->

1. Откройте [портал Azure](https://portal.azure.com), выполните **вход**, щелкните **Создать**, найдите и выберите **Azure ML Request-Response Service Web App** (Веб-приложение службы "запрос-ответ" Azure ML), а затем щелкните **Создать**. 
   
   * Присвойте веб-приложению уникальное имя. URL-адресом веб-приложения будет это имя с текстом `.azurewebsites.net.`. Например: `http://carprediction.azurewebsites.net.`
   * Выберите подписку Azure и службы, с которыми работает ваша веб-служба.
   * Щелкните **Создать**.
     
     ![Создать веб-приложение][image5]

4. Когда служба Azure завершит развертывание веб-приложения, щелкните **URL-адрес** на странице параметров веб-приложения в Azure или введите URL-адрес в веб-браузере. Например, `http://carprediction.azurewebsites.net.`
5. При первом запуске веб-приложение запросит ввести значения в поля **API Post URL** (URL-адрес записи API) и **Ключ API**.
   Введите значения, которые были сохранены ранее (**URI запроса** и **Ключ API** соответственно).
     
     Нажмите кнопку **Submit**(Отправить).
     
     ![Введите Post URI и ключ API][image6]

6. Веб-приложение отобразит страницу **Конфигурация веб-приложения** с текущими параметрами веб-службы. Здесь можно вносить изменения в параметры, используемые веб-приложением.
   
   > [!NOTE]
   > Изменение этих параметров влияет только на параметры этого веб-приложения. Это не изменяет параметры веб-службы по умолчанию. Например, если изменить параметр **Описание** , описание, отображаемое на панели мониторинга веб-службы в Студии машинного обучения, не изменится.
   > 
   > 
   
    Когда все будет готово, нажмите кнопку **Сохранить изменения**, а затем щелкните **На домашнюю страницу**.

7. На домашней странице можно ввести значения для отправки в веб-службу. Закончив, нажмите кнопку **Отправить** и получите результат.

Если вы хотите вернуться на страницу **Конфигурация**, перейдите на страницу `setting.aspx` веб-приложения. Например: `http://carprediction.azurewebsites.net/setting.aspx.`. Вам будет предложено ввести ключ API снова, чтобы получить доступ к странице и обновить параметры.

Можно остановить, перезапустить или удалить веб-приложения на портале Azure, как любое другое веб-приложение. При условии что приложение работает, можно перейти к домашнему веб-адресу и ввести новые значения.

## <a name="how-to-use-the-batch-execution-service-bes-template"></a>Использование шаблона службы пакетного выполнения (BES)
Шаблон веб-приложения BES можно использовать так же, как и шаблон RRS. Исключение состоит только в том, что создаваемое веб-приложение позволит передавать несколько строк данных и получать несколько результатов.

Источником входных значений для веб-службы пакетного выполнения может быть хранилище Azure или локальный файл. Результаты хранятся в контейнере хранилища Azure.
Таким образом, вам потребуется контейнер хранилища Azure для хранения результатов, возвращаемых веб-приложением. Вам также нужно будет подготовить входные данные.

![Использование веб-шаблона BES][image2]

1. Чтобы создать веб-приложение BES, выполните ту же процедуру, что и для шаблона RRS, кроме таких действий: перейдите по ссылке [Azure ML Batch Execution Service Web App Template](https://azure.microsoft.com/marketplace/partners/microsoft/azuremlbeswebapptemplate/) (Шаблон веб-приложения службы пакетного выполнения Azure ML), чтобы открыть шаблон BES в Azure Marketplace, а затем нажмите кнопку **Создать веб-приложение**.

2. Чтобы указать, куда следует сохранить результаты, введите сведения о целевом контейнере на домашней странице веб-приложения. Кроме того, укажите источник входных значений для веб-приложения: локальный файл или контейнер хранилища Azure.
   Нажмите кнопку **Submit**(Отправить).
   
    ![Сведения о хранилище][image7]

Веб-приложение отобразит страницу с состоянием задания.
После завершения задания будет указано расположение результатов в хранилище больших двоичных объектов Azure. Результаты также можно загрузить в локальный файл.

## <a name="for-more-information"></a>Дополнительные сведения
Дополнительная информация.

* Создание эксперимента машинного обучения в Студии машинного обучения — см. статью [Руководство по машинному обучению. Создание первого эксперимента по обработке и анализу данных в Студии машинного обучения Azure](create-experiment.md).
* Развертывание эксперимента машинного обучения в качестве веб-службы — см. статью [Развертывание веб-службы машинного обучения Azure](publish-a-machine-learning-web-service.md).
* Сведения о других способах доступа к веб-службе см. статье [Как использовать веб-службу машинного обучения Azure](consume-web-services.md).

[image1]: media/consume-web-service-with-web-app-template/rrs-web-template-flow.png
[image2]: media/consume-web-service-with-web-app-template/bes-web-template-flow.png
[image3]: media/consume-web-service-with-web-app-template/api-key.png
[image4]: media/consume-web-service-with-web-app-template/post-uri.png
[image5]: media/consume-web-service-with-web-app-template/create-web-app.png
[image6]: media/consume-web-service-with-web-app-template/web-service-info.png
[image7]: media/consume-web-service-with-web-app-template/storage.png
