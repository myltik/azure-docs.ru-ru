---
title: Использование веб-службы машинного обучения через Excel | Документация Майкрософт
description: Использование веб-службы Машинного обучения Azure в Excel
services: machine-learning
documentationcenter: ''
author: YasinMSFT
ms.author: yahajiza
manager: hjerez
editor: cgronlun
ms.assetid: 3f3cdd2f-1816-487e-ab78-530e01e9788f
ms.service: machine-learning
ms.component: studio
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 2/1/2018
ms.openlocfilehash: 14621e50a397bc1f1922a4c8fae638d6b42ab8ba
ms.sourcegitcommit: 944d16bc74de29fb2643b0576a20cbd7e437cef2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/07/2018
ms.locfileid: "34837071"
---
# <a name="consuming-an-azure-machine-learning-web-service-from-excel"></a>Использование веб-службы Машинного обучения Azure в Excel
 Студия машинного обучения Azure упрощает вызов веб-службы оценки непосредственно из Excel, избавляя от необходимости написания какого-либо кода.

При использовании Excel 2013 (или более поздней версии) или Excel Online рекомендуется также использовать [надстройку Excel](excel-add-in-for-web-services.md).

[!INCLUDE [machine-learning-free-trial](../../../includes/machine-learning-free-trial.md)]

## <a name="steps"></a>Действия
Опубликуйте веб-службу. [этой странице](walkthrough-5-publish-web-service.md) объясняется, как это сделать. В настоящее время функция книги Excel поддерживается только для служб обработки запросов и ответов с один выходом (то есть с одной меткой оценки). 

После создания веб-службы щелкните раздел **ВЕБ-СЛУЖБЫ** в левой части студии, а затем выберите веб-службу, которую нужно использовать в Excel.

**Классическая веб-служба**

1. На вкладке **Панель мониторинга** веб-службы есть строка для службы обработки **Запрос — ответ**. Если бы в этой службе был один выход, в строке отобразилась бы ссылка **Загрузить книгу Excel** .
   
    ![][1]
2. Щелкните **Download Excel Workbook**(Скачать книгу Excel).

**Новая веб-служба**

1. На портале веб-служб Машинного обучения Azure выберите **Consume**(Использование).
2. На странице "Consume" (Использование) в разделе **Web service consumption options** (Параметры использования веб-службы) щелкните значок Excel.

**Использование книги**

1. Откройте книгу.
2. Отобразится предупреждение системы безопасности. Нажмите кнопку **Разрешить изменение**.
   
    ![][2]
3. Отобразится предупреждение системы безопасности. Нажмите кнопку **Включить содержимое** , чтобы запустить макросы в электронной таблице.
   
    ![][3]
4. После включения макросов будет создана таблица. Синие столбцы представляют собой входные данные, или **ПАРАМЕТРЫ**, для веб-службы RRS. Обратите внимание на выходные данные службы RRS ( **ПРОГНОЗИРУЕМЫЕ ЗНАЧЕНИЯ** ), отмеченные зеленым цветом. После заполнения всех столбцов для указанной строки книга автоматически вызывает API оценки и отображает результаты оценки.
   
    ![][4]
5. Чтобы оценить несколько строк, заполните вторую строку данными, и вы получите прогнозируемые значения. Можно даже вставить несколько строк одновременно.

Для лучшей визуализации данных к прогнозируемым значениям можно применять все функции Excel (графики, Power Map, условное форматирование и пр.).    

## <a name="sharing-your-workbook"></a>Предоставление общего доступа к книге
Для выполнения макросов в электронную таблицу должен входить ключ API. Это означает, что общий доступ к книге нужно предоставлять только тем организациям и людям, которым вы доверяете.

## <a name="automatic-updates"></a>Автоматическое обновление
Служба RRS вызывается в двух следующих случаях:

1. когда впервые встречается строка, содержащая значения во всех столбцах **ПАРАМЕТРЫ**
2. в любое время при изменении значения в любом столбце **Параметры** в строке, содержащей значения во всех столбцах **Параметры**.

[1]: ./media/consuming-from-excel/excellink.png
[2]: ./media/consuming-from-excel/enableeditting.png
[3]: ./media/consuming-from-excel/enablecontent.png
[4]: ./media/consuming-from-excel/sampletable.png
