---
title: Руководство по расширенной подготовке данных для системы совместного использования велосипедов при помощи Azure Machine Learning Workbench
description: В этом руководстве вы выполните полную подготовку данных с помощью Azure Machine Learning Workbench.
services: machine-learning
author: ranvijaykumar
ms.author: ranku
manager: mwinkle
ms.reviewer: garyericson, jasonwhowell, mldocs
ms.service: machine-learning
ms.workload: data-services
ms.custom: mvc
ms.topic: tutorial
ms.date: 09/21/2017
ms.openlocfilehash: 51ed7dbead7f9085de563d2fb20c4e4a08f90bb2
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
---
# <a name="tutorial-use-azure-machine-learning-workbench-for-advanced-data-preparation-bike-share-data"></a>Руководство. Использование Azure Machine Learning Workbench для расширенной подготовки данных (система совместного использования велосипедов)
Машинное обучение Azure (предварительная версия) — это полнофункциональное интегрированное аналитическое решение для специалистов по обработке данных. Оно помогает подготавливать данные, разрабатывать эксперименты и развертывать модели в масштабе облака.

В этом руководстве вы будете использовать машинное обучение (предварительная версия), чтобы научиться выполнять следующие задачи:
> [!div class="checklist"]
> * Интерактивная подготовка данных с помощью средства подготовки данных в службе "Машинное обучение".
> * Импорт, преобразование и создание тестового набора данных.
> * Создание пакета подготовки данных.
> * Запуск пакета подготовки данных с использованием Python.
> * Создание набора данных для обучения с повторным использованием пакета подготовки данных для дополнительных входных файлов.
> * выполнение скриптов в локальном окне Azure CLI;
> * выполнение скриптов в облачной среде Azure HDInsight.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="prerequisites"></a>предварительным требованиям

* Локально установленное приложение Azure Machine Learning Workbench. Дополнительные сведения см. в [кратком руководстве по установке](../service/quickstart-installation.md).
* Если у вас не установлен Azure CLI, следуйте инструкциям по [установке последней версии Azure CLI](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest).
* [Кластер HDInsight Spark](how-to-create-dsvm-hdi.md#create-an-apache-spark-for-azure-hdinsight-cluster-in-azure-portal), созданный в Azure.
* Учетная запись хранения Azure.
* Навыки создания проектов в Workbench.
* Хоть это и не обязательно, вам будет удобно установить и использовать службу [Обозреватель службы хранилища Azure](https://azure.microsoft.com/features/storage-explorer/). Это позволит передавать, загружать и просматривать большие двоичные объекты в учетной записи хранения.

## <a name="data-acquisition"></a>Сбор данных
В этом руководстве используются [набор данных Hubway в Бостоне](https://s3.amazonaws.com/hubway-data/index.html) и сведения [NOAA](http://www.noaa.gov/) о погоде в Бостоне.

1. Загрузите файлы данных по ссылкам ниже в локальную среду разработки.

   * [Сведения о погоде в Бостоне](https://azuremluxcdnprod001.blob.core.windows.net/docs/azureml/bikeshare/BostonWeather.csv).

   * Сведения о поездках Hubway с веб-сайта Hubway.

      - [201501-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201501-hubway-tripdata.zip)
      - [201504-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201504-hubway-tripdata.zip)
      - [201510-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201510-hubway-tripdata.zip)
      - [201601-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201601-hubway-tripdata.zip)
      - [201604-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201604-hubway-tripdata.zip)
      - [201610-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201610-hubway-tripdata.zip)
      - [201701-hubway-tripdata.zip](https://s3.amazonaws.com/hubway-data/201701-hubway-tripdata.zip)

2. Распакуйте каждый ZIP-файл после загрузки.

## <a name="upload-data-files-to-azure-blob-storage"></a>Отправка файлов данных в хранилище BLOB-объектов Azure
В хранилище BLOB-объектов Azure можно разместить файлы данных.

1. Используйте учетную запись хранения, указанную для кластера HDInsight, с которым вы работаете.

    ![Учетные записи хранения кластера HDInsight](media/tutorial-bikeshare-dataprep/hdinsightstorageaccount.png)

2. Создайте контейнер **data-files** для хранения файлов данных **BikeShare**.

3. Передайте файлы данных. Передайте `BostonWeather.csv` в папку `weather`, а файлы данных поездок — в папку `tripdata`.

    ![Отправка файлов данных](media/tutorial-bikeshare-dataprep/azurestoragedatafile.png)

> [!TIP]
> Вы также можете использовать службу "Обозреватель службы хранилища" для передачи больших двоичных объектов. Используйте это средство, если требуется просмотреть содержимое любого файла, созданного при работе с руководством.

## <a name="learn-about-the-datasets"></a>Сведения о наборах данных
1. Файл со сведениями о __погоде в Бостоне__ содержит следующие поля для связанных с погодой данных, которые отображаются каждый час:

   * **DATE**;

   * **REPORTTPYE**;

   * **HOURLYDRYBULBTEMPF**;

   * **HOURLYRelativeHumidity**;

   * **HOURLYWindSpeed**.

2. Данные __Hubway__ упорядочены в файлах по годам и месяцам. Например, файл с именем `201501-hubway-tripdata.zip`— это CSV-файл с данными за январь 2015 г. Данные помещены в указанные ниже поля. Каждая строка представляет поездку на велосипеде:

   * **длительность поездки (в секундах)**;

   * **дата и время начала**;

   * **дата и время остановки**;

   * **имя и идентификатор начальной станции**;

   * **имя и идентификатор конечной станции**;

   * **идентификатор велосипеда;**

   * **тип пользователя (случайный — пользователь со временем поездки 24 или 72 часа; участник — пользователь, предпринимающий поездки ежегодно или ежемесячно)**;

   * **почтовый индекс (если пользователь является участником)**;

   * **пол (самостоятельно указывается участником)**.

## <a name="create-a-new-project"></a>Создание нового проекта
1. Запустите **Machine Learning Workbench** из меню "Пуск" или при помощи средства запуска.

2. Создайте проект в службе "Машинное обучение". Нажмите кнопку **+** на странице **Проекты** или последовательно выберите **Файл** > **Создать**.

   * Используйте шаблон **Bike Share**.

   * Назовите проект **BikeShare**. 

## <a id="newdatasource"></a>Создание источника данных

1. Создайте источник данных. Нажмите кнопку **Данные** (значок цилиндра) на панели слева, чтобы открыть представление **Данные**.

   ![Вкладка просмотра данных](media/tutorial-bikeshare-dataprep/navigatetodatatab.png)

2. Добавьте источник данных. Щелкните значок **+** и выберите **Add Data Source** (Добавить источник данных).

   ![Параметр Add Data Source (Добавить источник данных)](media/tutorial-bikeshare-dataprep/newdatasource.png)

## <a name="add-weather-data"></a>Добавление сведений о погоде

1. **Хранилище данных.** Выберите хранилище, в котором содержатся данные. Так как вы используете файлы, выберите **File(s)/Directory** (Файлы или каталог). Нажмите кнопку **Далее**, чтобы продолжить.

   ![Элемент File(s)/Directory (Файлы или каталог)](media/tutorial-bikeshare-dataprep/datasources.png)

2. **Выбор файла.** Добавьте сведения о погоде. Найдите и выберите файл `BostonWeather.csv`, переданный в хранилище BLOB-объектов ранее. Щелкните **Далее**.

   ![Выбранный файл BostonWeater.csv](media/tutorial-bikeshare-dataprep/azureblobpickweatherdatafile.png)

3. **Сведения о файле.** Проверьте схему обнаруженного файла. Machine Learning Workbench анализирует данные в файле и выводит схему для использования.

   ![Проверка сведений о файле](media/tutorial-bikeshare-dataprep/fileparameters.png)

   > [!IMPORTANT]
   > В некоторых случаях Workbench может не обнаружить правильную схему. Всегда проверяйте правильность параметров для набора данных. Убедитесь, что для сведений о погоде установлены следующие значения:
   >
   > * __Тип файла:__ файл с разделителями (csv, tsv, txt и т. д.).
   > * __Разделитель:__ запятая [,].
   > * __Символ в строке комментария:__ значение не задано.
   > * __Режим пропуска строк:__ не пропускать.
   > * __Кодировка файла:__ utf-8.
   > * __Режим повышения уровня для заголовков:__ использовать заголовки из первого файла.

   В режиме предварительного просмотра данных должны отображаться следующие столбцы:

   * **Путь**

   * **DATE**;

   * **REPORTTYPE**;

   * **HOURLYDRYBULBTEMPF**;
   
   * **HOURLYRelativeHumidity**;

   * **HOURLYWindSpeed**.

   Нажмите кнопку **Далее**, чтобы продолжить.

4. **Типы данных.** Проверьте типы данных, которые определяются автоматически. Machine Learning Workbench анализирует данные в файле и выводит сведения о типах данных для использования.

   a. Для этих данных измените **тип данных** для всех столбцов на **String**.

   > [!NOTE]
   > String используется для описания возможностей Workbench далее в этом руководстве. 

   ![Проверка типов данных](media/tutorial-bikeshare-dataprep/datatypedetection.png)

   Б. Нажмите кнопку __Далее__, чтобы продолжить. 

5. **Выборка.** Чтобы создать схему выборки, выберите **Изменить**. Выберите добавленную строку __Top 10000__ (Первые 10 000) и нажмите __Изменить__. Задайте для параметра __Sample Strategy__ (Стратегия выборки) значение **Full File** (Файл полностью), а затем выберите **Применить**.

   ![Добавление новой стратегии выборки](media/tutorial-bikeshare-dataprep/weatherdatasamplingfullfile.png)

   Для использования стратегии __Full File__ (Файл полностью), выберите запись __Full File__ (Файл полностью), а затем — __Set as Active__ (Установить как активный). Рядом с записью __Full File__ (Файл полностью) отобразится звездочка, указывающая на то, что стратегия активна.

   ![Активная стратегия Full File (Файл полностью)](media/tutorial-bikeshare-dataprep/fullfileactive.png)

   Нажмите кнопку **Далее**, чтобы продолжить.

6. **Столбец пути.** Раздел __Path Column__ (Столбец пути) позволяет добавить полный путь к файлу как столбец в импортированных данных. Выберите __Do Not Include Path Column__ (Не включать столбец пути).

   > [!TIP]
   > Включение столбца пути полезно в том случае, если вы импортируете папку со множеством файлов с различными именами. Это также полезно, если имена файлов содержат сведения, которые нужно извлечь позже.

   ![Параметр Path Column (Столбец пути), для которого задано значение Do Not Include Path Column (Не включать столбец пути)](media/tutorial-bikeshare-dataprep/pathcolumn.png)

7. **Завершение.** Чтобы завершить создание источника данных, выберите **Готово**.

    Откроется новая вкладка источника данных с именем __BostonWeather__. Пример данных отображается в представлении сетки. Пример построен на активной схеме выборки, которая рассматривалась ранее.

    Обратите внимание, что в области **Шаги** в правой части экрана отображаются отдельные действия, выполненные при создании этого источника данных.

   ![Отображение источника данных, примера и области шагов](media/tutorial-bikeshare-dataprep/weatherdataloaded.png)

### <a name="view-data-source-metrics"></a>Просмотр метрик источника данных

Выберите __Metrics__ (Метрики) в верхнем левом углу представления сетки для вкладки. В этом представлении отображаются сведения о распределении и другая статистическая информация для данных выборки.

![Отображение метрики](media/tutorial-bikeshare-dataprep/weathermetrics.png)

> [!NOTE]
> Чтобы настроить режим отображения статистических данных, используйте раскрывающийся список **Choose Metric** (Выбор метрики). Чтобы изменить представление сетки, устанавливайте или снимайте флажки напротив определенных метрик.

Чтобы вернуться к __просмотру данных__, в левом верхнем углу страницы выберите __Данные__.

## <a name="add-a-data-source-to-the-data-preparation-package"></a>Добавление источника данных в пакет подготовки данных

1. Чтобы начать подготовку данных, выберите __Подготовить__. 

2. При появлении запроса введите имя пакета для подготовки данных, например **BikeShare Data Prep**. 

3. Чтобы продолжить, нажмите кнопку __ОК__ .

   ![Диалоговое окно подготовки](media/tutorial-bikeshare-dataprep/dataprepdialog.png)

4. В разделе __Подготовка данных__ на вкладке __Данные__ отобразится новый пакет с именем **BikeShare Data Prep**. 

   Чтобы открыть пакет, выберите эту запись. 

5. Нажмите кнопку **>>**, чтобы развернуть __Dataflows__ и просмотреть потоки данных, содержащиеся в пакете. В этом примере единственным потоком данных является__BostonWeather__.

   > [!IMPORTANT]
   > Пакет может содержать несколько потоков данных.

   ![Потоки данных в пакете](media/tutorial-bikeshare-dataprep/weatherdataloadedingrid.png)

## <a name="filter-data-by-value"></a>Фильтрация данных по значению
1. Чтобы отфильтровать данные, щелкните правой кнопкой мыши ячейку с определенным значением и выберите __Фильтр__. Затем выберите тип фильтра.

2. Для этого руководства выберите ячейку, которая содержит значение `FM-15`. Установите для фильтра значение **Равно**.  Теперь данные фильтруются и возвращаются только строки, в которых для __REPORTTYPE__ установлено значение `FM-15`.

   ![Диалоговое окно фильтра](media/tutorial-bikeshare-dataprep/weatherfilterinfm15.png)

   > [!NOTE]
   > FM-15 — это тип объекта регулярной авиационной сводки погоды в метеорологическом терминале (METAR). Отчеты FM-15 эмпирически отслеживаются, чтобы предоставлялась наиболее исчерпывающая информация.

## <a name="remove-a-column"></a>Удаление столбца

Столбец __REPORTTYPE__ больше не нужен. Щелкните правой кнопкой мыши заголовок столбца и выберите **Remove Column** (Удалить столбец).

   ![Параметр Remove Column (Удалить столбец)](media/tutorial-bikeshare-dataprep/weatherremovereporttype.png)

## <a name="change-datatypes-and-remove-errors"></a>Изменение типов данных и устранение ошибок
1. Нажмите кнопку CTRL (Command ⌘ на компьютере Mac) при выделении заголовков столбцов, чтобы выбрать несколько столбцов одновременно. Выберите таким образом следующие заголовки столбцов:

   * **HOURLYDRYBULBTEMPF**;

   * **HOURLYRelativeHumidity**;

   * **HOURLYWindSpeed**.

2. Щелкните правой кнопкой мыши один из выбранных заголовков столбцов и выберите **Convert Field Type to Numeric** (Преобразовать тип поля в числовой). Этот параметр преобразует тип данных столбцов в числовой.

   ![Преобразование нескольких столбцов в числовые](media/tutorial-bikeshare-dataprep/weatherconverttonumeric.png)

3. Примените фильтр, чтобы получить значения с ошибками. В некоторых столбцах возникают проблемы с преобразованием данных. На такие проблемы указывает красный цвет __панели качества данных__ для столбца.

   Чтобы удалить строки с ошибками, щелкните правой кнопкой мыши заголовок столбца **HOURLYDRYBULBTEMPF**. Выберите **Фильтровать столбец**. Используйте для параметра **I Want To** (Требуется) значение по умолчанию **Keep Rows** (Сохранить строки). Измените раскрывающийся список **условий** таким образом, чтобы при выборе условия определялись как **не являющиеся ошибкой**. Нажмите кнопку **ОК**, чтобы применить фильтр.

   ![Фильтрация ошибочных значений](media/tutorial-bikeshare-dataprep/filtererrorvalues.png)

4. Чтобы устранить ошибки в оставшихся строках в других столбцах, повторите процедуру фильтрации для столбцов **HOURLYRelativeHumidity** и **HOURLYWindSpeed**.

## <a name="use-by-example-transformations"></a>Преобразования с использованием образца

Чтобы использовать данные прогноза для двухчасовых интервалов времени, вычислите для них средние погодные условия. Выполните следующие действия:

* Разделите столбец **DATE** на отдельные столбцы **Date** и **Time**. В разделе далее представлены более подробные инструкции.

* Получите столбец **Hour_Range** из столбца **Time**. В разделе далее представлены более подробные инструкции.

* Получите столбец **Date\_Hour\_Range** из столбцов **DATE** и **Hour_Range**. В разделе далее представлены более подробные инструкции.

### <a name="split-column-by-example"></a>Разделение столбца по образцу

1. Разделите столбец **DATE** на отдельные столбцы **Date** и **Time**. Щелкните правой кнопкой мыши заголовок столбца **DATE** и выберите **Split Column by Example** (Разделить столбец по образцу).

   ![Элемент разделения столбца по образцу](media/tutorial-bikeshare-dataprep/weathersplitcolumnbyexample.png)

2. Machine Learning Workbench автоматически определяет применимый разделитель и создает два столбца, разделив данные на значения даты и времени. 

3. Нажмите __ОК__, чтобы принять результаты разделения.

   ![Разделенные столбцы DATE_1 и DATE_2](media/tutorial-bikeshare-dataprep/weatherdatesplitted.png)

### <a name="derive-column-by-example"></a>Получение столбца по образцу

1. Чтобы получить данные за двухчасовой интервал времени, щелкните правой кнопкой мыши заголовок столбца __DATE\_2__ и выберите **Derive Column by Example** (Получение столбца по образцу).

   ![Элемент получения столбца по образцу](media/tutorial-bikeshare-dataprep/weatherdate2range.png)

   Добавляется пустой столбец со значениями NULL.

2. Выберите первую пустую ячейку в новом столбце. Укажите образец требуемого интервала времени. Для этого введите **12AM-2AM** в новый столбец и нажмите клавишу ВВОД.

   ![Новый столбец со значением 12AM-2AM](media/tutorial-bikeshare-dataprep/weathertimerangeexample.png)

   > [!NOTE]
   > Machine Learning Workbench синтезирует программу, основанную на предоставленных вами образцах, и применяет ее к оставшимся строкам. Все остальные строки автоматически заполняются на основе предоставленного вами образца. Кроме того, Workbench анализирует данные и пытается определить пограничные случаи. 

   > [!IMPORTANT]
   > Идентификация пограничных случаев на компьютере Mac в текущей версии Workbench может не работать. Если у вас компьютер Mac, пропустите указанные ниже шаги 3 и 4. Вместо этого нажмите кнопку __ОК__, когда все строки будут заполнены производными значениями.
   
3. Текст **Анализ данных** над сеткой указывает, что Workbench пытается определить пограничные случаи. После этого состояние приобретает значение **Review next suggested row** (Проверка следующей предлагаемой строки) или **No suggestions** (Предложения отсутствуют). В этом примере возвращается значение **Review next suggested row** (Проверка следующей предлагаемой строки).

4. Чтобы просмотреть предлагаемые изменения, выберите **Review next suggested row** (Проверка следующей предлагаемой строки). Ячейка, которую необходимо просмотреть и исправить (при необходимости), выделяется на экране.

   ![Проверка следующей предлагаемой строки](media/tutorial-bikeshare-dataprep/weatherreviewnextsuggested.png)

    Нажмите __ОК__, чтобы принять преобразование.
 
5. Вы вернетесь к представлению сетки данных для __BostonWeather__. Теперь сетка содержит три столбца, добавленных ранее.

   ![Представление сетки с добавленными строками](media/tutorial-bikeshare-dataprep/timerangecomputed.png)

   > [!TIP]
   > Все внесенные изменения сохраняются в области **Шаги**. Перейдите к действию в области **Шаги**, щелкните стрелку вниз и выберите **Изменить**. Будет развернуто окно **Derive Column by Example** (Получение столбца по образцу). Здесь сохраняются все образцы. Кроме того, можно добавлять образцы вручную, дважды щелкнув строку в указанной ниже сетке. Выберите **Отмена**, чтобы вернуться к основной сетке без применения изменений. Это представление также можно открыть, выбрав **Расширенный режим** при выполнении преобразования **Derive Column by Example** (Получение столбца по образцу).

6. Чтобы переименовать столбец, дважды щелкните его заголовок и введите **Hour Range**. Нажмите клавишу ВВОД, чтобы сохранить изменения.

   ![Переименование столбцов](media/tutorial-bikeshare-dataprep/weatherhourrangecolumnrename.png)

7. Для получения интервала дат и времени, одновременно выберите столбцы **Date\_1** и **Hour Range**, щелкните правой кнопкой мыши и выберите **Derive column by example** (Получение столбца по образцу).

   ![Получение столбца по образцу](media/tutorial-bikeshare-dataprep/weatherderivedatehourrange.png)

   Введите в первой строке **Jan 01, 2015 12AM-2AM** в качестве образца и нажмите клавишу ВВОД.

   Workbench определяет преобразование на основе предоставленного вами образца. В этом примере результатом является изменение формата даты и ее сцепление с двухчасовым интервалом времени.

   ![Образец Jan 01, 2015 12AM-2AM](media/tutorial-bikeshare-dataprep/wetherdatehourrangeexample.png)

   > [!IMPORTANT]
   > На компьютере Mac выполните следующий шаг вместо шага 8.
   >
   > * Перейдите к первой ячейке, которая содержит **Feb 01, 2015 12AM-2AM**. Она должна быть в строке 15. Исправьте значение на **Jan 02, 2015 12AM-2AM** и нажмите клавишу ВВОД. 
   

8. Подождите, пока состояние изменится с **Анализ данных** на **Review next suggested row** (Проверка следующей предлагаемой строки). Это изменение может занять несколько секунд. Выберите ссылку состояния, чтобы перейти к предлагаемой строке. 

   ![Строка, предлагаемая для проверки](media/tutorial-bikeshare-dataprep/wetherdatehourrangedisambiguate.png)

   Строка имеет значение NULL, так как исходное значение даты может быть представлено как в формате дд/мм/гггг, так и в формате мм/дд/гггг. Введите правильное значение **Jan 13, 2015 2AM-4AM** и нажмите клавишу ВВОД. Workbench использует два образца, чтобы расширить возможности извлечения для оставшихся строк.

   ![Данные в надлежащем формате](media/tutorial-bikeshare-dataprep/wetherdatehourrangedisambiguated.png)

9. Нажмите **ОК**, чтобы принять преобразование.

   ![Сетка завершенного преобразования](media/tutorial-bikeshare-dataprep/weatherdatehourrangecomputed.png)

   > [!TIP]
   > Чтобы использовать **расширенный режим** параметра **Derive column by example** (Получение столбца по образцу) для этого шага, нажмите стрелку вниз в области **Шаги**. В сетке данных есть флажки напротив столбцов **DATE\_1** и **Hour Range**. Снимите флажок рядом со столбцом **Hour Range**, чтобы узнать, как при этом изменяются выходные данные. При отсутствии столбца **Hour Range** в качестве входных данных **12AM-2AM** обрабатывается как константа и добавляется к производным значениям. Выберите **Отмена**, чтобы вернуться к основной сетке без применения изменений.
   ![Расширенный режим](media/tutorial-bikeshare-dataprep/derivedcolumnadvancededitdeselectcolumn.png)

10. Чтобы переименовать столбец, дважды щелкните заголовок. Измените имя на **Date Hour Range** и нажмите клавишу ВВОД.

11. Одновременно выберите столбцы **DATE**, **DATE\_1**, **DATE\_2** и **Hour Range**. Щелкните правой кнопкой мыши и выберите **Удалить столбец**.

## <a name="summarize-data-mean"></a>Сведение данных (среднее значение)

На следующем этапе нужно вычислить итоговые значения для погодных условий, усреднив их для определенного интервала времени.

1. Выберите столбец **Date Hour Range** и нажмите **Summarize** (Вычисление итоговых значений) в меню **преобразования**.

    ![Меню преобразований](media/tutorial-bikeshare-dataprep/weathersummarizemenu.png)

2. Для сведения данных перетаскивайте столбцы из сетки в нижней части страницы в области в верхних углах слева и справа. В области слева отображается текст **Drag columns here to group data** (Перетащите сюда столбцы для группирования данных). В области справа отображается текст **Drag columns here to summarize data** (Перетащите сюда столбцы для сведения данных). 

    a. Перетащите столбец **Date Hour Range** из сетки в нижнюю часть области слева. Перетащите **HOURLYDRYBULBTEMPF**, **HOURLYRelativeHumidity** и **HOURLYWindSpeed** в область справа. 

    Б. В области справа выберите **Среднее** в качестве меры для **статистической обработки** каждого столбца. Нажмите кнопку **ОК**, чтобы завершить вычисление итоговых значений.

    ![Экран сводных данных](media/tutorial-bikeshare-dataprep/weathersummarize.png)

## <a name="transform-dataflow-by-using-script"></a>Преобразование потока данных с использованием скрипта

Изменив данные в числовых столбцах в диапазоне 0–1, можно быстро свести значения некоторых моделей. Сейчас нет встроенных средств для универсального выполнения этого преобразования. Для этого можно использовать скрипт Python.

1. В меню **преобразования** выберите **Transform Dataflow (Script)** (Преобразование потока данных (сценарий)).

2. В появившемся текстовом поле введите код ниже. Если вы использовали имена столбцов, код должен работать без изменений. Нужно написать простую логику нормализации минимальных и максимальных значений на Python.

    > [!WARNING]
    > Скрипт предполагает использование имен столбцов, которые применялись ранее в этом руководстве. Если у вас другие имена столбцов, измените их в скрипте.

   ```python
   maxVal = max(df["HOURLYDRYBULBTEMPF_Mean"])
   minVal = min(df["HOURLYDRYBULBTEMPF_Mean"])
   df["HOURLYDRYBULBTEMPF_Mean"] = (df["HOURLYDRYBULBTEMPF_Mean"]-minVal)/(maxVal-minVal)
   df.rename(columns={"HOURLYDRYBULBTEMPF_Mean":"N_DryBulbTemp"},inplace=True)

   maxVal = max(df["HOURLYRelativeHumidity_Mean"])
   minVal = min(df["HOURLYRelativeHumidity_Mean"])
   df["HOURLYRelativeHumidity_Mean"] = (df["HOURLYRelativeHumidity_Mean"]-minVal)/(maxVal-minVal)
   df.rename(columns={"HOURLYRelativeHumidity_Mean":"N_RelativeHumidity"},inplace=True)

   maxVal = max(df["HOURLYWindSpeed_Mean"])
   minVal = min(df["HOURLYWindSpeed_Mean"])
   df["HOURLYWindSpeed_Mean"] = (df["HOURLYWindSpeed_Mean"]-minVal)/(maxVal-minVal)
   df.rename(columns={"HOURLYWindSpeed_Mean":"N_WindSpeed"},inplace=True)

   df
   ```

    > [!TIP]
    > В результате скрипт Python должен вернуть `df`. Это значение используется для заполнения сетки.
    
   ![Диалоговое окно скрипта для преобразования потока данных](media/tutorial-bikeshare-dataprep/transformdataflowscript.png)

3. Нажмите кнопку __ОК__, чтобы использовать этот скрипт. Числовые столбцы в сетке теперь содержат значения в диапазоне 0–1.

    ![Сетка, содержащая значения в диапазоне от 0–1](media/tutorial-bikeshare-dataprep/datagridwithdecimals.png)

Мы завершили подготовку данных погоды. Теперь подготовим данные поездок.

## <a name="load-trip-data"></a>Загрузка данных поездок

1. Чтобы импортировать файл `201701-hubway-tripdata.csv`, выполните инструкции в разделе [Создание источника данных](#newdatasource). При импорте используйте следующие параметры:

    * __Выбор файла.__ Выберите **большой двоичный объект Azure** при обзоре папок для выбора файла.

    * __Схема выборки.__ Выберите схему выборки **Full File** (Файл полностью) и активируйте пример.

    * __Тип данных.__ Примите значения по умолчанию.

2. После импорта данных нажмите кнопку __Prepare__ (Подготовка), чтобы начать подготовку данных. Выберите существующий пакет **BikeShare Data Prep.dprep** и нажмите __ОК__.

    После этого **поток данных** добавляется в существующий файл **подготовки данных**. Новый файл не создается.

    ![Выбор имеющегося пакета](media/tutorial-bikeshare-dataprep/addjandatatodprep.png)

3. После загрузки сетки разверните __DATAFLOWS__. Теперь у вас есть два потока данных: **BostonWeather** и **201701-hubway-tripdata**. Выберите элемент **201701-hubway-tripdata**.

    ![Элемент 201701-hubway-tripdata](media/tutorial-bikeshare-dataprep/twodfsindprep.png)

## <a name="use-the-map-inspector"></a>Использование инспектора карты

Для подготовки данных предусмотрен ряд полезных визуализаций под названием "Инспекторы" для строковых, числовых и географических данных. Они упрощают анализ данных и определение выбросов. Ниже приведены указания по использованию инспектора карты.

1. Одновременно выберите столбцы **start station latitude** и **start station longitude**. Щелкните правой кнопкой мыши один из столбцов, а затем выберите **Карта**.

    > [!TIP]
    > Для множественного выбора удерживайте нажатой клавишу CTRL (Command ⌘ на компьютере Mac) и выберите заголовок каждого столбца.

    ![Визуализация карты](media/tutorial-bikeshare-dataprep/launchMapInspector.png)

2. Чтобы развернуть визуализацию карты, нажмите значок **Развернуть**. Чтобы карта помещалась в окне, выберите значок **E** в верхней левой части экрана визуализации.

    ![Развернутый экран](media/tutorial-bikeshare-dataprep/maximizedmap.png)

3. Нажмите кнопку **Свернуть**, чтобы вернуться к представлению сетки.

## <a name="use-the-column-statistics-inspector"></a>Использование инспектора статистики столбцов

Чтобы использовать инспектор статистики столбцов, щелкните правой кнопкой мыши столбец __tripduration__ и выберите __Column Statistics__ (Статистика по столбцам).

![Элемент статистики по столбцам](media/tutorial-bikeshare-dataprep/tripdurationcolstats.png)

После этого в область __INSPECTORS__ (Инспекторы) добавляется новая визуализация под названием __tripduration Statistics__.

![Инспектор tripduration Statistics](media/tutorial-bikeshare-dataprep/tripdurationcolstatsinwell.png)

> [!IMPORTANT]
> Максимальная длительность поездки — 961 814 минут, что равняется приблизительно двум годам. Похоже, что в наборе данных присутствуют выбросы.

## <a name="use-the-histogram-inspector"></a>Использование инспектора гистограммы

Чтобы определить выбросы, щелкните правой кнопкой мыши столбец __tripduration__ и выберите __Гистограмма__.

![Инспектор гистограммы](media/tutorial-bikeshare-dataprep/tripdurationhistogram.png)

Гистограмма не слишком полезна, так как выбросы искажают граф.

## <a name="add-a-column-by-using-script"></a>Добавление столбца с помощью скрипта

1. Щелкните правой кнопкой мыши столбец **tripduration** и выберите **Add Column (Script)** (Добавление столбца (скрипт)).

    ![Меню Add Column (Script) (Добавление столбца (скрипт))](media/tutorial-bikeshare-dataprep/computecolscript.png)

2. В диалоговом окне __Add Column (Script)__ (Добавление столбца (скрипт)) используйте следующие значения:

    * __Имя нового столбца__: logtripduration.

    * __Insert this New Column After__ (Вставить новый столбец после): tripduration.

    * __New Column Code__ (Код нового столбца): `math.log(row.tripduration)`.

    * __Code Block Type__ (Тип блока кода): Expression (Выражение).

   ![Диалоговое окно Add Column (Script) (Добавление столбца (скрипт))](media/tutorial-bikeshare-dataprep/computecolscriptdialog.png)

3. Нажмите __ОК__, чтобы добавить столбец **logtripduration**.

4. Щелкните столбец правой кнопкой мыши и выберите **Гистограмма**.

    ![Гистограмма столбца logtripduration](media/tutorial-bikeshare-dataprep/logtriphistogram.png)

    Визуально эта гистограмма похожа на график нормального распределения с нестандартным окончанием.

## <a name="use-an-advanced-filter"></a>Использование расширенного фильтра

Применив к данным фильтр, можно добавить в инспектор новые данные распределения. 

1. Щелкните правой кнопкой мыши столбец **tripduration** и выберите **Filter Column** (Фильтровать столбец). 

2. В диалоговом окне __Изменить__ используйте следующие значения:

    * __Filter this Number Column__ (Фильтрация этого числового столбца): logtripduration.

    * __I Want To__ (Требуется): Keep Rows (Сохранить строки).

    * __When__ (Условия применения): Any of the Conditions below are True (logical OR) (Любое указанное ниже условие имеет значение True (логическое ИЛИ)).

    * __If this Column__ (Если значение в этом столбце): less than (меньше, чем).

    * __The Value__ (Значение): 9.

    ![Параметры фильтра](media/tutorial-bikeshare-dataprep/loftripfilter.png)

3. Нажмите кнопку __ОК__, чтобы применить фильтр.

    ![Обновленные гистограммы после применения фильтра](media/tutorial-bikeshare-dataprep/loftripfilteredinspector.png)

### <a name="the-halo-effect"></a>Эффект нимба

1. Разверните гистограмму столбца **logtripduration**. На серую гистограмму накладывается голубая. Такое отображение называется **эффектом нимба**:

    * Серая гистограмма представляет распределение перед выполнением операции (в нашем случае фильтрации).

    * Голубая гистограмма представляет гистограмму после выполнения операции. 

   Эффект нимба помогает визуализировать воздействие операции на данные.

   ![Эффект нимба](media/tutorial-bikeshare-dataprep/loftripfilteredinspectormaximized.png)

    > [!NOTE]
    > Голубая гистограмма короче предыдущей. Это происходит из-за автоматического повторного группирования данных в новом диапазоне.

2. Чтобы удалить нимб, выберите __Изменить__ и снимите флажок __Show halo__ (Показать нимб).

    ![Параметры гистограммы](media/tutorial-bikeshare-dataprep/uncheckhalo.png)

3. Нажмите кнопку **ОК**, чтобы отключить эффект нимба. Затем сверните гистограмму.

### <a name="remove-columns"></a>Удаление столбцов

В данных поездок каждая строка представляет событие поездки на велосипеде. Для этого руководства требуются только столбцы **starttime** и **start station id**. Удалите другие столбцы. Для этого одновременно выберите эти два столбца, щелкните правой кнопкой мыши заголовок столбца и выберите **Keep Column** (Сохранить столбец). Остальные столбцы будут удалены.

![Параметр Keep Column (Сохранить столбец)](media/tutorial-bikeshare-dataprep/tripdatakeepcolumn.png)

### <a name="summarize-data-count"></a>Сведение данных (количество)

Чтобы вычислить итоговые значения для спроса на велосипеды в течение 2 часов, используйте производные столбцы.

1. Щелкните правой кнопкой мыши столбец **starttime** и выберите **Derive Column by Example** (Получение столбца по образцу).

    ![Параметр получения столбца по образцу](media/tutorial-bikeshare-dataprep/tripdataderivebyexample.png)

2. Чтобы создать образец, введите в первую строку значение **Jan 01, 2017 12AM-2AM**.

    > [!IMPORTANT]
    > В предыдущем примере получения столбцов выполнялось несколько шагов для получения столбца с датой и интервалом времени. В этом примере видно, что такая операция может быть выполнена как один шаг. Для этого нужно предоставить образец конечного результата.

    > [!NOTE]
    > Можно предоставить образец для любых строк. В этом образце значение **Jan 01, 2017 12AM-2AM** является допустимым для первой строки данных.

    ![Демонстрационные данные](media/tutorial-bikeshare-dataprep/tripdataderivebyexamplefirstexample.png)

   > [!IMPORTANT]
   > На компьютере Mac выполните следующий шаг вместо шага 3.
   >
   > * Перейдите к первой ячейке, которая содержит **Jan 01, 2017 1AM-2AM**. Она должна быть в строке 14. Исправьте значение на **Jan 01, 2017 12AM-2AM** и нажмите клавишу ВВОД. 

3. Подождите, пока приложение вычислит значения для всех строк. Этот процесс может занять несколько секунд. По завершении анализа воспользуйтесь ссылкой __Review next suggested row__ (Проверка следующей предлагаемой строки), чтобы проверить данные.

   ![Выполненный анализ со ссылкой на просмотр](media/tutorial-bikeshare-dataprep/tripdatabyexanalysiscomplete.png)

    Убедитесь, что рассчитанные значения верны. Если нет, замените значение ожидаемым и нажмите клавишу ВВОД. Дождитесь завершения анализа. Выполняйте процесс **Review next suggested row** (Проверка следующей предлагаемой строки), пока не отобразится запись **No suggestions** (Предложения отсутствуют). Запись **No suggestion** (Предложения отсутствуют) означает, что в приложении проанализированы пограничные случаи и синтезированная программа определена как удовлетворительная. Прежде чем принять преобразование, рекомендуем визуально проверить преобразованные данные. 

4. Нажмите **ОК**, чтобы принять преобразование. Переименуйте созданный столбец в **Date Hour Range**.

    ![Переименованный столбец](media/tutorial-bikeshare-dataprep/tripdatasummarize.png)

5. Щелкните правой кнопкой мыши заголовок столбца **starttime** и выберите **Remove column** (Удалить столбец).

6. Для сведения данных выберите __Summarize__ (Вычисление итоговых значений) в меню __преобразования__. Чтобы создать преобразование, выполните следующие действия:

    * Перетащите столбцы __Date Hour Range__ и __start station id__ в область **для группирования** слева.

    * Перетащите столбец __start station id__ в область **для сведения данных** справа.

   ![Параметры сведения данных](media/tutorial-bikeshare-dataprep/tripdatacount.png)

7. Нажмите **ОК**, чтобы принять сводный результат.

## <a name="join-dataflows"></a>Соединение потоков данных

Чтобы соединить сведения о погоде с данными поездок, выполните следующие действия:

1. Выберите __Join__ (Соединить) в меню __преобразования__.

2. __Таблицы.__ Выберите **BostonWeather** для потока данных **слева** и **201701-hubway-tripdata** для потока данных **справа**. Нажмите кнопку **Далее**, чтобы продолжить.

    ![Выбор таблиц](media/tutorial-bikeshare-dataprep/jointableselection.png)

3. __Ключевые столбцы.__ Выберите столбец **Date Hour Range** в обеих таблицах. Затем нажмите __Далее__.

    ![Выбор ключевых столбцов](media/tutorial-bikeshare-dataprep/joinkeyselection.png)

4. __Тип соединения.__ Выберите для типа соединения __Matching rows__ (Совпадающие строки) и нажмите кнопку __Готово__.

    ![Тип соединения по совпадающим строкам](media/tutorial-bikeshare-dataprep/joinscreen.png)

    После этого создается поток данных с именем __Join Result__.

## <a name="create-additional-features"></a>Создание дополнительных функций

1. Чтобы создать столбец, который содержит дни недели, щелкните правой кнопкой мыши столбец **Date Hour Range** и выберите **Derive column by Example** (Получение столбца по образцу). Используйте значение __Sun__ для даты, которая наступает в воскресенье. Например, **Jan 01, 2017 12AM-2AM**. Нажмите клавишу ВВОД, а затем — кнопку **ОК**. Переименуйте этот столбец в __MonthCalendar__.

    ![Создание столбца для дня недели](media/tutorial-bikeshare-dataprep/featureweekday.png)

2. Чтобы создать столбец, который содержит интервал времени для строки, щелкните правой кнопкой мыши столбец **Date Hour Range** и выберите **Derive column by Example** (Получение столбца по образцу). Используйте значение **12AM-2AM** для строки, в которой содержится значение **Jan 01, 2017 12AM-2AM**. Нажмите клавишу ВВОД, а затем — кнопку **ОК**. Переименуйте этот столбец в **Period**.

    ![Столбец Period](media/tutorial-bikeshare-dataprep/featurehourrange.png)

3. Чтобы удалить столбцы **Date Hour Range** и **rDate Hour Range**, нажмите клавишу CTRL (Command ⌘ на компьютере Mac) и выберите заголовок каждого столбца. Щелкните правой кнопкой мыши и выберите **Remove Column** (Удалить столбец).

## <a name="read-data-from-python"></a>Считывание данных из Python

Можно запустить пакет подготовки данных из Python или PySpark и получить результаты в виде **кадра данных**.

Чтобы создать пример скрипта Python, щелкните правой кнопкой мыши __BikeShare Data Prep__ и выберите __Generate Data Access Code File__ (Создать файл с кодом для доступа к данным). Пример файла Python создается в вашей **папке проекта** и загружается на вкладку в Workbench. Следующий скрипт Python является примером создаваемого кода:

```python
# Use the Azure Machine Learning data preparation package
from azureml.dataprep import package

# Use the Azure Machine Learning data collector to log various metrics
from azureml.logging import get_azureml_logger
logger = get_azureml_logger()

# This call will load the referenced package and return a DataFrame.
# If run in a PySpark environment, this call returns a
# Spark DataFrame. If not, it will return a Pandas DataFrame.
df = package.run('BikeShare Data Prep.dprep', dataflow_idx=0)

# Remove this line and add code that uses the DataFrame
df.head(10)
```

В этом руководстве имя файла — `BikeShare Data Prep.py`. Этот файл будет использоваться далее в руководстве.

## <a name="save-test-data-as-a-csv-file"></a>Сохранение тестовых данных в CSV-файл

Чтобы сохранить поток данных **Join Result** в CSV-файл необходимо изменить скрипт `BikeShare Data Prep.py`. 

1. Откройте проект для редактирования в Visual Studio Code.

    ![Открытие проекта в Visual Studio Code](media/tutorial-bikeshare-dataprep/openprojectinvscode.png)

2. Обновите скрипт Python в файле `BikeShare Data Prep.py`, добавив следующий код.

    ```python
    import pyspark

    from azureml.dataprep.package import run
    from pyspark.sql.functions import *

    # start Spark session
    spark = pyspark.sql.SparkSession.builder.appName('BikeShare').getOrCreate()

    # dataflow_idx=2 sets the dataflow to the 3rd dataflow (the index starts at 0), the Join Result.
    df = run('BikeShare Data Prep.dprep', dataflow_idx=2)
    df.show(n=10)
    row_count_first = df.count()

    # Example file name: 'wasb://data-files@bikesharestorage.blob.core.windows.net/testata'
    # 'wasb://<your container name>@<your azure storage name>.blob.core.windows.net/<csv folder name>
    blobfolder = 'Your Azure Storage blob path'

    df.write.csv(blobfolder, mode='overwrite') 

    # retrieve csv file parts into one data frame
    csvfiles = "<Your Azure Storage blob path>/*.csv"
    df = spark.read.option("header", "false").csv(csvfiles)
    row_count_result = df.count()
    print(row_count_result)
    if (row_count_first == row_count_result):
        print('counts match')
    else:
        print('counts do not match')
    print('done')
    ```

3. Замените `Your Azure Storage blob path` путем к выходному файлу, который будет создан. Замените переменные `blobfolder` и `csvfiles`.

## <a name="create-an-hdinsight-run-configuration"></a>Создание конфигурации запуска HDInsight

1. В Machine Learning Workbench откройте окно командной строки. Для этого в меню **Файл** выберите **Open Command Prompt** (Открыть командную строку). Командная строка откроется в папке проекта со строкой `C:\Projects\BikeShare>`.

    ![Параметр Open command prompt (Открыть командную строку)](media/tutorial-bikeshare-dataprep/opencommandprompt.png)

   >[!IMPORTANT]
   >Для выполнения следующих действий необходимо использовать окно командной строки, открыв его из Workbench.

2. Войдите в Azure с помощью командной строки. 

   Приложение Workbench и CLI используют независимые кэши учетных данных для выполнения проверки подлинности пользователя ресурсов Azure. Это необходимо сделать только один раз до истечения срока действия кэшированного маркера. Команда `az account list` возвращает список доступных подписок, доступных для вашего имени для входа. Если у вас несколько подписок, используйте значение идентификатора из нужной подписки. Назначьте эту подписку учетной записью по умолчанию для использования с командой `az account set -s`, а затем укажите значение идентификатора подписки. Подтвердите настройки с помощью команды `show` для учетной записи.

   ```azurecli
   REM login by using the aka.ms/devicelogin site
   az login
   
   REM lists all Azure subscriptions you have access to 
   az account list -o table
   
   REM sets the current Azure subscription to the one you want to use
   az account set -s <subscriptionId>
   
   REM verifies that your current subscription is set correctly
   az account show
   ```

3. Создайте конфигурацию запуска HDInsight. Потребуется указать имя кластера и пароль `sshuser`.

    ```azurecli
    az ml computetarget attach cluster --name hdinsight --address <yourclustername>.azurehdinsight.net --username sshuser --password <your password>
    az ml experiment prepare -c hdinsight
    ```
> [!NOTE]
> При создании пустого проекта доступны конфигурации запуска по умолчанию, **local** и **docker**. На этом шаге создается новая конфигурация запуска, которая доступна в Workbench при выполнении скриптом. 

## <a name="run-in-an-hdinsight-cluster"></a>Запуск в кластере HDInsight

Вернитесь к приложению Machine Learning Workbench, чтобы запустить скрипт в кластере HDInsight.

1. Вернитесь на начальный экран проекта, щелкнув значок **Главная** в левой части экрана.

2. Выберите **hdinsight** из раскрывающегося списка, чтобы запустить скрипт в кластере HDInsight.

3. Выберите **Запуск**. Скрипт отправляется на локальный компьютер как задание. Состояние задания изменится на __Завершено__ после того, как файл записан в указанное расположение в контейнере службы хранилища.

    ![Запуск скрипта HDInsight](media/tutorial-bikeshare-dataprep/hdinsightrunscript.png)


## <a name="substitute-data-sources"></a>Источники данных для замены

В предыдущих шагах для подготовки тестовых данных мы использовали источники данных `201701-hubway-tripdata.csv` и `BostonWeather.csv`. Чтобы использовать пакет с другими файлами данных поездок, выполните описанные ниже действия.

1. Создайте источник данных, выполнив инструкции, представленные ранее, со следующими изменениями процесса:

    * __Выбор файла.__ Одновременно выберите шесть оставшихся CSV-файлов с данными поездок.

    ![Загрузка шести оставшихся файлов](media/tutorial-bikeshare-dataprep/browseazurestoragefortripdatafiles.png)

    > [!NOTE]
     > Запись __+5__ указывает на наличие пяти дополнительных файлов, кроме того, который указан.

    * __Сведения о файле.__ Задайте для параметра __Promote Headers Mode__ (Режим повышения уровня для заголовков) значение **All Files Have The Same Headers** (Для всех файлов используются одинаковые заголовки). Это значение указывает на то, что все файлы содержат одинаковые заголовки.

    ![Выбор сведений о файле](media/tutorial-bikeshare-dataprep/headerfromeachfile.png) 

   Сохраните имя этого источника данных, так как он будет использоваться на последующих шагах.

2. Выберите значок папки, чтобы просмотреть файлы в проекте. Разверните каталог __aml\_config__ и выберите файл `hdinsight.runconfig`.

    ![Расположение файла local.runconfig](media/tutorial-bikeshare-dataprep/hdinsightsubstitutedatasources.png) 

3. Нажмите кнопку **Изменить**, чтобы открыть этот файл в Visual Studio Code.

4. Добавьте строки ниже в конец файла `hdinsight.runconfig` и нажмите значок дискеты, чтобы сохранить файл.

    ```yaml
    DataSourceSubstitutions:
      201701-hubway-tripdata.dsource: 201501-hubway-tripdata.dsource
    ```

    При этом изменении исходный источник данных заменяется источником, который содержит шесть файлов с данными поездок.

## <a name="save-training-data-as-a-csv-file"></a>Сохранение данных для обучения в файл CSV

1. Перейдите к файлу Python `BikeShare Data Prep.py`, который вы изменили ранее. Укажите другой путь к файлу, чтобы сохранить данные для обучения.

    ```python
    import pyspark

    from azureml.dataprep.package import run
    from pyspark.sql.functions import *

    # start Spark session
    spark = pyspark.sql.SparkSession.builder.appName('BikeShare').getOrCreate()

    # dataflow_idx=2 sets the dataflow to the 3rd dataflow (the index starts at 0), the Join Result.
    df = run('BikeShare Data Prep.dprep', dataflow_idx=2)
    df.show(n=10)
    row_count_first = df.count()

    # Example file name: 'wasb://data-files@bikesharestorage.blob.core.windows.net/traindata'
    # 'wasb://<your container name>@<your azure storage name>.blob.core.windows.net/<csv folder name>
    blobfolder = 'Your Azure Storage blob path'

    df.write.csv(blobfolder, mode='overwrite') 

    # retrieve csv file parts into one data frame
    csvfiles = "<Your Azure Storage blob path>/*.csv"
    df = spark.read.option("header", "false").csv(csvfiles)
    row_count_result = df.count()
    print(row_count_result)
    if (row_count_first == row_count_result):
        print('counts match')
    else:
        print('counts do not match')
    print('done')
    ```

2. Укажите папку `traindata` для вывода данных для обучения.

3. Чтобы отправить новое задание, щелкните значок **Выполнить**. Убедитесь, что сценарий **hdinsight** выбран. Задание отправляется с новой конфигурацией. Выходные данные этого задания являются данными для обучения. При создании этих данных выполняются шаги по их подготовке, которые были выполнены ранее. Выполнение задания может занять несколько минут.


## <a name="clean-up-resources"></a>Очистка ресурсов

[!INCLUDE [aml-delete-resource-group](../../../includes/aml-delete-resource-group.md)]

## <a name="next-steps"></a>Дополнительная информация
Мы завершили работу с руководством по подготовке данных для системы совместного использования велосипедов. В этом руководстве вы использовали машинное обучение (предварительная версия), чтобы научиться выполнять следующие задачи:
> [!div class="checklist"]
> * Интерактивная подготовка данных с помощью средства подготовки данных в службе "Машинное обучение".
> * Импорт, преобразование и создание тестового набора данных.
> * Создание пакета подготовки данных.
> * Запуск пакета подготовки данных с использованием Python.
> * Создание набора данных для обучения с повторным использованием пакета подготовки данных для дополнительных входных файлов.

Далее ознакомьтесь с дополнительными сведениями о подготовке данных:
> [!div class="nextstepaction"]
> [Data preparation user guide](data-prep-user-guide.md) (Руководство пользователя по подготовке данных)
