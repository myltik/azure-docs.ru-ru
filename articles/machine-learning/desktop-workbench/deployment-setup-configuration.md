---
title: Установка и настройка службы управления моделями Машинного обучения Azure | Документация Майкрософт
description: В этом документе описываются действия и основные понятия, использующиеся при установке и настройке службы управления моделями в Машинном обучении Azure.
services: machine-learning
author: aashishb
ms.author: aashishb
manager: hjerez
ms.reviewer: jmartens, jasonwhowell, mldocs
ms.service: machine-learning
ms.component: desktop-workbench
ms.workload: data-services
ms.topic: article
ms.date: 12/6/2017
ms.openlocfilehash: bf96a6986abe858074decaaecfe38b3807822aab
ms.sourcegitcommit: 944d16bc74de29fb2643b0576a20cbd7e437cef2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/07/2018
ms.locfileid: "34830247"
---
# <a name="model-management-setup"></a>Установка службы управления моделями

Этот документ содержит вводные сведения об использовании службы управления моделями Машинного обучения Azure для развертывания моделей машинного обучения в качестве веб-служб и управления ими. 

Используя управление моделями Машинного обучения Azure, можно эффективно развертывать модели машинного обучения, созданные с помощью нескольких платформ, включая SparkML, Keras, TensorFlow, Microsoft Cognitive Toolkit или Python, а также управлять ими. 

Выполнив инструкции в этом документе, вы сможете настроить среду управления моделями и подготовить ее к развертыванию моделей машинного обучения.

## <a name="what-you-need-to-get-started"></a>Что необходимо для начала работы
Чтобы получить оптимальный результат, нужны права владельца на доступ к подписке или группе ресурсов Azure, в которой вы сможете развернуть модели.
Интерфейс командной строки поставляется предварительно установленным в Azure Machine Learning Workbench и на [виртуальных машинах Azure для обработки и анализа данных](https://docs.microsoft.com/azure/machine-learning/machine-learning-data-science-virtual-machine-overview).

## <a name="using-the-cli"></a>Использование интерфейса командной строки
Чтобы использовать интерфейсы командной строки (CLI) на платформе Workbench, щелкните **Файл** -> **Открыть командную строку**. 

На виртуальной машине для обработки и анализа данных подключитесь к командной строке и откройте ее. Введите `az ml -h` для просмотра параметров. Чтобы получить дополнительные сведения о командах, используйте параметр --help.

В остальных системах необходимо установить CLI.

### <a name="installing-or-updating-on-windows"></a>Установка (или обновление) в Windows

Установите Python отсюда: https://www.python.org/. Убедитесь, что выбрана установка pip.

Откройте командную строку, используя запуск от имени администратора, а затем выполните следующие команды:

```cmd
pip install -r https://aka.ms/az-ml-o16n-cli-requirements-file
```

### <a name="installing-or-updating-on-linux"></a>Установка (или обновление) в Linux
Выполните следующую команду из командной строки и следуйте указаниям.

```bash
sudo -i
pip install -r https://aka.ms/az-ml-o16n-cli-requirements-file
```

### <a name="configuring-docker-on-linux"></a>Настройка Docker в Linux
Чтобы настроить Docker в Linux для непривилегированных пользователей, следуйте приведенным здесь инструкциям: [Post-installation steps for Linux](https://docs.docker.com/engine/installation/linux/linux-postinstall/) (Шаги после установки для Linux).

>[!NOTE]
> На виртуальной машине для обработки и анализа данных под управлением Linux можно выполнить приведенный ниже скрипт, чтобы настроить Docker надлежащим образом. **Обязательно выйдите из системы и войдите снова после выполнения скрипта.**
>```
>sudo /opt/microsoft/azureml/initial_setup.sh
>```

## <a name="deploying-your-model"></a>Развертывание модели
Используйте CLI для развертывания моделей в качестве веб-служб. Их можно развернуть локально или в кластере.

Начните с локального развертывания, убедитесь, что модель и код работают, затем выполните развертывание в кластер для использования в производственных масштабах.

Чтобы начать, необходимо настроить среду развертывания. Это необходимо сделать всего лишь один раз. После настройки среду можно повторно использовать для последующих развертываний. Дополнительные сведения см. в следующем разделе.

Действия после настройки среды:
- Вам будет предложено войти в Azure. Чтобы войти, воспользуйтесь браузером и откройте страницу https://aka.ms/devicelogin. Введите код для проверки подлинности.
- В процессе проверки подлинности вам будет предложена учетная запись, с помощью которой будет выполнена проверка подлинности. Важно! Выберите учетную запись с действительной подпиской Azure и достаточными разрешениями для создания ресурсов в учетной записи. После входа отображаются сведения о подписке и запрос на продолжение работы с выбранной учетной записью.

### <a name="environment-setup"></a>Настройка среды
Чтобы начать процесс установки, зарегистрируйте несколько поставщиков среды при помощи следующей команды:

```azurecli
az provider register -n Microsoft.MachineLearningCompute
az provider register -n Microsoft.ContainerRegistry
az provider register -n Microsoft.ContainerService
```
#### <a name="local-deployment"></a>Локальное развертывание
Чтобы развернуть и протестировать веб-службу на локальном компьютере, настройте локальную среду, используя следующую команду. Имя группы ресурсов является необязательным.

```azurecli
az ml env setup -l [Azure Region, e.g. eastus2] -n [your environment name] [-g [existing resource group]]
```
>[!NOTE] 
>Для локального развертывания веб-службы необходимо установить Docker на локальном компьютере. 
>

Команда настройки локальной среды создает следующие ресурсы в подписке:
- группу ресурсов (если не указана или если указанное имя не существует);
- учетную запись хранения;
- реестр контейнеров Azure (ACR);
- учетную запись Application Insights.

После успешного завершения настройки настройте среду для использования с помощью следующей команды:

```azurecli
az ml env set -n [environment name] -g [resource group]
```

#### <a name="cluster-deployment"></a>Развертывание кластера
Используйте развертывание кластера для крупномасштабных рабочих сред. В этом случае кластер ACS настраивается с Kubernetes в качестве оркестратора. Кластер ACS можно масштабировать для обработки большей пропускной способности для вызовов вашей веб-службы.

Чтобы развернуть веб-службу в рабочей среде, сначала настройте среду, используя следующую команду:

```azurecli
az ml env setup --cluster -n [your environment name] -l [Azure region e.g. eastus2] [-g [resource group]]
```

Команда установки среды кластера создает следующие ресурсы в подписке:
- группу ресурсов (если не указана или если указанное имя не существует);
- учетную запись хранения;
- Реестр контейнеров Azure (ACR).
- развертывание Kubernetes в кластере Службы контейнеров Azure (ACS);
- учетную запись Application Insights.

>[!IMPORTANT]
> Чтобы успешно создать кластерную среду, нужны права участника для подписки или группы ресурсов Azure.

Группа ресурсов, учетная запись хранения и запись контроля доступа создаются быстро. Развертывание ACS может занять до 20 минут. 

Чтобы проверить состояние подготовки текущего кластера, используйте следующую команду:

```azurecli
az ml env show -n [environment name] -g [resource group]
```

После завершения настройки необходимо настроить среду, которая будет использоваться в этом развертывании. Используйте следующую команду:

```azurecli
az ml env set -n [environment name] -g [resource group]
```

>[!NOTE] 
> После создания среды для последующих развертываний необходимо использовать только приведенную выше команду set.
>

### <a name="create-a-model-management-account"></a>Создание учетной записи управления моделями
Учетная запись Управления моделями необходима для развертывания моделей. Вам понадобится создать одну учетную запись для каждой подписки, а одну и ту же учетную запись можно использовать в нескольких развертываниях.

Создайте учетную запись с помощью следующей команды:

```azurecli
az ml account modelmanagement create -l [Azure region, e.g. eastus2] -n [your account name] -g [resource group name] --sku-instances [number of instances, e.g. 1] --sku-name [Pricing tier for example S1]
```

Чтобы использовать имеющуюся учетную запись, воспользуйтесь следующей командой:
```azurecli
az ml account modelmanagement set -n [your account name] -g [resource group it was created in]
```

В результате этого процесса среда будет готова и будет создана учетная запись управления моделью для предоставления функций, необходимых для развертывания моделей машинного обучения и управления ими (см. обзор в статье [Управление моделями Машинного обучения Azure](model-management-overview.md)).

## <a name="next-steps"></a>Дополнительная информация

* Инструкции по развертыванию веб-служб для запуска на локальном компьютере или в кластере см. в статье [Развертывание модели Машинного обучения в качестве веб-службы](model-management-service-deploy.md).
* Воспользуйтесь одним из многих примеров в коллекции.
