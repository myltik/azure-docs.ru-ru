---
title: "Реагирование на события с помощью оповещений Azure Log Analytics | Документы Майкрософт"
description: "Это руководство знакомит вас с основными принципами оповещений в Log Analytics, которые идентифицируют важную информацию в репозитории OMS и заранее уведомляют вас о возникших проблемах или выполняют действия в попытке устранить их."
services: log-analytics
documentationcenter: log-analytics
author: MGoedtel
manager: carmonm
editor: 
ms.assetid: abb07f6c-b356-4f15-85f5-60e4415d0ba2
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 09/20/2017
ms.author: magoedte
ms.custom: mvc
ms.openlocfilehash: fcfaa849f67ffcfa69672d116837e96d318c2124
ms.sourcegitcommit: d87b039e13a5f8df1ee9d82a727e6bc04715c341
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2018
---
# <a name="respond-to-events-with-log-analytics-alerts"></a>Реагирование на события с помощью оповещений Log Analytics
Оповещения в Log Analytics содержат важную информацию о вашем репозитории Log Analytics. Они создаются правилами генерации оповещений, которые автоматически выполняют поиск по журналам через регулярные интервалы и, если результаты поиска по журналу соответствуют конкретным условиям, создают запись оповещения (для которой можно настроить выполнение автоматического ответного действия).  Эта статья является продолжением руководства по [созданию и совместному использованию панелей мониторинга данных Log Analytics](log-analytics-tutorial-dashboards.md).   

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * Создание правила оповещения
> * Настройка правила генерации оповещения для отправки уведомлений по электронной почте

Для выполнения примера в этом руководстве требуется виртуальная машина [, подключенная к рабочей области Log Analytics](log-analytics-quick-collect-azurevm.md).  

## <a name="log-in-to-azure-portal"></a>Вход на портал Azure
Войдите на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com). 

## <a name="create-alerts"></a>Создание оповещений

Оповещения создаются с помощью правил оповещения, которые автоматически выполняют поиск по журналам через регулярные интервалы.  Можно создать оповещения, основанные на конкретных метках производительности, создании конкретных событий, отсутствии события или создании ряда событий за определенный период.  Например, оповещения можно использовать для уведомления о том, что средняя загрузка ЦП превышает определенный порог, или для уведомления о создании события, возникающего, если определенная служба Windows или управляющая программа Linux не выполняется.   Если результаты поиска по журналам соответствуют определенным условиям, создается запись оповещения. После этого правило может автоматически запустить одно или несколько действий, чтобы заблаговременно уведомить вас об оповещении либо вызвать другой процесс. 

В следующем примере мы создадим правило генерации оповещений по измерению метрики, которое будет создавать оповещение для каждого объекта-компьютера в запросе со значением, превышающим порог в 90 %.

1. На портале Azure щелкните **Все службы**. В списке ресурсов введите **Log Analytics**. Как только вы начнете вводить символы, список отфильтруется соответствующим образом. Выберите **Log Analytics**.
2. Выберите и запустите портал OMS, а на странице **Обзор** выберите **Поиск по журналам**.  
3. Щелкните **Избранное** в верхней части портала и в правой области **Сохраненные условия поиска** выберите запрос *Виртуальные машины Azure — загрузка процессора*.  
4. Щелкните **Оповещение** в верхней части страницы, чтобы открыть экран **Добавить правило оповещения**.  
5. Настройте правило генерации оповещений, указав следующие сведения:  
   a. Укажите **имя** для оповещения, например *Загрузка процессора виртуальной машины превышает 90*.  
   Б. В поле **Временное окно** укажите период времени для запроса, например *30*.  Запрос возвращает только те записи, которые были созданы в течение этого периода, предшествующего настоящему времени.  
   c. Значение **Периодичность оповещений** указывает, как часто должен выполняться запрос.  В этом примере укажите *5* минут, которые будут входить в заданное временное окно.  
   d. Выберите **Измерение метрик** и введите *90* в поле **Суммарное значение** и *3* — в поле **Активировать оповещение на основе** .  
   д. В разделе **Действия** отключите уведомление по электронной почте.
6. Щелкните **Сохранить** для завершения работы с правилом генерации оповещений. Оно начнет выполняться немедленно.<br><br> ![Пример правила генерации оповещения](media/log-analytics-tutorial-response/log-analytics-alert-01.png)

Записи оповещений, созданные правилами генерации оповещений в Log Analytics, имеют тип **Alert** и значение **OMS** для параметра SourceSystem.<br><br> ![Пример создаваемого события оповещения](media/log-analytics-tutorial-response/log-analytics-alert-events-01.png)  

## <a name="alert-actions"></a>Действия оповещений
С оповещениями можно выполнять дополнительные действия, например создавать уведомления по электронной почте, запускать [модуль Runbook службы автоматизации](../automation/automation-runbook-types.md), использовать веб-перехватчик для создания записи инцидента в системе управления инцидентами ITSM или в [решении соединителя управления ИТ-службами](log-analytics-itsmc-overview.md) в качестве ответного действия при соблюдении условий оповещения.   

Действия электронной почты отправляют сообщение электронной почты с описанием оповещения одному или нескольким получателям. Вы можете указать тему сообщения, но его содержимое имеет стандартный формат, определяемый службой Log Analytics.  Мы изменим правило генерации оповещений, созданное ранее, и настроим отправку уведомлений по электронной почте вместо активного отслеживания записи оповещения с помощью поиска по журналам.     

1. На портале OMS в меню вверху выберите **Параметры**, а затем **Оповещения**.
2. В списке правил генерации оповещений щелкните значок карандаша рядом с оповещением, созданным ранее.
3. В разделе **Действия** включите уведомления по электронной почте.
4. Укажите **Тему** сообщения, например *Загрузка процессора превышает порог 90*.
5. Добавьте адреса одного или нескольких получателей сообщения в поле **Получатели**.  При указании нескольких адресов разделяйте их точкой с запятой (;).
6. Щелкните **Сохранить** для завершения работы с правилом генерации оповещений. Оно начнет выполняться немедленно.<br><br> ![Правило генерации оповещений с уведомлением по электронной почте](media/log-analytics-tutorial-response/log-analytics-alert-02.png)

## <a name="next-steps"></a>Дополнительная информация
В этом руководстве вы узнали, как правила генерации оповещений позволяют своевременно выявлять проблемы и реагировать на них путем выполнения поиска по журналам через запланированные интервалы и обнаружения соответствия определенным условиям.  

Чтобы увидеть готовые примеры сценариев Log Analytics, перейдите по ссылке ниже.  

> [!div class="nextstepaction"]
> [Примеры сценариев Log Analytics](powershell-samples.md)