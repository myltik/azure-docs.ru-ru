---
title: "Краткое руководство. Создание сервера службы \"База данных Azure для PostgreSQL\" с помощью портала Azure"
description: "Краткое руководство по созданию базы данных Azure для сервера PostgreSQL и управлению ею с помощью пользовательского интерфейса портала Azure."
services: postgresql
author: rachel-msft
ms.author: raagyema
manager: kfile
editor: jasonwhowell
ms.service: postgresql
ms.custom: mvc
ms.topic: quickstart
ms.date: 02/28/2018
ms.openlocfilehash: 83bdc6eba35f0deaaf541f2042854764ae513fb9
ms.sourcegitcommit: c765cbd9c379ed00f1e2394374efa8e1915321b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/28/2018
---
# <a name="quickstart-create-an-azure-database-for-postgresql-server-in-the-azure-portal"></a>Краткое руководство. Создание сервера службы "База данных Azure для PostgreSQL" на портале Azure

База данных Azure для PostgreSQL — это управляемая служба, с помощью которой можно запускать и масштабировать базы данных PostgreSQL высокой доступности, а также управлять ими в облаке. Из этого краткого руководства вы узнаете, как за 5 минут создать сервер службы "База данных Azure для PostgreSQL" с помощью портала Azure.

Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.

## <a name="sign-in-to-the-azure-portal"></a>Выполните вход на портал Azure.
Откройте веб-браузер и перейдите на [портал](https://portal.azure.com/). Введите свои учетные данные для входа на портал. Панель мониторинга службы является представлением по умолчанию.

## <a name="create-an-azure-database-for-postgresql-server"></a>Создание сервера базы данных Azure для PostgreSQL

Сервер службы "База данных Azure для PostgreSQL" создается с настроенным набором [вычислительных ресурсов и ресурсов хранения](./concepts-pricing-tiers.md). Он создается в [группе ресурсов Azure](../azure-resource-manager/resource-group-overview.md).

Чтобы создать базу данных Azure для сервера PostgreSQL, выполните такие действия:
1. Нажмите кнопку **Создать ресурс** (+) в левом верхнем углу окна портала.

2. Выберите **Базы данных** > **База данных Azure для PostgreSQL**.

    ![Параметр "База данных Azure для PostgreSQL"](./media/quickstart-create-database-portal/1-create-database.png)

3. Заполните форму для создания сервера, указав следующую информацию:

    ![Создание сервера](./media/quickstart-create-database-portal/3-create.png)

    Параметр|Рекомендуемое значение|ОПИСАНИЕ
    ---|---|---
    имя сервера; |*mydemoserver*|Уникальное имя, идентифицирующее базу данных Azure для сервера PostgreSQL. Имя домена *postgres.database.azure.com* добавляется к указанному имени сервера. Сервер может содержать только строчные буквы, цифры и знак дефиса (-). Его длина должна составлять от 3 до 63 символов.
    Подписка|Имя вашей подписки|Подписка Azure, которую вы хотите использовать для сервера. Если у вас есть несколько подписок, выберите ту, в которой взимается плата за использование ресурса.
    Группа ресурсов|*myresourcegroup*| Новое имя группы ресурсов или уже имеющееся из подписки.
    Выбор источника | *Пустой* | Чтобы создать сервер с нуля, выберите *Пустой*. Если вы создаете сервер из геоизбыточной резервной копии существующего сервера службы "База данных Azure для PostgreSQL", выберите *Резервная копия*.
    учетные данные администратора сервера для входа; |*myadmin*| Собственная учетная запись входа, используемая при подключении к серверу. Не используйте для имени учетной записи администратора такие варианты: **azure_superuser**, **azure_pg_admin**, **admin**, **administrator**, **root**, **guest** или **public**. Оно не может начинаться с **pg_**.
    Пароль |Ваш пароль| Новый пароль для учетной записи администратора сервера. Пароль должен содержать от 8 до 128 символов. Пароль должен содержать символы трех из следующих категорий: прописные латинские буквы, строчные латинские буквы, цифры (от 0 до 9) и другие символы (!, $, #, % и т. д.).
    Расположение|Ближайший к пользователям регион| Ближайшее к пользователям расположение.
    Version (версия)|Последняя версия| Последняя версия PostgreSQL, если нет особых требований.
    Ценовой уровень | **Общего назначения**, **Поколение 4**, **2 виртуальных ядра**, **5 ГБ**, **7 дней**, **Геоизбыточное** | Конфигурации вычислительных ресурсов, хранилища и резервного копирования для нового сервера. Выберите **ценовую категорию**. Затем выберите вкладку **Общего назначения**. *Поколение 4*, *2 виртуальных ядра*, *5 ГБ*, и *7 дней* — это значения по умолчанию для параметров **Поколение вычислительных ресурсов**, **Виртуальное ядро**, **Хранилище** и **Срок хранения резервных копий**. Можно оставить эти ползунки как есть. Чтобы включить резервное копирование сервера в геоизбыточном хранилище, выберите **Геоизбыточное** в разделе **параметров избыточности резервного копирования**. Щелкните **ОК**, чтобы сохранить ценовую категорию. На следующем снимке экрана показаны выбранные параметры.

    > [!IMPORTANT]
    > Указанные здесь учетные данные и пароль администратора сервера понадобятся позже в этом руководстве, чтобы войти на сервер и в его базу данных. Запомните или запишите эту информацию для последующего использования.

    ![Область "Ценовая категория"](./media/quickstart-create-database-portal/2-pricing-tier.png)

4. Щелкните **Создать**, чтобы подготовить сервер. Это может занять несколько минут.

5. На панели инструментов щелкните значок **Уведомления** (колокольчик), чтобы отслеживать процесс развертывания. По завершении развертывания можно выбрать **Закрепить на панели мониторинга**. После этого на панели мониторинга на портале Azure отобразится плитка, которая будет служить ярлыком страницы **Обзор** для этого сервера. Если выбрать **Перейти к ресурсу**, откроется страница сервера **Обзор**.

    ![Область "Уведомления"](./media/quickstart-create-database-portal/3-notifications.png)
   
  По умолчанию на сервере создается база данных **postgres**. База данных [postgres](https://www.postgresql.org/docs/9.6/static/app-initdb.html) — это база данных по умолчанию, предназначенная для использования пользователями, служебными программами и сторонними приложениями. 

## <a name="configure-a-server-level-firewall-rule"></a>Настройка правила брандмауэра на уровне сервера

База данных Azure для PostgreSQL создает брандмауэр на уровне сервера. Он не позволяет внешним приложениям и инструментам подключаться к серверу и к любой базе данных на сервере, если не создано правило, открывающее брандмауэр для определенных IP-адресов. 

1. Найдите сервер после завершения развертывания. При необходимости можно выполнить поиск. Например, в меню слева выберите **Все ресурсы**. Чтобы найти созданный сервер, введите его имя, например **mydemoserver**. Выберите имя сервера в списке результатов поиска. После этого откроется страница **обзора** сервера с параметрами для дальнейшей конфигурации.
 
    ![Поиск по имени сервера](./media/quickstart-create-database-portal/4-locate.png)

2. На странице сервера выберите **Безопасность подключения**.

3. В разделе **Правила брандмауэра** в столбце **Имя правила** щелкните пустое текстовое поле, чтобы создать правило брандмауэра. 

    В этом кратком руководстве мы разрешим трафик на сервер со всех IP-адресов. Заполните текстовое поле в каждом столбце такими значениями:

    Имя правила | Начальный IP-адрес | Конечный IP-адрес 
    ---|---|---
    AllowAllIps | 0.0.0.0 | 255.255.255.255

     ![Настройка правил брандмауэра](./media/quickstart-create-database-portal/5-firewall-2.png)

4. На верхней панели инструментов на странице **Безопасность подключения** щелкните **Сохранить**. Прежде чем продолжить, подождите, пока не появится уведомление о том, что обновление безопасного подключения успешно завершено.

    > [!NOTE]
    > Подключения к базе данных Azure для сервера PostgreSQL выполняются через порт 5432. При попытке подключиться из корпоративной сети исходящий трафик через порт 5432 может блокироваться сетевым брандмауэром. В таком случае вы не сможете подключиться к серверу. Для этого ваш ИТ-отдел должен открыть порт 5432.
    >

## <a name="get-the-connection-information"></a>Получение сведений о подключении

При создании базы данных Azure для сервера PostgreSQL создается база данных по умолчанию с именем **postgres**. Чтобы подключиться к серверу базы данных, вам потребуются учетные данные администратора для входа и полное имя сервера. Скорее всего, вы уже записали эти значения раньше. Если вы не сделали этого, имя сервера и данные для входа можно легко найти на странице **Обзор** сервера на портале.

Откройте страницу сервера **Обзор**. Запишите значения **имени сервера** и **имени для входа администратора сервера**. Наведите указатель на каждое поле. Справа от текста отобразится символ копирования. Щелкните его, чтобы скопировать нужные значения.

 ![Страница "Обзор" сервера](./media/quickstart-create-database-portal/6-server-name.png)

## <a name="connect-to-the-postgresql-database-by-using-psql-in-cloud-shell"></a>Подключение к базе данных PostgreSQL с помощью psql в Cloud Shell

К базе данных Azure для сервера PostgreSQL можно подключиться с помощью нескольких приложений. Сначала воспользуемся служебной программой командной строки psql для подключения к серверу. Веб-браузер и Azure Cloud Shell можно использовать, как описано здесь, без установки дополнительного программного обеспечения. Если на вашем компьютере установлена служебная программа psql, вы можете подключиться с него.

1. В верхней части области навигации щелкните символ терминала, чтобы открыть Cloud Shell.

   ![Символ терминала Azure Cloud Shell](./media/quickstart-create-database-portal/7-cloud-console.png)

2. В браузере откроется служба Cloud Shell, где вы можете вводить команды оболочки Bash.

   ![Строка Shell Cloud Shell](./media/quickstart-create-database-portal/8-bash.png)

3. Чтобы подключиться к базе данных Azure для сервера PostgreSQL, введите команду в командной строке psql.

    Чтобы подключиться к серверу базы данных Azure для PostgreSQL с помощью служебной программы [psql](https://www.postgresql.org/docs/9.6/static/app-psql.html), используйте следующий формат:
    ```bash
    psql --host=<yourserver> --port=<port> --username=<server admin login> --dbname=<database name>
    ```

    Например, следующая команда позволяет подключиться к серверу, используемому для примера:

    ```bash
    psql --host=mydemoserver.postgres.database.azure.com --port=5432 --username=myadmin@mydemoserver --dbname=postgres
    ```

    Параметр psql |Значение|ОПИСАНИЕ
    ---|---|---
    --host | имя сервера; | Значение имени сервера, которое вы использовали раньше при создании базы данных Azure для сервера PostgreSQL. В нашем примере используется имя сервера **mydemoserver.postgres.database.azure.com**. Используйте полное доменное имя (**\*.postgres.database.azure.com**), как показано в примере. Если вы не помните имя своего сервера, выполните действия из предыдущего раздела, чтобы получить сведения о подключении. 
    --port | 5432 | Порт, используемый при подключении к базе данных Azure для сервера PostgreSQL. 
    --username | Имя для входа администратора сервера |Имя для входа администратора сервера, которое вы использовали раньше при создании базы данных Azure для сервера PostgreSQL. Если вы не помните имя пользователя, выполните действия из предыдущего раздела, чтобы получить сведения о подключении. Используйте формат *username@servername*.
    --dbname | *postgres* | Имя базы данных по умолчанию, созданное системой при первом подключении. Позже можно создать собственную базу данных.

    Когда вы запустите команду psql с собственными значениями параметров, появится запрос на ввод пароля администратора сервера. Это пароль, указанный при создании сервера. 

    Параметр psql |Рекомендуемое значение|ОПИСАНИЕ
    ---|---|---
    password | Ваш пароль администратора | Символы введенного пароля не отображаются в строке Bash. После ввода всех символов нажмите клавишу ВВОД, чтобы пройти аутентификацию и подключиться.

    После подключения служебная программа psql отображает запрос postgres в поле, где вы вводите команды sql. Возможно, в первоначальных выходных данных подключения отобразится предупреждение, так как psql в Cloud Shell может иметь версию, отличную от версии сервера службы "База данных Azure для PostgreSQL". 
    
    Пример выходных данных psql:
    ```bash
    psql (9.5.7, server 9.6.2)
    WARNING: psql major version 9.5, server major version 9.6.
        Some psql features might not work.
    SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-SHA384, bits: 256, compression: off)
    Type "help" for help.
   
    postgres=> 
    ```

    > [!TIP]
    > Если в брандмауэре не настроено разрешение IP-адресов Cloud Shell, возникнет следующая ошибка:
    > 
    > "psql: FATAL: нет записи pg_hba.conf для узла 0.0.0.0, пользователь myadmin, база данных postgres, подключение SSL для FATAL: необходимо SSL-подключение". Укажите параметры SSL и повторите попытку.
    > 
    > Чтобы устранить эту ошибку, убедитесь, что конфигурация сервера соответствует инструкциям в разделе "Настройка правила брандмауэра на уровне сервера" этой статьи.

4. Создайте пустую базу данных с именем mypgsqldb. Для этого в командной строке введите следующую команду:
    ```bash
    CREATE DATABASE mypgsqldb;
    ```
    Выполнение команды может занять несколько минут. 

5. Чтобы подключиться к созданной базе данных **mypgsqldb**, выполните в командной строке следующую команду:
    ```bash
    \c mypgsqldb
    ```

6. Введите `\q` и нажмите клавишу ВВОД, чтобы выйти из psql. После завершения можно закрыть Cloud Shell.

Вы подключились к серверу службы "База данных Azure для PostgreSQL" через psql в Cloud Shell и создали пустую пользовательскую базу данных. Перейдите к следующему разделу, чтобы подключиться к базе данных с помощью другого популярного средства — pgAdmin.

## <a name="connect-to-the-postgresql-server-using-pgadmin"></a>Подключение к серверу PostgreSQL с помощью pgAdmin

pgAdmin — это средство с открытым кодом, которое используется с PostgreSQL. Средство PgAdmin можно установить с [веб-сайта pgAdmin](http://www.pgadmin.org/). Ваша версия pgAdmin может отличаться от используемой в этом кратком руководстве. Если вам требуются дополнительные инструкции, ознакомьтесь с документацией по pgAdmin.

1. Откройте приложение pgAdmin на клиентском компьютере.

2. На панели инструментов выберите **Object** (Объект), наведите указатель мыши на пункт **Create** (Создать) и выберите **Server** (Сервер).

3. На вкладке **General** (Общее) в диалоговом окне **Create - Server** (Создание сервера) введите уникальное понятное имя сервера, например **mydemoserver**.

    ![Вкладка "Общие"](./media/quickstart-create-database-portal/9-pgadmin-create-server.png)

4. На вкладке **Connection** (Подключение) в диалоговом окне **Create - Server** (Создание сервера) заполните таблицу настроек.

   ![Вкладка "Подключение"](./media/quickstart-create-database-portal/10-pgadmin-create-server.png)

    параметр pgAdmin |Значение|ОПИСАНИЕ
    ---|---|---
    Имя узла и адрес | имя сервера; | Значение имени сервера, которое вы использовали раньше при создании базы данных Azure для сервера PostgreSQL. В нашем примере используется имя сервера **mydemoserver.postgres.database.azure.com**. Используйте полное доменное имя (**\*.postgres.database.azure.com**), как показано в примере. Если вы не помните имя своего сервера, выполните действия из предыдущего раздела, чтобы получить сведения о подключении. 
    Порт | 5432 | Порт, используемый при подключении к базе данных Azure для сервера PostgreSQL. 
    База данных обслуживания | *postgres* | Имя базы данных по умолчанию, созданное системой.
    Имя пользователя | Имя для входа администратора сервера | Имя для входа администратора сервера, которое вы использовали раньше при создании базы данных Azure для сервера PostgreSQL. Если вы не помните имя пользователя, выполните действия из предыдущего раздела, чтобы получить сведения о подключении. Используйте формат *username@servername*.
    Пароль | Ваш пароль администратора | Пароль, выбранный при создании сервера во время работы с этим руководством.
    Роль | Не указывайте | Указывать роль на этом шаге не нужно. Оставьте поле пустым.
    Режим SSL | *Require* | На вкладке pgAdmin SSL можно настроить режим SSL. По умолчанию все серверы службы "База данных Azure для PostgreSQL" создаются с включенным применением SSL. Чтобы отключить применение SSL, см. сведения о [включении SSL](./concepts-ssl-connection-security.md).
    
5. Щелкните **Сохранить**.

6. В области **Браузер** слева разверните узел **Серверы**. Выберите свой сервер, например **mydemoserver**. Щелкните, чтобы подключиться к нему.

7. Разверните узел сервера, а затем разверните раздел **Базы данных** под ним. Список должен включать существующую базу данных *postgres* и еще одну базу данных, созданную вами. С помощью службы "База данных Azure для PostgreSQL" для сервера можно создать несколько баз данных.

8. Щелкните правой кнопкой мыши **Базы данных**, выберите меню **Создать**, а затем щелкните **База данных**.

9. Введите выбранное имя базы данных в поле **База данных**, например **mypgsqldb2**.

10. Выберите **владельца** базы данных из списка. Выберите имя администратора сервера для входа (например, **mylogin**).

   ![Создание базы данных в pgadmin](./media/quickstart-create-database-portal/11-pgadmin-database.png)

11. выберите **Сохранить**, чтобы создать пустую базу данных.

12. Созданная база данных отобразится в области **Обзор** в списке баз данных под именем сервера.


## <a name="clean-up-resources"></a>Очистка ресурсов
Удалить ресурсы, созданные в ходе работы с этим руководством, можно с помощью одного из двух способов. Вы можете удалить [группу ресурсов Azure](../azure-resource-manager/resource-group-overview.md), которая содержит все связанные ресурсы. Чтобы сохранить другие ресурсы, удалите только ресурс сервера.

> [!TIP]
> Другие краткие руководства в этой коллекции созданы на основе этого документа. Если вы планируете продолжать работу с этими краткими руководствами, не удаляйте созданные ресурсы, а если нет — удалите все созданные в ходе работы с ним ресурсы, выполнив приведенные ниже действия на портале.

Чтобы удалить группу ресурсов, в том числе только что созданный сервер, сделайте следующее:
1. Найдите группу ресурсов на портале. В меню слева выберите **Группы ресурсов**. Затем выберите имя группы ресурсов (например, **myresourcegroup**).

2. На странице группы ресурсов щелкните **Удалить**. Затем введите имя своей группы ресурсов, например **myresourcegroup**, в текстовое поле, чтобы подтвердить удаление. Нажмите кнопку **Удалить**.

Чтобы удалить только что созданный сервер, сделайте следующее:
1. Найдите сервер на портале, если от еще не открыт. В меню слева выберите **Все ресурсы**. Затем найдите созданный сервер.

2. На странице **Обзор** выберите **Удалить**.

    ![Кнопка "Удалить"](./media/quickstart-create-database-portal/12-delete.png)

3. Подтвердите имя сервера, которое нужно удалить, чтобы появилась нужная база данных. Введите имя сервера в текстовое поле (например, **mydemoserver**). Нажмите кнопку **Удалить**.

## <a name="next-steps"></a>Дополнительная информация
> [!div class="nextstepaction"]
> [Перенос базы данных с помощью экспорта и импорта](./howto-migrate-using-export-and-import.md)
