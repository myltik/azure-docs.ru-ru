---
title: "DNS в Azure Stack | Документация Майкрософт"
description: "DNS в Azure Stack"
services: azure-stack
documentationcenter: 
author: mattbriggs
manager: femila
ms.assetid: 
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/28/2018
ms.author: mabrigg
ms.openlocfilehash: 394abe5295af4ed99e48d50b5886ac93af87e875
ms.sourcegitcommit: 782d5955e1bec50a17d9366a8e2bf583559dca9e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2018
---
# <a name="dns-in-azure-stack"></a>DNS в Azure Stack

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

Azure Stack включает следующие компоненты DNS:
* разрешение DNS-имен узлов;
* создание зон и записей DNS и управление ими через API-интерфейс.

## <a name="support-for-dns-hostname-resolution"></a>Разрешение DNS-имен узлов
Вы можете указать метку доменного имени DNS для ресурса с общедоступным IP-адресом. После этого на DNS-серверах под управлением Azure адрес *метка_домена.расположение*.cloudapp.azurestack.external будет сопоставлен с этим общедоступным IP-адресом.  

Например, если вы создадите в локальном расположении Azure Stack ресурс с общедоступным IP-адресом и укажете для него метку доменного имени **contoso**, полное доменное имя **contoso.local.cloudapp.azurestack.external** будет разрешаться в общедоступный IP-адрес этого ресурса. Это полное доменное имя можно указать в записи CNAME, которая указывает на общедоступный IP-адрес в Azure Stack.

> [!IMPORTANT]
> Каждая создаваемая метка доменного имени должна быть уникальной в пределах своего расположения в Azure Stack.

Создание общедоступного IP-адреса на портале выглядит так:

![Создание общедоступного IP-адреса](media/azure-stack-whats-new-dns/image01.png)

Такая конфигурация удобна, если вам нужно связать общедоступный IP-адрес с ресурсом, для которого выполняется балансировка нагрузки. Предположим, что запросы от веб-приложения обрабатывает подсистема балансировки нагрузки. Веб-сайт, расположенный за подсистемой балансировки нагрузки, размещается на одной или нескольких виртуальных машинах. Теперь вы можете обращаться к веб-сайту за подсистемой балансировки нагрузки не только по IP-адресу, но и по доменному имени.

## <a name="create-and-manage-dns-zones-and-records-using-api"></a>Создание зон и записей DNS и управление ими через API-интерфейс
В Azure Stack вы можете создавать зоны и записи DNS и управлять ими.  

Azure Stack, как и Azure, предоставляет службу DNS. API-интерфейсы этой службы совпадают с интерфейсами службы Azure DNS.  Размещая домены в Azure Stack DNS, вы можете управлять своими записями DNS с помощью тех же учетных данных, API, инструментов, процедуры выставления счетов и поддержки, что и в других службах Azure. 

Вполне очевидно, что инфраструктура Azure Stack DNS более компактна, чем ее аналог в Azure. Ее масштаб, область действия и производительность зависят от масштаба развертывания Azure Stack и среды, в которой она развернута.  Это означает, что показатели производительности, доступности, глобального распространения и уровня доступности будут зависеть от конкретного развертывания.

## <a name="comparison-with-azure-dns"></a>Сравнение с Azure DNS
Служба DNS в Azure Stack действует так же, как и в Azure, с двумя важными различиями:
* **Записи AAAA не поддерживаются**.

    Azure Stack НЕ поддерживает записи AAAA, так как Azure Stack не поддерживает адреса IPv6.  Это ключевое различие между службами DNS в Azure и Azure Stack.
* **Мультитенантность не поддерживается**.

    В отличие от Azure, служба DNS в Azure Stack не является мультитенантной. Это означает, что разные клиенты не смогут создать одинаковые зоны DNS. Успешной будет только первая попытка создать зону, а все последующие запросы завершатся ошибкой.  Это известная проблема и второе ключевое различие между службами DNS в Azure и Azure Stack. Она будет устранена в одном из последующих выпусков.

Кроме того, есть несколько незначительных различий в том, как Azure Stack DNS использует теги, метаданные, ETag и ограничения.

Следующие сведения относятся только к службе Azure Stack DNS, поведение которой несколько отличается от Azure DNS. Дополнительные сведения об Azure DNS см. в статье о [зонах и записях DNS](../../dns/dns-zones-records.md) на сайте документации Microsoft Azure.

### <a name="tags-metadata-and-etags"></a>Теги, метаданные и теги ETag

**Теги**

Azure Stack DNS поддерживает использование тегов Azure Resource Manager в ресурсах зоны DNS. Но использование тегов в наборе записей DNS не поддерживается. Вместо этого в наборе записей DNS можно использовать метаданные, как описано ниже.

**Metadata**

Вместо тегов для наборов записей Azure Stack DNS поддерживает создание заметок с помощью метаданных. Так же как и теги, метаданные позволяют связывать пары "имя — значение" с каждым набором записей. К примеру, это позволяет указать назначение каждого набора записей. В отличие от тегов метаданные нельзя использовать, чтобы обеспечить отфильтрованное представление счетов Azure, и указывать в политике Azure Resource Manager.

**Теги ETag**

Предположим, что два человека или два процесса пробуют изменить запись DNS одновременно. У какого из них это получится? И будет ли этот человек или процесс знать, что они заменили изменения кого-то другого?

Служба Azure Stack DNS использует теги ETag для безопасной обработки параллельных изменений одного ресурса. Теги ETag не связаны с тегами Azure Resource Manager. С каждым ресурсом DNS (зоной или набором записей) связан Etag. При извлечении ресурса также передается его значение Etag. При обновлении ресурса вы можете вернуть ETag, чтобы служба Azure Stack DNS могла сопоставить его с ETag на сервере. Так как каждое обновление ресурса приводит к повторному созданию Etag, несовпадение Etag указывает на параллельное изменение. Теги Etag можно также использовать при создании ресурса для проверки того, что ресурс не существует.

По умолчанию PowerShell для Azure Stack DNS использует теги ETag для защиты от одновременных изменений зон и наборов записей. С помощью необязательного параметра *-Overwrite* можно отключить проверки тегов Etag. В этом случае все одновременные изменения перезаписываются.

На уровне REST API службы Azure Stack DNS теги ETag указываются с помощью заголовков HTTP. Их поведение описывается в следующей таблице:

| Заголовок | Поведение|
|--------|---------|
| None   | PUT всегда завершается успешно (без проверки Etag)|
| If-match| PUT завершается успешно, только если ресурс существует и Etag соответствует|
| If-match *| PUT завершается успешно, только если ресурс существует|
| If-none-match*| PUT завершается успешно, только если ресурс не существует|

### <a name="limits"></a>Ограничения

При использовании Azure Stack DNS по умолчанию применяются следующие ограничения:

| Ресурс| Ограничение по умолчанию|
|---------|--------------|
| Зон на подписку| 100|
| Наборов записей на зону| 5000|
| Записей на набор записей| 20|

## <a name="next-steps"></a>Дополнительная информация
[Общие сведения об iDNS для Azure Stack](azure-stack-understanding-dns.md)
