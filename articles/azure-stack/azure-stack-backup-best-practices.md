---
title: Рекомендации по службе резервного копирования инфраструктуры для Azure Stack | Документация Майкрософт
description: Следуйте этому набору рекомендаций при развертывании и администрировании Azure Stack в вашем центре обработки данных, чтобы снизить риск потери данных в случае катастрофического сбоя.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''
ms.assetid: 221FDE40-3EF8-4F54-A075-0C4D66EECE1A
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 4/20/2017
ms.author: mabrigg
ms.reviewer: hectorl
ms.openlocfilehash: ec30832e6863ad92eff8f5c2e613adc503c73af5
ms.sourcegitcommit: fc64acba9d9b9784e3662327414e5fe7bd3e972e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2018
ms.locfileid: "34075754"
---
# <a name="infrastructure-backup-service-best-practices"></a>Рекомендации по службе резервного копирования инфраструктуры

*Область применения: интегрированные системы Azure Stack и Пакет средств разработки Azure Stack*

Следуйте этим рекомендациям при развертывании и администрировании Azure Stack в вашем центре обработки данных, чтобы снизить риск потери данных в случае катастрофического сбоя.

Регулярно просматривайте рекомендации, чтобы удостовериться, что установка по-прежнему соответствует требованиям после внесения изменений в рабочий процесс. Если у вас возникнут проблемы при реализации этих рекомендаций, обратитесь за помощью в службу поддержки Майкрософт.

## <a name="configuration-best-practices"></a>Рекомендации по настройке

### <a name="deployment"></a>Развертывание

Включайте резервное копирование инфраструктуры после развертывания каждого облака Azure Stack. С помощью AzureStack-Tools можно запланировать резервное копирование из любого клиента или сервера с доступом к конечной точке API управления для оператора.

### <a name="networking"></a>Сеть

В UNC-строке для пути необходимо использовать полное доменное имя (FQDN). Если разрешение имен не поддерживается, можно указать IP-адрес. UNC-строка указывает расположение ресурсов, например общих файлов или устройств.

### <a name="encryption"></a>Шифрование

Ключ шифрования используется для шифрования резервных копий, которые экспортируются во внешнее хранилище. Этот ключ можно создать с помощью AzureStack-Tools. 

![AzureStack-Tools](media\azure-stack-backup\azure-stack-backup-encryption1.png)

Ключ должен храниться в надежном расположении (например, как секрет в открытом хранилище Azure Key Vault). Этот ключ нужно использовать во время повторного развертывания Azure Stack. 

![Сохранение ключа в безопасном расположении](media\azure-stack-backup\azure-stack-backup-encryption2.png)

## <a name="operational-best-practices"></a>Рекомендации по использованию

### <a name="backups"></a>Резервные копии

 - Контроллер резервного копирования инфраструктуры должен активироваться по требованию. Рекомендуем выполнять резервное копирование как минимум дважды в день.
 - Задания резервного копирования выполняются во время работы системы. Это обеспечивает бесперебойное управление и функционирование пользовательских приложений. Выполнение заданий резервного копирования занимает 20–40 минут для решений с нормальной нагрузкой.
 - В соответствии с предоставляемыми OEM инструкциями, созданные вручную резервные копии сетевых коммутаторов и узла жизненного цикла оборудования (HLH) должны храниться в одном общем ресурсе резервного копирования, где контроллер резервного копирования инфраструктуры сохраняет резервные копии данных плоскости управления. Рекомендуем сохранять конфигурации коммутаторов и HLH в папке региона. Если в одном регионе есть несколько экземпляров Azure Stack, советуем использовать идентификатор для каждой конфигурации, которая относится к единице масштабирования.

### <a name="folder-names"></a>Имена папок

 - В инфраструктуре автоматически создается папка MASBACKUP. Это общий ресурс под управлением Майкрософт. Можно создавать общие ресурсы на том же уровне, что и MASBACKUP. Не рекомендуем создавать папки или хранить данные в папке MASBACKUP, если они созданы не в Azure Stack. 
 -  Используйте в имени папки полное доменное имя и название региона, чтобы различать резервные копии данных из разных облаков. Полное доменное имя (FQDN) развертывания Azure Stack и конечных точек представляет собой сочетание параметра региона и имени внешнего домена. Дополнительные сведения см. в статье [Интеграция центра обработки данных Azure Stack — DNS](azure-stack-integrate-dns.md).

Предположим, что общий ресурс резервного копирования AzSBackups размещен в fileserver01.contoso.com. В этом файловом ресурсе может содержаться папка каждого развертывания Azure Stack, для которой используется внешнее доменное имя, и вложенная папка, для которой используется название региона. 

Полное доменное имя: contoso.com  
Регион: nyc


    \\fileserver01.contoso.com\AzSBackups
    \\fileserver01.contoso.com\AzSBackups\contoso.com
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\MASBackup

В папке MASBackup хранятся резервные копии Azure Stack. Не следует использовать эту папку для хранения личных данных. Изготовители оборудования также не должны использовать эту папку для хранения резервных копий. 

Изготовителям оборудования рекомендуется хранить резервные копии своих компонентов в папке региона. Данные каждого сетевого коммутатора, узла жизненного цикла оборудования (HLH) и т. д. должны храниться в отдельной вложенной папке. Например: 

    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\HLH
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\Switches
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\DeploymentData
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\Registration

### <a name="monitoring"></a>Мониторинг

В системе поддерживаются следующие предупреждения:

| Предупреждение                                                   | ОПИСАНИЕ                                                                                     | Исправление                                                                                                                                |
|---------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| Сбой резервного копирования: исчерпана емкость файлового ресурса | Емкость файлового ресурса исчерпана, и контроллеру резервного копирования не удается экспортировать резервные копии в расположение. | Увеличьте емкость хранилища и повторите попытку резервного копирования. Удалите существующие резервные копии (начиная с самых старых), чтобы освободить место.                    |
| Сбой резервного копирования: проблемы с подключением             | В сети между Azure Stack и файловым ресурсом возникли проблемы.                          | Устраните проблему с сетью и повторите попытку резервного копирования.                                                                                            |
| Сбой резервного копирования: ошибка пути                | Не удается разрешить путь к файловому ресурсу.                                                          | Сопоставьте общий ресурс с другого компьютера, чтобы убедиться в наличии доступа к ресурсу. Возможно, потребуется обновить путь, если он недействителен.       |
| Сбой резервного копирования: проблема с аутентификацией               | Проблема с учетными данными или сетью, влияющая на процесс аутентификации.    | Сопоставьте общий ресурс с другого компьютера, чтобы убедиться в наличии доступа к ресурсу. Возможно, потребуется обновить учетные данные, если они недействительны. |
| Сбой резервного копирования: общий сбой                    | Сбой выполнения запроса может быть вызван временной проблемой. Повторите попытку резервного копирования.                    | Обратитесь в службу поддержки.                                                                                                                               |

## <a name="next-steps"></a>Дополнительная информация

 - Ознакомьтесь со справочными материалами по [службе резервного копирования инфраструктуры](azure-stack-backup-reference.md).  
 - Ознакомьтесь с инструкциями по включению [службы резервного копирования инфраструктуры](azure-stack-backup-enable-backup-console.md).