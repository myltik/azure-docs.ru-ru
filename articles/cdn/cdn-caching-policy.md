---
title: Управление политикой кэширования Azure CDN в службах мультимедиа Azure | Документация Майкрософт
description: Узнайте, как управлять политикой кэширования Azure CDN в службах мультимедиа Azure.
services: media-services,cdn
documentationcenter: .NET
author: juliako
manager: erikre
editor: ''
ms.assetid: be33aecc-6dbe-43d7-a056-10ba911e0e94
ms.service: media-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/04/2017
ms.author: juliako
ms.openlocfilehash: dce8d588a78b028223776e3ade737d4abd26094b
ms.sourcegitcommit: e221d1a2e0fb245610a6dd886e7e74c362f06467
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
ms.locfileid: "33765291"
---
# <a name="manage-azure-cdn-caching-policy-in-azure-media-services"></a>Управление политикой кэширования Azure CDN в службах мультимедиа Azure
Службы мультимедиа Azure предоставляют адаптивную потоковую передачу и прогрессивное скачивание на основе протокола HTTP. Потоковая передача на основе протокола HTTP — это технология с высоким уровнем масштабируемости, обладающая преимуществами кэширования на стороне прокси-сервера и на стороне клиента, а также преимуществами слоев CDN. Функция конечных точек потоковой передачи предоставляет общие возможности потоковой передачи, а также конфигурацию для заголовков кэша HTTP. Она также задает заголовки HTTP Cache-Control: max-age и Expires. Узнать больше о заголовках кэша HTTP можно на веб-сайте [W3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html).

## <a name="default-caching-headers"></a>Заголовки кэша по умолчанию
Конечные точки потоковой передачи по умолчанию используют 3-дневные заголовки кэша для потоковой передачи данных по требованию (собственно мультимедийных фрагментов/блоков) и манифеста (списка воспроизведения). Для динамической потоковой передачи конечные точки потоковой передачи используют 3-дневные заголовки кэша для данных (собственно мультимедийных фрагментов/блоков) и 2-секундный заголовок для запросов манифеста (списка воспроизведения). При переключении динамической программы в программу по запросу (динамический архив) используются заголовки кэша потоковой передачи по запросу.

## <a name="azure-cdn-integration"></a>Интеграция Azure CDN
Службы мультимедиа Azure обеспечивают [интегрированную сеть CDN](https://azure.microsoft.com/updates/azure-media-services-now-fully-integrated-with-azure-cdn/) для конечных точек потоковой передачи. Заголовки Cache-control применяются таким же образом, как и конечные точки потоковой передачи для таких же точек с поддержкой CDN. В сетях CDN Azure значения кэша, настроенные для конечных точек потоковой передачи, используются, чтобы определить жизненный цикл внутренне кэшированных объектов и задать заголовки кэша доставки. При использовании конечных точек потоковой передачи с поддержкой CDN не рекомендуется устанавливать небольшие значения кэша. Малые значения кэша снижают производительность и нивелируют преимущество CDN. Задать заголовки кэша менее 600 секунд для конечных точек потоковой передачи с поддержкой CDN невозможно.

> [!IMPORTANT]
>Службы мультимедиа Azure полностью интегрированы с Azure CDN. Одним щелчком можно интегрировать все доступные поставщики Azure CDN в конечную точку потоковой передачи, включая продукты уровней "Стандартный" и "Премиум". Дополнительные сведения см. в [этом объявлении](https://azure.microsoft.com/blog/standardstreamingendpoint/).
> 
> Плата за передачу данных из конечной точки в CDN не взимается только тогда, когда CDN включена в API-интерфейсах конечной точки потоковой передачи или в разделе конечной точки потоковой передачи на портале Azure. При интеграции вручную или при непосредственном создании конечной точки CDN с помощью API-интерфейса CDN или на портале плата за передачу данных продолжает взиматься.

## <a name="configuring-cache-headers-with-azure-media-services"></a>Настройка заголовков кэша с помощью служб мультимедиа Azure
Чтобы настроить значения заголовков кэша, вы можете использовать портал Azure или API-интерфейсы служб мультимедиа Azure.

1. Чтобы настроить заголовки кэша с помощью портала Azure, выполните инструкции в разделе "Настройка конечной точки потоковой передачи" статьи [Управление конечными точками потоковой передачи с помощью портала Azure](../media-services/previous/media-services-portal-manage-streaming-endpoints.md).
2. Интерфейс REST API служб мультимедиа Azure, [StreamingEndpoint](https://msdn.microsoft.com/library/azure/dn783468.aspx#StreamingEndpointCacheControl).
3. Пакет SDK для служб мультимедиа Azure для .NET, [свойства StreamingEndpointCacheControl](http://go.microsoft.com/fwlink/?LinkId=615302).

## <a name="cache-configuration-precedence-order"></a>Порядок приоритета конфигурации кэша
1. Настроенные значения кэша служб мультимедиа Azure переопределяют значение по умолчанию.
2. При отсутствии настроек, заданных вручную, применяются значения по умолчанию.
3. По умолчанию для манифеста динамической потоковой передачи (списка воспроизведения) используются 2-секундные заголовки кэша независимо от конфигурации мультимедиа Azure или службы хранилища Azure, и переопределить это значение невозможно.

