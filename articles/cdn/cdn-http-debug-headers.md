---
title: Заголовки HTTP X-EC-Debug для обработчика правил Azure CDN | Документация Майкрософт
description: Заголовок запроса отладочной информации о кэше X-EC-Debug предоставляет дополнительные сведения о политике кэша, которая применяется к запрошенному ресурсу. Эти заголовки относятся к Verizon.
services: cdn
documentationcenter: ''
author: dksimpson
manager: akucer
editor: ''
ms.assetid: ''
ms.service: cdn
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/12/2018
ms.author: v-deasim
ms.openlocfilehash: 3a99e322d81748c54585e7dd0eb06959bfeb9569
ms.sourcegitcommit: 1362e3d6961bdeaebed7fb342c7b0b34f6f6417a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2018
ms.locfileid: "31516278"
---
# <a name="x-ec-debug-http-headers-for-azure-cdn-rules-engine"></a>Заголовки HTTP X-EC-Debug для обработчика правил Azure CDN
Заголовок запроса отладочной информации о кэше `X-EC-Debug` предоставляет дополнительные сведения о политике кэша, которая применяется к запрошенному ресурсу. Эти заголовки относятся к продуктам **Azure CDN уровня "Премиум" от Verizon**.

## <a name="usage"></a>Использование
Ответ, отправленный с серверов POP пользователю, включает заголовок `X-EC-Debug` только при выполнении следующих условий:

- в необходимом запросе для обработчика правил включена [функция заголовков ответа Debug Cache](cdn-rules-engine-reference-features.md#debug-cache-response-headers);
- в определенном запросе определен набор заголовков ответа Debug Cache, которые будут включены в ответ.

## <a name="requesting-debug-cache-information"></a>Запрос отладочной информации о кэше
Используйте следующие директивы в определенном запросе, чтобы определить, как отладочная информация о кэше будет включена в ответ:

Заголовок запроса | ОПИСАНИЕ |
---------------|-------------|
X-EC-Debug: x-ec-cache | [Код состояния кэша](#cache-status-code-information)
X-EC-Debug: x-ec-cache-remote | [Код состояния кэша](#cache-status-code-information)
X-EC-Debug: x-ec-check-cacheable | [Кэшируемые](#cacheable-response-header)
X-EC-Debug: x-ec-cache-key | [Ключ кэша](#cache-key-response-header)
X-EC-Debug: x-ec-cache-state | [Состояние кэша](#cache-state-response-header)

### <a name="syntax"></a>Синтаксис

Заголовки ответа Debug Cache можно запрашивать, добавив в запрос следующий заголовок и определенные директивы:

`X-EC-Debug: Directive1,Directive2,DirectiveN`

### <a name="sample-x-ec-debug-header"></a>Пример заголовка X-EC-Debug

`X-EC-Debug: x-ec-cache,x-ec-check-cacheable,x-ec-cache-key,x-ec-cache-state`

## <a name="cache-status-code-information"></a>Информация о коде состояния кэша
Заголовок ответа X-EC-Debug может идентифицировать сервер и способ обработки ответа с помощью следующих директив:

Заголовок | ОПИСАНИЕ
-------|------------
X-EC-Debug: x-ec-cache | Этот заголовок отображается каждый раз, когда содержимое направляется через CDN. Он идентифицирует сервер POP, который выполнил запрос.
X-EC-Debug: x-ec-cache-remote | Этот заголовок выводится только тогда, когда запрашиваемое содержимое было кэшировано на защитном сервере-источнике или на сервере шлюза ADN.

### <a name="response-header-format"></a>Формат заголовка ответа

Заголовок X-EC-Debug сообщает информацию о коде состояния кэша в следующем формате:

- `X-EC-Debug: x-ec-cache: <StatusCode from Platform (POP/ID)>`

- `X-EC-Debug: x-ec-cache-remote: <StatusCode from Platform (POP/ID)>`

Термины, используемые в синтаксисе заголовка ответа выше, определяются следующим образом:
- StatusCode. Указывает, как запрошенное содержимое было обработано CDN, что представлено кодом состояния кэша.
    
    Код состояния TCP_DENIED может быть отправлен вместо NONE, когда неавторизованный запрос отклоняется из-за проверки подлинности на основе токенов. Тем не менее код состояния NONE продолжает использоваться при просмотре отчетов о состоянии кэша или необработанных данных журнала.

- Platform. Указывает платформу, на которой было запрошено содержимое. В этом поле допустимы следующие коды:

    Код  | платформа
    ------| --------
    ECAcc | Большой HTTP-объект
    ECS   | Малый HTTP-объект
    ECD   | Сеть доставки приложений (ADN)

- POP. Указывает [POP](cdn-pop-abbreviations.md), который обработал запрос. 

### <a name="sample-response-headers"></a>Пример заголовков ответа

В следующих примерах заголовков предоставляется информация о коде состояния кэша для запроса:

- `X-EC-Debug: x-ec-cache: TCP_HIT from ECD (lga/0FE8)`

- `X-EC-Debug: x-ec-cache-remote: TCP_HIT from ECD (dca/EF00)`

## <a name="cacheable-response-header"></a>Кэшируемый заголовок ответа
Заголовок ответа `X-EC-Debug: x-ec-check-cacheable` указывает, можно ли кэшировать запрошенное содержимое.

Этот заголовок ответа не указывает, выполнялось ли кэширование. Вместо этого он указывает, пригоден ли запрос для кэширования.

### <a name="response-header-format"></a>Формат заголовка ответа

Заголовок ответа `X-EC-Debug` сообщает, может ли запрос быть кэширован, в следующем формате:

`X-EC-Debug: x-ec-check-cacheable: <cacheable status>`

Термины, используемые в синтаксисе заголовка ответа выше, определяются следующим образом:

Значение  | ОПИСАНИЕ
-------| --------
ДА    | Указывает, что содержимое запроса пригодно для кэширования.
НЕТ     | Указывает, что содержимое запроса непригодно для кэширования. Это состояние может быть вызвано одной из следующих причин: <br /> — Клиентская конфигурация. Конфигурация, которая относится к учетной записи, может предотвратить кэширование ресурса POP-серверами. Например, обработчик правил может предотвратить кэширование ресурса путем включения функции обхода кэширования для отвечающих требованиям запросов.<br /> — Кэширование заголовков ответа. Запрашиваемые заголовки Cache-Control и Expires ресурса могут предотвратить их кэширование POP-серверами.
UNKNOWN | Указывает, что серверы не смогли оценить, можно ли кэшировать запрашиваемый ресурс. Это состояние обычно возникает, когда запрос отклоняется из-за проверки подлинности на основе токенов.

### <a name="sample-response-header"></a>Пример заголовка ответа

В следующем примере заголовка ответа указано, можно ли кэшировать запрошенное содержимое:

`X-EC-Debug: x-ec-check-cacheable: YES`

## <a name="cache-key-response-header"></a>Заголовок ответа ключа кэша
Заголовок ответа `X-EC-Debug: x-ec-cache-key` указывает физический ключ кэша, связанный с запрошенным содержимым. Физический ключ кэша состоит из пути, определяющего ресурс для целей кэширования. Иными словами, серверы будут проверять наличие кэшированной версии ресурса по его пути, как определено в ключе кэша.

Этот физический ключ кэша начинается с двойной косой черты (//), за которой следует протокол, используемый для запроса содержимого (HTTP или HTTPS). За этим протоколом следует относительный путь к запрашиваемому ресурсу, который начинается с точки доступа к содержимому (например, _/000001/_).

По умолчанию платформы HTTP настроены использовать *стандартный кэш*, что означает, что строки запроса будут игнорироваться механизмом кэширования. Конфигурация данного типа не позволяет ключу кэширования включить данные строки запроса.

Если в ключе кэша записана строка запроса, она преобразуется в хэш-эквивалент, а затем вставляется ​​между именем запрашиваемого ресурса и его расширением файла (например, asset&lt;хэш-значение&gt;.html).

### <a name="response-header-format"></a>Формат заголовка ответа

Заголовок ответа `X-EC-Debug` сообщает информацию о физическом ключе кэша в следующем формате:

`X-EC-Debug: x-ec-cache-key: CacheKey`

### <a name="sample-response-header"></a>Пример заголовка ответа

Следующий пример заголовка ответа указывает физический ключ кэша для запрошенного содержимого:

`X-EC-Debug: x-ec-cache-key: //http/800001/origin/images/foo.jpg`

## <a name="cache-state-response-header"></a>Заголовок ответа о состоянии кэширования
Заголовок ответа `X-EC-Debug: x-ec-cache-state` указывает состояние кэширования запрошенного содержимого во время запроса.

### <a name="response-header-format"></a>Формат заголовка ответа

Заголовок ответа `X-EC-Debug` сообщает информацию о состоянии кэширования в следующем формате:

`X-EC-Debug: x-ec-cache-state: max-age=MASeconds (MATimePeriod); cache-ts=UnixTime (ddd, dd MMM yyyy HH:mm:ss GMT); cache-age=CASeconds (CATimePeriod); remaining-ttl=RTSeconds (RTTimePeriod); expires-delta=ExpiresSeconds`

Термины, используемые в синтаксисе заголовка ответа выше, определяются следующим образом:

- MASeconds. Указывает max-age (в секундах), как указано в заголовке Cache-Control запрошенного содержимого.

- MATimePeriod. Преобразует значение max-age (т. е. MASeconds) в приблизительный эквивалент большей единицы измерения (например, дни). 

- UnixTime. Указывает метку времени кэширования запрошенного содержимого в текущем времени UNIX (т.е. времени POSIX или UNIX EPOCH). Метка времени кэша указывает начальную дату и время, с которых будет рассчитываться срок жизни ресурса. 

    Если сервер-источник не использует сервер кэширования HTTP сторонних разработчиков или сервер не возвращает заголовок ответа Age, тогда метка времени кэша всегда будет отображать дату и время, когда ресурс был извлечен или повторно проверен. В противном случае серверы POP используют поле Age для вычисления срока жизни ресурса следующим образом: Retrieval/RevalidateDateTime - Age.

- ddd, dd MMM yyyy HH:mm:ss. Указывает метку времени кэширования запрошенного содержимого. Дополнительные сведения см. в описании термина UnixTime выше.

- CASeconds. Указывает, сколько секунд истекло с времени кэширования.

- RTSeconds. Указывает, сколько секунд осталось, в течение которых кэшированное содержимое будет считаться актуальным. Это значение вычисляется следующим образом: RTSeconds = max-age — срок действия кэша.

- RTTimePeriod. Преобразует оставшееся значение срока жизни (т. е. RTSeconds) в приблизительный эквивалент большей единицы измерения (например, дни).

- ExpiresSeconds. Указывает количество оставшихся секунд до даты и времени, указанных в заголовке ответа `Expires`. Если заголовок ответа `Expires` не включен в ответ, тогда значение этого термина — *none*.

### <a name="sample-response-header"></a>Пример заголовка ответа

В следующем примере заголовок ответа указывает состояние кэширования запрошенного содержимого во время запроса:

```X-EC-Debug: x-ec-cache-state: max-age=604800 (7d); cache-ts=1341802519 (Mon, 09 Jul 2012 02:55:19 GMT); cache-age=0 (0s); remaining-ttl=604800 (7d); expires-delta=none```

