---
title: Обнаружение угроз для управляемого экземпляра Базы данных SQL Azure | Документация Майкрософт
description: Система обнаружения угроз обнаруживает подозрительную активность в базе данных, указывающую на наличие потенциальных угроз безопасности.
services: sql-database
author: rmatchoro
manager: craigg
ms.service: sql-database
ms.custom: security, managed instance
ms.topic: conceptual
ms.date: 03/07/2018
ms.author: ronmat
ms.reviewer: carlrab
ms.openlocfilehash: 14ef907717045e2e0cf297694d92468a65e57e4d
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34650083"
---
# <a name="azure-sql-database-managed-instance-threat-detection"></a>Обнаружение угроз в управляемом экземпляре Базы данных SQL Azure

Система обнаружения угроз SQL выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями в управляемом экземпляре Базы данных SQL Azure (предварительная версия).

## <a name="overview"></a>Обзор

Система обнаружения угроз обнаруживает подозрительные действия в базе данных, указывающие на наличие потенциальных угроз для безопасности управляемого экземпляра. Теперь система обнаружения угроз работает в режиме предварительной версии для управляемого экземпляра.

Благодаря оповещениям безопасности о подозрительных операциях с базой данных система обнаружения угроз формирует дополнительный уровень безопасности, позволяющий клиентам обнаруживать потенциальные угрозы по мере возникновения аномальных действий и реагировать на них. Система обнаружения угроз упрощает устранение потенциальных угроз безопасности управляемого экземпляра, не требуя от пользователя экспертных навыков в сфере безопасности либо умения работать в сложных системах отслеживания угроз. Для полного исследования рекомендуется включить аудит управляемого экземпляра Azure, при котором события базы данных записываются в журнал аудита вашей учетной записи хранения Azure. 

Оповещения об обнаружении угроз SQL интегрируются с оповещениями [центра безопасности Azure](https://azure.microsoft.com/services/security-center/). Каждый защищенный управляемый экземпляр оплачивается по такому же тарифу, как и центр безопасности Azure категории "Стандартный" (15 долларов США за узел в месяц), где каждый защищенный управляемый экземпляр считается как один узел.  

## <a name="set-up-threat-detection-for-your-managed-instance-in-the-azure-portal"></a>Настройка обнаружения угроз для управляемого экземпляра на портале Azure
1. Запустите портал Azure: [https://portal.azure.com](https://portal.azure.com).
2. Перейдите на страницу настройки управляемого экземпляра, который требуется защитить. На странице **Параметры** выберите **Обнаружение угроз**. 
3. На странице настройки обнаружения угроз сделайте следующее: 
   - Переведите переключатель системы обнаружения угроз в положение **ВКЛ.** .
   - Настройте **список электронных адресов** для получения оповещений безопасности в случае обнаружения подозрительной активности в базе данных.
   - Выберите **учетную запись хранения Azure** для сохранения записей аудита аномальных угроз. 
4.  Щелкните **Сохранить**, чтобы сохранить новую или обновленную политику обнаружения угроз.

   ![обнаружение угроз](./media/sql-database-managed-instance-threat-detection/threat-detection.png)

## <a name="explore-anomalous-managed-instance-activities-upon-detection-of-a-suspicious-event"></a>Анализ аномальных действий в управляемом экземпляре при обнаружении подозрительного события

1. При обнаружении подозрительной активности в базе данных вы получите уведомление по электронной почте. 

   В электронном сообщении содержится информация о подозрительном событии безопасности, включая характер подозрительной активности, имя базы данных и сервера, а также время, когда произошло событие. Кроме того, в нем приводится информация о возможных причинах возникновения события, а также рекомендуемые действия по поиску и устранению потенциальной угрозы безопасности управляемого экземпляра.

   ![электронное сообщение об обнаружении угроз](./media/sql-database-managed-instance-threat-detection/threat-detection-email.png)

2. Щелкните ссылку **View recent SQL alerts** (Просмотр недавних оповещений SQL) в почтовом сообщении, чтобы запустить портал Azure и открыть страницу оповещений центра безопасности Azure. На этой странице содержится обзор активных угроз SQL, обнаруженных в базе данных управляемого экземпляра.

   ![активные угрозы](./media/sql-database-managed-instance-threat-detection/active-threats.png)

3. Щелкните определенное оповещение, чтобы отобразить дополнительные сведения и действия для изучения этой угрозы и устранения будущих угроз.

   Например, внедрение кода SQL — один из распространенных видов угроз безопасности веб-приложений в Интернете. Внедрение кода SQL используется для атак на приложения, управляемые данными. Хакеры используют уязвимости приложения, чтобы ввести вредоносные инструкции SQL в поля ввода приложения, чтобы испортить или изменить данные в базе данных. В сведениях оповещений о внедрении кода SQL указывается уязвимая инструкция SQL, которая была использована.

   ![внедрение кода SQL](./media/sql-database-managed-instance-threat-detection/sql-injection.png)

## <a name="managed-instance-threat-detection-alerts"></a>Оповещения об обнаружении угроз для управляемого экземпляра 

Система обнаружения угроз для управляемого экземпляра выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями. Она может активировать следующие оповещения:
- **Уязвимость к атакам путем внедрения кода SQL.** Это предупреждение активируется, если приложение создает инструкцию SQL с ошибкой в базе данных. Оно может указывать на возможную уязвимость к атакам путем внедрения кода SQL. Существует две причины создания инструкции с ошибкой:
 - Дефект в коде приложения, который создает инструкцию SQL с ошибкой.
 - Код приложения или хранимые процедуры не очищают ввод данных пользователя при создании ошибочной инструкции SQL, которая может быть использована для внедрения кода SQL.
- **Потенциальная атака путем внедрения кода SQL.** Это предупреждение запускается при активном эксплойте идентифицированной уязвимости приложения для внедрения кода SQL. Это означает, что злоумышленник пытается внедрить вредоносные инструкции SQL с помощью кода уязвимого приложения или хранимых процедур.
- **Доступ из незнакомого расположения.** Это предупреждение активируется при изменении схемы доступа к управляемому экземпляру, если пользователь вошел в управляемый экземпляр из незнакомого географического расположения. Иногда предупреждение определяет допустимые действия (новое приложение или операцию обслуживания разработчиком). В других случаях предупреждение обнаруживает вредоносное действие (бывшего сотрудника, внешнего злоумышленника и т. д.).
- **Доступ из стороннего центра обработки данных Azure.** Это предупреждение активируется при изменении схемы доступа к управляемому экземпляру, если кто-то за последнее время выполнил вход в управляемый экземпляр из центра обработки данных Azure, который не был замечен в доступе к этому управляемому экземпляру в последнее время. Иногда предупреждение определяет допустимые действия (новое приложение в Azure, Power BI, редактор SQL-запросов Azure и т. д.). В других случаях предупреждение обнаруживает угрозу от ресурса или службы Azure (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из незнакомого субъекта.** Это предупреждение активируется при изменении схемы доступа к серверу управляемого экземпляра, если пользователь вошел в управляемый экземпляр с помощью нестандартного субъекта (пользователя SQL). Иногда предупреждение определяет допустимые действия (новое приложение, операцию обслуживания разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из потенциально опасного приложения.** Это предупреждение активируется, когда доступ к базе данных получают потенциально опасные приложения. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку с помощью обычных средств.
- **Подбор учетных данных SQL.** Это предупреждение активируется при большом количестве неудачных попыток входа с разными учетными данными. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку методом подбора.

## <a name="next-steps"></a>Дополнительная информация

- Сведения об управляемом экземпляре см. в статье с [обзором управляемого экземпляра](sql-database-managed-instance.md).
- Подробнее об [аудите управляемых экземпляров](https://go.microsoft.com/fwlink/?linkid=869430). 
- Узнайте больше о [центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro).
