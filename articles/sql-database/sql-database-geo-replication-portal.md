---
title: "Портал Azure: георепликация базы данных SQL | Документация Майкрософт"
description: "Настройка георепликации для базы данных SQL Azure с помощью портала Azure и запуск отработки отказа."
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: d0b29822-714f-4633-a5ab-fb1a09d43ced
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 03/062/2016
ms.author: carlrab
ms.translationtype: Human Translation
ms.sourcegitcommit: 7c4d5e161c9f7af33609be53e7b82f156bb0e33f
ms.openlocfilehash: 64babace9ec5aa61acb396edf86f889e96a52c71
ms.contentlocale: ru-ru
ms.lasthandoff: 05/04/2017


---
# <a name="configure-active-geo-replication-for-azure-sql-database-in-the-azure-portal-and-initiate-failover"></a>Настройка активной георепликации для базы данных SQL Azure с помощью портала Azure и запуск отработки отказа

В этой статье объясняется, как настроить активную георепликацию для базы данных SQL Azure с помощью [портала Azure](http://portal.azure.com) и запустить отработку отказа.

Сведения о запуске отработки отказа с помощью портала Azure см. в разделе [Запуск плановой или незапланированной отработки отказа для базы данных SQL Azure с помощью портала Azure](sql-database-geo-replication-portal.md).

> [!NOTE]
> Активная георепликация (с доступными для чтения базами данных-получателями) теперь доступна для всех баз данных и всех уровней обслуживания. В апреле 2017 года недоступные для чтения базы данных-получатели будут удалены, и существующие недоступные для чтения базы данных будут автоматически преобразованы в доступные для чтения базы данных-получатели.
> 
> 

Для настройки активной георепликации с помощью портала Azure необходим приведенный ниже ресурс.

* База данных SQL Azure — база данных-источник, которую необходимо реплицировать в другом географическом регионе.

> [!Note]
Активная георепликация должна поддерживаться между базами данных в рамках одной подписки.

## <a name="add-a-secondary-database"></a>Добавление базы данных-получателя
Следующие действия позволяют создать новую базу данных-получателя в связи георепликации.  

Добавить базу данных-получатель может только владелец или совладелец подписки.

Базе данных-получателю присваивается такое же имя, как у базы данных-источника, и по умолчанию тот же уровень обслуживания. База данных-получатель может быть отдельной базой данных или базой данных в эластичном пуле. Чтобы узнать больше, ознакомьтесь с [уровнями служб](sql-database-service-tiers.md).
После создания и заполнения базы данных-получателя начинается репликация данных из базы данных-источника в новую базу данных-получателя.

> [!NOTE]
> Если база данных-партнер уже создана (например, в результате прекращения предыдущей связи георепликации), выполнение команды завершится сбоем.
> 

1. На [портале Azure](http://portal.azure.com) перейдите к базе данных, для которой нужно настроить георепликацию.
2. На странице базы данных SQL выберите **Георепликация**, а затем выберите регион для создания базы данных-получателя. Можно выбрать любой регион, кроме региона, в котором размещена база данных-источник, но рекомендуется выбрать [сопряженный регион](../best-practices-availability-paired-regions.md).
   
    ![Настройка георепликации](./media/sql-database-geo-replication-portal/configure-geo-replication.png)
3. Выберите или настройте сервер и ценовую категорию для базы данных-получателя.
   
    ![Настройка базы данных-получателя](./media/sql-database-geo-replication-portal/create-secondary.png)
4. По желанию добавьте базу данных-получатель в пул эластичных баз данных. Чтобы создать базу данных-получатель, щелкните **Пул эластичных БД** и выберите пул на целевом сервере. Пул должен быть создан на целевом сервере заранее. Этот рабочий процесс не создает пул.
5. Щелкните **Создать** , чтобы добавить базу данных-получатель.
6. После создания базы данных-получателя начнется процесс заполнения.
   
    ![Настройка базы данных-получателя](./media/sql-database-geo-replication-portal/seeding0.png)
7. Как только процесс заполнения будет закончен, отобразится состояние базы данных-получателя.
   
    ![Заполнение завершено](./media/sql-database-geo-replication-portal/seeding-complete.png)

## <a name="initiate-a-failover"></a>Запуск отработки отказа

Базу данных-получатель можно сделать источником.  

1. На [портале Azure](http://portal.azure.com) перейдите к базе данных-источнику в партнерстве георепликации.
2. В колонке "База данных SQL" выберите **Все параметры** > **Георепликация**.
3. В списке **Получатели** выберите базу данных, которая должна стать новым источником, и щелкните **Отработка отказа**.
   
    ![Отработка отказа](./media/sql-database-geo-replication-failover-portal/secondaries.png)
4. Выберите **Да** , чтобы запустить отработку отказа.

Команда немедленно переключит базу данных-получатель на роль базы данных-источника. 

В течение короткого периода (от 0 до 25 секунд), пока переключаются роли, обе базы данных будут недоступны. Если база данных-источник имеет несколько баз данных-получателей, то команда автоматически перенастроит другие базы данных-получатели для подключения к новой базе данных-источнику. Обычно вся операция занимает меньше минуты. 

> [!NOTE]
> Эта команда предназначена для быстрого восстановления базы данных в случае сбоя. Она активирует отработку отказа без синхронизации данных (принудительная отработка отказа).  Если при отправке команды источник находится в сети и выполняет транзакции, некоторые данные могут быть утеряны. 
> 
> 

## <a name="remove-secondary-database"></a>Удаление базы данных-получателя
Данная операция безвозвратно отменяет репликацию в базу данных-получатель и превращает ее в обычную базу данных для чтения и записи. Если подключение к базе данных-получателю прервется, команда будет выполнена, но после восстановления связи база данных-получатель не станет доступной для чтения и записи.  

1. На [портале Azure](http://portal.azure.com) перейдите к базе данных-источнику в партнерстве георепликации.
2. На странице базы данных SQL выберите **Георепликация**.
3. В списке **Получатели** выберите базу данных, которую нужно удалить из партнерства георепликации.
4. Щелкните **Остановить репликацию**.
   
    ![Удаление базы данных-получателя](./media/sql-database-geo-replication-portal/remove-secondary.png)
5. Откроется окно подтверждения. Нажмите кнопку **Да**, чтобы удалить базу данных из партнерства георепликации (и сделать ее доступной для чтения и записи и не используемой в репликации).

## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения об активной георепликации см. в статье [Обзор: активная георепликация для базы данных SQL](sql-database-geo-replication-overview.md).
* Сведения об обеспечении непрерывности бизнес-процессов и возможные сценарии описаны в [обзоре непрерывности бизнес-процессов](sql-database-business-continuity.md).


