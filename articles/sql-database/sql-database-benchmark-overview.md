---
title: Общие сведения об измерении производительности службы "База данных SQL Azure" в DTU
description: В этом разделе описывается тест производительности Базы данных SQL Azure, используемый при измерении ее производительности.
services: sql-database
author: jan-eng
manager: jhubbard
ms.service: sql-database
ms.custom: DBs & servers
ms.topic: article
ms.date: 04/01/2018
ms.author: janeng
ms.openlocfilehash: dbe991ddaa4d85ee3d117dc3c0c246a642b53f2f
ms.sourcegitcommit: e2adef58c03b0a780173df2d988907b5cb809c82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2018
ms.locfileid: "32191413"
---
# <a name="azure-sql-database-dtu-benchmark-overview"></a>Общие сведения об измерении производительности службы "База данных SQL Azure" в DTU
## <a name="overview"></a>Обзор
В модели приобретения на основе DTU служба "База данных SQL Azure" предлагает три [уровня служб](sql-database-service-tiers-dtu.md) с несколькими уровнями производительности. Каждый уровень производительности предоставляет более обширный набор ресурсов (или «мощностей»), предназначенный для повышения пропускной способности.

> [!IMPORTANT]
> Теперь служба "База данных SQL Azure" также поддерживает модель приобретения на основе виртуальных ядер (предварительная версия). Узнайте больше о [модели приобретения на основе виртуальных ядер (предварительная версия)](sql-database-service-tiers-vcore.md).

Важно иметь возможность измерить, как увеличивающаяся мощность каждого уровня производительности преобразуется в повышенную производительность базы данных. Для этого корпорация Майкрософт разработала тест производительности Базы данных SQL Azure (ASDB). Этот тест выполняет набор базовых операций, которые есть во всех рабочих нагрузках OLTP. Измеряется пропускная способность, обеспечиваемая базами данных на каждом уровне производительности.

Ресурсы и мощность каждого уровня служб и уровня производительности выражаются в [единицах транзакций базы данных (DTU)](sql-database-what-is-a-dtu.md). Единицы DTU позволяют описывать относительную мощность уровня производительности, основываясь на измерении загрузки ЦП, памяти и скорости чтения и записи, которые характерны для каждого уровня производительности. Удвоение оценки DTU базы данных соответствует удвоению ее мощности. Тест производительности позволяет оценить, как увеличение мощности влияет на производительность базы данных для каждого уровня производительности. Эта оценка выполняется так: запускаются реальные операции базы данных, при этом размер базы данных, количество пользователей и скорость транзакций масштабируются пропорционально ресурсам, предоставляемым базе данных.

Если пропускную способность служб уровня Basic выражать с помощью количества транзакций в час, служб уровня Standard — с помощью количества транзакций в минуту, а служб уровня служб Premium — с помощью количества транзакций в секунду, становится проще соотносить потенциал производительности служб каждого уровня с требованиями приложения.

## <a name="correlating-benchmark-results-to-real-world-database-performance"></a>Соотнесение результатов тестирования производительности с реальной производительностью базы данных
Важно понимать, что тест ASDB, как все тесты производительности, является только показательным и ориентировочным тестом. Показатели скорости транзакций, достигнутые приложением тестирования производительности, будут отличаться от таких показателей других приложений. Тест производительности состоит из набора транзакций разных типов, выполняемых в схеме, которая содержит целый ряд таблиц и типов данных. Хотя тест производительности выполняет основные операции, свойственные для всех рабочих нагрузок OLTP, он не представляет какой-либо определенный класс базы данных или приложения. Цель тестирования производительности заключается в предоставлении приемлемых рекомендаций для относительной производительности базы данных, которую можно ожидать при переходе на более высокий или более низкий уровень производительности. На самом деле базы данных имеют разные размеры и сложность, обрабатывают разные сочетания рабочих нагрузок и реагируют разными способами. Например, приложение с большим объемом операций ввода-вывода может быстрее достигнуть порогового значения таких операций или приложение с интенсивной нагрузкой ЦП может быстрее достигнуть порогового значения такой нагрузки. Нет никакой гарантии, что конкретная база данных будет увеличиваться так же, как это показывает тест производительности при увеличении нагрузки.

Тест производительности и его методология подробно описаны ниже.

## <a name="benchmark-summary"></a>Сводка о тесте производительности
Тест ASDB измеряет производительность набора основных операций базы данных, выполняемых чаще всего при рабочих нагрузках оперативной обработки транзакций (OLTP). Хотя тест производительности разрабатывался для облачных вычислений, схемы базы данных, заполнение данными и транзакции рассчитаны на максимально широкий уровень репрезентативности основных элементов, которые чаще всего используются в рабочих нагрузках OLTP.

## <a name="schema"></a>Схема
Схема разработана таким образом, чтобы предоставить достаточную степень разнообразия и сложности для поддержки широкого диапазона операций. Тест производительности выполняется в базе данных, состоящей из шести таблиц. Эти таблицы делятся на три категории: фиксированного размера, масштабируемые и расширяемые. Есть две таблицы фиксированного размера, три масштабируемые таблицы и одна расширяемая таблица. Таблицы фиксированного размера имеют неизменное количество строк. Масштабируемые таблицы имеют кратность, пропорциональную производительности базы данных, но не изменяемую во время тестирования производительности. Расширяемая таблица имеет такой же размер, что и масштабируемая таблица при начальной нагрузке, но затем в процессе тестирования производительности кратность изменяется по мере добавления и удаления строк.

Схема включает сочетание типов данных, в том числе целое число, цифру, символ, а также дату и время. Схема включает первичные и вторичные ключи, но не имеет внешних ключей, т. е. между таблицами нет ограничений ссылочной целостности.

Программа формирования данных создает данные для исходной базы данных. Целочисленные и числовые данные создаются с помощью разных стратегий. В некоторых случаях значения случайным образом распределяются в диапазоне. Чтобы гарантировать соблюдение конкретного распределения в других случаях, набор значений переставляется случайным образом. Текстовые поля создаются из взвешенного списка слов для формирования реалистичных данных.

Размер базы данных устанавливается в соответствии с «коэффициентом масштабирования». Коэффициент масштабирования (сокращенно SF) определяет кратность элементов в масштабируемых и растущих таблицах. Как описано ниже, в разделе «Пользователи и пошаговое продвижение», размер базы данных, количество пользователей и максимальная производительность масштабируются пропорционально друг к другу.

## <a name="transactions"></a>Транзакции
Рабочая нагрузка состоит из девяти типов транзакций, как показано в следующей таблице. Каждая транзакция должна подчеркивать определенный набор системных характеристик в ядре СУБД и системном оборудовании. При этом она должна явно отличаться от других транзакций. Такой подход упрощает оценку влияния различных компонентов на общую производительность. Например, транзакция «Чтение, высокая интенсивность» создает значительное число операций чтения с диска.

| Тип транзакции | ОПИСАНИЕ |
| --- | --- |
| Чтение, низкая интенсивность |ВЫБОР; в памяти; только для чтения |
| Носитель для чтения |ВЫБОР; в основном в памяти; только для чтения |
| Чтение, высокая интенсивность |ВЫБОР; в основном не в памяти; только для чтения |
| Обновление, низкая интенсивность |ОБНОВЛЕНИЕ; в памяти; чтение и запись |
| Обновление, высокая интенсивность |ОБНОВЛЕНИЕ; в основном не в памяти; чтение и запись |
| Вставка, низкая интенсивность |ВСТАВКА; в памяти; чтение и запись |
| Вставка, высокая интенсивность |ВСТАВКА; в основном не в памяти; чтение и запись |
| Delete |УДАЛЕНИЕ; сочетание в памяти и не в памяти; чтение и запись |
| ЦП, высокая интенсивность |ВЫБОР; в памяти; относительно высокая загрузка ЦП; только для чтения |

## <a name="workload-mix"></a>Сочетание рабочих нагрузок
Транзакции выбираются случайным образом из взвешенного распределения следующего общего сочетания. Обще сочетание имеет соотношение чтения и записи 2:1.

| Тип транзакции | Процент от сочетания |
| --- | --- |
| Чтение, низкая интенсивность |35 |
| Носитель для чтения |20 |
| Чтение, высокая интенсивность |5 |
| Обновление, низкая интенсивность |20 |
| Обновление, высокая интенсивность |3 |
| Вставка, низкая интенсивность |3 |
| Вставка, высокая интенсивность |2 |
| Delete |2 |
| ЦП, высокая интенсивность |10 |

## <a name="users-and-pacing"></a>Пользователи и пошаговое продвижение
Рабочая нагрузка теста производительности определяется с помощью средства, которое передает транзакции через ряд подключений для имитации работы определенного количества одновременных пользователей. Хотя все подключения и транзакции создаются компьютером, для простоты мы называем эти подключения «пользователи». Несмотря на то, что каждый пользователь работает независимо от других пользователей, все они выполняют одинаковый цикл, показанный ниже:

1. Установление подключения к базе данных.
2. Повторение до получения сигнала выхода:
   * случайный выбор транзакций (из взвешенного распределения);
   * выполнение выбранной транзакции и измерение времени ответа;
   * ожидание задержки шага.
3. Завершение подключения к базе данных.
4. Выход.

Задержка шага (в действии 2в) выбирается случайным образом, однако с распределением со средним значением в 1,0 секунду. Таким образом, в среднем каждый пользователь может создавать максимум одну транзакцию в секунду.

## <a name="scaling-rules"></a>Правила масштабирования
Количество пользователей определяется размером базы данных (в единицах коэффициента масштабирования). Существует один пользователь на каждые пять единиц коэффициента масштабирования. Из-за задержки шага один пользователь может в среднем создавать не более одной транзакции в секунду.

Например, база данных с коэффициентом масштабирования 500 (SF=500) будет иметь 100 пользователей и может достичь максимальной скорости в 100 транзакций в секунду. Для более высокой скорости требуется больше пользователей и большие размеры базы данных.

В таблице ниже показано количество пользователей, фактически поддерживаемых для каждого уровня службы и уровня производительности.

| Уровень службы (уровень производительности) | Пользователи | Размер базы данных |
| --- | --- | --- |
| базовая; |5 |720 МБ |
| Standard (S0) |10 |1 GB |
| Standard (S1) |20 |2,1 ГБ |
| Standard (S2) |50 |7,1 ГБ |
| Premium (P1) |100 |14 ГБ |
| Premium (P2) |200 |28 ГБ |
| Premium (P6) |800 |114 ГБ |

## <a name="measurement-duration"></a>Продолжительность измерения
Для правильного выполнения теста производительности требуется измерять устойчивое состояние по крайней мере один час.

## <a name="metrics"></a>Метрики
Ключевыми показателями теста производительности являются пропускная способность и время ответа.

* Пропускная способность — это важный показатель производительности в тесте производительности. Пропускная способность измеряется в транзакциях в единицу времени, учитывая все типы транзакций.
* Время отклика — это показатель прогнозируемости производительности. Ограничение времени ответа зависит от класса службы. Более высокие классы службы имеют более строгие требования ко времени ответа, как показано ниже.

| Класс службы | Единица пропускной способности | Требование ко времени ответа |
| --- | --- | --- |
| Премиум |Транзакций в секунду |95-й процентиль при 0,5 секунды |
| Стандартная |Транзакций в минуту |90-й процентиль при 1,0 секунде |
| Basic |Транзакций в час |80-й процентиль при 2,0 секундах |

## <a name="conclusion"></a>Заключение
Тест производительности Базы данных SQL Azure измеряет относительную производительность такой базы данных, функционирующей в диапазоне доступных уровней служб и уровней производительности. Тест производительности выполняет набор основных операций базы данных, выполняемых чаще всего при рабочих нагрузках оперативной обработки транзакций (OLTP). Измеряя фактическую производительность, тест обеспечивает более существенную оценку того, как изменение уровня производительности влияет на пропускную способность. Такого уровня оценки не добиться, если просто перечислять ресурсы, предоставляемые на каждом уровне, например скорость ЦП, объем памяти и операции ввода-вывода. В дальнейшем мы продолжим совершенствовать тест производительности, чтобы расширить область его применения и увеличить количество предоставляемых данных.

## <a name="resources"></a>Ресурсы
[Введение в базы данных SQL](sql-database-technical-overview.md)

[Уровни служб на основе DTU и уровни производительности](sql-database-service-tiers-dtu.md)

[Уровни служб на основе виртуальных ядер и уровни производительности](sql-database-service-tiers-vcore.md)

[Руководство по производительности для отдельных баз данных](sql-database-performance-guidance.md)
