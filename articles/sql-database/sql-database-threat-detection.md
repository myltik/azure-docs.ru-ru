---
title: Обнаружение угроз для базы данных SQL Azure | Документация Майкрософт
description: Система обнаружения угроз обнаруживает подозрительную активность в базе данных, указывающую на наличие потенциальных угроз безопасности.
services: sql-database
author: rmatchoro
manager: craigg
ms.service: sql-database
ms.custom: security
ms.topic: conceptual
ms.date: 05/17/2018
ms.author: ronmat
ms.reviewer: carlrab
ms.openlocfilehash: 09ba4b3b72d5c82dc42199f2f883cedee6609bd2
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34649549"
---
# <a name="azure-sql-database-threat-detection"></a>Обнаружение угроз базы данных SQL Azure

Система обнаружения угроз службы "База данных SQL Azure" выявляет аномальные операции, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями.

Система обнаружения угроз входит в состав предложения [Расширенная защита от угроз SQL ](sql-advanced-threat-protection.md), которое представляет собой унифицированный пакет расширенных возможностей безопасности SQL. Доступ к системе обнаружения угроз можно получить через центральный портал SQL ATP. Там же ею можно управлять.

## <a name="what-is-threat-detection"></a>Общие сведения о системе обнаружения угроз

Благодаря оповещениям безопасности о подозрительной активности система обнаружения угроз формирует дополнительный уровень безопасности, позволяющий клиентам обнаруживать потенциальные угрозы по мере возникновения и реагировать на них. Пользователи получают оповещения о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных закономерностей в доступе к базам данных и шаблонам запросов. Система обнаружения угроз SQL интегрирует оповещения с [центром безопасности Azure](https://azure.microsoft.com/services/security-center/), который предоставляет сведения о подозрительных операциях и дает рекомендации о том, как определить причину угрозы и устранить ее. Система обнаружения угроз SQL упрощает устранение потенциальных угроз безопасности базы данных, не требуя от пользователя экспертных навыков в сфере безопасности либо умения работать в сложных системах отслеживания угроз. 

Чтобы воспользоваться всеми преимуществами исследования, советуем включить [аудит базы данных SQL](sql-database-auditing.md), при котором события базы данных записываются в журнал аудита вашей учетной записи хранения Azure.  

## <a name="set-up-threat-detection-for-your-database-in-the-azure-portal"></a>Настройка обнаружения угроз для базы данных с помощью портала Azure
1. Запустите портал Azure: [https://portal.azure.com](https://portal.azure.com).
2. Перейдите на страницу настройки сервера базы данных SQL Azure, который требуется защитить. В параметрах безопасности выберите **Advanced Threat Protection**.
3. На странице конфигурации **Advanced Threat Protection**, сделайте следующее:

   - Включите расширенную защиту от угроз на сервере.
   - В **параметрах обнаружения угроз** в текстовом поле **Кому отправлять оповещения** предоставляется список адресов электронной почты пользователей, которым будут отправляться оповещения системы безопасности об обнаружении аномальных действий в базе данных.
  
   ![Настройка обнаружения угроз](./media/sql-database-threat-detection/set_up_threat_detection.png)

## <a name="set-up-threat-detection-using-powershell"></a>Настройка обнаружения угроз с помощью PowerShell

Пример сценария см. в статье [Настройка аудита и обнаружения угроз для базы данных SQL с помощью PowerShell](scripts/sql-database-auditing-and-threat-detection-powershell.md).

## <a name="explore-anomalous-database-activities-upon-detection-of-a-suspicious-event"></a>Анализ подозрительной активности в базе данных при обнаружении подозрительного события

При обнаружении подозрительной активности в базе данных вы получите уведомление по электронной почте. В этом уведомлении содержится информация о подозрительном событии безопасности, в том числе характер подозрительных операций, имя базы данных, имя сервера, имя приложения, а также время, когда произошло событие. Кроме того, в уведомлении приводится информация о возможных причинах возникновения события, а также рекомендуемые действия по поиску и устранению потенциальной угрозы безопасности базы данных.

![Отчеты об аномальных действиях](./media/sql-database-threat-detection/anomalous_activity_report.png)
     
1. Щелкните ссылку **View recent SQL alerts** (Просмотр недавних оповещений SQL) в почтовом сообщении, чтобы запустить портал Azure и открыть страницу оповещений центра безопасности Azure. На этой странице содержится обзор активных угроз, обнаруженных в базе данных SQL.

   ![Угрозы действию](./media/sql-database-threat-detection/active_threats.png)

2. Щелкните определенное оповещение, чтобы отобразить дополнительные сведения и действия для изучения этой угрозы и устранения будущих угроз.

   Например, внедрение кода SQL — один из распространенных видов угроз безопасности веб-приложений в Интернете, используемый для получения несанкционированного доступа к приложениям, управляемым данными. Хакеры используют уязвимости приложения, чтобы ввести вредоносные инструкции SQL в поля ввода приложения, чтобы испортить или изменить данные в базе данных. В сведениях оповещений о внедрении кода SQL указывается уязвимая инструкция SQL, которая была использована.

   ![Определенное оповещение](./media/sql-database-threat-detection/specific_alert.png)

## <a name="explore-threat-detection-alerts-for-your-database-in-the-azure-portal"></a>Изучение оповещений об обнаружении угроз базы данных на портале Azure

Оповещения об обнаружении угроз базы данных SQL интегрируются с [центром безопасности Azure](https://azure.microsoft.com/services/security-center/). Динамический элемент обнаружения угроз SQL в колонках базы данных и SQL ATP на портале Azure отображает состояние активных угроз.

Щелкните **Threat detection alert** (Оповещение об обнаружении угроз), чтобы запустить страницу оповещений центра безопасности Azure и получить обзор активных угроз SQL, обнаруженных в базе данных.

   ![Оповещение об обнаружении угроз](./media/sql-database-threat-detection/threat_detection_alert.png)
   
   ![Оповещение об обнаружении угроз 2](./media/sql-database-threat-detection/threat_detection_alert_atp.png)

## <a name="azure-sql-database-threat-detection-alerts"></a>Оповещение об обнаружении угроз базы данных SQL Azure 
Система обнаружения угроз службы "База данных SQL Azure" выявляет аномальные действия, указывающие на нестандартные и потенциально вредоносные попытки получить доступ к базам данных или воспользоваться их уязвимостями. Она может активировать следующие оповещения:
- **Уязвимость к атакам путем внедрения кода SQL.** Это предупреждение активируется, если приложение создает инструкцию SQL с ошибкой в базе данных. Оно может указывать на возможную уязвимость к атакам путем внедрения кода SQL. Существует две причины создания инструкции с ошибкой:
   - Дефект в коде приложения, который создает инструкцию SQL с ошибкой.
   - Код приложения или хранимые процедуры не очищают ввод данных пользователя при создании ошибочной инструкции SQL, которая может быть использована для внедрения кода SQL.
- **Потенциальная атака путем внедрения кода SQL.** Это предупреждение запускается при активном эксплойте идентифицированной уязвимости приложения для внедрения кода SQL. Это означает, что злоумышленник пытается внедрить вредоносные инструкции SQL с помощью кода уязвимого приложения или хранимых процедур.
- **Доступ из незнакомого расположения.** Это предупреждение активируется при изменении шаблона доступа к серверу SQL, если пользователь вошел на сервер SQL из незнакомого географического расположения. Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из стороннего центра обработки данных Azure.** Это предупреждение активируется при изменении шаблона доступа к серверу SQL, если кто-то за последнее время выполнил вход на сервер из стороннего центра обработки данных Azure. Иногда предупреждение определяет допустимые действия (новое приложение в Azure, Power BI, редактор SQL-запросов Azure). В других случаях предупреждение обнаруживает угрозу от ресурса или службы Azure (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из незнакомого субъекта.** Это предупреждение активируется при изменении шаблона доступа к серверу SQL, если пользователь вошел на сервер SQL с помощью нестандартного субъекта (пользователя SQL). Иногда предупреждение определяет допустимые действия (новое приложение, обслуживание разработчиком). В других случаях предупреждение обнаруживает угрозу (бывшего сотрудника, внешнего злоумышленника).
- **Доступ из потенциально опасного приложения.** Это предупреждение активируется, когда доступ к базе данных получают потенциально опасные приложения. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку с помощью обычных средств.
- **Подбор учетных данных SQL.** Это предупреждение активируется при большом количестве неудачных попыток входа с разными учетными данными. В некоторых случаях предупреждения обнаруживают выполнение теста на проникновение. В других случаях — атаку методом подбора.

## <a name="next-steps"></a>Дополнительная информация

* Дополнительные сведения о службе "Расширенная защита от угроз SQL" см. в [этой статье](sql-advanced-threat-protection.md). 
* Узнайте больше об [аудите базы данных SQL Azure](sql-database-auditing.md).
* Узнайте больше о [центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro).
* Дополнительные сведения о ценах см. на [странице цен на базу данных SQL](https://azure.microsoft.com/pricing/details/sql-database/).  
