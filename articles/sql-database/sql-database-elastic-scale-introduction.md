---
title: Развертывание с помощью базы данных SQL Azure | Документация Майкрософт
description: Разработчики программного обеспечения как услуги (SaaS) могут с легкостью создавать эластичные и масштабируемые базы данных в облаке, используя следующие средства
services: sql-database
manager: craigg
author: stevestein
ms.service: sql-database
ms.custom: scale out apps
ms.topic: conceptual
ms.date: 04/01/2018
ms.author: sstein
ms.openlocfilehash: e8a07f1a1d172a96646a5c71a6267239e159c267
ms.sourcegitcommit: 266fe4c2216c0420e415d733cd3abbf94994533d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/01/2018
ms.locfileid: "34646574"
---
# <a name="scaling-out-with-azure-sql-database"></a>Развертывание с помощью Базы данных SQL Azure
Можно легко развертывать базы данных SQL Azure с помощью инструментов **эластичной базы данных** . Эти инструменты и компоненты позволяют использовать ресурсы **Базы данных SQL Azure** для создания решений для транзакционных рабочих нагрузок и, в частности, приложений SaaS (программное обеспечение как услуга). Возможности эластичных баз данных включают в себя следующее.

* [Клиентская библиотека эластичной базы данных](sql-database-elastic-database-client-library.md) является компонентом, который позволяет создавать и обслуживать сегментированные базы данных.  См. статью [Приступая к работе с инструментами эластичных баз данных](sql-database-elastic-scale-get-started.md).
* [Инструмент разбиения и объединения эластичной базы данных](sql-database-elastic-scale-overview-split-and-merge.md) перемещает данные между сегментированными базами данных. Это удобно для перемещения данных из мультитенантной базы данных в базу данных с одним клиентом (или наоборот). См. [руководство по инструменту разбиения и объединения эластичной базы данных](sql-database-elastic-scale-configure-deploy-split-and-merge.md).
* [Задания обработки эластичных баз данных](sql-database-elastic-jobs-overview.md) (предварительная версия): используйте задания для управления большим количеством баз данных Azure SQL. Легко выполняйте административные операции, такие как изменение схем, управление учетными данными, обновления ссылочных данных, сбор данных о производительности или сбор данных телеметрии клиента (пользователя) с помощью заданий.
* [Запрос к эластичной базе данных](sql-database-elastic-query-overview.md) (предварительная версия) позволяет выполнять запросы Transact-SQL, охватывающие несколько баз данных. Это позволяет подключить средства создания отчетов, например Excel, PowerBI, Tableau и т. д.
* [Эластичные транзакции](sql-database-elastic-transactions-overview.md) позволяют выполнять транзакции, охватывающие несколько баз данных в базе данных SQL Azure. Транзакции эластичной базы данных доступны для приложений .NET, использующих ADO.NET. Кроме того, транзакции можно объединить с уже знакомыми приемами программирования, используя [классы System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx).

На рисунке ниже показана архитектура, которая включает в себя **возможности эластичных баз данных** по отношению к коллекции баз данных.

Цвета баз данных на этой иллюстрации представляют схемы. Базы данных одного цвета используют одинаковые схемы.

1. Набор **баз данных Azure SQL** размещается в Azure с использованием архитектуры сегментирования.
2. **Клиентская библиотека эластичных баз данных** используется для управления набором сегментов.
3. Подмножество баз данных помещается в **эластичный пул**. (См. статью [Что такое пул эластичных БД Azure?](sql-database-elastic-pool.md))
4. **Задание обработки эластичных баз данных** запускает запланированные или динамические сценарии T-SQL для всех баз данных.
5. **Служба разбиения на части и объединения** используется для перемещения данных из одного сегмента в другой.
6. **Запрос к эластичной базе данных** позволяет создать запрос, который охватывает все базы данных в наборе сегментов.
7. **Эластичные транзакции** позволяют выполнять транзакции, охватывающие несколько баз данных. 

![Инструменты эластичных баз данных][1]

## <a name="why-use-the-tools"></a>Зачем использовать эти инструменты?
Для виртуальных машин и хранилища BLOB-объектов эластичность и масштабирование облачных приложений легко реализуются путем простого добавления и удаления вычислительных единиц либо увеличения мощности. Однако для обработки данных в реляционных базах данных с отслеживанием состояния их реализация по-прежнему представляет сложности. Сложности появились в следующих сценариях.

* Увеличение и уменьшение производительности реляционной базы данных как части рабочей нагрузки решения.
* Управление хот-спотами при влиянии на конкретное подмножество данных, например загруженный пользователь (клиент).

В большинстве случаев такие сценарии решаются путем приобретения дополнительных серверов баз данных для поддержки приложения. Тем не менее реализация этого варианта ограничена облаком, в котором вся обработка выполняется на предустановленном стандартном оборудовании. Использование вместо этого распределения и обработки данных в нескольких идентично структурированных базах данных (метод масштабирования, известный как сегментирование) является убедительной альтернативой традиционным подходам к масштабированию с точки зрения затрат и гибкости.

## <a name="horizontal-and-vertical-scaling"></a>Горизонтальное и вертикальное масштабирование
На рисунке ниже показаны горизонтальные и вертикальные измерения масштабирования, которые представляют собой базовые способы масштабирования эластичных баз данных.

![Горизонтальное и вертикальное развертывание][2]

Горизонтальное масштабирование означает добавление или удаление баз данных для настройки емкости или общей производительности. Оно также называется "расширением". Сегментирование, в которым данные разделяются по набору идентично структурированных баз данных, является наиболее распространенным методом горизонтального масштабирования.  

Вертикальное масштабирование означает увеличение или уменьшение уровня производительности отдельной базы данных. Оно также называется "увеличением масштаба".

В большей части баз данных облачных приложений для масштабирования используется сочетание этих двух стратегий. Например, приложение "программное обеспечение как сервис" может использовать горизонтальное масштабирование для подготовки новых конечных пользователей и вертикальное масштабирование для увеличения или уменьшения ресурсов базы данных каждого конечного клиента, согласно требованиям рабочей нагрузки.

* Для управления горизонтальным масштабированием используется [клиентская библиотека эластичных баз данных](sql-database-elastic-database-client-library.md).
* Вертикальное масштабирование осуществляется с помощью командлетов Azure PowerShell для изменения уровня служб или путем помещения баз данных в пул эластичных БД.

## <a name="sharding"></a>Сегментирование
*Сегментирование* — это методика распределения больших объемов данных с одинаковой структурой по множеству независимых баз данных. Она пользуется особенной популярностью среди разработчиков облачных технологий, создающих решения SaaS для пользователей или предприятий. Эти конечные пользователи часто называются "клиентами". Сегментирование может потребоваться по ряду причин:  

* общий объем данных слишком велик для размещения в пределах отдельной базы данных;
* пропускная способность транзакций общей рабочей нагрузки превышает возможности отдельной базы данных;
* клиентам может потребоваться физическая изоляция друг от друга, для чего требуются отдельные базы данных для каждого клиента;
* разные части базы данных могут размещаться в разных регионах по соображениям соответствия требованиям законодательства, производительности или по геополитическим причинам.

В других сценариях, например в приеме данных из распределенных устройств, сегментирование может использоваться для заполнения набора баз данных по временному признаку. Например, отдельная база данных может выделяться под каждый день или неделю. В этом случае ключом сегментирования может быть целое число, представляющее дату (присутствующую во всех строках сегментированных таблиц), а запросы получения информации о диапазоне дат должны передаваться приложением в подмножество баз данных, которые покрывают рассматриваемый диапазон.

Сегментирование лучше всего работает, когда каждая транзакция в приложении может ограничиваться одним значением ключа сегментирования. Это гарантирует, что все транзакции будут осуществляться в пределах отдельной базы данных.

## <a name="multi-tenant-and-single-tenant"></a>Мультитенантные и с одним клиентом
Некоторые приложения используют простой способ создания отдельной базы данных для каждого клиента. Это **шаблон сегментирования для одного клиента**, который предоставляет возможность изолирования, архивации и восстановления, а также масштабирования ресурсов в соответствии со степенью детализации клиента. Благодаря сегментированию для одного клиента каждая база данных привязывается к отдельному идентификатору клиента (или значению ключа клиента), но этот ключ не должен постоянно присутствовать в самих данных. За направление каждого запроса к соответствующей базе данных отвечает само приложение, а клиентская библиотека эластичных баз данных может упростить этот процесс.

![Сравнение многопользовательских версий одного клиента][4]

Другие сценарии объединяют несколько клиентов вместе в базах данных вместо изолирования их в отдельных базах данных. Это типичный **шаблон сегментирования для нескольких клиентов**. Он может использоваться при обработке приложением большого числа маленьких клиентов. При сегментировании на несколько клиентов строки таблиц базы данных спроектированы для хранения ключа, идентифицирующего пользователя, или ключа сегментирования. Кроме того, уровень приложения отвечает за направление запроса клиента к соответствующей базе данных, что поддерживается клиентской библиотекой эластичной базы данных. Кроме того, для ограничения строк, доступных для каждого клиента, можно воспользоваться безопасностью на уровне строк. Дополнительные сведения см. в статье [Мультитенантные приложения со средствами эластичных баз данных и безопасностью на уровне строк](sql-database-elastic-tools-multi-tenant-row-level-security.md). Перераспределение данных между базами данных может потребоваться при использовании шаблона многопользовательского сегментирования и обеспечивается службой разбиения и объединения эластичной базы данных. Дополнительные сведения о шаблонах разработки для приложений SaaS, использующих пулы эластичных БД, см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием базы данных Azure SQL](sql-database-design-patterns-multi-tenancy-saas-applications.md).

### <a name="move-data-from-multiple-to-single-tenancy-databases"></a>Перемещение данных из многопользовательских баз данных в однопользовательскую базу данных
При создании приложения SaaS потенциальным клиентам обычно предлагается пробная версия программного обеспечения. В этом случае для хранения данных экономически выгодно использовать многопользовательскую базу данных. Однако, когда потенциальный клиент становится реальным, предпочтительнее однопользовательская база данных, так как она обеспечивает лучшую производительность. Если клиент создал данные в течение пробного периода, используйте [средство разбиения и объединения](sql-database-elastic-scale-overview-split-and-merge.md) для перемещения данных из базы данных с несколькими клиентами в новую базу данных с одним клиентом.

## <a name="next-steps"></a>Дополнительная информация
Пример приложения, демонстрирующий клиентскую библиотеку, приведен в статье [Приступая к работе с инструментами эластичных баз данных](sql-database-elastic-scale-get-started.md).

Сведения о том, как преобразовать имеющиеся базы данных, чтобы использовать эти инструменты, см. в статье [Перенос существующих баз данных для масштабирования](sql-database-elastic-convert-to-use-elastic-tools.md).

Сведения об особенностях эластичного пула см. в статье [Когда следует использовать эластичный пул?](sql-database-elastic-pool.md). Вы можете также создать [эластичные пулы](sql-database-elastic-pool-manage-portal.md).  

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-introduction/tools.png
[2]:./media/sql-database-elastic-scale-introduction/h_versus_vert.png
[3]:./media/sql-database-elastic-scale-introduction/overview.png
[4]:./media/sql-database-elastic-scale-introduction/single_v_multi_tenant.png

