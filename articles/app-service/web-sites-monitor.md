---
title: Отслеживание приложений в службе приложений Azure | Документация Майкрософт
description: Узнайте, как выполнять мониторинг приложений в службе приложений Azure с помощью портала Azure.
services: app-service
documentationcenter: ''
author: btardif
manager: erikre
editor: ''
ms.assetid: d273da4e-07de-48e0-b99d-4020d84a425e
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/28/2017
ms.author: byvinyal
ms.openlocfilehash: fdc4329806d416811352d0d4dbc8dd3bce25aa0b
ms.sourcegitcommit: 088a8788d69a63a8e1333ad272d4a299cb19316e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2018
ms.locfileid: "29573809"
---
# <a name="how-to-monitor-apps-in-azure-app-service"></a>Мониторинг приложений в службе приложений Azure
[Служба приложений](http://go.microsoft.com/fwlink/?LinkId=529714) предоставляет встроенные средства мониторинга на [портале Azure](https://portal.azure.com).
На портале Azure можно просматривать **квоты**, **метрики** приложения и план службы приложений, а также настраивать получение **оповещений** и автоматическое **масштабирование** приложения на основе метрик.

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="understanding-quotas-and-metrics"></a>Общие сведения о квотах и метриках
### <a name="quotas"></a>Квоты
На приложения, размещенные в службе приложений, распространяются *ограничения* на использование ресурсов. Эти ограничения определены в рамках **плана службы приложений** , связанного с приложением.

[!INCLUDE [app-service-dev-test-note](../../includes/app-service-dev-test-note.md)]

Если приложение используется в режиме плана **Бесплатный** или **Общий**, ограничения на использование ресурсов выражены в виде **квот**.

Если приложение используется в режиме плана **Базовый**, **Стандартный** или **Премиум**, ограничения выражаются в виде **размера** выделенных ресурсов ("Малый", "Средний" или "Большой") и **числа экземпляров** (1, 2, 3 и т. д.) **плана службы приложений**.

Для приложений, работающих в режиме плана **Бесплатный** или **Общий**, предоставляются следующие **квоты**.

* **CPU (Short)**
  * Объем ресурсов ЦП, которые может потребить приложение в течение 5 минут. Эта квота повторно назначается каждые 5 минут.
* **CPU (Day)**
  * объем ресурсов ЦП, которые может потребить приложение в течение одного дня. Эта квота повторно назначается каждые 24 часа в полночь (в формате UTC);
* **Память**
  * объем ресурсов ЦП, которые может потребить приложение;
* **Пропускная способность**
  * объем исходящей пропускной способности, который может использовать приложение в течение одного дня.
    Эта квота повторно назначается каждые 24 часа в полночь (в формате UTC);
* **Filesystem**
  * общий объем доступного пространства для хранения.

Для приложений, настроенных для работы в режиме плана **Базовый**, **Стандартный** и **Премиум**, доступна только квота **Filesystem**.

Дополнительные сведения об определенных квотах, ограничениях и функциях, доступных для разных номеров SKU службы приложений, см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md#app-service-limits).

#### <a name="quota-enforcement"></a>Принудительное применение квот
Если квоты на использование ЦП (**непродолжительное** и **посуточное**), а также квота на **пропускную способность** будут превышены, работа приложения будет остановлена до повторного назначения квоты. В течение этого времени все входящие запросы завершаются с ошибкой **HTTP 403**.
![][http403]

Если будет превышена квота на **память**, приложение перезапускается.

Если будет превышена квота на **файловую систему**, все операции записи, в том числе и записи в журналы, завершаются сбоем.

Квоту на использование можно увеличить или удалить из приложения путем изменения плана службы приложений.

### <a name="metrics"></a>Метрики
**Метрики** предоставляют сведения о приложении или поведении плана службы приложений.

Для **приложения**доступны следующие метрики:

* **Среднее время ответа**
  * среднее время обработки запроса приложением (в миллисекундах);
* **средний размер рабочего набора памяти;**
  * средний объем памяти (в МиБ/с), используемый приложением;
* **Время ЦП**
  * количество времени ЦП (в секундах), используемого приложением. Дополнительные сведения об этих метриках см. в документации по [времени и проценту использования ЦП](#cpu-time-vs-cpu-percentage);
* **Входящие данные**
  * объем входящей пропускной способности, используемый приложением (в МиБ/с);
* **Выходные данные**
  * объем исходящей пропускной способности, используемый приложением (в МиБ/с);
* **HTTP 2xx**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 200, но меньшим 300;
* **HTTP 3xx**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 300, но меньшим 400;
* **HTTP 401**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния 401;
* **Http 403**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния 403;
* **HTTP 404**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния 404;
* **HTTP 406**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния 406;
* **HTTP 4xx**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 400, но меньшим 500;
* **Ошибки HTTP-сервера**
  * количество запросов, для которых возвращается ошибка HTTP с кодом состояния, большим или равным 500, но меньшим 600;
* **рабочий набор памяти;**
  * текущий объем используемой приложением памяти (в МиБ/с);
* **Requests (Запросы)**
  * общее количество запросов, для которых возвращается ошибка HTTP (независимо от кода состояния).

Для **плана службы приложений**доступны следующие метрики.

> [!NOTE]
> Метрики плана службы приложений поддерживаются только для планов на уровнях **Базовый**, **Стандартный** и **Премиум**.
> 
> 

* **Процент использования ЦП**
  * средний процент использования ЦП всеми экземплярами плана;
* **Процент использования памяти**
  * средний процент использование памяти всеми экземплярами плана;
* **Входящие данные**
  * средний показатель использования входящей пропускной способности всеми экземплярами плана;
* **Выходные данные**
  * средний показатель использования исходящей пропускной способности всеми экземплярами плана;
* **Длина дисковой очереди**
  * среднее число запросов на чтение и запись, поставленных в очередь в хранилище. Большая длина очереди на диске замедляет производительность приложения из-за избыточных дисковых операции ввода-вывода;
* **Длина очереди HTTP**
  * среднее число запросов HTTP, которые ставятся в очередь перед выполнением. Большая или увеличивающая длина очереди HTTP является признаком интенсивной нагрузки плана.

### <a name="cpu-time-vs-cpu-percentage"></a>Время и процент использования ЦП
<!-- To do: Fix Anchor (#CPU-time-vs.-CPU-percentage) -->

Доступны две метрики, которые отражают использование ЦП: **Время ЦП** и **Процент ЦП**.

Метрику **Время ЦП** рекомендуется использовать для приложений, настроенных для работы в режиме плана **Бесплатный** или **Общий**. Это связанно с тем, что квота на использование ЦП приложением, предоставленная в этих планах, определяется в минутах.

Метрика **Процент ЦП** удобна для приложений, размещенных в планах **Базовый**, **Стандартный** и **Премиум**, так как они поддерживают масштабирование. Метрика "Процент ЦП" позволяет получить представление об общем использовании ЦП для всех экземпляров.

## <a name="metrics-granularity-and-retention-policy"></a>Степень детализации метрик и политика их хранения
Метрики для приложения и плана службы приложений записываются и обрабатываются в службе в соответствии со следующей степенью детализации и политиками хранения.

* Метрики со степенью детализации до **минут** хранятся **30 часов**.
* Метрики со степенью детализации до **часов** хранятся **30 дней**.
* Метрики со степенью детализации до **дней** хранятся **30 дней**.

## <a name="monitoring-quotas-and-metrics-in-the-azure-portal"></a>Мониторинг квот и метрик на портале Azure.
Состояние **квот** и **метрик**, влияющих на приложение, можно просмотреть на [портале Azure](https://portal.azure.com).

Чтобы просмотреть сведения о ![][quotas]
**квотах**, выберите "Параметры" > **Квоты**. В UX отображаются следующие сведения о квотах: (1) имя, (2) интервал повторного назначения, (3) текущее ограничение и (4) текущее значение.

Доступ к сведениям о ![][metrics]
**метриках** можно получить прямо на странице ресурсов. Здесь также можно настроить отображение диаграммы. Для этого необходимо **щелкнуть** диаграмму и выбрать **Изменить диаграмму**.
Этот параметр позволяет задать **диапазон времени**, **тип диаграммы** и отображаемые **метрики**.  

Дополнительные сведения о метриках см. в статье [Обзор метрик в Microsoft Azure](../monitoring-and-diagnostics/insights-how-to-customize-monitoring.md).

## <a name="alerts-and-autoscale"></a>Оповещения и автомасштабирование
Метрики для плана приложения или службы приложений можно привязать к оповещениям. Дополнительные сведения об этом см. в статье [Получение уведомлений об оповещениях](../monitoring-and-diagnostics/insights-alerts-portal.md).

Приложения службы приложений в рамках плана "Базовый", "Стандартный" и "Премиум", поддерживают возможность **автомасштабирования**. Автомасштабирование позволяет настроить правила, которые отслеживают метрики плана службы приложений. Правила могут увеличивать или уменьшать число экземпляров, предоставляя дополнительные ресурсы при необходимости. Правила также помогают сократить расходы на чрезмерную подготовку приложений. Дополнительные сведения об автомасштабировании см. в статье [Масштабирование числа экземпляров вручную или автоматически](../monitoring-and-diagnostics/insights-how-to-scale.md) и [Рекомендации по автомасштабированию Azure Monitor](../monitoring-and-diagnostics/insights-autoscale-best-practices.md).

> [!NOTE]
> Чтобы приступить к работе со службой приложений Azure до создания учетной записи Azure, перейдите к разделу [Пробное использование службы приложений](https://azure.microsoft.com/try/app-service/), где вы можете быстро создать кратковременное веб-приложение начального уровня в службе приложений. Никаких кредитных карт и обязательств.
> 
> 

[fzilla]:http://go.microsoft.com/fwlink/?LinkId=247914
[vmsizes]:http://go.microsoft.com/fwlink/?LinkID=309169



<!-- Images. -->
[http403]: ./media/web-sites-monitor/http403.png
[quotas]: ./media/web-sites-monitor/quotas.png
[metrics]: ./media/web-sites-monitor/metrics.png
