---
title: 'Наблюдатель за сетями Azure: общие сведения о записи пакетов | Документация Майкрософт'
description: Эта страница содержит обзорные сведения о функции записи пакетов в службе наблюдения за сетями
services: network-watcher
documentationcenter: na
author: jimdial
manager: timlt
editor: ''
ms.assetid: 3a81afaa-ecd9-4004-b68e-69ab56913356
ms.service: network-watcher
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/22/2017
ms.author: jdial
ms.openlocfilehash: 152cc8fb61aa6115c7b5863e4d798db9e7aa5b7c
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/11/2017
ms.locfileid: "23036839"
---
# <a name="introduction-to-variable-packet-capture-in-azure-network-watcher"></a>Общие сведения о возможностях записи пакетов в Наблюдателе за сетями Azure

Возможности записи пакетов Наблюдателя за сетями позволяют создавать соответствующие сеансы для отслеживания входящего и исходящего трафика виртуальной машины. Функция записи пакетов помогает выявлять аномалии в работе сети по факту или заранее. Они также помогают выполнять сбор сетевой статистики, получать сведения о сетевых вторжениях, выполнять отладку передачи данных между клиентом и сервером и многое другое.

Запись пакетов — это расширение виртуальной машины, которое запускается удаленно в службе наблюдения за сетями. Эту функцию не нужно запускать вручную. К тому же она сразу выполняется на требуемой виртуальной машине, что также позволяет сэкономить ваше время. Запись пакетов можно активировать через портал, PowerShell, интерфейс командной строки или REST API. Один из примеров активации записи пакетов — активация с помощью оповещений на виртуальной машине. Для сеанса записи доступны фильтры, с помощью которых можно убедиться, что записывается только требуемый трафик. В фильтрах используются сведениях о пяти кортежах (протокол, локальный IP-адрес, удаленный IP-адрес, локальный порт, удаленный порт). Собранные данные хранятся на локальном диске или в большом двоичном объекте хранилища. Установлено ограничение в 10 сеансов записи пакетов на подписку в регионе. Это ограничение относится только к сеансам, а не к файлам записанных пакетов, сохраненных локально на виртуальной машине или в учетной записи хранения.

> [!IMPORTANT]
> Для записи пакетов необходимо расширение виртуальной машины `AzureNetworkWatcherExtension`. Информацию об установке расширения для виртуальной машины Windows см. в статье [Расширение виртуальной машины агента Наблюдателя за сетями для Windows](../virtual-machines/windows/extensions-nwa.md), а для виртуальной машины Linux — в статье [Расширение виртуальной машины агента Наблюдателя за сетями для Linux](../virtual-machines/linux/extensions-nwa.md).

Следующие параметры позволяют собирать только необходимые данные во время сеанса записи пакетов:

**Параметры записи**

|Свойство|ОПИСАНИЕ|
|---|---|
|**Максимальное число байтов на пакет (в байтах)** | Число записываемых байтов из каждого пакета. Если поле остается пустым, записываются все байты. Число записываемых байтов из каждого пакета. Если поле остается пустым, записываются все байты. Если вам нужен только заголовок IPv4, укажите здесь 34. |
|**Максимальное число байтов за сеанс (в байтах)** | Общее число записанных байтов, при достижении которого происходит завершение сеанса.|
|**Ограничение по времени (в секундах)** | Задает ограничение по времени для сеанса записи пакета. Значение по умолчанию составляет 18 000 секунд или 5 часов.|

**Фильтрация (необязательно)**

|Свойство|ОПИСАНИЕ|
|---|---|
|**Протокол** | Протокол фильтрации для записи пакетов. Возможны такие значения: TCP, UDP и все.|
|**Локальный IP-адрес** | Это значение фильтрует запись пакетов по указанному локальному IP-адресу.|
|**Локальный порт** | Это значение фильтрует запись пакетов по указанному локальному порту.|
|**Удаленный IP-адрес** | Это значение фильтрует запись пакетов по указанному удаленному IP-адресу.|
|**Удаленный порт** | Это значение фильтрует запись пакетов по указанному удаленному порту.|

### <a name="next-steps"></a>Дополнительная информация

См. дополнительные сведения об управлении записью пакетов [на портале Azure](network-watcher-packet-capture-manage-portal.md) и [с помощью PowerShell](network-watcher-packet-capture-manage-powershell.md).

См. дополнительные сведения о создании упреждающей записи пакетов с помощью оповещений на виртуальной машине в [этой статье](network-watcher-alert-triggered-packet-capture.md).

<!--Image references-->
[1]: ./media/network-watcher-packet-capture-overview/figure1.png













