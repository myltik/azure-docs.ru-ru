---
title: Потоковая трансляция с помощью локальных кодировщиков c использованием портала Azure | Документация Майкрософт
description: В этом руководстве рассматривается создание канала, настроенного для сквозной доставки.
services: media-services
documentationcenter: ''
author: juliako
manager: cfowler
editor: ''
ms.assetid: 6f4acd95-cc64-4dd9-9e2d-8734707de326
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 08/09/2017
ms.author: juliako
ms.openlocfilehash: e4f786eeb8994e44f827e5158811cae4a60453cc
ms.sourcegitcommit: e221d1a2e0fb245610a6dd886e7e74c362f06467
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2018
ms.locfileid: "33780642"
---
# <a name="how-to-perform-live-streaming-with-on-premises-encoders-using-the-azure-portal"></a>Потоковая трансляция с помощью локальных кодировщиков c использованием портала Azure
> [!div class="op_single_selector"]
> * [Портал](media-services-portal-live-passthrough-get-started.md)
> * [.NET](media-services-dotnet-live-encode-with-onpremises-encoders.md)
> * [REST](https://docs.microsoft.com/rest/api/media/operations/channel)
> 
> 

В этом руководстве рассматривается создание **канала** , настроенного для сквозной доставки, с помощью портала Azure. 

## <a name="prerequisites"></a>предварительным требованиям
Ниже перечислены необходимые условия для выполнения действий, описанных в этом учебнике.

* Учетная запись Azure. Дополнительные сведения см. в разделе [Бесплатная пробная версия Azure](https://azure.microsoft.com/pricing/free-trial/). 
* Учетная запись служб мультимедиа. Инструкции по созданию учетной записи служб мультимедиа см. в статье [Создание учетной записи служб мультимедиа Azure с помощью портала Azure](media-services-portal-create-account.md).
* Веб-камера, например [кодировщик Telestream Wirecast](http://www.telestream.net/wirecast/overview.htm).

Настоятельно рекомендуется ознакомиться со следующими статьями:

* [Поддержка протокола RTMP службами мультимедиа Azure и динамические кодировщики](https://azure.microsoft.com/blog/2014/09/18/azure-media-services-rtmp-support-and-live-encoders/)
* [Общие сведения о динамической потоковой передаче с использованием служб мультимедиа Azure](media-services-manage-channels-overview.md)
* [Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями](media-services-live-streaming-with-onprem-encoders.md)

## <a id="scenario"></a>Стандартный сценарий потоковой передачи в режиме реального времени
Далее описаны задачи, связанные с созданием стандартных приложений для потоковой трансляции, которые используют каналы, настроенные для сквозной доставки. В этом руководстве показано, как создавать сквозные каналы и интерактивные события, а также управлять ими.

>[!NOTE]
>Убедитесь, что конечная точка потоковой передачи, из которой нужно передавать содержимое потоком, находится в состоянии **Выполняется**. 
    
1. Подключите видеокамеру к компьютеру. Запустите и настройте локальный динамический кодировщик, который выводит поток с разными скоростями RTMP или фрагментированный поток MP4. Дополнительные сведения см. в статье о [поддержке протокола RTMP в службах мультимедиа Azure и о динамических кодировщиках](http://go.microsoft.com/fwlink/?LinkId=532824).
   
    Это действие также можно выполнить после создания канала.
2. Создайте и запустите сквозной канал.
3. Получите URL-адрес приема канала. 
   
    URL-адрес приема используется динамическим кодировщиком для отправки потока в канал.
4. Получите URL-адрес предварительного просмотра канала. 
   
    С его помощью можно убедиться в том, что канал надлежащим образом получает поток.
5. Создайте интерактивное событие или программу. 
   
    Если вы используете портал Azure, при создании интерактивного события также создается ресурс. 

6. Когда вы будете готовы начать потоковую передачу и архивацию, запустите событие или программу.
7. При необходимости динамическому кодировщику можно дать сигнал начать показ рекламы. Реклама вставляется в выходной поток.
8. Чтобы остановить потоковую передачу и архивацию содержимого события, завершите работу события или программы.
9. Удалите событие или программу (и при необходимости ресурс).     

> [!IMPORTANT]
> Основные понятия и рекомендации, связанные с потоковой трансляцией с помощью локальных кодировщиков и сквозных каналов, см. в статье [Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями](media-services-live-streaming-with-onprem-encoders.md).
> 
> 

## <a name="to-view-notifications-and-errors"></a>Просмотр уведомлений и сообщений об ошибках
Чтобы просмотреть уведомления и ошибки на портале Azure, щелкните значок уведомления.

![Уведомления](./media/media-services-portal-passthrough-get-started/media-services-notifications.png)

## <a name="create-and-start-pass-through-channels-and-events"></a>Создание и запуск сквозных каналов и событий
Канал связан с событиями и программами, с помощью которых вы можете управлять публикацией и хранением сегментов динамического потока. Каналы управляют событиями. 

Задать количество часов, в течение которых следует хранить записанное содержимое программы, можно с помощью параметра длины **окна архивирования** . Это значение может быть задано в диапазоне от 5 минут до 25 часов. Длина окна архивирования также определяет максимальный период, в пределах которого клиенты могут перемещаться назад во времени относительно текущей позиции в передаваемом потоке данных. События могут происходить в течение определенного времени, однако содержимое, выходящее за пределы этого периода, теряется. Значение этого свойства также определяет максимальный размер манифестов клиентов.

Каждое событие связано с ресурсом. Чтобы опубликовать событие, необходимо создать указатель OnDemand для соответствующего ресурса. С помощью этого указателя можно сформировать URL-адрес потоковой передачи данных, который предоставляется клиентам.

Канал поддерживает одновременную потоковую трансляцию максимум трех событий, поэтому можно создавать по несколько архивов одного и того же входящего потока. Благодаря этому можно публиковать и архивировать разные части транслируемого мероприятия. Например ваш бизнес-требование — архивировать 6 часов программы, но для передачи только оставить последние 10 минут. Для этого необходимо создать две одновременно работающие программы. Для одной из них настроено архивирование 6 часов транслируемого мероприятия, но без публикации. Для второй программы настроено архивирование 10 минут с публикацией.

Не следует использовать имеющиеся интерактивные события повторно. Вместо этого создайте и запустите новое событие для каждого события.

Когда вы будете готовы начать потоковую передачу и архивацию, запустите событие. Чтобы остановить потоковую передачу и архивацию содержимого мероприятия, завершите работу программы. 

Чтобы удалить архивированное содержимое, остановите и удалите событие, а затем удалите связанный с ним ресурс. Ресурс невозможно удалить, пока он используется каким-либо событием: сначала нужно удалить это событие. 

Даже после остановки и удаления события пользователи смогут запрашивать потоковую передачу архивированного видеосодержимого, пока не удален соответствующий ресурс.

Если вы хотите сохранить заархивированное содержимое, но при этом заблокировать возможность его потоковой передачи, удалите указатель.

### <a name="to-use-the-portal-to-create-a-channel"></a>Создание канала с помощью портала
В этом разделе показано, как использовать функцию **Быстрое создание** для создания сквозного канала.

Дополнительные сведения об этих каналах см. в статье [Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями](media-services-live-streaming-with-onprem-encoders.md).

1. Выберите учетную запись служб мультимедиа Azure на [портале Azure](https://portal.azure.com/).
2. В окне **Параметры** щелкните элемент **Потоковая трансляция**. 
   
    ![Приступая к работе](./media/media-services-portal-passthrough-get-started/media-services-getting-started.png)
   
    Появится окно **Live streaming** (Потоковая трансляция).
3. Щелкните элемент **Быстрое создание** , чтобы создать сквозной канал с протоколом приема RTMP.
   
    Появится окно **CREATE A NEW CHANNEL** (СОЗДАНИЕ КАНАЛА).
4. Присвойте имя новому каналу и нажмите кнопку **Создать**. 
   
    После этого будет создан сквозной канал с протоколом приема RTMP.

## <a name="create-events"></a>Создание событий
1. Выберите канал, в который нужно добавить событие.
2. Нажмите кнопку **Интерактивное событие** .

![Событие](./media/media-services-portal-passthrough-get-started/media-services-create-events.png)

## <a name="get-ingest-urls"></a>Получение URL-адресов приема
После создания канала можно получить URL-адреса приема, которые необходимо передать динамическому кодировщику. Он использует эти адреса для передачи динамического потока на вход.

![Создано](./media/media-services-portal-passthrough-get-started/media-services-channel-created.png)

## <a name="watch-the-event"></a>Просмотр события
Чтобы просмотреть событие, щелкните **Посмотреть** на портале Azure или скопируйте URL-адрес потоковой передачи и используйте проигрыватель по своему усмотрению. 

![Создано](./media/media-services-portal-passthrough-get-started/media-services-default-event.png)

После остановки интерактивное событие автоматически преобразуется в содержимое по запросу.

## <a name="clean-up"></a>Очистка
Дополнительные сведения об этих каналах см. в статье [Потоковая трансляция с помощью локальных кодировщиков, создающих потоки с разными скоростями](media-services-live-streaming-with-onprem-encoders.md).

* Канал можно остановить, только если все передаваемые по нему события и программы остановлены.  После остановки канала начисление платы прекращается. Если вам понадобится снова запустить его, вы можете воспользоваться тем же URL-адресом приема (перенастраивать кодировщик не потребуется).
* Канал можно удалить, только если все передаваемые по нему интерактивные события удалены.

## <a name="view-archived-content"></a>Просмотр архивного содержимого
Даже после остановки и удаления события пользователи смогут запрашивать потоковую передачу архивированного видеосодержимого, пока не удален соответствующий ресурс. Ресурс невозможно удалить, пока он используется каким-либо событием: сначала нужно удалить это событие. 

Для управления ресурсами последовательно выберите **Параметры** и **Ресурсы**.

![ресурсы](./media/media-services-portal-passthrough-get-started/media-services-assets.png)

## <a name="next-step"></a>Дальнейшие действия
Просмотрите схемы обучения работе со службами мультимедиа.

[!INCLUDE [media-services-learning-paths-include](../../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a>Отзывы
[!INCLUDE [media-services-user-voice-include](../../../includes/media-services-user-voice-include.md)]

