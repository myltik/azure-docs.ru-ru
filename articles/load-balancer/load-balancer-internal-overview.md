---
title: "Общие сведения о внутреннем балансировщике нагрузки | Документация Майкрософт"
description: "Обзор внутренней подсистемы балансировки нагрузки и ее функций, а также информация о том, как она работает в Azure и возможные сценарии настройки внутренних конечных точек."
services: load-balancer
documentationcenter: na
author: KumudD
manager: timlt
editor: tysonn
ms.assetid: 36065bfe-0ef1-46f9-a9e1-80b229105c85
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/25/2017
ms.author: kumud
ms.translationtype: HT
ms.sourcegitcommit: c3a2462b4ce4e1410a670624bcbcec26fd51b811
ms.openlocfilehash: ec07c77119c2da408da21fbdc7877d0b43d16556
ms.contentlocale: ru-ru
ms.lasthandoff: 09/25/2017

---

# <a name="internal-load-balancer-overview"></a>Обзор внутренней подсистемы балансировки нагрузки

[!INCLUDE [load-balancer-basic-sku-include.md](../../includes/load-balancer-basic-sku-include.md)]

В отличие от подсистемы балансировки нагрузки для Интернета, внутренняя подсистема балансировки нагрузки (ILB) направляет трафик только к ресурсам в пределах облачной службы или использует VPN для доступа к инфраструктуре Azure. Эта инфраструктура ограничивает доступ к виртуальным IP-адресам с балансировкой нагрузки для облачной службы или виртуальной сети. Таким образом, они никогда не будут доступны напрямую конечной точке в Интернете. Это позволяет выполнять внутренние бизнес-приложения в Azure и получать к ним доступ в облаке или из локальных ресурсов.

## <a name="why-you-may-need-an-internal-load-balancer"></a>Чем полезна внутренняя подсистема балансировки нагрузки

Внутренняя балансировка нагрузки Azure обеспечивает балансировку нагрузки между виртуальными машинами, которые размещены в облачной службе или региональной виртуальной сети. Информацию об использовании и настройке региональных виртуальных сетей см. в разделе блога Azure, посвященном [региональным виртуальным сетям](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/). В имеющихся виртуальных сетях, настроенных для территориальной группы, невозможно использовать внутреннюю балансировку нагрузки.

Внутренняя подсистема балансировки нагрузки реализует следующие типы балансировки нагрузки:

* в облачной службе от виртуальных машин к набору виртуальных машин, размещенных в той же облачной службе (см. рис. 1);
* в виртуальной сети от виртуальных машин в виртуальной сети к набору виртуальных машин, размещенных в той же облачной службе виртуальной сети (см. рис. 2);
* для распределенной виртуальной сети от локальных компьютеров к набору виртуальных машин, размещенных в той же облачной службе виртуальной сети (см. рис. 3).
* Доступные в Интернете многоуровневые приложения, серверные уровни в которых недоступны в Интернете, но требуют балансировки нагрузки для трафика на уровне, доступном в Интернете,
* Для балансировки нагрузки в бизнес-приложениях, размещенных в Azure. При этом не требуется дополнительное оборудование или программное обеспечение для распределения нагрузки. включая локальные серверы в наборе компьютеров, чей трафик балансируется.

## <a name="internet-facing-multi-tier-applications"></a>Многоуровневые приложения, доступные в Интернете

Веб-уровень содержит конечные точки, доступные в Интернете, для интернет-клиентов и входит в набор балансировки нагрузки. Подсистема балансировки нагрузки распределяет трафик от веб-клиентов на TCP-порт 443 (HTTPS) для веб-серверов.

Серверы баз данных находятся в пределах конечной точки внутренней балансировки нагрузки, которую веб-серверы используют для хранения данных. Это конечная точка с балансировкой нагрузки службы баз данных, трафик которой распределяется по серверам баз данных во внутреннем наборе балансировки нагрузки.

На следующем рисунке показано многоуровневое приложение, доступное в Интернете, в пределах одной и той же облачной службы.

![Внутренняя балансировка нагрузки для одной облачной службы](./media/load-balancer-internal-overview/IC736321.png)

Рис. 1. Многоуровневое приложение для Интернета

Другой возможный сценарий для многоуровневого приложения: внутренняя подсистема балансировки нагрузки развертывается в облачной службе, отличной от той, которая использует службу для внутренней подсистемы балансировки нагрузки.

Облачные службы, использующие одну и ту же виртуальную сеть, будут иметь доступ к конечной точке внутренней подсистемы балансировки нагрузки. На следующем изображении показано, что веб-серверы переднего плана размещены в облачной службе, отличной от той, в которой размещен сервер базы данных. Кроме того, они используют конечную точку внутреннего балансировщика нагрузки в пределах одной и той же виртуальной сети.

![Внутренняя балансировка нагрузки между облачными службами](./media/load-balancer-internal-overview/IC744147.png)

Рис. 2. Серверы переднего плана в другой облачной службе

## <a name="intranet-line-of-business-applications"></a>Бизнес-приложения в интрасети

Трафик от клиентов в локальной сети распределяется по набору серверов бизнес-приложений с помощью VPN-подключения к сети Azure.

Клиентский компьютер получит доступ к IP-адресу из службы VPN Azure, используя VPN подключение типа "точка — сеть". Это позволит использовать бизнес-приложение, размещенное за конечной точкой внутренней подсистемы балансировки нагрузки.

![Внутренняя балансировка нагрузки с использованием VPN типа «точка-сеть»](./media/load-balancer-internal-overview/IC744148.png)

Рис. 3. Бизнес-приложение, размещенное за конечной точкой подсистемы балансировки нагрузки

Другой сценарий для бизнес-приложения: использование VPN подключения типа "сеть —сеть" для виртуальной сети, в которой настроена конечная точка внутренней подсистемы балансировки нагрузки. Это позволит направлять локальный сетевой трафик к конечной точке внутренней подсистемы балансировки нагрузки.

![Внутренняя балансировка нагрузки с помощью VPN типа «сеть-сеть»](./media/load-balancer-internal-overview/IC744150.png)

Рис. 4. Локальной сетевой трафик направляется к конечной точке внутренней подсистемы балансировки нагрузки

## <a name="limitations"></a>Ограничения

Конфигурации с внутренней подсистемой балансировки нагрузки не поддерживают SNAT. В контексте этого документа под SNAT следует понимать преобразование сетевых адресов маскирующего порты источника.  Такое преобразование требуется в ситуациях, когда виртуальной машине в пуле подсистем балансировки нагрузки необходимо установить связь с соответствующим интерфейсным IP-адресом внутренней подсистемы балансировки нагрузки. В настоящее время для внутренней подсистемы балансировки нагрузки такой сценарий не поддерживается. Когда в ходе балансировки нагрузка, создаваемая потоком, переносится на виртуальную машину, которая создала этот поток, происходит сбой подключения. В таких ситуациях следует использовать подсистему балансировки нагрузки, работающую по принципу прокси-сервера.

## <a name="next-steps"></a>Дальнейшие действия

[Поддержка Azure Resource Manager для Azure Load Balancer](load-balancer-arm.md)

[Приступая к настройке подсистемы балансировки нагрузки, доступной в Интернете](load-balancer-get-started-internet-arm-ps.md)

[Приступая к настройке внутренней подсистемы балансировки нагрузки](load-balancer-get-started-ilb-arm-ps.md)

[Настройка режима распределения подсистемы балансировки нагрузки](load-balancer-distribution-mode.md)

[Настройка параметров времени ожидания простоя TCP для подсистемы балансировки нагрузки](load-balancer-tcp-idle-timeout.md)

