---
title: Общие сведения о внутреннем Azure Load Balancer | Документация Майкрософт
description: Сведения о том, как внутренняя подсистема балансировки нагрузки работает в Azure, и сценарии настройки внутренних конечных точек.
services: load-balancer
documentationcenter: na
author: KumudD
manager: timlt
editor: tysonn
ms.assetid: 36065bfe-0ef1-46f9-a9e1-80b229105c85
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/25/2017
ms.author: kumud
ms.openlocfilehash: 0511165225f5a336291e86e0c504e60989933f3c
ms.sourcegitcommit: c3d53d8901622f93efcd13a31863161019325216
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2018
---
# <a name="overview-of-azure-internal-load-balancer"></a>Общие сведения о внутреннем Azure Load Balancer



Внутренняя подсистема балансировки нагрузки Azure (ILB) направляет трафик только к тем ресурсам, которые находятся внутри облачной службы или используют VPN для доступа к инфраструктуре Azure. В этом отношении ILB отличается от подсистемы балансировки нагрузки с доступом в Интернет. Инфраструктура Azure ограничивает доступ к виртуальным IP-адресам (с балансировкой нагрузки) облачных служб или к виртуальной сети. Виртуальные IP-адреса и виртуальные сети никогда не предоставляются напрямую конечной точке Интернета. Внутренние бизнес-приложения выполняются в Azure и доступны из Azure или из локальных ресурсов.

## <a name="why-you-might-need-an-internal-load-balancer"></a>Чем полезна внутренняя подсистема балансировки нагрузки

Внутренняя подсистема балансировки нагрузки обеспечивает балансировку нагрузки между виртуальными машинами, которые размещены в облачной службе или региональной виртуальной сети. Информацию о региональных виртуальных сетях см. в разделе блога Azure, посвященном [региональным виртуальным сетям](https://azure.microsoft.com/blog/2014/05/14/regional-virtual-networks/). В имеющихся виртуальных сетях, настроенных для территориальной группы, невозможно использовать внутреннюю балансировку нагрузки.

Внутренняя подсистема балансировки нагрузки реализует следующие типы балансировки нагрузки:

* В облачной службе: распределение нагрузки между виртуальными машинами и набором виртуальных машин, которые находятся в одной и той же облачной службе. См. этот <a href="#figure1">пример</a>.
* В виртуальной сети: распределение нагрузки между виртуальными машинами в виртуальной сети и набором виртуальных машин, размещенных в той же облачной службе виртуальной сети. См. этот <a href="#figure2">пример</a>.
* Для распределенной виртуальной сети: балансировка нагрузки локальных компьютеров к набору виртуальных машин, размещенных в той же облачной службе виртуальной сети. См. этот <a href="#figure3">пример</a>.
* Для многоуровневых приложений: балансировка нагрузки для многоуровневых приложений с доступом в Интернет, где серверные уровни не имеют доступа к Интернету. Серверные уровни требуют балансировки нагрузки трафика уровня с выходом в Интернет.
* Для бизнес-приложений: балансировка нагрузки для бизнес-приложений, размещенных в Azure без дополнительного оборудования или программного обеспечения подсистемы балансировки нагрузки. Сценарий включает в себя локальные серверы в наборе компьютеров, чей трафик балансируется.

## <a name="load-balancing-for-internet-facing-multi-tier-applications"></a>Балансировка нагрузки многоуровневых приложений с доступом в Интернет

Веб-уровень содержит конечные точки, доступные в Интернете, для интернет-клиентов и входит в набор балансировки нагрузки. Внутренняя подсистема балансировки нагрузки распределяет трафик от веб-клиентов на TCP-порт 443 (HTTPS) для веб-серверов.

Серверы баз данных находятся в пределах конечной точки внутренней подсистемы балансировки нагрузки, которую веб-серверы используют для хранения данных. Конечная точка ILB является конечной точкой службы базы данных с балансировкой нагрузки. Трафик распределяется между серверами базы данных в наборе внутренней балансировки нагрузки.

На следующем рисунке показана внутренняя балансировка нагрузки многоуровневого приложения с доступом в Интернет в пределах одной и той же облачной службы.

<a name="figure1"></a>
![Многоуровневое приложение с доступом в Интернет](./media/load-balancer-internal-overview/IC736321.png)

Для многоуровневых приложений доступен другой сценарий. Подсистема балансировки нагрузки развертывается в другую облачную службу, отличную от той, которая использует службу для внутренней балансировки нагрузки.

Облачные службы, использующие одну и ту же виртуальную сеть, будут иметь доступ к конечной точке внутренней подсистемы балансировки нагрузки. На следующем изображении показано, что веб-серверы переднего плана размещены в облачной службе, отличной от той, в которой размещен сервер базы данных. Кроме того, они используют конечную точку внутренней подсистемы балансировки нагрузки в пределах одной и той же виртуальной сети.

<a name="figure2"></a>
![Серверы переднего плана в другой облачной службе](./media/load-balancer-internal-overview/IC744147.png)

## <a name="load-balancing-for-intranet-line-of-business-applications"></a>Балансировка нагрузки для бизнес-приложений интрасети

Трафик от клиентов в локальной сети распределяется по набору серверов бизнес-приложений с помощью VPN-подключения к сети Azure.

Клиентский компьютер получит доступ к IP-адресу из службы VPN Azure, используя VPN подключение типа "точка — сеть". Бизнес-приложения можно разместить за конечной точкой внутренней подсистемы балансировки нагрузки.

<a name="figure3"></a>
![Бизнес-приложение, размещенное за конечной точкой внутренней подсистемы балансировки нагрузки](./media/load-balancer-internal-overview/IC744148.png)

Другой сценарий для бизнес-приложений: использование VPN-подключения типа "сеть —сеть" для виртуальной сети, в которой настроена конечная точка внутренней подсистемы балансировки нагрузки. Локальный сетевой трафик направляется к конечной точке внутренней подсистемы балансировки нагрузки.

<a name="figure4"></a>
![Локальный сетевой трафик направляется к конечной точке внутренней подсистемы балансировки нагрузки](./media/load-balancer-internal-overview/IC744150.png)

## <a name="limitations"></a>Ограничения

Конфигурации с внутренней подсистемой балансировки нагрузки не поддерживают SNAT. В контексте этой статьи под SNAT следует понимать преобразование исходных сетевых адресов с маскированием портов. У виртуальной машины в пуле балансировки нагрузки должен быть доступ к IP-адресу внешнего интерфейса соответствующей внутренней подсистемы балансировки нагрузки. Когда в ходе балансировки нагрузка, создаваемая потоком, переносится на виртуальную машину, которая создала этот поток, происходит сбой подключения. Внутренняя подсистема балансировки нагрузки в следующих сценариях не поддерживается: Вместо этого необходимо использовать подсистему балансировки нагрузки в режиме прокси-сервера.

## <a name="next-steps"></a>Дополнительная информация

* [Поддержка Azure Resource Manager для Azure Load Balancer](load-balancer-arm.md)
* [Создание балансировщика нагрузки для Интернета в Resource Manager с помощью PowerShell](load-balancer-get-started-internet-arm-ps.md)
* [Создание внутреннего балансировщика нагрузки с помощью PowerShell](load-balancer-get-started-ilb-arm-ps.md)
* [Настройка режима распределения для подсистемы балансировки нагрузки](load-balancer-distribution-mode.md)
* [Настройка параметров времени ожидания простоя TCP для подсистемы балансировки нагрузки](load-balancer-tcp-idle-timeout.md)
