---
title: Подключение устройства DevKit к приложению Azure IoT Central | Документация Майкрософт
description: Вы узнаете, как разработчик устройства может подключить устройство MXChip IoT DevKit к приложению Azure IoT Central.
author: tbhagwat3
ms.author: tanmayb
ms.date: 04/16/2018
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: d7b92359e8875c281fd460f1f5307a7941c11c1f
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "35261582"
---
# <a name="connect-an-mxchip-iot-devkit-device-to-your-azure-iot-central-application"></a>Подключение устройства MXChip IoT DevKit к приложению Azure IoT Central

В этой статье описано, каким образом разработчик устройства может подключить устройство MXChip IoT DevKit (DevKit) к приложению Microsoft Azure IoT Central.

## <a name="before-you-begin"></a>Перед началом работы

Чтобы выполнить действия, описанные в этой статье, необходимо следующее:

1. Приложение Azure IoT Central, созданное на основе шаблона приложения **Sample Devkits** (Образец Devkits). Дополнительные сведения см. в статье [Создание приложения Azure IoT Central](howto-create-application.md).
1. Устройство DevKit. Чтобы приобрести устройство DevKit, посетите сайт [MXChip IoT DevKit](http://mxchip.com/az3166).

Приложение, созданное из шаблона приложения **Sample Devkits** (Образец Devkits), включает в себя шаблон приложения **MXChip** со следующими характеристиками:

### <a name="measurements"></a>Измерения

#### <a name="telemetry"></a>Телеметрия 

| Имя поля     | Units  | Минимальная | Максимальная | Число десятичных знаков |
| -------------- | ------ | ------- | ------- | -------------- |
| Влажность       | %      | 0       | 100     | 0              |
| temp           | °C     | –40     | 120     | 0              |
| pressure       | гПа    | 260     | 1260    | 0              |
| magnetometerX  | мГс | –1000   | 1000    | 0              |
| magnetometerY  | мГс | –1000   | 1000    | 0              |
| magnetometerZ  | мГс | –1000   | 1000    | 0              |
| accelerometerX | mg     | –2000   | 2000    | 0              |
| accelerometerY | mg     | –2000   | 2000    | 0              |
| accelerometerZ | mg     | –2000   | 2000    | 0              |
| gyroscopeX     | милиградусов/с   | –2000   | 2000    | 0              |
| gyroscopeY     | милиградусов/с   | –2000   | 2000    | 0              |
| gyroscopeZ     | милиградусов/с   | –2000   | 2000    | 0              |

#### <a name="states"></a>States 

| ИМЯ          | Отображаемое имя   | ОБЫЧНЫЙ РЕЖИМ | ВНИМАНИЕ! | ОПАСНОСТЬ! | 
| ------------- | -------------- | ------ | ------- | ------ | 
| DeviceState   | Состояние устройства   | Зеленый  | Оранжевый  | Красный    | 

#### <a name="events"></a>События 

| ИМЯ             | Отображаемое имя      | 
| ---------------- | ----------------- | 
| ButtonBPressed   | Нажата кнопка B  | 



### <a name="settings"></a>Параметры

Числовые параметры

| Отображаемое имя | Имя поля | Units | Число десятичных знаков | Минимальная | Максимальная | Initial |
| ------------ | ---------- | ----- | -------------- | ------- | ------- | ------- |
| Напряжение      | setVoltage | В | 0              | 0       | 240     | 0       |
| Текущее значение      | setCurrent | Амперы  | 0              | 0       | 100     | 0       |
| Скорость вращения вентилятора    | fanSpeed   | Об/мин   | 0              | 0       | 1000    | 0       |

Параметры переключения

| Отображаемое имя | Имя поля | Включение текста | Отключение текста | Initial |
| ------------ | ---------- | ------- | -------- | ------- |
| IR           | activateIR | ВКЛ      | ВЫКЛ.      | Отключить     |

### <a name="properties"></a>properties

| type            | Отображаемое имя | Имя поля | Тип данных |
| --------------- | ------------ | ---------- | --------- |
| Свойство устройства | Серийный номер   | dieNumber  | number    |
| текст            | Расположение     | location   | Недоступно       |


### <a name="add-a-real-device"></a>Добавление реального устройства

В приложении Azure IoT Central добавьте реальное устройство на основе шаблона приложения **MXChip** и запишите строку подключения к устройству. Дополнительные сведения см. в статье [Добавление реального устройства в приложение Azure IoT Central](tutorial-add-device.md).

## <a name="prepare-the-devkit-device"></a>Подготовка устройства DevKit

> [!TIP]
> Рекомендации по устранению неполадок устройства DevKit см. [здесь](https://microsoft.github.io/azure-iot-developer-kit/docs/get-started/).

Чтобы подготовить устройство DevKit, сделайте следующее:

1. Скачайте последнюю версию встроенного ПО Azure IoT Central для MXChip на [этой](https://github.com/Azure/iot-central-firmware/releases) странице на сайте GitHub. Имя загрузочного файла на странице выпусков выглядит следующим образом: `AZ3166-IoT-Central-X.X.X.bin`.

1. Подключите устройство DevKit к компьютеру, на котором будет выполняться разработка, с помощью USB-кабеля. В Windows в проводнике откроется диск, сопоставленный с хранилищем на устройстве DevKit. Например, этот диск может называться **AZ3166 (D:)**.

1. Перетащите файл **iotCentral.bin** в окно диска. По завершении копирования устройство перезагрузится с новой версией встроенного ПО.

1. При перезапуске устройства DevKit отображается следующий экран:

    ```
    Connect HotSpot:
    AZ3166_??????
    go-> 192.168.0.1 
    PIN CODE xxxxx
    ```

    > [!NOTE]
    > Если на экране отображается что-то еще, нажмите кнопку **Reset** (Сбросить). 

1. Устройство находится в режиме точки доступа. Вы можете подключаться к точке доступа Wi-Fi с компьютера или мобильного устройства.

1. На компьютере, телефоне или планшете подключитесь к сети Wi-Fi с именем, отображаемым на экране устройства. При подключении к этой сети у вас не будет доступа к Интернету. Это состояние является нормальным. Вы подключены к этой сети только на некоторое время, пока выполняется настройка устройства.

1. Откройте веб-браузер и перейдите по адресу [http://192.168.0.1/start](http://192.168.0.1/start). Откроется следующая веб-страница:

    ![Страница конфигурации устройства](media/howto-connect-devkit/configpage.png)

    На этой веб-странице сделайте следующее. 
    - Добавьте имя сети Wi-Fi. 
    - Введите пароль сети Wi-Fi. 
    - Укажите ПИН-код, который отображается на ЖК-мониторе устройства. 
    - Введите строку подключения к устройству. 
      Вы можете использовать строку подключения @ `https://apps.iotcentral.com` -> `Device Explorer` -> `Device` -> `Select or Create a new Real Device` -> `Connect this device` (в правом верхнем углу). 
    - Выберите все доступные измерения телеметрии. 

1. Если выбрать **Настройка устройства**, откроется следующая страница:

    ![Устройство настроено](media/howto-connect-devkit/deviceconfigured.png)

1. Нажмите кнопку **Reset** (Сбросить) на устройстве.

> [!NOTE]
> Чтобы перенастроить устройство для использования другой сети Wi-Fi, строки подключения или измерения телеметрии, одновременно нажмите на клавиатуре клавиши **A** и **B**. Если это не помогло, нажмите кнопку **сброса** и повторите попытку. 

## <a name="view-the-telemetry"></a>Просмотр телеметрии

При перезапуске устройства DevKit на экране устройства можно увидеть следующее:

* количество отправленных сообщений телеметрии;
* количество сбоев;
* количество полученных требуемых свойств и отправленных передаваемых свойств.

Встряхните устройство, чтобы увеличить количество отправленных передаваемых свойств. Устройство отправляет случайное число в качестве свойства устройства **Серийный номер**.

Вы можете просмотреть измерения телеметрии и значения передаваемых свойств, а также настроить параметры в Azure IoT Central:

1. Используйте **Device Explorer**, чтобы перейти на страницу **Measurements** (Измерения) реального устройства MXChip, которое вы добавили:

    ![Переход к реальному устройству](media/howto-connect-devkit/realdevice.png)

1. На странице **Measurements** (Измерения) можно просмотреть данные телеметрии, поступающие из устройства MXChip.

    ![Просмотр данных телеметрии из реального устройства](media/howto-connect-devkit/realtelemetry.png)

1. На странице **Свойства** можно просмотреть последний серийный номер, сообщенный устройством:

    ![Просмотр свойств устройства](media/howto-connect-devkit/deviceproperties.png)

1. На странице **Параметры** можно обновить параметры устройства MXChip:

    ![Просмотр параметров устройства](media/howto-connect-devkit/settings.png)

## <a name="download-the-source-code"></a>Скачивание исходного кода

Если вы хотите просмотреть и изменить код устройства, его можно скачать с сайта GitHub. Если вы планируете изменить код, необходимо следовать этим инструкциям по [подготовке среды разработки](https://microsoft.github.io/azure-iot-developer-kit/docs/get-started/#step-5-prepare-the-development-environment) для операционной системы настольных устройств.

Чтобы скачать исходный код, выполните следующую команду на настольном компьютере:

```cmd/sh
git clone https://github.com/Azure/iot-central-firmware
```

Исходный код будет скачан в папку с именем `iot-central-firmware`. 

> [!NOTE]
> Если **git** не установлен в среде разработки, его можно скачать здесь: [https://git-scm.com/download](https://git-scm.com/download).

## <a name="review-the-code"></a>Просмотр кода

В редакторе Visual Studio Code, который был установлен во время подготовки среды разработки, откройте папку `AZ3166` в папке `iot-central-firmware`: 

![Visual Studio Code.](media/howto-connect-devkit/vscodeview.png)

Чтобы узнать, каким образом данные телеметрии передаются в приложение Azure IoT Central, откройте файл **main_telemetry.cpp** в исходной папке.

Функция `buildTelemetryPayload` создает полезные данные телеметрии JSON, используя данные из датчиков устройства.

Функция `sendTelemetryPayload` вызывает `sendTelemetry` в **iotHubClient.cpp**, чтобы отправить полезные данные JSON в Центр Интернета вещей, используемый приложением Azure IoT Central.

Чтобы узнать, каким образом значения свойств передаются в приложение Azure IoT Central, откройте файл **main_telemetry.cpp** в исходной папке.

Функция `telemetryLoop` отправляет передаваемое свойство **doubleTap**, если акселерометр обнаруживает двойное касание. Акселерометр использует функцию `sendReportedProperty` в исходном файле **iotHubClient.cpp**.

Код в исходном файле **iotHubClient.cpp** использует функции из [пакетов SDK Microsoft Azure IoT и библиотек для C](https://github.com/Azure/azure-iot-sdk-c), чтобы взаимодействовать с Центром Интернета вещей.

Сведения о способах изменения, создания и отправки примера кода на устройство, см. в файле **readme.md** в папке `AZ3166`.

## <a name="next-steps"></a>Дополнительная информация

Вы узнали, как подключить устройство DevKit к Azure IoT Central, а значит вы готовы к следующему шагу.

* [Подготовка и подключение Raspberry Pi](howto-connect-raspberry-pi-python.md)