---
title: "Виртуальные машины Linux в Azure и служба хранилища Azure | Документация Майкрософт"
description: "Здесь описываются хранилища Azure класса Standard и Premium на основе управляемых и неуправляемых дисков для виртуальных машин Linux."
services: virtual-machines-linux
documentationcenter: virtual-machines-linux
author: vlivech
manager: timlt
editor: 
ms.assetid: d364c69e-0bd1-4f80-9838-bbc0a95af48c
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 2/7/2017
ms.author: rasquill
translationtype: Human Translation
ms.sourcegitcommit: bb1ca3189e6c39b46eaa5151bf0c74dbf4a35228
ms.openlocfilehash: 1ada403a502972ee0d8cd96af2d62d923d43f6cf
ms.lasthandoff: 03/18/2017


---
# <a name="azure-and-linux-vm-storage"></a>Azure и Linux: хранилища виртуальных машин
Хранилище Azure — это облачное решение для хранения современных приложений, обеспечивающее устойчивость, доступность и масштабируемость для удовлетворения потребностей клиентов.  Служба хранилища Azure не только позволяет разработчикам создавать масштабные приложения для поддержки новых сценариев, но и предоставляет основу хранилища для виртуальных машин Azure.

## <a name="managed-disks"></a>Управляемые диски

Теперь доступны виртуальные машины Azure на основе [управляемых дисков Azure](../storage/storage-managed-disks-overview.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json). Это позволяет создавать виртуальные машины, не создавая [учетные записи хранения Azure](../storage/storage-introduction.md) и не управляя ими. Укажите желаемый класс хранилища и необходимый размер диска, а Azure создаст диски виртуальной машины. Виртуальные машины с управляемыми дисками содержат много важных функций, включая следующие:

- Поддержка автоматического масштабирования. Azure создает диски и управляет базовым хранилищем, что дает возможность поддерживать до 10 000 дисков в пределах одной подписки.
- Повышенная надежность групп доступности. Azure гарантирует, что диски виртуальной машины будут автоматически изолированы друг от друга в группах доступности.
- Повышенный уровень контроля. Управляемые диски предоставляют различные операции, которые контролирует [управление доступом на основе ролей (RBAC)](../active-directory/role-based-access-control-what-is.md).

При этом цены на Управляемые диски отличаются от цен на неуправляемые диски. Дополнительные сведения см. в разделе [Цены и выставление счетов для Управляемых дисков](../storage/storage-managed-disks-overview.md#pricing-and-billing).

Существующие виртуальные машины, использующие неуправляемые диски, можно преобразовать для использования управляемых дисков с помощью команды [az vm convert](/cli/azure/vm#convert). Дополнительные сведения см. в статье [How to convert a Linux VM from unmanaged disks to Azure Managed Disks](virtual-machines-linux-convert-unmanaged-to-managed-disks.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (Как преобразовать виртуальную машину Linux с неуправляемыми дисками для использования Управляемых дисков Azure). Невозможно преобразовать неуправляемый диск в управляемый, если неуправляемый диск размещен в учетной записи хранения, которая зашифрована или когда-либо шифровалась с помощью [шифрования службы хранилища Azure (SSE)](../storage/storage-service-encryption.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json). Ниже приведены инструкции по преобразованию неуправляемых дисков, которые находятся или находились в зашифрованной учетной записи хранения.

- Выполните команду [az storage blob copy start](/cli/azure/storage/blob/copy#start), чтобы скопировать виртуальный жесткий диск в учетную запись хранения, для которой никогда не использовалось шифрование службы хранилища Azure.
- Создайте виртуальную машину, которая использует управляемые диски, и в процессе создания укажите этот VHD-файл с помощью команды [az vm create](/cli/azure/vm#create).
- Можно также с помощью команды [az vm disk attach](/cli/azure/vm/disk#attach) подключить этот VHD-файл к работающей виртуальной машине, использующей управляемые диски.


## <a name="azure-storage-standard-and-premium"></a>Хранилище Azure: уровни "Стандартный" и "Премиум"
Виртуальные машины Azure могут создаваться на основе управляемых и неуправляемых дисков хранилища класса Standard или Premium. При использовании портала для выбора виртуальной машины в меню **Основные** необходимо открыть раскрывающийся список, чтобы отображались диски обоих уровней — "Стандартный" и "Премиум". Если выбрать SSD, то будут отображаться только виртуальные машины, основанные на хранилище уровня "Премиум" с твердотельными накопителями (SSD).  Если выбрать HDD, то будут отображаться виртуальные машины на основе хранилища класса Standard с вращающимися жесткими дисками, а также виртуальные машины на базе хранилища класса Premium с поддержкой SSD.

При создании виртуальной машины с использованием `azure-cli` можно выбрать уровень "Стандартный" или "Премиум", когда с помощью флага `-z` или `--vm-size` указывается размер виртуальной машины.

## <a name="creating-a-vm-with-a-managed-disk"></a>Создание виртуальной машины на основе управляемого диска

В следующем примере вам понадобится Azure CLI 2.0, который можно установить, скачав [отсюда].

Сначала создайте группу ресурсов для управления ресурсами:

```azurecli
az group create --location westus --name myResourceGroup
```

Затем создайте виртуальную машину с помощью команды `az vm create`, как показано в следующем примере. Не забудьте указать уникальный аргумент `--public-ip-address-dns-name`, так как, скорее всего, была выполнена команда `manageddisks`.

```azurecli
az vm create \
--image credativ:Debian:8:latest \
--admin-username azureuser \
--ssh-key-value ~/.ssh/id_rsa.pub
--public-ip-address-dns-name manageddisks \
--resource-group myResourceGroup \
--location westus \
--name myVM
```

В предыдущем примере создавалась виртуальная машина с управляемым диском учетной записи хранения уровня "Стандартный". Чтобы использовать учетную запись хранения уровня "Премиум", добавьте аргумент `--storage-sku Premium_LRS`, как показано в следующем примере:

```azurecli
az vm create \
--storage-sku Premium_LRS
--image credativ:Debian:8:latest \
--admin-username azureuser \
--ssh-key-value ~/.ssh/id_rsa.pub
--public-ip-address-dns-name manageddisks \
--resource-group myResourceGroup \
--location westus \
--name myVM
```


### <a name="create-a-vm-with-an-unmanaged-standard-disk-using-the-azure-cli-10"></a>Создание виртуальной машины на основе стандартных неуправляемых дисков с помощью Azure CLI 1.0

Диски виртуальных машин уровня "Стандартный" и "Премиум" также можно создавать с помощью Azure CLI 1.0. Однако сейчас невозможно создавать виртуальные машины на основе управляемых дисков с помощью Azure CLI 1.0.

Параметр `-z` выбирает Standard_A1, где A1 — это виртуальная машина Linux на основе хранилища класса Standard.

```azurecli
azure vm quick-create -g rbg \
exampleVMname \
-l westus \
-y Linux \
-Q Debian \
-u exampleAdminUser \
-M ~/.ssh/id_rsa.pub
-z Standard_A1
```

### <a name="create-a-vm-with-premium-storage-using-the-azure-cli-10"></a>Создание виртуальной машины с хранилищем класса Premium с помощью Azure CLI 1.0
Параметр `-z` выбирает Standard_DS1, где DS1 — это виртуальная машина Linux на основе хранилища класса Premium.

```azurecli
azure vm quick-create -g rbg \
exampleVMname \
-l westus \
-y Linux \
-Q Debian \
-u exampleAdminUser \
-M ~/.ssh/id_rsa.pub
-z Standard_DS1
```

## <a name="standard-storage"></a>Хранилище уровня "Стандартный"
Хранилище Azure уровня "Стандартный" — это тип хранилища по умолчанию.  Хранилище уровня "Стандартный" экономически эффективно и сохраняет высокий уровень производительности.  

## <a name="premium-storage"></a>Хранилище уровня "Премиум"
Хранилище Azure Premium обеспечивает поддержку дисков с высокой производительностью и малой задержкой для виртуальных машин с интенсивной рабочей нагрузкой ввода-вывода. Диски виртуальной машины, использующие хранилище класса Premium, хранят данные на твердотельных накопителях. Диски виртуальной машины приложения можно перенести в хранилище Azure класса Premium, чтобы использовать их быстродействие и производительность.

Возможности хранилища уровня "Премиум":

* Диски хранилища уровня "Премиум". Хранилище Azure уровня "Премиум" поддерживает диски виртуальных машин, которые можно подключить к виртуальным машинам Azure серии DS, DSv2 или GS.
* Страничный BLOB-объект уровня "Премиум". Хранилище уровня "Премиум" поддерживает страничные BLOB-объекты Azure, используемые для хранения постоянных дисков для виртуальных машин Azure.
* Локально избыточное хранилище уровня "Премиум". Учетная запись хранения уровня "Премиум" в качестве параметра репликации поддерживает только локально избыточное хранилище (LRS) и хранит три копии данных в пределах одного региона.
* [Хранилище уровня "Премиум"](../storage/storage-premium-storage.md).

## <a name="premium-storage-supported-vms"></a>Виртуальные машины, поддерживаемые хранилищем уровня "Премиум"
Хранилище уровня "Премиум" поддерживает виртуальные машины серий DS, DSv2, GS и Fs. В этих виртуальных машинах можно использовать диски хранилищ уровня "Стандартный" и "Премиум". Но нельзя использовать диски хранилища уровня "Премиум" с серией виртуальных машин, не совместимой с хранилищем уровня "Премиум".

Ниже перечислены дистрибутивы Linux, проверенные на предмет работоспособности с хранилищем Premium.

| Дистрибутив | Версия | Поддерживаемое ядро |
| --- | --- | --- |
| Ubuntu |12.04 |3.2.0-75.110 или более поздней версии |
| Ubuntu |14.04 |3.13.0-44.73 или более поздней версии |
| Debian |7.x, 8.x |3.16.7-ckt4-1 или более поздней версии |
| SLES |SLES 12 |3.12.36-38.1 или более поздней версии |
| SLES |SLES 11 SP4 или более поздней версии |3.0.101-0.63.1 или более поздней версии |
| CoreOS |584.0.0 или более поздней версии |3.18.4 или более поздней версии |
| CentOS |6.5, 6.6, 6.7, 7.0, 7.1 |3.10.0-229.1.2.el7 или более поздней версии |
| RHEL |6.8 или более поздней версии, 7.2 или более поздней версии | |

## <a name="file-storage"></a>Хранилище файлов
Хранилище файлов Azure предоставляет общие папки в облаке с доступом по стандартному протоколу SMB. Благодаря хранилищу файлов Azure можно переносить корпоративные приложения с файловых серверов в Azure. Приложения, работающие в Azure, могут легко подключать общие папки из виртуальных машин Azure под управлением Linux. Кроме того, новая версия хранилища файлов позволяет подключить общую папку из локального приложения, которое поддерживает протокол SMB 3.0.  Так как эти общие папки используют протокол SMB, вы можете обращаться к ним с помощью стандартных интерфейсов API файловой системы.

Хранилище файлов Azure основано на той же технологии, что и хранилища BLOB-объектов, таблиц и очередей, поэтому оно предлагает все средства обеспечения доступности, надежности, масштабируемости и геоизбыточности, встроенные в платформу службы хранения Azure. Дополнительные сведения о целевых показателях производительности и ограничениях хранилища файлов см. в статье "Целевые показатели масштабируемости и производительности службы хранилища Azure".

* [Использование хранилища файлов Azure в Linux](../storage/storage-how-to-use-files-linux.md)

## <a name="hot-storage"></a>"Горячее" хранилище
"Горячий" уровень хранилища Azure оптимизирован для хранения часто используемых данных.  "Горячее" хранилище — это тип хранилища по умолчанию для хранения больших двоичных объектов.

## <a name="cool-storage"></a>"Холодное" хранилище
"Холодный" уровень хранилища Azure оптимизирован для хранения данных, которые используют редко и долго хранят. К вариантам использования "холодного" хранилища относятся резервные копии, мультимедийное содержимое, данные научных исследований, сведения о соответствии требованиям и архивные данные. Как правило, любые данные, которые редко используются, являются идеальными кандидатами для "холодного" хранилища.

|  | "Горячий" уровень хранилища | "Холодный" уровень хранилища |
|:--- |:---:|:---:|
| Доступность |99,9 % |99 % |
| Доступность (операции чтения RA-GRS) |99,99 % |99,9 % |
| Плата за использование |Больше затрат на хранение |Меньше затрат на хранение |
| Меньше затрат на доступ |Больше затрат на доступ | |
| и транзакции |и транзакции | |

## <a name="redundancy"></a>Избыточность
Данные в учетной записи хранения Microsoft Azure всегда реплицируются, обеспечивая устойчивость, высокий уровень доступности и соответствие соглашению об уровне обслуживания для службы хранилища Azure даже при временных сбоях оборудования.

При создании учетной записи хранения необходимо выбрать один из следующих вариантов репликации:

* Локально избыточное хранилище (LRS)
* Хранилище, избыточное в пределах зоны (ZRS)
* Геоизбыточное хранилище (GRS)
* Геоизбыточное хранилище с доступом для чтения (RA-GRS)

### <a name="locally-redundant-storage"></a>Локально избыточное хранилище
Локально избыточное хранилище (LRS) реплицирует ваши данные в регионе, в котором создана учетная запись хранения. Для максимальной устойчивости каждый запрос данных в учетной записи хранения реплицируется три раза. Эти три реплики хранятся в отдельных доменах сбоя и доменах обновления.  Запрос возвращается только после того, как его записывают во все три реплики.

### <a name="zone-redundant-storage"></a>Хранилище, избыточное в пределах зоны
Хранилище, избыточное в пределах зоны (ZRS), реплицирует данные в двух-трех помещениях в одном или двух регионах, предоставляя более высокую доступность по сравнению с LRS. Если в вашей учетной записи хранения включена репликация ZRS, данные будут устойчивы даже в случае сбоя в одном из помещений.

### <a name="geo-redundant-storage"></a>Геоизбыточное хранилище
Геоизбыточное хранилище (GRS) реплицирует данные во вторичный регион, который находится в сотнях километров от первичного региона. Если в учетной записи хранения включена репликация GRS, данные будут устойчивы даже в случае отключения электричества во всем регионе или аварии, при которой первичный регион не может быть восстановлен.

### <a name="read-access-geo-redundant-storage"></a>Геоизбыточное хранилище с доступом для чтения
Геоизбыточное хранилище с доступом для чтения (RA-GRS) максимально увеличивает доступность для учетной записи хранения, обеспечивая доступ только для чтения к данным во вторичном местоположении в дополнение к репликации в двух регионах, предоставленной в GRS. В случае недоступности данных в первичном регионе ваше приложение может считывать данные из вторичного региона.

Подробный обзор избыточности хранилища Azure см. в следующей статье:

* [Репликация службы хранилища Azure](../storage/storage-redundancy.md)

## <a name="scalability"></a>Масштабируемость
Хранилище Azure обладает высокой степенью масштабируемости, позволяя хранить и обрабатывать сотни терабайт данных для поддержки сценариев с данными большого размера, которые необходимы для исследовательских, аналитических финансовых и мультимедийных приложений. Можно также хранить небольшие объемы данных, необходимые для веб-сайта компании малого бизнеса. Когда ваши потребности снижаются, вы оплачиваете только те данные, которые храните. В настоящее время в хранилище Azure хранятся десятки триллионов уникальных клиентских объектов и обрабатываются в среднем миллионы запросов в секунду.

Для учетных записей хранения уровня "Стандартный": учетная запись хранения уровня "Стандартный" имеет ограничение по частоте запросов в 20 000 операций ввода-вывода. Общее число операций ввода-вывода для всех дисков виртуальной машины в стандартной учетной записи хранения не должно превышать это ограничение.

Для учетных записей хранения уровня "Премиум": учетная запись хранения уровня "Премиум" имеет максимальную общую пропускную способность в 50 Гбит/с. Общая пропускная способность для всех дисков виртуальной машины не должна превышать это ограничение.

## <a name="availability"></a>Доступность
Мы гарантируем, что по крайней мере 99,99 % времени (99,9 % для "холодного" уровня доступа) мы будем успешно обрабатывать запросы на чтение данных из учетных записей геоизбыточного хранилища с доступом на чтение (RA-GRS), но при условии, что, если данные будут недоступны в основном регионе,то будет предпринята попытка их чтения из дополнительного региона.

Мы гарантируем, что по крайней мере 99,9 % времени (99% для "холодного" уровня доступа) мы будем успешно обрабатывать запросы на чтение данных из учетных записей локально избыточного хранилища (LRS), хранилища, избыточного в пределах зоны (ZRS), и геоизбыточного хранилища (GRS).

Мы гарантируем, что по крайней мере 99,9 % времени (99 % для "холодного" уровня доступа) мы будем успешно обрабатывать запросы на запись данных из учетных записей локально избыточного хранилища (LRS), хранилища, избыточного в пределах зоны (ZRS), геоизбыточного хранилища (GRS) и геоизбыточного хранилища с доступом только на чтение (RA-GRS).

* [Соглашение об уровне обслуживания Azure для службы хранилища](https://azure.microsoft.com/support/legal/sla/storage/v1_1/)

## <a name="regions"></a>регионы
Службы Azure доступны в 30 регионах по всему миру. В ближайшее время запланировано обеспечение доступности в 4 дополнительных регионах. Расширение географии деятельности является приоритетной задачей для Azure, поскольку это позволяет нашим клиентам добиться более высокой производительности. Это также соответствует их требованиям и предпочтениям относительно расположения данных.  Последний регион, в котором запущена поддержка Azure, — это Германия.

Microsoft Cloud Germany обеспечивает дифференцированный подход к поддержке облачных служб (Майкрософт), которые уже доступны по всей Европе. Созданы дополнительные возможности для инноваций и экономического роста, доступные для наших партнеров и клиентов, работающих в жестко регламентированных сферах, в Германии, Европейском Союзе (ЕС) и Европейской ассоциации свободной торговли (ЕАСТ).

В новых центрах обработки данных, в Магдебурге и Франкфурте, обработка данных пользователей осуществляется под контролем управителя данными. В роли такого управителя выступает T-Systems International, независимая немецкая компания, являющаяся подразделением компании Deutsche Telekom. Поддержка коммерческих облачных служб корпорации Майкрософт в этих центрах обработки данных регулируется немецкими нормами обработки данных. Наши клиенты получили дополнительные возможности выбора, позволяющие указать способ и место обработки данных.

* [Карта регионов Azure](https://azure.microsoft.com/regions/)

## <a name="security"></a>Безопасность
Служба хранилища Azure предоставляет полный набор возможностей обеспечения безопасности, которые в совокупности позволяют разработчикам создавать защищенные приложения. Учетную запись хранения можно защитить с помощью управления доступом на основе ролей и Azure Active Directory. Защитить данные, передаваемые между приложением и Azure, можно с помощью шифрования на стороне клиента, HTTPS или SMB 3.0. Вы можете настроить автоматическое шифрование данных при записи в службу хранилища Azure с помощью шифрования службы хранилища (SSE). Для дисков ОС и данных, используемых виртуальными машинами, можно настроить шифрование дисков Azure. Делегированный доступ к объектам данных в службе хранилища Azure можно предоставлять с помощью подписанных URL-адресов.

### <a name="management-plane-security"></a>Безопасность плоскости управления
Плоскость управления состоит из ресурсов, используемых для управления учетной записью хранения. В этом разделе мы рассмотрим модель развертывания с помощью Azure Resource Manager и использование управления доступом на основе ролей (RBAC) для контроля доступа к учетным записям хранения. Мы также поговорим об управлении ключами учетной записи хранения и их повторном создании.

### <a name="data-plane-security"></a>Безопасность плоскости данных
В этом разделе рассказывается о предоставлении доступа к объектам данных в учетной записи хранения, таким как BLOB-объекты, файлы, очереди и таблицы, с помощью подписанных URL-адресов и хранимых политик доступа. Будут рассмотрены подписанные URL-адреса как уровня службы, так и уровня учетной записи. Вы также узнаете, как ограничить доступ к определенному IP-адресу (или диапазону IP-адресов), как запретить использование любых протоколов, кроме HTTPS, и как отозвать подписанный URL-адрес, не дожидаясь истечения срока его действия.

## <a name="encryption-in-transit"></a>Шифрование при передаче
В этом разделе рассматривается, как можно защитить данные при передаче в службу хранилища Azure или из нее. Мы поговорим о рекомендуемых способах применения протокола HTTPS и методах шифрования, используемых протоколом SMB 3.0 для общих папок Azure. Мы также рассмотрим функцию шифрования на стороне клиента, которая позволяет шифровать данные в клиентском приложении перед их передачей в хранилище и расшифровывать данные после их получения из хранилища.

## <a name="encryption-at-rest"></a>Шифрование при хранении
Мы рассмотрим функцию шифрования службы хранилища и ее включение для учетной записи хранения для автоматического шифрования блочных, страничных и добавочных BLOB-объектов при их записи в службу хранилища Azure. Мы также расскажем, как применять шифрование дисков Azure, объясним основные различия между шифрованием дисков, шифрованием службы хранилища и шифрованием на стороне клиента, а также приведем сценарии использования каждого из этих вариантов. Вкратце будут рассмотрены вопросы обеспечения соответствия FIPS на компьютерах, используемых в государственных учреждениях США.

* [Руководство по безопасности службы хранилища Azure](../storage/storage-security-guide.md)

## <a name="temporary-disk"></a>Временный диск
У каждой виртуальной машины есть временный диск. Он выступает в качестве временного хранилища для приложений и процессов и предназначен только для хранения данных, таких как страничные файлы или файлы подкачки. Данные на временном диске могут быть потеряны во время [обслуживания](virtual-machines-linux-manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json#understand-planned-vs-unplanned-maintenance) или при [повторном развертывании виртуальной машины](virtual-machines-linux-redeploy-to-new-node.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json). Во время обычной перезагрузки виртуальной машины данные на временном диске должны сохраниться.

На виртуальных машинах Linux в качестве временного диска обычно используется **/dev/sdb**. Агент Linux для Azure форматирует этот диск и монтирует его в каталог **/mnt**. Размер временного диска зависит от размера виртуальной машины. Чтобы узнать больше, ознакомьтесь с [размерами виртуальных машин Linux](../virtual-machines/virtual-machines-linux-sizes.md).

Дополнительные сведения об использовании временного диска в Azure см. в статье [Общие сведения о временном диске на виртуальных машинах Microsoft Azure](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).

## <a name="cost-savings"></a>Экономия денежных средств
* [Стоимость хранения](https://azure.microsoft.com/pricing/details/storage/)
* [Калькулятор стоимости хранения](https://azure.microsoft.com/pricing/calculator/?service=storage)

## <a name="storage-limits"></a>Ограничения хранилища
* [Ограничения службы хранилища](../azure-subscription-service-limits.md#storage-limits)

