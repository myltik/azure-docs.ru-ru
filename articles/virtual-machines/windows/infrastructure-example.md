---
title: Пошаговое руководство по примеру инфраструктуры Azure | Документация Майкрософт
description: Изучите основные рекомендации по проектированию и реализации, касающиеся развертывания примера инфраструктуры в Azure.
documentationcenter: ''
services: virtual-machines-windows
author: iainfoulds
manager: jeconnoc
editor: ''
tags: azure-resource-manager
ms.assetid: 7032b586-e4e5-4954-952f-fdfc03fc1980
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 12/15/2017
ms.author: iainfou
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: c532657951d6d0241a5d8d25a56bb237ad481567
ms.sourcegitcommit: 168426c3545eae6287febecc8804b1035171c048
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/08/2018
ms.locfileid: "29809875"
---
# <a name="example-azure-infrastructure-walkthrough-for-windows-vms"></a>Пошаговое руководство по примеру инфраструктуры Azure для виртуальных машин Windows
В этой статье рассматривается создание примера инфраструктуры приложений. Мы подробно рассмотрим проектирование инфраструктуры для простого интернет-магазина, учтя все рекомендации и решения по соглашениям об именовании, группам доступности, виртуальным сетям и подсистемам балансировки нагрузки, и фактически развернем виртуальные машины.

## <a name="example-workload"></a>Пример рабочей нагрузки
Adventure Works Cycles хочет создать приложение интернет-магазина в Azure, которое состоит из:

* двух серверов IIS, на которых выполняется клиентский внешний интерфейс на уровне Интернета;
* двух серверов IIS, обрабатывающих данные и заказы на уровне приложения;
* двух экземпляров Microsoft SQL Server с группами доступности AlwaysOn (двух серверов SQL Server и следящего сервера основных узлов) для хранения данных продуктов и заказов на уровне базы данных;
* двух контроллеров домена Active Directory для учетных записей клиентов и поставщиков на уровне аутентификации.
* Все серверы расположены в двух подсетях:
  * интерфейсной сети для веб-серверов; 
  * внутренней подсети для серверов приложений, кластера SQL и контроллеров домена.

![Схема разных уровней для инфраструктуры приложений](./media/infrastructure-example/example-tiers.png)

Защищенный входящий веб-трафик должен быть сбалансирован между веб-серверами, пока клиенты просматривают интернет-магазин. Трафик обработки заказов в виде HTTP-запросов от веб-серверов должен быть сбалансирован между серверами приложений. Кроме того, инфраструктура должна обеспечивать высокий уровень доступности.

В результате проект должен включать:

* подписку и учетную запись Azure;
* одну группу ресурсов.
* Управляемые диски Azure
* виртуальную сеть с двумя подсетями;
* группы доступности для виртуальных машин с аналогичной ролью;
* Виртуальные машины

Все вышеуказанное соответствует соглашению об именовании.

* В Adventure Works Cycles используется префикс **[рабочая нагрузка ИТ-среды]-[расположение]-[ресурс Azure]** .
  * Например, **azos** (интернет-магазин Azure) — это имя рабочей нагрузки ИТ, а **use** (восточная часть США 2) — это расположение.
* Для виртуальных сетей используется формат AZOS-USE-VN **[номер]**.
* Для групп доступности используется формат azos-use-as-**[роль]**.
* Для имен виртуальных машин используется формат use azos-use-vm-**[имя_виртуальной_машины]**.

## <a name="azure-subscriptions-and-accounts"></a>Подписки и учетные записи Azure
Компания Adventure Works Cycles использует подписку Enterprise Subscription под названием "Adventure Works Enterprise Subscription" для выставления счетов за эту рабочую нагрузку ИТ-среды.

## <a name="storage"></a>Хранилище
В компании Adventure Works Cycles решили использовать Управляемые диски Azure. При создании виртуальных машин используются оба доступных уровня хранилища:

* **хранилище уровня "Стандартный"** для веб-серверов, серверов приложений, контроллеров домена и их дисков данных;
* **хранилище уровня "Премиум"** для виртуальных машин SQL Server и их дисков данных.

## <a name="virtual-network-and-subnets"></a>Виртуальные сети и подсети
Так как виртуальная сеть не требует постоянного подключения к локальной сети Adventure Work Cycles, компания выбрала облачную виртуальную сеть.

Облачная виртуальная сеть создана на портале Azure с указанием следующих параметров:

* Имя: AZOS-USE-VN01
* Расположение: восточная часть США 2.
* Адресное пространство виртуальной сети: 10.0.0.0/8.
* Первая подсеть:
  * Имя: FrontEnd.
  * Адресное пространство: 10.0.1.0/24.
* Вторая подсеть:
  * Имя: BackEnd.
  * Адресное пространство: 10.0.2.0/24.

## <a name="availability-sets"></a>Группы доступности
Чтобы обеспечить высокий уровень доступности всех четырех уровней интернет-магазина, компания Adventure Works Cycles использует четыре группы доступности:

* **azos-use-as-web** для веб-серверов;
* **azos-use-as-app** для серверов приложений;
* **azos-use-as-sql** для серверов SQL Server;
* **azos-use-as-dc** для контроллеров домена.

## <a name="virtual-machines"></a>Виртуальные машины
Компания Adventure Works Cycles использует следующие имена для своих виртуальных машин Azure:

* **azos-use-vm-web01** для первого веб-сервера;
* **azos-use-vm-web02** для второго веб-сервера;
* **azos-use-vm-app01** для первого сервера приложений;
* **azos-use-vm-app02** для второго сервера приложений;
* **azos-use-vm-sql01** для первого сервера SQL Server в кластере;
* **azos-use-vm-sql02** для второго сервера SQL Server в кластере;
* **azos-use-vm-dc01** для первого контроллера домена;
* **azos-use-vm-dc02** для второго контроллера домена.

Это конфигурация, которая получается в результате.

![Окончательная инфраструктура приложений, развернутая в Azure](./media/infrastructure-example/example-config.png)

Эта конфигурация включает:

* облачную виртуальную сеть с двумя подсетями (FrontEnd и BackEnd);
* Управляемые диски Azure с дисками уровней "Стандартный" и "Премиум";
* четыре группы доступности, по одной для каждого уровня интернет-магазина;
* виртуальные машины для четырех уровней;
* внешний набор с балансировкой нагрузки для веб-трафика HTTPS из Интернета на веб-серверы;
* внешний набор с балансировкой нагрузки для незашифрованного веб-трафика с веб-серверов на серверы приложений.
* одну группу ресурсов.
