---
title: Бизнес-аналитика SQL Server | Документация Майкрософт
description: В этой статье используются ресурсы, созданные с помощью классической модели развертывания, и описываются функции бизнес-аналитики, доступные для сервера SQL Server, запущенного на виртуальных машинах Azure.
services: virtual-machines-windows
documentationcenter: na
author: markingmyname
manager: erikre
editor: monicar
tags: azure-service-management
ms.assetid: c681e7a7-eeda-48aa-bc35-6277f4828244
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/30/2017
ms.author: maghan
ms.openlocfilehash: 6f1a95e52def9154253192ab9d43d1e7d621cee7
ms.sourcegitcommit: 9cdd83256b82e664bd36991d78f87ea1e56827cd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="sql-server-business-intelligence-in-azure-virtual-machines"></a>Бизнес-аналитика SQL Server на виртуальных машинах Azure
> [!IMPORTANT] 
> В Azure предлагаются две модели развертывания для создания ресурсов и работы с ними: [модель Resource Manager и классическая модель](../../../azure-resource-manager/resource-manager-deployment-model.md). В этой статье рассматривается использование классической модели развертывания. Для большинства новых развертываний Майкрософт рекомендует использовать модель диспетчера ресурсов.

Коллекция виртуальных машин Microsoft Azure включает в себя образы, содержащие установки SQL Server. Выпуски SQL Server, поддерживаемые в образах коллекции, представляют сбой те же файлы установки, которые можно установить на локальных компьютерах и виртуальных машинах. В этом разделе приведены сводные данные об установленных в образах компонентах бизнес-аналитики SQL Server, а также о настройке, необходимой после подготовки виртуальной машины. Кроме того, в этом разделе описаны поддерживаемые топологии развертывания для компонентов бизнес-аналитики и рекомендации.

## <a name="license-considerations"></a>Рекомендации по лицензированию
Существует два способа лицензирования SQL Server на виртуальных машинах Microsoft Azure.

1. Преимущества перемещения лицензий, предоставляемые в рамках программы Software Assurance. Дополнительные сведения см. в статье [Перемещение лицензий в рамках программы Software Assurance в Azure](https://azure.microsoft.com/pricing/license-mobility/).
2. Оплата виртуальных машин Azure с установленным SQL Server по часовой ставке. См. раздел "SQL Server" на странице [цен на виртуальные машины](https://azure.microsoft.com/pricing/details/virtual-machines/#Sql).

Дополнительные сведения о лицензировании и текущих тарифах см. на странице [Виртуальные машины. Вопросы и ответы по лицензированию](https://azure.microsoft.com/pricing/licensing-faq/%20/).

## <a name="sql-server-images-available-in-azure-virtual-machine-gallery"></a>Образы SQL Server, доступные в коллекции виртуальных машин Azure
Коллекция виртуальных машин Microsoft Azure включает в себя несколько образов, содержащих Microsoft SQL Server. Программное обеспечение, установленное в образах виртуальной машины, зависит от версии операционной системы и версии SQL Server. Список образов в коллекции виртуальных машин Azure часто изменяется.

<!--![SQL image in azure VM gallery](./media/virtual-machines-windows-classic-ps-sql-bi/IC741367.png)-->
![Образ SQL в коллекции виртуальных машин Azure](./media/virtual-machines-windows-classic-ps-sql-bi/vm-sql-images.png)

![PowerShell](./media/virtual-machines-windows-classic-ps-sql-bi/IC660119.gif) Следующий сценарий PowerShell возвращает список образов Azure, содержащих значение «SQL-Server» в элементе ImageName:

    # assumes you have already uploaded a management certificate to your Microsoft Azure Subscription. View the thumbprint value from the "Subscriptions" menu in Azure portal.

    $subscriptionID = ""    # REQUIRED: Provide your subscription ID.
    $subscriptionName = "" # REQUIRED: Provide your subscription name.
    $thumbPrint = "" # REQUIRED: Provide your certificate thumbprint.
    $certificate = Get-Item cert:\currentuser\my\$thumbPrint # REQUIRED: If your certificate is in a different store, provide it here.-Ser  store is the one specified with the -ss parameter on MakeCert

    Set-AzureSubscription -SubscriptionName $subscriptionName -Certificate $certificate -SubscriptionID $subscriptionID

    Write-Host -foregroundcolor green "List of available gallery images where imagename contains 2016"
    Write-Host -foregroundcolor green ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
    get-azurevmimage | where {$_.ImageName -Like "*SQL-Server-2016*"} | select imagename,category, location, label, description

    Write-Host -foregroundcolor green "List of available gallery images where imagename contains 2014"
    Write-Host -foregroundcolor green ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
    get-azurevmimage | where {$_.ImageName -Like "*SQL-Server-2014*"} | select imagename,category, location, label, description

Дополнительные сведения о выпусках и функциях, поддерживаемых в SQL Server, см. в следующих разделах.

* [Выпуски SQL Server](https://www.microsoft.com/server-cloud/products/sql-server-editions/#fbid=Zae0-E6r5oh)
* [Features Supported by the Editions of SQL Server 2016](https://msdn.microsoft.com/library/cc645993.aspx)

### <a name="bi-features-installed-on-the-sql-server-virtual-machine-gallery-images"></a>Компоненты бизнес-аналитики, установленные в образах коллекции виртуальных машин SQL Server
В следующей таблице перечислены компоненты бизнес-аналитики, установленные в общих образах коллекции виртуальных машин Microsoft Azure для SQL Server.

* SQL Server 2016 SP1 Enterprise
* SQL Server 2016 SP1 Standard
* SQL Server 2014 SP2 Enterprise
* SQL Server 2014 SP2 Standard
* SQL Server 2012 SP3 Enterprise
* SQL Server 2012 SP3 Standard

| Компонент бизнес-аналитики SQL Server | Установлен в образе коллекции | Заметки |
| --- | --- | --- |
| **Собственный режим служб Reporting Services** |Yes |Установлен, но требует настройки, включая URL-адрес диспетчера отчетов. См. раздел [Настройка служб Reporting Services](#configure-reporting-services). |
| **Режим SharePoint служб Reporting Services** |Нет  |Образ коллекции виртуальных машин Microsoft Azure не включает в себя SharePoint или файлы установки SharePoint. <sup>1</sup> |
| **Многомерный и интеллектуальный анализ данных в службах Analysis Services (OLAP)** |Yes |Установлен и настроен в качестве экземпляра служб Analysis Services по умолчанию. |
| **Табличный режим служб Analysis Services** |Нет  |Поддерживается в образах SQL Server 2012, 2014 и 2016, но не устанавливается по умолчанию. Установите другой экземпляр служб Analysis Services. Ознакомьтесь с подразделом "Установка других служб и компонентов SQL Server" этого раздела. |
| **Power Pivot служб Analysis Services для SharePoint** |Нет  |Образ коллекции виртуальных машин Microsoft Azure не включает в себя SharePoint или файлы установки SharePoint. <sup>1</sup> |

<sup>1</sup> Дополнительные сведения о SharePoint и виртуальных машинах Azure см. в статьях [Архитектуры Microsoft Azure для SharePoint 2013](https://technet.microsoft.com/library/dn635309.aspx) и [Развертывание SharePoint на виртуальных машинах Microsoft Azure](https://www.microsoft.com/download/details.aspx?id=34598).

![PowerShell](./media/virtual-machines-windows-classic-ps-sql-bi/IC660119.gif) Выполните следующую команду PowerShell, чтобы получить список установленных служб, в имени которых содержится значение «SQL».

    get-service | Where-Object{ $_.DisplayName -like '*SQL*' } | Select DisplayName, status, servicetype, dependentservices | format-Table -AutoSize

## <a name="general-recommendations-and-best-practices"></a>Общие рекомендации
* При использовании SQL Server Enterprise Edition минимальный размер, рекомендуемый для виртуальной машины, — **A3** . Размер виртуальной машины **A4** рекомендуется использовать для развертывания бизнес-аналитики SQL Server в службах Analysis Services и Reporting Services.
  
    Сведения о текущих размерах виртуальных машин см. в разделе [Размеры виртуальных машин в Azure](../sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).
* В рамках управления дисками рекомендуется хранить данные, журналы и файлы резервных копий на дисках, отличных от **C:** и **D:**. Например, создайте диски данных **E:** и **F:**.
  
  * Политика кэширования диска для диска по умолчанию **C:** не является оптимальным выбором для работы с данными.
  * **D:**— это временный диск, который используется в основном для файла подкачки. Диск **D:** не является сохраняемым и не сохраняется в хранилище BLOB-объектов. Задачи управления, такие как изменение размера виртуальной машины, приводят к сбросу диска **D:**. **НЕ** рекомендуется использовать диск **D:** для файлов базы данных, включая tempdb.
    
    Дополнительные сведения о создании и подключении дисков см. в разделе [Подключение диска данных к виртуальной машине](../classic/attach-disk-classic.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).
* Остановите или удалите службы, которые не планируете использовать. Например, если виртуальная машина используется только для служб Reporting Services, остановите или удалите службы Analysis Services и службы SQL Server Integration Services. На рисунке приведен пример служб, которые запускаются по умолчанию.
  
    ![Службы SQL Server](./media/virtual-machines-windows-classic-ps-sql-bi/IC650107.gif)
  
  > [!NOTE]
  > В поддерживаемых сценариях бизнес-аналитики требуется ядро СУБД SQL Server. В односерверной топологии ВМ ядро СУБД обязательно должно выполняться на той же ВМ.
  
    Дополнительные сведения см. в следующих разделах: [Удаление служб Reporting Services](https://msdn.microsoft.com/library/hh479745.aspx) и [Как удалить экземпляр служб Analysis Services](https://msdn.microsoft.com/library/ms143687.aspx).
* Просмотрите раздел «Важные обновления» **Центра обновления Windows** . Образы виртуальных машин Microsoft Azure часто обновляются, однако важные обновления могут поступать из **Центра обновления Windows** уже после последнего обновления образа виртуальной машины.

## <a name="example-deployment-topologies"></a>Пример топологий развертывания
Ниже приведены примеры развертываний, использующих виртуальные машины Microsoft Azure. На этих схемах приведено лишь несколько из множества возможных топологий, которые можно использовать совместно с функциями бизнес-аналитики SQL Server и виртуальными машинами Microsoft Azure.

### <a name="single-virtual-machine"></a>Одна виртуальная машина
Службы Analysis Services, Reporting Services, ядро СУБД SQL Server и источники данных на одной виртуальной машине.

![сценарий бизнес-аналитики iass с 1 виртуальной машиной](./media/virtual-machines-windows-classic-ps-sql-bi/IC650108.gif)

### <a name="two-virtual-machines"></a>Две виртуальные машины
* Службы Analysis Services, Reporting Services и ядро СУБД SQL Server на одной виртуальной машине. Данное развертывание включает в себя базы данных сервера отчетов.
* Источники данных на второй виртуальной машине. На второй виртуальной машине ядро СУБД SQL Server используется в качестве источника данных.

![сценарий бизнес-аналитики iass с двумя виртуальными машинами](./media/virtual-machines-windows-classic-ps-sql-bi/IC650109.gif)

### <a name="mixed-azure--data-on-azure-sql-database"></a>Смешанная среда Azure — данные в базе данных SQL Azure
* Службы Analysis Services, Reporting Services и ядро СУБД SQL Server на одной виртуальной машине. Данное развертывание включает в себя базы данных сервера отчетов.
* Источником данных является база данных SQL Azure.

![сценарии бизнес-аналитики iaas с виртуальной машиной и AzureSQL в качестве источника данных](./media/virtual-machines-windows-classic-ps-sql-bi/IC650110.gif)

### <a name="hybrid-data-on-premises"></a>Гибридная среда — локальные данные
* В этом примере развертывания службы Analysis Services, Reporting Services и ядро СУБД SQL Server выполняются на одной виртуальной машине. На этой виртуальной машине размещаются базы данных сервера отчетов. Виртуальная машина присоединена к локальному домену через виртуальную сеть Azure или некоторое другое решение туннелирования VPN.
* Источник данных находится в локальной среде.

![сценарии бизнес-аналитики IaaS с виртуальной машиной и локальными источниками данных](./media/virtual-machines-windows-classic-ps-sql-bi/IC654384.gif)

## <a name="reporting-services-native-mode-configuration"></a>Конфигурация собственного режима служб Reporting Services
Коллекция образов виртуальных машин для SQL Server включает в себя установленный собственный режим Reporting Services, однако сервер отчетов при этом не настроен. Действия, описанные в этом разделе, позволяют настроить сервер отчетов служб Reporting Services. Дополнительные сведения о настройке собственного режима служб Reporting Services см. в разделе [Установка сервера отчетов служб Reporting Services в основном режиме](https://msdn.microsoft.com/library/ms143711.aspx).

> [!NOTE]
> Аналогичные материалы, где для настройки сервера отчетов используются сценарии Windows PowerShell, см. в статье [Использование PowerShell для создания виртуальной машины Azure с помощью сервера отчетов, работающего в собственном режиме](../classic/ps-sql-report.md).

### <a name="connect-to-the-virtual-machine-and-start-the-reporting-services-configuration-manager"></a>Подключение к виртуальной машине и запуск диспетчера конфигурации служб Reporting Services
Существуют две общие процедуры для подключения к виртуальной машине Azure:

* Для подключения выберите имя виртуальной машины и нажмите кнопку **Подключить**. Открывает подключение к удаленному рабочему столу, и автоматически заполняется имя компьютера.
  
    ![подключение к виртуальной машине Azure](./media/virtual-machines-windows-classic-ps-sql-bi/IC650112.gif)
* Подключитесь к виртуальной машине с помощью подключения к удаленному рабочему столу Windows. В пользовательском интерфейсе удаленного рабочего стола выполните следующие действия.
  
  1. Введите **имя облачной службы** в качестве имени компьютера.
  2. Введите двоеточие (:) и номер общего порта, настроенного для конечной точки удаленного рабочего стола TCP.
     
      Моя_служба.облачное_приложение.net:63133
     
      Дополнительные сведения см. в статье с информацией об [облачной службе](https://azure.microsoft.com/manage/services/cloud-services/what-is-a-cloud-service/).


**Запуск диспетчера конфигурации служб Reporting Services**

В **Windows Server 2012 или Windows Server 2016** выполните следующие действия.

1. На **начальном** экране введите **Reporting Services**, чтобы просмотреть список приложений.
2. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.

В **Windows Server 2008 R2**выполните следующие действия.

1. Нажмите кнопку **Пуск** и выберите **Все программы**.
2. Выберите пункт **Microsoft SQL Server 2016**.
3. Выберите **Средства настройки**.
4. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.

Или сделайте так:

1. Нажмите **Запуск**.
2. В диалоговом окне **Найти программы и файлы** введите **reporting services**. Если виртуальная машина запущена в Windows Server 2012, введите **reporting services** на начальном экране Windows Server 2012.
3. Щелкните правой кнопкой мыши элемент **Диспетчер конфигурации служб Reporting Services** и выберите пункт **Запуск от имени администратора**.
   
    ![поиск диспетчера конфигурации служб ssrs](./media/virtual-machines-windows-classic-ps-sql-bi/IC650113.gif)

### <a name="configure-reporting-services"></a>Настройка служб Reporting Services
**Учетная запись службы и URL-адрес веб-службы:**

1. Убедитесь, что в поле **Имя сервера** указано имя локального сервера, и нажмите кнопку **Подключение**.
2. Обратите внимание, что поле **Имя базы данных сервера отчетов**пусто. База данных создается после завершения настройки.
3. Убедитесь, что для параметра **Состояние сервера отчетов** указано значение **Запущен**. Если вы хотите проверить службу в Windows Server Manager, она является службой Windows **SQL Server Reporting Services** .
4. Щелкните **Учетная запись службы** и при необходимости измените учетную запись. Если виртуальная машина используется в среде без присоединения к домену, встроенной учетной записи **ReportServer** достаточно. Дополнительные сведения об учетной записи службы см. в статье [Учетная запись службы](https://msdn.microsoft.com/library/ms189964.aspx).
5. Щелкните **URL-адрес веб-службы** на левой панели.
6. Нажмите кнопку **Применить** , чтобы настроить значения по умолчанию.
7. Запишите значение **URL-адреса веб-службы сервера отчетов**. Обратите внимание, что TCP-порт по умолчанию имеет значение 80 и является частью URL-адреса. Позднее вы создадите для этого порта конечную точку виртуальной машины Microsoft Azure.
8. В области **Результаты** убедитесь, что действия успешно выполнены.

**База данных:**

1. Щелкните элемент **База данных** на левой панели.
2. Щелкните элемент **Изменение базы данных**.
3. Убедитесь, что выбран параметр **Создать новую базу данных сервера отчетов** , и нажмите кнопку «Далее».
4. Проверьте значение параметра **Имя сервера** и щелкните **Проверка соединения**.
5. Если получен результат **Проверка соединения завершена успешно**, нажмите кнопку **ОК** и кнопку **Далее**.
6. Убедитесь, что в качестве имени базы данных используется **ReportServer**, а для параметра **Режим сервера отчетов** указано значение **Собственный**, а затем нажмите кнопку **Далее**.
7. Нажмите кнопку **Далее** on the **Далее** .
8. Нажмите кнопку **Далее** on the **Далее** .
9. Нажмите кнопку **Далее** on the **Далее** .

**URL-адрес веб-портала или URL-адрес диспетчера отчетов для выпусков 2012 и 2014:**

1. Щелкните **URL-адрес веб-портала** или **URL-адрес диспетчера отчетов** для выпусков 2012 и 2014 в левой области.
2. Нажмите кнопку **Применить**.
3. В области **Результаты** убедитесь, что действия успешно выполнены.
4. Щелкните **Выход**.

Сведения о разрешениях сервера отчетов см. в разделе [Предоставление разрешений на сервер отчетов в собственном режиме](https://msdn.microsoft.com/library/ms156014.aspx).

### <a name="browse-to-the-local-report-manager"></a>Переход в локальный диспетчер отчетов
Чтобы проверить конфигурацию, перейдите в диспетчер отчетов на виртуальной машине.

1. На виртуальной машине запустите Internet Explorer с правами администратора.
2. Откройте http://localhost/reports на виртуальной машине.

### <a name="to-connect-to-remote-web-portal-or-report-manager-for-2014-and-2012"></a>Подключение к удаленному веб-порталу или диспетчеру отчетов для выпусков 2012 и 2014
Если требуется подключиться к веб-порталу или диспетчеру отчетов для выпусков 2012 и 2014 на виртуальной машине с удаленного компьютера, создайте новую конечную точку TCP виртуальной машины. По умолчанию сервер отчетов прослушивает HTTP-запросы через **порт 80**. В случае настройки URL-адресов сервера отчетов на использование другого порта необходимо указать этот номер порта в следующих инструкциях.

1. Создайте конечную точку для виртуальной машины через TCP-порт 80. Дополнительные сведения см. в разделе [Конечные точки виртуальной машины и порты брандмауэра](#virtual-machine-endpoints-and-firewall-ports) этого документа.
2. Откройте порт 80 в брандмауэре виртуальной машины.
3. Перейдите к веб-порталу или диспетчеру отчетов, используя **DNS-имя** виртуальной машины Azure в качестве имени сервера в URL-адресе. Например: 
   
    **Сервер отчетов**: http://uebi.cloudapp.net/reportserver **Веб-портал**: http://uebi.cloudapp.net/reports
   
    [Настройка брандмауэра для доступа к серверу отчетов](https://msdn.microsoft.com/library/bb934283.aspx)

### <a name="to-create-and-publish-reports-to-the-azure-virtual-machine"></a>Создание и публикация отчетов на виртуальной машине Azure
В следующей таблице перечислены некоторые параметры, доступные для публикации существующих отчетов с локального компьютера на сервер отчетов, размещенный на виртуальной машине Microsoft Azure.

* **Построитель отчетов**. Виртуальная машина включает в себя ClickOnce-версию построителя отчетов Microsoft SQL Server для выпусков 2012 и 2014. Для первого запуска построителя отчетов на виртуальной машине с SQL 2016 сделайте следующее:
  
  1. Запустите браузер с правами администратора.
  2. Перейдите на веб-портал на виртуальной машине и выберите значок **Скачать** в правом верхнем углу.
  3. Выберите **Построитель отчетов**.
     
     Дополнительные сведения см. в разделе [Запуск построителя отчетов](https://msdn.microsoft.com/library/ms159221.aspx).
* **SQL Server Data Tools**: виртуальная машина. Компонент SQL Server Data Tools устанавливается на виртуальной машине и может использоваться для создания **проектов сервера отчетов** и отчетов на виртуальной машине. SQL Server Data Tools может публиковать отчеты на сервере отчетов на виртуальной машине.
* **SQL Server Data Tools: удаленно**. Создайте на локальном компьютере проект служб Reporting Services в SQL Server Data Tools, содержащий отчеты служб Reporting Services. Настройте проект для подключения к URL-адресу веб-службы.
  
    ![свойства проекта SSDT для проекта SSRS](./media/virtual-machines-windows-classic-ps-sql-bi/IC650114.gif)
* Создайте жесткий диск VHD, содержащий отчеты, а затем отправьте и подключите этот диск.
  
  1. Создайте на локальном компьютере жесткий диск VHD, содержащий ваши отчеты.
  2. Создайте и установите сертификат управления.
  3. Отправьте VHD-файл в Azure с помощью командлета Add-AzureVHD, руководствуясь указаниями из статьи [Создание и передача виртуального жесткого диска Windows Server в Azure](../classic/createupload-vhd.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).
  4. Подключите диск к виртуальной машине.

## <a name="install-other-sql-server-services-and-features"></a>Установка других служб и компонентов SQL Server
Чтобы установить дополнительные службы SQL Server, такие как службы Analysis Services в табличном режиме, запустите мастер установки SQL Server. Файлы установки находятся на локальном диске виртуальной машины.

1. Нажмите кнопку **Пуск** и выберите **Все программы**.
2. Щелкните **Microsoft SQL Server 2016**, **Microsoft SQL Server 2014** или **Microsoft SQL Server 2012**, а затем выберите **Средства настройки**.
3. Щелкните **Центр установки SQL Server**.

Либо запустите файл C:\SQLServer_13.0_full\setup.exe, C:\SQLServer_12.0_full\setup.exe или C:\SQLServer_11.0_full\setup.exe.

> [!NOTE]
> При первом запуске программы установки SQL Server может потребоваться скачивание большего числа файлов установки, а также перезагрузка виртуальной машины и перезапуск программы установки SQL Server.
> 
> Если необходимо многократно настраивать образ, выбранный из виртуальной машины Microsoft Azure, рекомендуется создать собственный образ SQL Server. Функциональные возможности SysPrep служб Analysis Services были включены в SQL Server 2012 SP1 CU2. Дополнительные сведения см. в разделах [Вопросы по установке SQL Server с помощью SysPrep](https://msdn.microsoft.com/library/ee210754.aspx) и [Sysprep Support for Server Roles](https://msdn.microsoft.com/windows/hardware/commercialize/manufacture/desktop/sysprep-support-for-server-roles) (Поддержка ролей сервера в Sysprep).
> 
> 

### <a name="to-install-analysis-services-tabular-mode"></a>Установка табличного режима служб Analysis Services
Действия, приведенные в этом разделе, **кратко описывают** установку табличного режима служб Analysis Services. Дополнительную информацию см. в следующих разделах.

* [Установка служб Analysis Services в табличном режиме](https://msdn.microsoft.com/library/hh231722.aspx)
* [Табличное моделирование (руководство по Adventure Works)](https://msdn.microsoft.com/library/140d0b43-9455-4907-9827-16564a904268)

**Порядок установки табличного режима служб Analysis Services:**

1. В левой области мастера установки SQL Server щелкните элемент **Установка**, а затем — элемент **Новая установка изолированного экземпляра SQL Server или добавление компонентов к существующей установке**.
   
   * Если вы видите элемент **Выбор папки**, перейдите к папке C:\SQLServer_13.0_full, C:\SQLServer_12.0_full или C:\SQLServer_11.0_full и нажмите кнопку **ОК**.
2. Нажмите кнопку **Далее** на странице обновлений продуктов.
3. На странице **Тип установки** выберите **Выполнить новую установку SQL Server** и нажмите кнопку **Далее**.
4. На странице **Роль установки** щелкните **Установка компонентов SQL Server**.
5. На странице **Выбор компонентов** щелкните **Службы Analysis Services**.
6. На странице **Конфигурации экземпляра** введите описательное имя, например **Табличный режим**, в текстовых полях **Именованный экземпляр** и **Идентификатор экземпляра**.
7. На странице **Настройка служб Analysis Services** выберите **Табличный режим**. Добавьте текущего пользователя в список разрешений администратора.
8. Завершите процедуру и закройте мастер установки SQL Server.

## <a name="analysis-services-configuration"></a>Настройка служб Analysis Services
### <a name="remote-access-to-analysis-services-server"></a>Удаленный доступ к серверу служб Analysis Services
Сервер служб Analysis Services поддерживает только проверку подлинности Windows. Для удаленного доступа к службам Analysis Services из клиентских приложений, таких как SQL Server Management Studio или SQL Server Data Tools, виртуальная машина должна быть присоединена к локальному домену с помощью виртуальной сети Azure. Дополнительные сведения см. в статье [Обзор виртуальной сети](../../../virtual-network/virtual-networks-overview.md).

**Экземпляр по умолчанию** служб Analysis Services прослушивает TCP-порт **2383**. Откройте этот порт в брандмауэре виртуальных машин. Порт **2383**прослушивается также кластеризованным именованным экземпляром служб Analysis Services.

Для **именованного экземпляра** служб Analysis Services для управления доступом к портам требуется служба обозревателя SQL Server. В качестве настройки по умолчанию для обозревателя SQL Server используется порт **2382**.

В брандмауэре виртуальных машин откройте порт **2382** и создайте статический порт именованного экземпляра служб Analysis Services.

1. Чтобы просмотреть порты, которые уже используются на виртуальной машине, и узнать, какой именно процесс использует эти порты, выполните следующую команду с правами администратора:
   
        netstat /ao
2. Используйте SQL Server Management Studio для создания статического порта именованного экземпляра служб Analysis Services, обновив значение "Порт" в общих свойствах служб Analysis Services в табличном режиме. Дополнительные сведения см. в разделе "Использование фиксированного порта для экземпляра по умолчанию или именованного экземпляра" статьи [Настройка брандмауэра Windows на разрешение доступа к службам Analysis Services](https://msdn.microsoft.com/library/ms174937.aspx#bkmk_fixed).
3. Перезагрузите табличный экземпляр служб Analysis Services.

Дополнительные сведения см. в разделе **Конечные точки виртуальной машины и порты брандмауэра** этого документа.

## <a name="virtual-machine-endpoints-and-firewall-ports"></a>Конечные точки виртуальной машины и порты брандмауэра
В этом разделе перечислены конечные точки виртуальной машины Microsoft Azure, которые нужно создать, и порты, которые нужно открыть в брандмауэрах виртуальных машин. В следующей таблице перечислены **TCP** -порты, для которых нужно создать конечные точки, и порты, которые нужно открыть в брандмауэре виртуальных машин.

* Если вы используете одну виртуальную машины и выполняются два следующих условия, вам не нужно создавать конечные точки виртуальной машины и открывать порты в брандмауэре на этой виртуальной машине.
  
  * Вы не осуществляете удаленное подключение к компонентам SQL Server на виртуальной машине. Установка подключения удаленного рабочего стола к виртуальной машине и доступ к компонентам SQL Server локально в виртуальной машине не считаются удаленным подключением к компонентам SQL Server.
  * Вы не присоединяете виртуальную машину к локальному домену через виртуальную сеть Azure или некоторое другое решение туннелирования VPN.
* Если виртуальная машина не присоединена к домену, но требуется установить удаленное подключение к компонентам SQL Server на виртуальной машине, выполните следующие действия.
  
  * Откройте порты в брандмауэре на виртуальной машине.
  * Создайте конечные точки виртуальной машины для указанных портов (*).
* Если виртуальная машина присоединена к домену с помощью VPN-туннеля, такого как виртуальная сеть Azure, конечные точки не требуются. Однако следует открыть порты в брандмауэре на виртуальной машине.
  
  | Порт | type | ОПИСАНИЕ |
  | --- | --- | --- |
  | **80** |TCP |Удаленный доступ к серверу отчетов (*). |
  | **1433** |TCP |SQL Server Management Studio (*). |
  | **1434** |UDP |Обозреватель SQL Server. Это необходимо, если виртуальная машина присоединена к домену. |
  | **2382** |TCP |Обозреватель SQL Server. |
  | **2383** |TCP |Экземпляр SQL Server Analysis Services по умолчанию и кластеризованные именованные экземпляры. |
  | **Определяется пользователем** |TCP |Создайте статический порт именованного экземпляра служб Analysis Services для выбранного номера порта, а затем разблокируйте этот порт в брандмауэре. |

Дополнительную информацию о создании конечных точек см. в следующих разделах.

* Создание конечных точек:[Настройка конечных точек виртуальной машины](../classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).
* SQL Server: см. раздел "Выполнение шагов по подключению к виртуальной машине с помощью SQL Server Management Studio" статьи [Подготовка виртуальной машины SQL Server на портале Azure](../sql/virtual-machines-windows-portal-sql-server-provision.md).

На следующей схеме показаны порты, которые необходимо открыть в брандмауэре виртуальной машины, чтобы разрешить удаленный доступ к функциям и компонентам на виртуальной машине.

![порты, которые необходимо открыть для приложений бизнес-аналитики в виртуальных машинах Azure](./media/virtual-machines-windows-classic-ps-sql-bi/IC654385.gif)

## <a name="resources"></a>Ресурсы
* Просмотрите политику поддержки серверного программного обеспечения Майкрософт, применяемую в среде виртуальных машин Azure. Ниже приведены сведения о поддержке таких компонентов, как BitLocker, отказоустойчивая кластеризация и балансировка сетевой нагрузки. [Поддержка серверного программного обеспечения Майкрософт для виртуальных машин Azure](http://support.microsoft.com/kb/2721672).
* [Обзор. SQL Server на виртуальных машинах Azure](../sql/virtual-machines-windows-sql-server-iaas-overview.md)
* [Виртуальные машины](https://azure.microsoft.com/documentation/services/virtual-machines/)
* [Подготовка виртуальной машины SQL Server в Azure](../sql/virtual-machines-windows-portal-sql-server-provision.md)
* [Подключение диска с данными к виртуальной машине](../classic/attach-disk-classic.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json)
* [Миграция базы данных в SQL Server на виртуальной машине Azure](../sql/virtual-machines-windows-migrate-sql.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fsqlclassic%2ftoc.json)
* [Определение режима работы сервера экземпляра служб Analysis Services](https://msdn.microsoft.com/library/gg471594.aspx)
* [Многомерное моделирование (руководство по Adventure Works)](https://technet.microsoft.com/library/ms170208.aspx)
* [Центр документации Azure](https://azure.microsoft.com/documentation/)
* [Использование Power BI в гибридной среде](https://msdn.microsoft.com/library/dn798994.aspx)

> [!NOTE]
> [Отправьте отзыв и контактные данные через Microsoft SQL Server Connect](https://connect.microsoft.com/SQLServer/Feedback)

### <a name="community-content"></a>Материалы сообщества
* [Управление базой данных SQL Azure с помощью PowerShell](http://blogs.msdn.com/b/windowsazure/archive/2013/02/07/windows-azure-sql-database-management-with-powershell.aspx)

