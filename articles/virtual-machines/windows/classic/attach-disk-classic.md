---
title: Подключение диска к классической виртуальной машине Azure | Документация Майкрософт
description: Подключение диска данных к виртуальной машине Windows, созданной с использованием классической модели развертывания, и его инициализация.
services: virtual-machines-windows, storage
documentationcenter: ''
author: cynthn
manager: jeconnoc
editor: tysonn
tags: azure-service-management
ROBOTS: NOINDEX
ms.assetid: be4e3e74-05bc-4527-969f-84f10a1d66a7
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 02/21/2017
ms.author: cynthn
ms.openlocfilehash: 48a6b96bd611fcc8fa8219aeef359419255b8cef
ms.sourcegitcommit: 5b2ac9e6d8539c11ab0891b686b8afa12441a8f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30918597"
---
# <a name="attach-a-data-disk-to-a-windows-virtual-machine-created-with-the-classic-deployment-model"></a>Подключение диска данных к виртуальной машине Windows, созданной с использованием классической модели развертывания

В этой статье демонстрируется подключение нового и существующего дисков, созданных в классической модели развертывания, к виртуальной машине Windows на портале Azure.



Вы также можете [подключить диск данных к виртуальной машине Linux на портале Azure](../../linux/attach-disk-portal.md).

Прежде чем подключить диск, ознакомьтесь со следующими советами.

* Размер виртуальной машины определяет, сколько дисков данных к ней можно подключить. Дополнительную информацию см. в статье [Размеры виртуальных машин](../../virtual-machines-windows-sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

* Для использования хранилища класса Premium вам необходимо будет использовать виртуальную машину серии DS или GS. Эти виртуальные машины позволяют использовать диски из учетных записей хранения Premium и Standard. Хранилище Premium доступно в определенных регионах. Дополнительные сведения см. в разделе [Хранилище класса Premium: высокопроизводительная служба хранилища для рабочих нагрузок виртуальных машин Azure](../premium-storage.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

* Если вы подключаете новый диск, его не надо предварительно создавать. Azure создаст его при подключении.

Вы также можете [присоединить диск данных с помощью Powershell](../../virtual-machines-windows-attach-disk-ps.md).

> [!IMPORTANT]
> В Azure предлагаются две модели развертывания для создания ресурсов и работы с ними: [модель Resource Manager и классическая модель](../../../resource-manager-deployment-model.md).
> [!INCLUDE [virtual-machines-common-classic-createportal](../../../../includes/virtual-machines-classic-portal.md)]

## <a name="find-the-virtual-machine"></a>Поиск виртуальной машины
1. Войдите на [портале Azure](https://portal.azure.com/).
2. Выберите виртуальную машину среди ресурсов на панели мониторинга.
3. В левой области в разделе **Параметры** щелкните **Диски**.

    ![Открытие параметров диска](./media/attach-disk/virtualmachinedisks.png)

Продолжайте, следуя указаниям по подключению [нового](#option-1-attach-a-new-disk) или [существующего диска](#option-2-attach-an-existing-disk).

## <a name="option-1-attach-and-initialize-a-new-disk"></a>Вариант 1. Подключение и инициализация нового диска

1. В колонке **Диски** щелкните **Подключить новый**.
2. Просмотрите параметры по умолчанию, при необходимости измените их, затем нажмите кнопку **ОК**.

   ![Просмотр параметров диска](./media/attach-disk/attach-new.png)

3. После того как Azure создаст диск и подключит его к виртуальной машине, он появится в параметрах дисков виртуальной машины в разделе **Диски данных**.

### <a name="initialize-a-new-data-disk"></a>Инициализация нового диска данных

1. Подключитесь к виртуальной машине. Указания см. в статье [Как подключиться к виртуальной машине Azure под управлением Windows и войти в систему](../../virtual-machines-windows-connect-logon.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).
2. После входа в систему на виртуальной машине откройте **Диспетчер сервера**. В области слева выберите **Файловые службы и службы хранилища**.

    ![Откройте диспетчер сервера.](../media/attach-disk-portal/fileandstorageservices.png)

3. Выберите **Диски**.
4. В разделе **Диски** перечислены все диски. Чаще всего виртуальная машина содержит диск 0, диск 1 и диск 2. Диск 0 — это диск операционной системы, диск 1 — временный диск, а диск 2 — диск данных, который был только что подключен к виртуальной машине. Диск данных содержит раздел **Неизвестный**.

 Щелкните диск правой кнопкой мыши и выберите пункт **Инициализировать**.

5. Появится уведомление о том, что при инициализации диска все данные будут очищены. Щелкните **Да** , чтобы подтвердить ознакомление с предупреждением и инициализировать диск. После завершения операции раздел будет иметь значение **GPT**. Щелкните диск правой кнопкой мыши еще раз и выберите пункт **Новый том**.

6. Завершите мастер, используя значения по умолчанию. После этого в разделе **Тома** появится новый том. Теперь диск в сети и готов к хранению данных.

    ![Том успешно инициализирован](./media/attach-disk/newdiskafterinitialization.png)

## <a name="option-2-attach-an-existing-disk"></a>Вариант 2. Подключение существующего диска
1. В колонке **Диски** щелкните **Подключить существующий**.
2. В разделе **Подключение существующего диска** щелкните **Расположение**.

   ![Подключение существующего диска](./media/attach-disk/attachexistingdisksettings.png)
3. В разделе **Учетные записи хранения**выберите учетную запись и контейнер, который содержит VHD-файл.

   ![Поиск расположения VHD](./media/attach-disk/existdiskstorageaccountandcontainer.png)

4. Выберите VHD-файл.
5. В разделе **Подключение существующего диска** выбранный вами файл отображается в списке, расположенном в разделе **VHD-файл**. Последовательно выберите **ОК**.
6. После того как Azure подключит диск к виртуальной машине, он будет отображаться в параметрах дисков виртуальной машины в разделе **Диски данных**.

## <a name="use-trim-with-standard-storage"></a>Использование функции TRIM в хранилище уровня "Стандартный"

Если вы используете хранилище уровня "Стандартный" (HDD), то следует включить функцию TRIM. TRIM удаляет неиспользуемые блоки на диске, таким образом плата взимается только за ту часть хранилища, которая используется. Использование функции TRIM может уменьшить затраты, включая затраты на неиспользуемые блоки, возникающие в результате удаления больших файлов.

Вы можете выполнить эту команду, чтобы проверить состояние функции TRIM. На виртуальной машине Windows откройте командную строку и введите:

```
fsutil behavior query DisableDeleteNotify
```

Если команда возвращает значение 0, то функция TRIM включена правильно. Если она возвращает значение 1, то для включения TRIM выполните следующую команду:
```
fsutil behavior set DisableDeleteNotify 0
```

## <a name="next-steps"></a>Дополнительная информация
Если вашему приложению нужно использовать диск D для хранения данных, вы можете [изменить букву временного диска Windows](../../virtual-machines-windows-change-drive-letter.md).

## <a name="additional-resources"></a>Дополнительные ресурсы
[О дисках и виртуальных жестких дисках для виртуальных машин](../../virtual-machines-linux-about-disks-vhds.md)
