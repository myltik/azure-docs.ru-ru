<properties
	pageTitle="Создание Jupyter/IPython Notebook | Microsoft Azure"
	description="Узнайте, как развернуть Jupyter/IPython Notebook на виртуальной машине в Azure под управлением Linux или Windows, созданной с помощью модели развертывания с использованием менеджера ресурсов."
	services="virtual-machines-linux"
	documentationCenter="python"
	authors="crwilcox"
	manager="wpickett"
	editor=""
	tags="azure-service-management,azure-resource-manager"/>

<tags
	ms.service="virtual-machines-linux"
	ms.workload="infrastructure-services"
	ms.tgt_pltfrm="vm-linux"
	ms.devlang="python"
	ms.topic="article"
	ms.date="11/10/2015"
	ms.author="crwilcox"/>

# Jupyter Notebook в Azure

[Проект Jupyter](http://jupyter.org), ранее известный как [проект IPython](http://ipython.org), предоставляет собой набор средств для научных вычислений, который сочетает в себе выполнение кода с созданием документа вычислений в реальном времени. Эти файлы записной книжки могут содержать произвольный текст, математические формулы, код ввода, результаты, графику, видео и любые другие виды носителей, которые может отображать современный веб-браузер. Независимо от того, кем вы являетесь — новичком в Python, который хочет изучить этот язык в интересной интерактивной среде, или специалистом, которому требуется выполнить какие-то серьезные параллельные или технические вычисления, Jupyter Notebook станет великолепным выбором.

![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/ipy-notebook-spectral.png) Применение пакетов SciPy и matplotlib для анализа структуры звукозаписи.


## Два способа реализации Jupyter: Azure Notebook или пользовательское развертывание
В Azure есть служба, позволяющая [быстро начать работу с Jupyter](http://blogs.technet.com/b/machinelearning/archive/2015/07/24/introducing-jupyter-notebooks-in-azure-ml-studio.aspx). С помощью службы Azure Notebook можно с легкостью получить доступ к веб-интерфейсу Jupyter для масштабируемых вычислительных ресурсов в сочетании со всеми возможностями Python и его многочисленных библиотек. Поскольку установкой занимается служба, пользователи могут работать с этими ресурсами без всякого администрирования и настройки конфигурации.

Если служба Notebook не подходит для вашего сценария, далее в этой статье вы узнаете, как развернуть Jupyter Notebook в Microsoft Azure, используя виртуальные машины Linux.

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-rm-include.md)]Классическая модель развертывания.

[AZURE.INCLUDE [create-account-and-vms-note](../../includes/create-account-and-vms-note.md)]

## Создание и настройка виртуальной машины в Azure

Первым шагом является создание виртуальной машины (VM) в Azure. Эта виртуальная машина является полноценной операционной системой в облаке и будет использоваться для запуска Jupyter Notebook. В среде Azure можно размещать виртуальные машины Linux и Windows. Мы рассмотрим установку Jupyter на обоих типах виртуальных машин.

### Создание виртуальной Машины Linux и открытие порта для Jupyter

Следуя приведенным [здесь][portal-vm-linux], создайте виртуальную машину из дистрибутива *Ubuntu*. В этом учебнике используется Ubuntu Server 14.04 LTS. Предположим, что имя пользователя — *azureuser*.

После развертывания виртуальной машины необходимо открыть правило безопасности для группы безопасности сети. На портале Azure откройте раздел **Сетевые группы безопасности** и перейдите на вкладку группы безопасности, соответствующей вашей виртуальной машине. Вам нужно добавить правило безопасности для входящего трафика со следующими параметрами: **TCP** в качестве протокола, ***** в качестве исходного (открытого) порта и **9999** в качестве конечного (закрытого) порта.

![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/azure-add-endpoint.png)

В группе безопасности сети щелкните **Сетевые интерфейсы** и запишите **общедоступный IP-адрес** — он потребуется для подключения к виртуальной машине на следующем этапе.

## Установка необходимого программного обеспечения в виртуальной машине

Чтобы запустить Jupyter Notebook на своей виртуальной машине, необходимо предварительно установить Jupyter и его зависимости. Подключитесь к своей виртуальной машине Linux по протоколу SSH, указав имя пользователя и пароль, выбранные при ее создании. В этом учебнике используется PuTTY и подключение из Windows.

### Установка Jupyter на Ubuntu
Установите Anaconda, популярный дистрибутив Python для работы с научными данными, воспользовавшись одной из ссылок на сайте [Continuum Analytics](https://www.continuum.io/downloads). На момент составления данного документа на последние версии вели указанные ниже ссылки.

#### Дистрибутивы Anaconda для Linux
<table>
  <th>Python 3.4</th>
  <th>Python 2.7</th>
  <tr>
    <td>
		<a href='https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda3-2.3.0-Linux-x86_64.sh'>64-разрядный</href>
	</td>
    <td>
		<a href='https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda-2.3.0-Linux-x86_64.sh'>64-разрядный</href>
	</td>
  </tr>
  <tr>
    <td>
		<a href='https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda3-2.3.0-Linux-x86.sh'>32-разрядный</href>
	</td>
    <td>
		<a href='https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda-2.3.0-Linux-x86.sh'>32-разрядный</href>
	</td>  
  </tr>
</table>


#### Установка 64-разрядной версии Anaconda 3 2.3.0 на Ubuntu
Приведем пример установки Anaconda на Ubuntu:

	# install anaconda
	cd ~
	mkdir -p anaconda
	cd anaconda/
	curl -O https://3230d63b5fc54e62148e-c95ac804525aac4b6dba79b00b39d1d3.ssl.cf1.rackcdn.com/Anaconda3-2.3.0-Linux-x86_64.sh
	sudo bash Anaconda3-2.3.0-Linux-x86_64.sh -b -f -p /anaconda3

	# clean up home directory
	cd ..
	rm -rf anaconda/

	# Update Jupyter to the latest install and generate its config file
	sudo /anaconda3/bin/conda install -f jupyter -y
	/anaconda3/bin/jupyter-notebook --generate-config


![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/anaconda-install.png)


### Настройка Jupyter и использование протокола SSL
После установки необходимо настроить файлы конфигурации для Jupyter. Если с настройкой Jupyter возникнут проблемы, обратитесь к [документации по Jupyter в части запуска сервера службы Notebook](http://jupyter-notebook.readthedocs.org/en/latest/public_server.html).

Далее мы выполним команду `cd`, чтобы перейти к папке профиля для создания своего SSL-сертификата и изменения файла конфигурации профилей.

В Linux используйте следующую команду.

    cd ~/.jupyter

Используйте следующую команду, чтобы создать сертификат SSL (Linux и Windows).

    openssl req -x509 -nodes -days 365 -newkey rsa:1024 -keyout mycert.pem -out mycert.pem

Обратите внимание — так как создается самозаверяющий SSL-сертификат, при подключении к записной книжке в браузере будет выведено предупреждение системы безопасности. Для долгосрочного использования в рабочей среде потребуется должным образом подписанный сертификат, связанный с вашей организацией. Так как управление сертификатами выходит за рамки этой демонстрации, в данном случае мы ограничимся самозаверяющим сертификатом.

Помимо сертификата, необходимо также указать пароль для защиты записной книжки от несанкционированного использования. Из соображений безопасности Jupyter использует зашифрованные пароли в своем файле конфигурации, поэтому сначала необходимо зашифровать пароль. IPython предоставляет для этого соответствующую утилиту; в командной строке выполните следующую команду:

    /anaconda3/bin/python -c "import IPython;print(IPython.lib.passwd())"

Система запросит пароль и подтверждение, а затем выведет пароль на экран. Запишите его для следующего этапа.

    Enter password:
    Verify password:
    sha1:b86e933199ad:a02e9592e59723da722.. (elided the rest for security)

Далее предстоит отредактировать файл конфигурации профиля, т. е. файл `jupyter_notebook_config.py` в текущей папке профиля. Если этот файл не существует, создайте его. Этот файл содержит несколько полей, которые по умолчанию закомментированы. Этот файл можно открыть в любом текстовом редакторе. Необходимо убедиться, что в нем есть по крайней мере следующее содержимое: Не забудьте заменить пароль на sha1 из предыдущего шага.

    c = get_config()

    # You must give the path to the certificate file.
    c.NotebookApp.certfile = u'/home/azureuser/.jupyter/mycert.pem'

    # Create your own password as indicated above
    c.NotebookApp.password = u'sha1:b86e933199ad:a02e9592e5 etc... '

    # Network and browser details. We use a fixed port (9999) so it matches
    # our Azure setup, where we've allowed :wqtraffic on that port
    c.NotebookApp.ip = '*'
    c.NotebookApp.port = 9999
    c.NotebookApp.open_browser = False

### Запустите Jupyter Notebook.

Теперь можно запустить Jupyter Notebook. Для этого перейдите в каталог, в котором предполагается хранить записные книжки, и запустите сервер Jupyter Notebook с помощью следующей команды:

    /anaconda3/bin/jupyter-notebook

Теперь можно получить доступ к Jupyter Notebook по адресу `https://[PUBLIC-IP-ADDRESS]:9999`.

При первом обращении к записной книжке, на странице входа будет запрошен пароль: После входа в систему вы увидите "Панель мониторинга Jupyter Notebook", которая является центром управления для всех операций с записными книжками. На этой странице можно создать новые записные книжки и открывать существующие:

![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/jupyter-tree-view.png)

### Использование Jupyter Notebook

Нажав кнопку **Создать**, вы увидите следующую начальную страницу.

![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/jupyter-untitled-notebook.png)

Область, отмеченная запросом `In []:`, является областью ввода: здесь можно ввести любой допустимый код Python и он будет исполнен, если нажать `Shift-Enter` или щелкнуть значок «Воспроизведение» (направленный вправо треугольник на панели инструментов).

## Мощная парадигма: документы с вычислениями в режиме реального времени и богатыми возможностями мультимедиа

Сама работа с записной книжкой должна быть интуитивно понятна для любого, кто использовал Python и текстовый процессор, так как это является в некотором смысле сочетанием обоих вариантов: здесь можно выполнять блоки кода Python, но можно также сохранять заметки и другой текст, изменив стиль в ячейки с «Код» на «Разметка» в раскрывающемся меню на панели инструментов.

Но это гораздо больше, чем текстовый процессор, так как Jupyter позволяет совмещать вычисления и широкие возможности мультимедиа (текст, графику, видео и практически любые данные, которые способен отображать современный браузер). Вы можете комбинировать текст, код, видео и многое другое!

![Снимок экрана](./media/virtual-machines-linux-jupyter-notebook/jupyter-editing-experience.png)

И с помощью множества великолепных библиотек Python, предназначенных для научных и технических вычислений, как показано на следующем снимке экрана, можно с легкостью выполнять и простые вычисления, и анализ сложных сетей в единой среде.

Эта парадигма сочетания мощи современных веб-технологий с вычислениями в режиме реального времени предоставляет множество возможностей и идеально подходит для облака. Notebook можно использовать для следующих целей:

* Как вычислительный электронный блокнот для регистрации исследовательской работы над проблемой.

* Для совместного использования результатов с коллегами либо в форме вычислений в режиме реального времени, либо в формате печатной копии (HTML, PDF).

* Для распространения и представления материалов интерактивного обучения,включающих вычисления, что позволит слушателям сразу же приступить к экспериментам с реальным кодом, изменять его и повторно выполнять в интерактивном режиме.

* Для предоставления «исполняемых документов», в которых представлены результаты исследования таким образом,что оно может быть немедленно воспроизведено, проверено и дополнено другими.

* Как платформа для совместной работы: несколько пользователей могут войти на один сервер записной книжки для совместной работы в интерактивном сеансе вычислений.


В [репозитории][] исходного кода IPython доступен весь каталог с примерами записных книжек, которые можно скачать и использовать в виртуальной машине Jupyter для Azure для экспериментов. Просто загрузите файлы `.ipynb` с сайта и отправьте их на панель мониторинга виртуальной машины Azure для записной книжки (или загрузите их прямо в виртуальную машину).

## Заключение

Jupyter Notebook предоставляет богатый возможностями интерфейс для интерактивной работы с мощной экосистемой Python в Azure. Он охватывает широкий диапазон вариантов использования, включая простой просмотр и изучения Python, анализ данных и визуализацию, моделирование и параллельные вычисления. Итоговые документы Notebook содержат полную запись выполненных вычислений и могут использоваться совместно с другими пользователями Jupyter. Приложение Jupyter Notebook можно использовать в качестве локального приложения, однако оно идеально подходит для развертываний в облаке Azure.

Основные функции Jupyter также доступны в Visual Studio в [Средствах Python для Visual Studio][] (PTVS). PTVS является бесплатным подключаемым модулем с открытым кодом от корпорации Майкрософт, который превращает Visual Studio в среду разработки Python с расширенными возможностями, включающую редактор с интеграцией IntelliSense, средств отладки, профилирования и параллельных вычислений.

## Дальнейшие действия

Дополнительную информацию можно найти в [Центре разработчика Python](/develop/python/).

[portal-vm-linux]: https://azure.microsoft.com/documentation/articles/virtual-machines-linux-tutorial-portal-rm/
[репозитории]: https://github.com/ipython/ipython
[Средствах Python для Visual Studio]: http://aka.ms/ptvs

<!---HONumber=AcomDC_0420_2016-->