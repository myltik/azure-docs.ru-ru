---
title: Как найти адрес с помощью службы поиска Azure Location Based Services (предварительная версия) | Документация Microsoft
description: Узнайте, как найти адрес с помощью службы поиска Azure Location Based Services (предварительная версия)
services: location-based-services
author: kgremban
ms.author: kgremban
ms.date: 11/29/2017
ms.topic: article
ms.service: location-based-services
ms.openlocfilehash: f8b886607fe0915396a659593cd5910a271fca93
ms.sourcegitcommit: 5b2ac9e6d8539c11ab0891b686b8afa12441a8f3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
# <a name="how-to-find-an-address-using-the-azure-location-based-services-preview-search-service"></a>Как найти адрес с помощью службы поиска Azure Location Based Services (предварительная версия)
Служба поиска — это набор API-интерфейсов на основе REST для разработчиков, позволяющий выполнять поиск адресов, мест, достопримечательностей, деловых справочников и других географических данных. Служба поиска присваивает значения широты и долготы определенному адресу, пересекающей улице, географической особенности или достопримечательности. Значения широты и долготы, возвращенные программным интерфейсом службы поиска, можно использовать в качестве параметров в других Azure Location Based Services, например в API потока транспорта и маршрута.

## <a name="prerequisites"></a>предварительным требованиям
* Установите [приложение Postman](https://www.getpostman.com/apps).

* Вам потребуется ключ и учетная запись Azure Location Based Services. Дополнительные сведения о создании учетной записи и получении ключа см. в статье об [управлении ключами и учетной записью Azure Location Based Services](how-to-manage-account-keys.md). 

## <a name="using-fuzzy-search"></a>Использование поиска нечетких соответствий

API по умолчанию для службы поиска — API поиска нечетких соответствий, который обрабатывает любое сочетание токенов адреса или достопримечательности. Этот API поиска является классическим "однострочным поиском". Его можно использовать, если неизвестно, какие данные применяет пользователь для поискового запроса. API поиска нечетких соответствий включает в себя сочетание поиска достопримечательностей и геокодирование. Этому API также можно назначить взвешенное значение с помощью контекстно-зависимой позиции (пары широты или долготы), полностью ограничить с помощью координат и радиуса, а также выполнить без точки привязки геосмещения.

Большинство запросов службы поиска по умолчанию имеют значение maxFuzzyLevel=1 для улучшения производительности и уменьшения количества необычных результатов. Это значение по умолчанию можно переопределить в зависимости от запроса, используя параметр запроса maxFuzzyLevel=2 или 3.

### <a name="search-for-an-address-using-fuzzy-search"></a>Поиск адреса с помощью поиска нечетких соответствий

1. Откройте приложение Postman, в раскрывающемся списке New (Создать) щелкните Create New (Создать) и выберите **запрос GET**. Введите название запроса **поиска нечетких соответствий**, выберите коллекцию или папку, в которую нужно его сохранить, и щелкните **Save** (Сохранить).

    Дополнительные сведения см. в документации по запросам в Postman.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.

    ![Поиск нечетких соответствий ](./media/how-to-search-for-address/fuzzy_search_url.png)

    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | ПОЛУЧЕНИЕ |
    | Request URL (URL-адрес запроса) | https://atlas.microsoft.com/search/fuzzy/json? |
    | Авторизация | No Auth (Без авторизации) |

    Атрибут **json** в URL-адресе пути определяет формат ответа. В этой статье json применяется для простоты использования и удобочитаемости. Доступные форматы ответа в определении **метода Get поиска нечетких соответствий** можно найти в [справочнике по функциональным API Location Based Services] (https://docs.microsoft.com/rest/api/location-based-services/search/getsearchfuzzy).

3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:

    ![Поиск нечетких соответствий ](./media/how-to-search-for-address/fuzzy_search_params.png)

    | Ключ | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<ваш ключ Azure Location Based Services\> |
    | query | пицца |

4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа. 

    Неоднозначная строка запроса "пицца" возвратила в результате 10 достопримечательностей с категориями, удовлетворяющими запрос "пицца" и "ресторан". Каждый результат возвращает адрес улицы, значения широты и долготы, окно просмотра и точки входа для расположения.
    
    Результаты для этого запроса различны и не связаны с конкретным эталонным расположением. Вы можете использовать параметр **countrySet**, чтобы указать только те страны, которые приложению требуется охватить, так как в поведении по умолчанию задан глобальный поиск (из-за чего могут возвращаться ненужные результаты).

5. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |------------------|-------------------------|
    | countrySet | США |
    
    Теперь результаты ограничены кодом страны и запрос возвращает адреса пиццерий в США.
    
    Для получения результатов для указанного места можно запрашивать достопримечательность и использовать возвращаемое значение широты и долготы в вызове службы поиска нечетких соответствий. В этом случае служба поиска использовалась для возврата местоположения Space Needle (Сиэтл) и применялись значения широты и долготы, чтобы ориентировать поиск.
    
4. В разделе Params (Параметры) введите следующие пары "ключ — значение" и щелкните **Send** (Отправить).

    ![Поиск нечетких соответствий ](./media/how-to-search-for-address/fuzzy_search_latlon.png)
    
    | Ключ | Значение |
    |-----|------------|
    | lat | 47.62039 |
    | lon | -122.34928 |

## <a name="search-for-address-properties-and-coordinates"></a>Поиск координат и свойств адреса 

Вы можете указать полный почтовый адрес или его часть в API поиска адреса и получить ответ, содержащий подробные сведения о свойствах адреса (например, муниципалитет или подразделение, а также позиционные значения широты и долготы).

1. В раскрывающемся списке Postman щелкните **New Request** (Создать запрос)  | , **GET request** (Запрос GET) и назовите его **Поиск адреса**.
2. На вкладке Builder (Конструктор) выберите метод HTTP **GET**, введите URL-адрес запроса для конечной точки API и выберите протокол авторизации, если он используется.

    ![Поиск адреса ](./media/how-to-search-for-address/address_search_url.png)
    
    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | ПОЛУЧЕНИЕ |
    | Request URL (URL-адрес запроса) | https://atlas.microsoft.com/search/address/json? |
    | Авторизация | No Auth (Без авторизации) |

2. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:
    
    ![Поиск адреса ](./media/how-to-search-for-address/address_search_params.png)
    
    | Ключ | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<ваш ключ Azure Location Based Services\> |
    | query | Броад Стрит 400, Сиэтл, штат Вашингтон, 98109 |
    
3. Щелкните **Send** (Отправить), а затем просмотрите текст ответа. 
    
    В этом случае указан запрос с полным адресом и получен один результат в тексте ответа. 
    
4. В разделе Params (Параметры) замените строку запроса следующим значением.
    ```
        400 Broad, Seattle
    ```

5. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | typeahead | Да |

    Флажок **typeahead** сообщает API поиска адреса, что нужно обработать запрос как частичные входные данные и вернуть массив прогнозных значений.

## <a name="search-for-a-street-address-using-reverse-address-search"></a>Поиск улицы и номера дома с использованием обратного поиска адреса
1. В Postman щелкните **New Request** (Создать запрос) | **GET request** (Запрос GET). Назовите его **Обратный поиск адреса**.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.
    
    ![URL-адрес обратного поиска адреса ](./media/how-to-search-for-address/reverse_address_search_url.png)
    
    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | ПОЛУЧЕНИЕ |
    | Request URL (URL-адрес запроса) | https://atlas.microsoft.com/search/address/reverse/json? |
    | Авторизация | No Auth (Без авторизации) |
    
2. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:
    
    ![Параметры обратного поиска адреса ](./media/how-to-search-for-address/reverse_address_search_params.png)
    
    | Ключ | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<ваш ключ Azure Location Based Services\> |
    | query | 47.59093, -122.33263 |
    
3. Щелкните **Send** (Отправить), а затем просмотрите текст ответа. 
    
    Ответ включает в себя запись достопримечательности для поля Safeco с категорией достопримечательности "Стадион". 
    
4. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | number | Да |

    Если с запросом отправлен параметр [number](https://docs.microsoft.com/rest/api/location-based-services/search/getsearchaddressreverse#search_getsearchaddressreverse_uri_parameters), ответ может включать в себя сведения о стороне улицы (левая или правая), а также о позиции смещения для этого номера.
    
5. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | spatialKeys | Да |

    Если задан параметр запроса [spatialKeys](https://docs.microsoft.com/rest/api/location-based-services/search/getsearchaddressreverse#search_getsearchaddressreverse_uri_parameters), ответ содержит закрытые сведения о геопространственном ключе для указанного расположения.

6. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | returnSpeedLimit | Да |
    
    Если задан параметр запроса [returnSpeedLimit](https://docs.microsoft.com/rest/api/location-based-services/search/getsearchaddressreverse#search_getsearchaddressreverse_uri_parameters), в ответе возвращаются сведения об установленном ограничении скорости.

7. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | returnRoadUse | Да |

    Если задан параметр запроса [returnRoadUse](https://docs.microsoft.com/rest/api/location-based-services/search/getsearchaddressreverse#search_getsearchaddressreverse_uri_parameters), в ответе возвращается массив использования пути для обратных геокодов на уровне улицы.

8. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Ключ | Значение |
    |-----|------------|
    | roadUse | Да |

    Вы можете ограничить запрос обратного геокода определенным типом пути, используя параметр запроса [roadUse](https://docs.microsoft.com/rest/api/location-based-services/search/getsearchaddressreverse#search_getsearchaddressreverse_uri_parameters).
    
## <a name="search-for-the-cross-street-using-reverse-address-cross-street-search"></a>Поиск пересекающей улицы с использованием обратного поиска адреса для пересекающей улицы

1. В Postman щелкните **New Request** (Создать запрос) | **GET request** (Запрос GET) и назовите его **Обратный поиск адреса для пересекающей улицы**.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.
    
    ![Обратный поиск адреса для пересекающей улицы ](./media/how-to-search-for-address/reverse_address_search_url.png)
    
    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | ПОЛУЧЕНИЕ |
    | Request URL (URL-адрес запроса) | https://atlas.microsoft.com/search/address/reverse/crossstreet/json? |
    | Авторизация | No Auth (Без авторизации) |
    
3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:
    
    | Ключ | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<ваш ключ Azure Location Based Services\> |
    | query | 47.59093, -122.33263 |
    
4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа. 

## <a name="next-steps"></a>Дополнительная информация
- Ознакомьтесь с документацией по API [службы поиска Azure Location Based Serices](https://docs.microsoft.com/rest/api/location-based-services/search). 
