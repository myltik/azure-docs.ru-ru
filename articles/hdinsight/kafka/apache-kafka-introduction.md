---
title: Основные сведения об Apache Kafka в Azure HDInsight | Документация Майкрософт
description: 'Данные об Apache Kafka в HDInsight: предназначение, выполняемые функции, а также сведения о том, где найти примеры и информацию по началу работы.'
services: hdinsight
documentationcenter: ''
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: f284b6e3-5f3b-4a50-b455-917e77588069
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/27/2018
ms.author: larryfr
ms.openlocfilehash: 4a4f2c6734de211cd20ee4b9f6815bdefefb25bc
ms.sourcegitcommit: c3d53d8901622f93efcd13a31863161019325216
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2018
---
# <a name="introducing-apache-kafka-on-hdinsight"></a>Общие сведения об Apache Kafka в HDInsight

[Apache Kafka](https://kafka.apache.org) — это распределенная платформа потоковой передачи с открытым исходным кодом, которую можно использовать для создания конвейеров и приложений потоковой передачи данных в режиме реального времени. Kafka также предоставляет функцию брокера сообщений, подобную очереди сообщений, с помощью которой можно выполнять публикацию и подписываться на именованные потоки данных. Kafka в HDInsight предоставляет управляемую, высокомасштабируемую службу с высоким уровнем доступности в облаке Microsoft Azure.

## <a name="why-use-kafka-on-hdinsight"></a>Преимущества Apache Kafka в HDInsight

Использование Kafka в HDInsight обеспечивает следующие преимущества:

* __Соглашение об уровне обслуживания (SLA) с гарантией времени доступности Kafka на уровне 99,9 %__. Дополнительные сведения см. в документе [Соглашение об уровне обслуживания для HDInsight](https://azure.microsoft.com/support/legal/sla/hdinsight/v1_0/).

* __Отказоустойчивость.__ Служба Kafka разработана с использованием одномерного представления стойки, которое успешно работает в некоторых средах. Однако в некоторых средах, таких как Azure, стойка разделена на два измерения: домены обновления (UD) и домены сбоя (FD). Корпорация Майкрософт предоставляет средства, которые могут выполнять перебалансировку секций и реплик Kafka в доменах обновления и сбоя. 

    Дополнительные сведения см. в статье [Обеспечение высокого уровня доступности данных с помощью Apache Kafka в HDInsight](apache-kafka-high-availability.md).

* **Интеграция со службой "Управляемые диски Azure".** Управляемые диски обеспечивают высокие показатели масштабируемости и пропускной способности для дисков, используемых Kafka в HDInsight (до 16 ТБ на каждый узел в кластере).

    См. сведения о [настройке числа управляемых дисков и повышении степени масштабируемости для Kafka в HDInsight](apache-kafka-scalability.md).

    См. дополнительные сведения об [управляемых дисках Azure](../../virtual-machines/windows/managed-disks-overview.md).

* **Предупреждения, мониторинг и диагностическое обслуживание.** Для мониторинга Kafka в HDInsight можно использовать Azure Log Analytics. Log Analytics обрабатывает информацию об уровне виртуальной машины (например, метрики диска и сетевой карты, а также метрики JMX от Kafka).

    Дополнительные сведения см. в статье [Анализ журналов для Apache Kafka в HDInsight](apache-kafka-log-analytics-operations-management.md).

* **Репликация данных Kafka.** Kafka предоставляет программу MirrorMaker, которая производит репликацию данных между кластерами Kafka.

    Сведения об использовании MirrorMaker см. в статье [Репликация разделов Apache Kafka с помощью Kafka в HDInsight и MirrorMaker](apache-kafka-mirroring.md).

* **Масштабирование кластера.** HDInsight позволяет изменить количество рабочих узлов (в которых размещается брокер Kafka) после создания кластера. Увеличивайте масштаб кластера по мере увеличения рабочей нагрузки или уменьшайте его масштаб для снижения затрат. Масштабирование можно выполнить на портале Azure, в Azure PowerShell и других интерфейсах управления Azure. Для Kafka выполните повторную балансировку реплик секций после масштабирования. Балансировка секций позволяет Kafka пользоваться преимуществами нового количества рабочих узлов.

    Дополнительные сведения см. в статье [Обеспечение высокого уровня доступности данных с помощью Apache Kafka в HDInsight](apache-kafka-high-availability.md).

* **Модель обмена сообщениями по схеме "публикация — подписка"**. Kafka предоставляет API производителя для публикации записей в разделе Kafka. При подписке на раздел используется API пользователя.

    Дополнительные сведения см. в статье [Приступая к работе с Apache Kafka в HDInsight](apache-kafka-get-started.md).

* **Потоковая обработка.** Kafka часто используется с Apache Storm или Spark для потоковой обработки в режиме реального времени. В Kafka 0.10.0.0 (HDInsight 3.5 и 3.6) представлен API для потоковой передачи, позволяющий создавать соответствующие решения без использования Storm или Spark.

    Дополнительные сведения см. в статье [Приступая к работе с Apache Kafka в HDInsight](apache-kafka-get-started.md).

* **Горизонтальное масштабирование.** В Kafka потоки разделяются между узлами в кластере HDInsight. Процессы пользователя можно связать с отдельными секциями для обеспечения балансировки нагрузки при использовании записей.

    Дополнительные сведения см. в статье [Приступая к работе с Apache Kafka в HDInsight](apache-kafka-get-started.md).

* **Порядок доставки.** В каждой секции записи сохраняются в потоке в том порядке, в котором они были получены. Достаточно связать один процесс пользователя с секцией — и записи будут обрабатываться в определенном порядке.

    Дополнительные сведения см. в статье [Приступая к работе с Apache Kafka в HDInsight](apache-kafka-get-started.md).

## <a name="use-cases"></a>Варианты использования

* **Обмен сообщениями.** Благодаря поддержке модели обмена сообщениями по схеме "публикация — подписка" Kafka часто используется как брокер сообщений.

* **Отслеживание действий.** Kafka предоставляет возможность ведения журнала записей в определенном порядке, поэтому его можно использовать для отслеживания и повторного создания действий. Например, действий пользователя на веб-сайте или в приложении.

* **Агрегирование.** С помощью потоковой обработки можно объединить информацию из разных потоков для ее централизации в качестве оперативных данных.

* **Преобразование.** С помощью потоковой обработки можно объединять и дополнять данные из нескольких входных разделов в один или несколько выходных разделов.

## <a name="architecture"></a>Архитектура

![Конфигурация кластера Kafka](./media/apache-kafka-introduction/kafka-cluster.png)

На этой схеме показана стандартная конфигурация Kafka, в которой предусмотрены группы объектов-получателей, секционирование и репликация, чтобы обеспечить параллельное считывание событий и отказоустойчивость. Служба Apache ZooKeeper разработана для параллельного выполнения надежных транзакций с низкой задержкой, так как она управляет состоянием кластера Kafka. В Kafka записи хранятся в *разделах*. Записи создаются *производителями*, а используются *потребителями*. Производители извлекают записи из *брокеров* Kafka. Каждый рабочий узел в кластере HDInsight — это брокер Kafka. Для каждого объекта-получателя создается одна секция, что позволяет параллельно обрабатывать данные потоковой передачи. Репликация используется для распределения секций между узлами, чтобы предотвратить сбои узлов (брокеров). Секция, обозначенная буквой *(L)*, является ведущей (leader) в определенном разделе. Трафик производителя направляется в ведущую секцию каждого узла в зависимости от состояния, которым управляет ZooKeeper.

Каждый брокер Kafka использует службу Azure "Управляемые диски". Количество дисков определяет пользователь. Общий объем хранилища может достигать 16 ТБ на брокер.

> [!IMPORTANT]
> В Kafka нет сведений о базовом оборудовании (стойке) в центре обработки данных Azure. Чтобы обеспечить правильное распределение секций в базовом оборудовании, см.статью [Обеспечение высокого уровня доступности данных с помощью Apache Kafka в HDInsight](apache-kafka-high-availability.md).

## <a name="next-steps"></a>Дополнительная информация

Ниже приведены ссылки на статьи об использовании Apache Kafka в HDInsight.

* [Get started with Apache Kafka on HDInsight (preview)](apache-kafka-get-started.md) (Приступая к работе с Apache Kafka в HDInsight (предварительная версия))

* [Use MirrorMaker to create a replica of a Kafka on HDInsight cluster (preview)](apache-kafka-mirroring.md) (Создание реплики Kafka в кластере HDInsight с помощью MirrorMaker (предварительная версия))

* [Совместное использование Apache Kafka (предварительная версия) и Storm в HDInsight](../hdinsight-apache-storm-with-kafka.md)

* [Совместное использование Apache Spark и Kafka (предварительная версия) в HDInsight](../hdinsight-apache-spark-with-kafka.md)

* [Подключение к Kafka через виртуальную сеть Azure](apache-kafka-connect-vpn-gateway.md)