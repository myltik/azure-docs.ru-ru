---
title: Настройка расписания установки обновления путем частичной замены ОС для кластеров HDInsight на базе Linux — Azure | Документы Майкрософт
description: Узнайте, как настроить расписание обновления путем частичной замены ОС для кластеров HDInsight.
services: hdinsight
documentationcenter: ''
author: bprakash
manager: asadk
editor: bprakash
ms.assetid: ''
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.date: 03/21/2017
ms.author: bhanupr
ms.openlocfilehash: 42771b9ff0f177b6b31f626d1dd2d07046a53965
ms.sourcegitcommit: 9cdd83256b82e664bd36991d78f87ea1e56827cd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
ms.locfileid: "31409761"
---
# <a name="os-patching-for-hdinsight"></a>Обновление путем частичной замены ОС для кластеров HDInsight 
Являясь управляемой службой Hadoop, HDInsight отвечает за обновление путем частичной замены ОС базовых виртуальных машин, используемых в кластерах HDInsight. Начиная с 1 апреля 2016 года изменена политика обновления путем частичной замены гостевой ОС для кластеров HDInsight под управлением Linux (версии 3.4 или более поздней версии). Цель этой новой политики — значительно сократить число перезагрузок, выполняемых в процессе исправления. Согласно новой политике исправления виртуальных машин в кластерах Linux будут по-прежнему выполняться каждый понедельник или четверг, начиная с 12:00 (UTC), поочередно обслуживая узлы в каждом данном кластере. Однако перезагрузка каждой данной виртуальной машины по причине исправлений в гостевой ОС будет выполняться не чаще одного раза в 30 дней. Кроме того, первая перезагрузка только что созданного кластера будет выполняться не ранее, чем через 30 дней от даты создания кластера. Исправления начнут действовать после перезагрузки виртуальных машин.

## <a name="how-to-configure-the-os-patching-schedule-for-linux-based-hdinsight-clusters"></a>Как настроить расписание обновления путем частичной замены ОС для кластеров HDInsight под управлением Linux
Виртуальные машины в кластере HDInsight нужно время от времени перезагружать для установки важных исправлений системы безопасности. Начиная с 1 августа 2016 года новые кластеры HDInsight под управлением Linux (версии 3.4 или более поздней версии) перезагружаются согласно приведенному ниже расписанию.

1. Виртуальная машина в кластере может быть перезагружена для установки исправлений не чаще, чем один раз на протяжении 30 дней.
2. Перезагрузка происходит после 12:00 (UTC).
3. Процесс перезагрузки виртуальных машин в кластере выполняется в шахматном порядке, поэтому кластер остается доступен.
4. Первая перезагрузка только что созданного кластера будет выполняться не ранее, чем через 30 дней после даты создания кластера.

С помощью действия сценария, описанного в этой статье, можно изменить расписание обновления путем частичной замены ОС следующим образом.
1. Можно включить или отключить автоматическую перезагрузку.
2. Можно задать частоту перезагрузки (в днях между перезагрузками).
3. Можно задать день недели, когда происходит перезагрузка.

> [!NOTE]
> Это действие сценария будет работать только с кластерами HDInsight под управлением Linux, созданными после 1 августа 2016 года. Исправления начнут действовать только после перезагрузки виртуальных машин. 
>

## <a name="how-to-use-the-script"></a>Как использовать сценарий 

Для использования этого сценария требуется следующая информация.
1. Расположение скрипта: https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv01/os-patching-reboot-config.sh.  HDInsight использует этот универсальный код ресурса (URI), чтобы найти и запустить сценарий на всех виртуальных машинах в кластере.
  
2. Типы узлов кластера, к которым применяется сценарий: головной узел, рабочий узел, узел zookeeper. Этот сценарий должен применяться к узлам всех типов в кластере. Если не применить его к какому-либо типу узла, то виртуальные машины этого типа узла продолжат использовать прежнее расписание обновления путем частичной замены ОС.


3.  Параметры. Этот сценарий принимает три числовых параметра.

    | Параметр | Определение |
    | --- | --- |
    | Включение или отключение автоматических перезагрузок. |0 или 1. Значение 0 отключает автоматические перезагрузки, а значение 1 — включает. |
    | Frequency |7–90 (включительно). Число дней до перезагрузки виртуальных машин для установки исправлений, которые требуют перезагрузки. |
    | День недели |1–7 (включительно). Значение 1 указывает, что перезагрузка должна выполняться в понедельник, а 7 — в воскресенью. Например, использование параметров 1 60 2 приведет к автоматической перезагрузке каждые 60 дней (максимум) во вторник. |
    | Сохраняемость |В случае применения действия сценария к существующему кластеру можно пометить сценарий как сохраняемый. Сохраняемые сценарии применяются при добавлении новых рабочих узлов в кластер при операциях масштабирования. |

> [!NOTE]
> Этот сценарий необходимо пометить как сохраняемый, если он применяется к существующему кластеру. В противном случае все новые узлы, созданные операциями масштабирования, будут использовать расписание обновления путем частичной замены ОС по умолчанию.
Если применить сценарий при создании кластера, он сохраняется автоматически.
>

## <a name="next-steps"></a>Дополнительная информация

Конкретные инструкции по использованию действия сценария см. в следующих разделах статьи [Настройка кластеров HDInsight под управлением Linux с помощью действия сценария](hdinsight-hadoop-customize-cluster-linux.md):

* [Использование действия скрипта при создании кластера](hdinsight-hadoop-customize-cluster-linux.md#use-a-script-action-during-cluster-creation)
* [Применение действия скрипта в работающем кластере](hdinsight-hadoop-customize-cluster-linux.md#apply-a-script-action-to-a-running-cluster)
