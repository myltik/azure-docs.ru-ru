---
title: "Управление кластерами Hadoop в HDInsight с помощью портала Azure | Документация Майкрософт"
description: "Узнайте, как создавать кластеры HDInsight и управлять ими с помощью портала Azure."
services: hdinsight
documentationcenter: 
author: mumian
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 5a76f897-02e8-4437-8f2b-4fb12225854a
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/17/2017
ms.author: jgao
translationtype: Human Translation
ms.sourcegitcommit: db7cb109a0131beee9beae4958232e1ec5a1d730
ms.openlocfilehash: 636d58cc3bda38c0fb49412b6bd4cbb96d235858
ms.lasthandoff: 04/18/2017


---
# <a name="manage-hadoop-clusters-in-hdinsight-by-using-the-azure-portal"></a>Управление кластерами Hadoop в HDInsight с помощью портала Azure
[!INCLUDE [selector](../../includes/hdinsight-portal-management-selector.md)]

[Портал Azure][azure-portal] позволяет управлять кластерами Hadoop в Azure HDInsight. Используйте другие вкладки, чтобы перейти к статьям об управлении кластерами Hadoop в HDInsight с помощью других инструментов.

**Предварительные требования**

Перед началом работы с этой статьей необходимо иметь следующее:

* **Подписка Azure**. Ознакомьтесь с [бесплатной пробной версией Azure](https://azure.microsoft.com/documentation/videos/get-azure-free-trial-for-testing-hadoop-in-hdinsight/).

## <a name="open-the-portal"></a>Запуск портала
1. Войдите на портал [https://portal.azure.com](https://portal.azure.com).
2. На портале:

   * В меню слева щелкните **Создать** , чтобы создать новый кластер.

       ![Кнопка создания кластера HDInsight](./media/hdinsight-administer-use-portal-linux/azure-portal-new-button.png)
   * В меню слева щелкните **Кластеры HDInsight** , чтобы просмотреть список существующих кластеров.

       ![Кнопка кластера HDInsight на портале Azure](./media/hdinsight-administer-use-portal-linux/azure-portal-hdinsight-button.png)

       Если кластер HDInsight не отображается, в нижней части списка щелкните **Больше служб** и в разделе **Аналитика** щелкните **Кластеры HDInsight**.

## <a name="create-clusters"></a>Создание кластеров
[!INCLUDE [delete-cluster-warning](../../includes/hdinsight-delete-cluster-warning.md)]

HDInsight работает со множеством компонентов Hadoop. Список проверенных и поддерживаемых компонентов см. в статье [Что представляют собой различные компоненты Hadoop, доступные в HDInsight?](hdinsight-component-versioning.md) Общие сведения о создании кластеров см. в статье [Создание кластеров Hadoop под управлением Linux в HDInsight](hdinsight-hadoop-provision-linux-clusters.md).

## <a name="list-and-show-clusters"></a>Отображение кластеров
1. Войдите на портал [https://portal.azure.com](https://portal.azure.com).
2. В меню слева щелкните **Кластеры HDInsight** , чтобы просмотреть список существующих кластеров.
3. Щелкните имя кластера. Если список кластеров длинный, можно использовать фильтр в верхней части страницы.
4. Щелкните кластер в списке, чтобы просмотреть страницу с общими сведениями:

    ![Основная информация о кластере HDInsight на портале Azure](./media/hdinsight-administer-use-portal-linux/hdinsight-essentials.png)

    **Меню "Обзор":**

   * **Панель мониторинга.** Открывает панель мониторинга кластера, а именно веб-интерфейс Ambari для кластеров под управлением Linux.
   * **Secure Shell**: отображение сведений, необходимых для подключения к кластеру по протоколу SSH.
   * **Изменить масштаб кластера**: позволяет изменить количество рабочих узлов для этого кластера.
   * **Удалить**: удаление кластера.

    **Меню слева:**

   * **Журналы действий.** Отображайте и запрашивайте журналы действий.
   * **Управление доступом (IAM).** Используйте назначение ролей.  Ознакомьтесь со статьей [Использование назначений ролей для управления доступом к ресурсам в подписке Azure](../active-directory/role-based-access-control-configure.md).
   * **Теги** позволяют задавать пары "ключ-значение" для определения пользовательской таксономии облачных служб. Например, можно создать ключ с именем **project**, а затем использовать общее значение для всех служб, связанных с определенным проектом.
   * **Диагностика и решение проблем.** Отображайте сведения об устранении неполадок.
   * **Блокировки.** Добавляйте блокировку во избежание изменения или удаления кластера.
   * **Сценарий автоматизации.** Отображайте и экспортируйте шаблон Azure Resource Manager для кластера. В настоящее время можно экспортировать только зависимую учетную запись хранения Azure. Ознакомьтесь со статьей [Создание кластеров Hadoop под управлением Linux в HDInsight с помощью шаблонов Azure Resource Manager](hdinsight-hadoop-create-linux-clusters-arm-templates.md).
   * **Быстрый запуск**: отображение сведений, необходимых для начала работы с HDInsight.
   * **Средства для HDInsight.** Справочные сведения об инструментах, связанных с HDInsight.
   * **Имя для входа в кластер.** Отображайте сведения о входе в кластер.
   * **Использование ядер в подписке.** Отображайте используемые и доступные ядра для подписки.
   * **Масштабирование кластера**: увеличение или уменьшение количества рабочих узлов в кластере. Ознакомьтесь с разделом [Масштабирование кластеров](hdinsight-administer-use-management-portal.md#scale-clusters).
   * **Secure Shell**: отображение сведений, необходимых для подключения к кластеру по протоколу SSH. Дополнительные сведения см. в статье [Использование SSH с Hadoop на основе Linux в HDInsight из Linux, Unix или OS X](hdinsight-hadoop-linux-use-ssh-unix.md).
   * **Партнер HDInsight**: добавление и удаление текущего партнера HDInsight.
   * **Внешние метахранилища**: просмотр метахранилищ Hive и Oozie. Метахранилища можно настроить только во время создания кластера. Ознакомьтесь с разделом [Использование метахранилища Hive/Oozie](hdinsight-hadoop-provision-linux-clusters.md#use-hiveoozie-metastore).
   * **Действия скрипта**: выполнение bash-скриптов в кластере. См. статью [Настройка кластеров HDInsight под управлением Linux с помощью действия сценария](hdinsight-hadoop-customize-cluster-linux.md).
   * **Приложения.** Добавляйте и удаляйте приложения HDInsight.  Ознакомьтесь со статьей [Установка пользовательских приложений HDInsight](hdinsight-apps-install-custom-applications.md).
   * **Свойства**: просмотр свойств кластера.
   * **Учетные записи хранения.** Просматривайте учетные записи хранения и ключи. Учетные записи хранения настраиваются во время создания кластера.
   * **Идентификатор AAD кластера**:
   * **Новый запрос в службу поддержки**. Вы можете создать запрос в службу поддержки Майкрософт.

6. Щелкните **Свойства**.

    Существуют следующие свойства.

   * **Имя узла**: имя кластера.
   * **URL-адрес кластера**. URL-адрес веб-интерфейса Ambari.
   * **Состояние**: возможны варианты "Прервано", "Принято", "Хранилище кластера подготовлено", "Конфигурация виртуальной машины Azure", "Конфигурация HDInsight", "Оперативный", "Выполняется", "Ошибка", "Удаление", "Удалено", "Время ожидания истекло", "Удаление добавлено в очередь", "Истекло время ожидания удаления", "Ошибка удаления", "Исправление добавлено в очередь", "Смена сертификатов в очереди", "Изменение размера поставлено в очередь" и "Настройка кластера".
   * **Регион**: расположение Azure. Поддерживаемые расположения Azure перечислены в раскрывающемся списке **Регион** на странице [Цены — HDInsight](https://azure.microsoft.com/pricing/details/hdinsight/).
   * **Дата создания.**
   * **Операционная система**: **Windows** или **Linux**.
   * **Тип**: Hadoop, HBase, Storm или Spark.
   * **Версия**. См. раздел [Поддерживаемые версии HDInsight](hdinsight-component-versioning.md).
   * **Подписка**: имя подписки.
   * **Источник данных по умолчанию**: файловая система кластера по умолчанию.
   * **Worker nodes size** (Размер рабочих узлов).
   * **Размер головного узла.**

## <a name="delete-clusters"></a>Удаление кластеров
Удаление кластера не приведет к удалению учетной записи хранения, используемой по умолчанию, или любых других учетных записей, связанных с кластером. Вы всегда сможете заново создать кластер, указав те же учетные записи хранения и те же метахранилища. При повторном создании кластера мы советуем вам использовать новый контейнер больших двоичных объектов по умолчанию.

1. Войдите на [портал][azure-portal].
2. В меню слева щелкните **Кластеры HDInsight** . Если вы не видите **кластеры HDInsight**, сначала щелкните **Больше служб**.
3. Щелкните кластер, который требуется удалить.
4. В верхнем меню щелкните **Удалить** и следуйте инструкциям на экране.

См. также раздел [Приостановка и завершение работы кластеров](#pauseshut-down-clusters).

## <a name="scale-clusters"></a>Масштабирование кластеров
Масштабирование кластера позволяет изменить количество рабочих узлов в кластере, который работает под управлением Azure HDInsight. При этом не требуется повторно создавать кластер.

> [!NOTE]
> Поддерживаются только кластеры HDInsight версии 3.1.3 или более поздней. Если вы не знаете версию кластера, см. страницу «Свойства».  См. раздел [Отображение кластеров](#list-and-show-clusters).
>
>

Ниже представлены возможности, связанные с изменением количества узлов данных в кластере каждого типа, поддерживаемого в HDInsight.

* Hadoop

    Вы можете легко увеличить количество рабочих узлов в работающем кластере Hadoop. Это не помешает обработке заданий в состоянии ожидания и выполнения. В ходе выполнения операции можно также отправлять новые задания. Сбои операции масштабирования обрабатываются корректно, поэтому кластер всегда пребывает в функциональном состоянии.

    Если уменьшить масштаб кластера Hadoop, сократив количество узлов данных, некоторые службы в нем будут перезапущены. Это приведет к сбою всех выполняющихся и ожидающих заданий при завершении операции масштабирования. Однако после завершения операции вы можете повторно отправить задания.
* HBase

    Вы можете с легкостью добавлять и удалять узлы данных в работающем кластере HBase. Балансировка региональных серверов выполняется автоматически в течение нескольких минут после завершения операции масштабирования. Но их также можно сбалансировать вручную, выполнив вход в головной узел кластера и выполнив следующие команды в окне командной строки:

        >pushd %HBASE_HOME%\bin
        >hbase shell
        >balancer

    Дополнительные сведения об использовании оболочки HBase см. []
* Storm

    Вы можете с легкостью добавлять и удалять узлы данных в работающем кластере Storm. Но после успешного завершения операции масштабирования потребуется повторная балансировка топологии.

    Повторную балансировку можно выполнить двумя способами:

  * с помощью веб-интерфейса Storm;
  * с помощью программы командной строки.

    Дополнительные сведения см. в [документации по Apache Storm](http://storm.apache.org/documentation/Understanding-the-parallelism-of-a-Storm-topology.html).

    В кластере HDInsight доступен веб-интерфейс Storm.

    ![HDInsight, Storm, масштабирование, перераспределение](./media/hdinsight-administer-use-portal-linux/hdinsight.portal.scale.cluster.storm.rebalance.png)

    Ниже приведен пример использования команды CLI для повторной балансировки топологии Storm:

        ## Reconfigure the topology "mytopology" to use 5 worker processes,
        ## the spout "blue-spout" to use 3 executors, and
        ## the bolt "yellow-bolt" to use 10 executors
        $ storm rebalance mytopology -n 5 -e blue-spout=3 -e yellow-bolt=10

**Масштабирование кластеров**

1. Войдите на [портал][azure-portal].
2. В меню слева щелкните **Кластеры HDInsight** .
3. Щелкните кластер, который требуется масштабировать.
3. Щелкните **Изменить масштаб кластера**.
4. В поле **Количество рабочих узлов**укажите нужное количество. Максимальное количество узлов кластера зависит от типа подписки Azure. Чтобы увеличить лимит, обратитесь в службу поддержки по вопросам выставления счетов.  Сведения о затратах будут отражать внесенные изменения количества узлов.

    ![HDInsight, Hadoop, HBase, Storm, Spark, масштабирование](./media/hdinsight-administer-use-portal-linux/hdinsight.portal.scale.cluster.png)

## <a name="pauseshut-down-clusters"></a>Приостановка и завершение работы кластеров

Большинство заданий Hadoop представляют собой пакетные задания, выполняемые от случая к случаю. Обычно кластеры Hadoop в течение долгих промежутков времени не используются для обработки данных. В случае с HDInsight ваши данные хранятся в службе хранилища Azure, что позволяет безопасно удалить неиспользуемый кластер.
Плата за кластеры HDInsight взимается, даже когда они не используются. Поскольку стоимость кластера во много раз превышает стоимость хранилища, экономически целесообразно удалять неиспользуемые кластеры.

Этот процесс можно выполнять автоматически несколькими способами:

* С помощью фабрики данных Azure. Дополнительные сведения о создании связанных служб HDInsight по запросу см. в статье [Создание кластеров Hadoop под управлением Linux в HDInsight по запросу с помощью фабрики данных Azure](hdinsight-hadoop-create-linux-clusters-adf.md).
* С помощью Azure PowerShell.  См. статью [Анализ данных о задержке рейсов с помощью Hive в HDInsight](hdinsight-analyze-flight-delay-data.md).
* С помощью интерфейса командной строки Azure. См. статью [Управление кластерами Hadoop в HDInsight с помощью интерфейса командной строки (CLI) Azure](hdinsight-administer-use-command-line.md).
* С помощью пакета SDK для HDInsight .NET. См. статью [Отправка заданий Hadoop в HDInsight](hdinsight-submit-hadoop-jobs-programmatically.md).

Сведения о ценах см. на странице [цен на HDInsight](https://azure.microsoft.com/pricing/details/hdinsight/). Удаление кластера на портале описано в разделе [Удаление кластеров](#delete-clusters).

## <a name="change-passwords"></a>Изменение паролей
Кластер HDInsight может иметь две учетные записи пользователя. Учетная запись пользователя кластера HDInsight (то есть учетная запись пользователя HTTP) и учетная запись пользователя SSH создаются во время создания кластера. С помощью веб-интерфейса Ambari можно изменить имя пользователя и пароль учетной записи, а также действия сценария для изменения учетной записи SSH.

### <a name="change-the-cluster-user-password"></a>Изменение пароля пользователя кластера
С помощью пользовательского веб-интерфейса Ambari можно изменить пароль пользователя кластера. Чтобы войти в Ambari, необходимо указать имя и пароль существующего пользователя.

> [!NOTE]
> Если изменить пароль пользователя (администратора) кластера, это может привести к сбою при выполнении действий сценария для этого кластера. Если у вас есть сохраненные действия сценария, нацеленные на рабочие узлы, они может завершиться ошибкой при добавлении узлов в кластер в ходе изменения размера. Дополнительные сведения о действиях сценариев см. в статье [Настройка кластеров HDInsight под управлением Linux с помощью действия сценария](hdinsight-hadoop-customize-cluster-linux.md).
>
>

1. Войдите в веб-интерфейс Ambari с помощью учетных данных пользователя кластера HDInsight. Имя пользователя по умолчанию — **admin**. URL-адрес — **https://&lt;имя_кластера_HDInsight>azurehdinsight.net**.
2. В верхнем меню щелкните **Admin** (Администратор) и выберите пункт "Manage Ambari" (Управление Ambari).
3. В меню слева щелкните **Users**(Пользователи).
4. Щелкните **Администратор**.
5. Щелкните **Change Password**(Изменить пароль).

Ambari изменит пароль на всех узлах в кластере.

### <a name="change-the-ssh-user-password"></a>Изменение пароля пользователя SSH
1. С помощью текстового редактора сохраните указанный ниже текст в файл с именем **changepassword.sh**.

   > [!IMPORTANT]
   > Необходимо использовать редактор, который использует LF в качестве конца строки. Если редактор использует CRLF, сценарий не будет работать.
   >
   >

        #! /bin/bash
        USER=$1
        PASS=$2

        usermod --password $(echo $PASS | openssl passwd -1 -stdin) $USER
2. Передайте файл в расположение хранилища, которое будет использоваться из HDInsight с помощью адреса HTTP или HTTPS. Например, в такое общедоступное хранилище файлов, как OneDrive или хранилище BLOB-объектов Azure. Сохраните универсальный код ресурса (URI) (адрес HTTP или HTTPS) файла, так как он понадобится на следующем шаге.
3. На портале Azure щелкните **Кластеры HDInsight**.
4. Щелкните свой кластер HDInsight.
4. Щелкните **Действия скрипта**.
4. В колонке **Действия скрипта** выберите **Отправить новое**. Когда отобразится колонка **Отправка действия скрипта**, введите следующие сведения.

   | Поле | Значение |
   | --- | --- |
   | Имя |Измените пароль SSH |
   | URI bash-скрипта |Универсальный код ресурса (URI) файла changepassword.sh. |
   | Узлы (головные, рабочие, Nimbus, супервизора, Zookeeper и т. д.). |✓ для всех перечисленных типов узлов. |
   | Параметры |Введите имя пользователя SSH и новый пароль. Между именем пользователя и паролем должен быть один пробел. |
   | Сохранить этот скрипт… |Оставьте это поле без изменений. |
5. Выберите **Создать**, чтобы применить сценарий. После выполнения сценария вы сможете подключиться к кластеру с помощью SSH с новым паролем.

## <a name="grantrevoke-access"></a>Предоставление и отмена доступа
В кластерах HDInsight имеются следующие веб-службы HTTP (все эти службы имеют конечные точки RESTful):

* ODBC
* JDBC
* Ambari
* Oozie
* Templeton

По умолчанию эти службы предоставляются для доступа. Вы можете отменить или предоставить доступ с помощью [Azure CLI](hdinsight-administer-use-command-line.md#enabledisable-http-access-for-a-cluster) и [Azure PowerShell](hdinsight-administer-use-powershell.md#grantrevoke-access).

## <a name="find-the-subscription-id"></a>Поиск идентификатора подписки

**Поиск идентификаторов подписок Azure**

1. Войдите на [портал][azure-portal].
2. Щелкните **Подписки**. У всех подписок есть имя и идентификатор.

Каждый кластер привязывается к подписке Azure. Идентификатор подписки отображается на элементе кластера **Основное**. См. раздел [Отображение кластеров](#list-and-show-clusters).

## <a name="find-the-resource-group"></a>Поиск группы ресурсов
В режиме Azure Resource Manager каждый кластер HDInsight создается с группой Azure Resource Manager. Группу Resource Manager, к которой принадлежит кластер, можно увидеть:

* в списке кластеров в столбце **Группа ресурсов** ;
* на плитке кластера **Основное** .  

См. раздел [Отображение кластеров](#list-and-show-clusters).

## <a name="find-the-default-storage-account"></a>Поиск учетной записи хранения по умолчанию
Каждый кластер HDInsight имеет учетную запись хранения, используемую по умолчанию. Учетную запись хранения по умолчанию и ее ключи можно просмотреть в разделе **Учетные записи хранения**. См. раздел [Отображение кластеров](#list-and-show-clusters).

## <a name="run-hive-queries"></a>Выполнение запросов Hive
Задание Hive нельзя выполнить непосредственно из портала Azure. Для этого можно использовать представление Hive в веб-интерфейсе Ambari.

**Выполнение запросов Hive с помощью представления Hive в Ambari**

1. Войдите в веб-интерфейс Ambari с помощью учетных данных пользователя кластера HDInsight. Имя пользователя по умолчанию — **admin**. URL-адрес — **https://&lt;имя_кластера_HDInsight>azurehdinsight.net**.
2. Откройте представление Hive, как показано на снимке экрана ниже:  

    ![Представление Hive в HDInsight](./media/hdinsight-administer-use-portal-linux/hdinsight-hive-view.png)
3. В верхнем меню щелкните **Query** (Запрос).
4. Введите запрос Hive в **редактор запросов**, а затем нажмите кнопку **Execute** (Выполнить).

## <a name="monitor-jobs"></a>Мониторинг заданий
Дополнительные сведения см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md#monitoring).

## <a name="browse-files"></a>Обзор файлов
На портале Azure можно просмотреть содержимое контейнера по умолчанию.

1. Войдите на портал [https://portal.azure.com](https://portal.azure.com).
2. В меню слева щелкните **Кластеры HDInsight** , чтобы просмотреть список существующих кластеров.
3. Щелкните имя кластера. Если список кластеров длинный, можно использовать фильтр в верхней части страницы.
4. Щелкните **Учетные записи хранения** в меню слева для кластера.
5. Щелкните учетную запись хранения.
7. Щелкните элемент **Большие двоичные объекты** .
8. Щелкните имя контейнера по умолчанию.

## <a name="monitor-cluster-usage"></a>Мониторинг использования кластера
В колонке кластера HDInsight в разделе **Использование** отображаются сведения о количестве ядер, доступных для HDInsight в рамках вашей подписки, а также о количестве ядер, выделенных для этого кластера, и их распределении между узлами в кластере. См. раздел [Отображение кластеров](#list-and-show-clusters).

> [!IMPORTANT]
> Для мониторинга служб, предоставляемых кластером HDInsight, необходимо использовать интерфейс Ambari Web или API REST Ambari. Дополнительные сведения об использовании Ambari см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](hdinsight-hadoop-manage-ambari.md).
>
>

## <a name="connect-to-a-cluster"></a>Подключение к кластеру
Дополнительные сведения см. в статье [Использование Hive с Hadoop в HDInsight с применением протокола SSH](hdinsight-hadoop-use-hive-beeline.md#a-idsshaconnect-with-ssh).

## <a name="next-steps"></a>Дальнейшие действия
Из этой статьи вы узнали, как создать кластер HDInsight с помощью портала и как открыть программу командной строки Hadoop. Для получения дополнительных сведений ознакомьтесь со следующими статьями:

* [Администрирование HDInsight с помощью Azure PowerShell](hdinsight-administer-use-powershell.md)
* [Администрирование HDInsight с помощью CLI Azure](hdinsight-administer-use-command-line.md)
* [Создание кластеров HDInsight](hdinsight-provision-clusters.md)
* [Использование Hive в HDInsight](hdinsight-use-hive.md)
* [Использование Pig в HDInsight](hdinsight-use-pig.md)
* [Использование Hadoop Sqoop в HDInsight](hdinsight-use-sqoop.md)
* [Начало работы с Azure HDInsight](hdinsight-hadoop-linux-tutorial-get-started.md)
* [Какая версия Hadoop включена в Azure HDInsight?](hdinsight-component-versioning.md)

[azure-portal]: https://portal.azure.com
[image-hadoopcommandline]: ./media/hdinsight-administer-use-portal-linux/hdinsight-hadoop-command-line.png "Командная строка Hadoop"

