<properties 
	pageTitle="Функциональные возможности операционной системы для веб-приложений службы приложений Azure" 
	description="Дополнительные сведения о функциональных возможностях ОС, доступных для веб-приложений на службе приложений Azure" 
	services="app-service\web" 
	documentationCenter="" 
	authors="cephalin" 
	manager="wpickett" 
	editor="mollybos"/>

<tags 
	ms.service="app-service-web" 
	ms.workload="web" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="04/08/2015" 
	ms.author="cephalin"/>

# Функциональные возможности операционной системы для веб-приложений службы приложений Azure #

В данной статье описаны общие базовые функции операционной системы, доступные для всех приложений, работающих на [службы приложения Azure](http://go.microsoft.com/fwlink/?LinkId=529714) веб-приложений. Данные функциональные возможности включают в себя доступ к файлам, сети и реестру, а также диагностику и журналы событий. 

<a id="tiers"></a>
## Уровни обслуживания плана службы приложений
Веб-приложения запускают приложения клиента в мультитенантной среде размещения. Веб-приложения, развернутые в уровнях обслуживания **Free** и **Shared**, выполняются в рабочих процессах на общих виртуальных машинах, а веб-приложения, развернутые в уровнях обслуживания **Standard** и **Premium**, выполняются на виртуальных машинах, которые выделены специально для веб-приложений, связанных с одним клиентом.

Поскольку веб-приложений поддерживают легкое масштабирование между различными уровнями, конфигурация безопасности для веб-приложений не изменится. Это обеспечивает отсутствие внезапного изменения режима работы веб-приложений и неожиданных сбоев при переключении веб-приложения с одного режима на другой.

<a id="developmentframeworks"></a>
## Платформы разработки

От уровня веб-приложений зависит объем доступных веб-приложениям вычислительных ресурсов (ЦП, дисковое пространство, память и исходящий сетевой трафик). При этом спектр доступных приложениям функциональных возможностей платформы остается неизменным в любом уровне масштабирования.

Веб-приложения поддерживают широкий спектр платформ разработки, включая ASP.NET, классический ASP, node.js, PHP и python, выполняемых в виде расширений в службах IIS. Чтобы упростить и нормализовать конфигурацию безопасности, веб-приложения обычно используют различные платформы разработки с параметрами по умолчанию. Один из подходов к настройке веб-приложений может заключаться в настройке контактной зоны API и функциональных возможностей для каждой отдельной платформы разработки. Вместо этого веб-приложения используют более общий подход, реализуя общий базовый уровень функциональных возможностей операционной системы независимо от среды разработки веб-приложения.

В следующих разделах приведены общие виды функциональных возможностей операционной системы, доступных веб-приложениям в Azure.


<a id="FileAccess"></a>
##Доступ к файлам

В веб-приложениях используются разные диски, включая локальные и сетевые диски.

<a id="LocalDrives"></a>
### Локальные диски

По своей сути веб-приложения являются службой, выполняемой поверх инфраструктуры Azure PaaS (платформа как услуга). В результате локальные диски, "подключенные" к виртуальной машине, - это те же типы дисков, которые доступны любой рабочей роли в Azure. Сюда входит диск операционной системы (диск D:\), диск приложений, содержащий файлы пакета CSPKG Azure, которые используются исключительно веб-приложениями (и недоступны для клиентов), и "пользовательский" диск (диск C:\), размер которого зависит от размера виртуальной машины.

<a id="NetworkDrives"></a>
### Сетевые диски (общие UNC-ресурсы)

Одно из уникальных свойств веб-приложений, позволяющее упростить обслуживание и развертывание веб-приложений, - это возможность хранения всего пользовательского содержимого на наборе общих UNC-ресурсов. Эта модель очень хорошо согласуется с распространенным шаблоном хранилища содержимого, который используется локальными средами размещения веб-сайтов, имеющими несколько серверов с балансировкой нагрузки. 

Внутри веб-приложений присутствует определенное число общих UNC-ресурсов, созданных в каждом центре обработки данных. Процент пользовательского содержимого для всех клиентов в каждом центре обработки данных выделяется для каждого общего UNC-ресурса. Кроме того, все файловое содержимое для одной клиентской подписки всегда размещается в одном общем UNC-ресурсе. 

Обратите внимание, что из-за особенностей работы облачных служб виртуальная машина, отвечающая за размещение общего UNC-ресурса, будет периодически меняться. Гарантируется, что общие UNC-ресурсы будут подключаться к различным виртуальным машинам во время их включения и отключения в рамках выполнения обычных облачных операций. По этой причине в веб-приложениях никогда не следует жестко программировать предположение о том, что информация о машине в пути UNC со временем будет оставаться неизменной. Вместо этого они должны использовать удобный *faux* абсолютный путь **D:\home\site**, предоставляемый веб-приложениями. Ложный абсолютный путь предоставляет портативный и независимый от приложений и пользователей метод указания ссылки на свое приложение. С помощью пути **D:\home\site** можно переносить общие файлы из приложения в приложение без необходимости настраивать новый абсолютный путь для каждой передачи.

<a id="TypesOfFileAccess"></a>
### Типы доступа к файлам для веб-приложения

В состав подписки каждого клиента входит зарезервированная структура каталогов на определенном общем UNC-ресурсе в центре обработки данных. У клиента может быть несколько веб-приложений, созданных в конкретном центре обработки данных, поэтому все каталоги, относящиеся к одной клиентской подписке, создаются на одном общем UNC-ресурсе. Общий ресурс может содержать каталоги, например, для содержимого, журналов ошибок и диагностики, а также более ранних версий веб-приложения, созданных системой управления версиями. Каталоги веб-приложения клиента доступны для чтения и записи во время выполнения для кода приложения веб-приложения.

На локальных дисках, подключенных к виртуальной машине, где выполняется веб-приложение, служба веб-приложений резервирует часть места на диске C:\ под временное локальное хранилище для конкретного веб-приложения. Хотя веб-приложение имеет полный доступ на чтение и запись к собственному временному локальному хранилищу, код приложения не может использовать это хранилище напрямую. Наоборот, цель состоит в том, чтобы предоставить временное хранилище файлов для служб IIS и платформ веб-приложений. Служба веб-приложений также ограничивает объем временного локального хранилища для каждого веб-приложения, чтобы предотвратить использование чрезмерных объемов памяти отдельными веб-приложениями.

Двумя примерами того, как веб-приложения используют временное локальное хранилище, являются каталог для временных файлов ASP.NET и каталог для сжатых файлов IIS. Система компиляции ASP.NET использует каталог "Temporary ASP.NET Files" в качестве временного расположения кэша компиляции. Службы IIS используют каталог "IIS Temporary Compressed Files" для хранения сжатых выходных данных ответа. Оба эти типа использования файлов (а также и другие) в веб-приложениях переназначаются временному локальному хранилищу для конкретных веб-приложений. Результатом такого переназначения является неизменная работа функциональных возможностей.

Каждое приложение в веб-приложениях выполняется как случайное уникальное удостоверение рабочего процесса с низкими привилегиями, называемое удостоверением пула приложений. Подробнее такое удостоверение описано здесь: [http://www.iis.net/learn/manage/configuring-security/application-pool-identities](http://www.iis.net/learn/manage/configuring-security/application-pool-identities). Код приложения использует это удостоверение в целях базового доступа только для чтения к диску операционной системы (диск D:\). Это означает, что код приложения может перечислять стандартные структуры каталогов и считывать стандартные файлы на диске операционной системы. Хотя такой уровень доступа может показаться довольно обширным, те же каталоги и файлы доступны при подготовке рабочей роли в размещенной службе Azure и считывании содержимого диска. 

<a name="multipleinstances"></a>
### Доступ к файлам в нескольких экземплярах

Содержимое приложения находится в домашнем каталоге, и веб-приложения могут осуществлять запись в него. Если веб-приложение выполняется в нескольких экземплярах, домашний каталог используется совместно всеми этими экземплярами, чтобы все они могли просматривать один и тот же каталог. Например, если веб-приложение сохраняет отправленные файлы в домашний каталог, эти файлы сразу же становятся доступны всем экземплярам. 

<a id="NetworkAccess"></a>
## Доступ к сети
Код приложения может использовать протоколы на базе TCP/IP и UDP для установки исходящих сетевых подключений к доступным из Интернета конечным точкам, предоставляющим внешние службы. Приложения могут использовать эти же протоколы для подключения к службам в Azure, например путем установки HTTPS-подключений к SQL Azure.

Также у приложений есть ограниченная возможность установить одно локальное подключение с замыканием на себя и заставить приложение прослушивать этот локальный сокет замыкания на себя. Эта возможность предназначена главным образом для того, чтобы использовать приложения, прослушивающие локальные сокеты замыкания на себя. Обратите внимание, что приложение каждого клиента обращается к "частному" подключению с замыканием на себя. Приложение "А" не может прослушивать локальный сокет замыкания на себя, созданный приложением "Б".

Именованные каналы также поддерживаются в качестве механизма межпроцессного взаимодействия (IPC) между различными процессами, которые совместно обеспечивают работу веб-приложения. Например, модуль FastCGI IIS использует именованные каналы для координации отдельных процессов, обеспечивающих работу страниц PHP.


<a id="Code"></a>
## Выполнение кода, процессы и память
Как отмечалось ранее, веб-приложения выполняются внутри рабочих процессов с низкими привилегиями, используя случайное удостоверение пула приложений. Код приложения имеет доступ к области памяти, связанной с рабочим процессом, а также любыми дочерними процессами, которые могут порождаться процессами CGI или другими приложениями. Однако веб-приложение одного клиента не может получить доступ к памяти или данным веб-приложения другого клиента, даже если он находится на той же виртуальной машине.

Приложения могут выполнять скрипты или страницы, созданные на базе поддерживаемых платформ разработки веб-приложений. Веб-приложения не настраивают параметры платформ веб-приложений для получения более ограниченных режимов. Например, приложения ASP.NET, выполняемые в веб-приложении, имеют полное доверие в отличие от режима более ограниченного доверия. Платформы приложений, в том числе классические ASP и ASP.NET, могут вызвать внутрипроцессные COM-компоненты (но не внепроцессные COM-компоненты), например ADO (объекты данных ActiveX), зарегистрированные по умолчанию в операционной системе Windows.

Веб-приложения могут создавать и запускать произвольный код. Веб-приложение может создать командную оболочку или запустить скрипт PowerShell. Тем не менее, хотя веб-приложением могут порождаться процессы и произвольный код, исполняемые программы и скрипты по-прежнему требуют прав доступа, назначаемых родительскому пулу приложений. Например, веб-приложение может породить исполняемый файл, который выполняет исходящий вызов HTTP, но тот же самый исполняемый файл не может попытаться отменить привязку IP-адреса виртуальной машины к его сетевой карте. Коду с низким уровнем привилегий разрешено выполнять исходящий сетевой вызов, но для перенастройки параметров сети на виртуальной машине требуются права администратора.


<a id="Diagnostics"></a>
## Журналы диагностики и события
Сведения журнала являются другим набором данных, к которому пытаются получить доступ некоторые веб-приложения. Типы данных журнала, которые доступны коду, выполняемому в веб-приложении, включают в себя диагностическую информацию и сведения журналов, создаваемые веб-приложением и легко доступные веб-приложению. 

Например, журналы HTTP W3C, созданные активным веб-приложением, доступны либо в каталоге журнала в сетевой папке, созданной для данного веб-приложения, либо в хранилище больших двоичных объектов, если клиент настроил ведение журналов W3C в этом хранилище. Последний вариант позволяет собирать больше журналов без риска превышения лимитов хранилища файлов, связанных с сетевой папкой.

Точно также можно регистрировать диагностическую информацию реального времени из приложений .NET с помощью инфраструктуры трассировки и диагностики .NET, при этом имеется возможность записывать данные трассировки в сетевую папку веб-приложения или в хранилище BLOB-объектов.

Веб-приложениям в Azure недоступны следующие области ведения журналов диагностики и трассировки: события трассировки событий Windows и общие журналы событий Windows (например, журналы событий системы, приложений и безопасности). Поскольку данные трассировки событий Windows могут стать видимыми в рамках всей машины (при использовании подходящих ACL), доступ на чтение и запись к событиям трассировки событий Windows блокируется. Разработчики могут заметить, что вызовы API для чтения и записи событий трассировки событий Windows и общих журналов событий Windows работают, но это вызвано тем, что веб-приложения "подделывают" такие вызовы, чтобы они выглядели успешными. На самом деле код веб-приложения не имеет доступа к этим данным событий.

<a id="RegistryAccess"></a>
## Доступ к реестру
Приложения имеют доступ только для чтения к большей части реестра на виртуальной машине, где они выполняются. На практике это означает, что разделы реестра, которые предоставляют локальным группам "Пользователи" доступ только для чтения, доступны веб-приложениям. Одной областью реестра, в настоящее время не поддерживающей доступ для чтения или записи, является HKEY\_CURRENT\_USER.

Запись в реестр заблокирована, в том числе доступ к разделам реестра для отдельных пользователей. С точки зрения приложения в облачных средах никогда не следует полагаться на возможность записи в реестр, так как приложения перемещаются между разными виртуальными машинами. Единственным постоянным хранилищем для записи, на которое может полагаться веб-приложение, является структура каталогов содержимого для отдельных веб-приложений, хранящаяся в общих UNC-ресурсах службы веб-приложений. 

>[AZURE.NOTE] Если вы хотите начать работу со службой приложений Azure еще до создания учетной записи Azure, перейдите на страницу [ознакомительной версии службы приложений](http://go.microsoft.com/fwlink/?LinkId=523751). Там вы сможете сразу создать свое первое веб-приложение, правда срок его службы будет ограничен. Никаких кредитных карт и обязательств.

## Изменения
* Сведения об изменении веб-сайтов на службу приложений см. в статье [Служба приложений Azure и ее влияние на существующие службы Azure](http://go.microsoft.com/fwlink/?LinkId=529714).
* Сведения о переходе со старого портала на новый см. в статье [Справочная информация о навигации по предварительной версии портала](http://go.microsoft.com/fwlink/?LinkId=529715).


<!--HONumber=52-->