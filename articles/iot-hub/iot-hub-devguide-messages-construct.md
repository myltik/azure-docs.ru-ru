---
title: Общие сведения о формате сообщений Центра Интернета вещей Azure | Документы Майкрософт
description: Руководство разработчика — сведения о формате и ожидаемом содержимом сообщений Центра Интернета вещей.
services: iot-hub
documentationcenter: .net
author: dominicbetts
manager: timlt
editor: ''
ms.assetid: 3fc5f1a3-3711-4611-9897-d4db079b4250
ms.service: iot-hub
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/20/2018
ms.author: dobett
ms.openlocfilehash: 5979c0d79a0abd9897fd3970ccea1d9ba07f9dfd
ms.sourcegitcommit: 20d103fb8658b29b48115782fe01f76239b240aa
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2018
---
# <a name="create-and-read-iot-hub-messages"></a>Создание и чтение сообщений Центра Интернета вещей

Для поддержки эффективного взаимодействия, независимого от протоколов, Центр Интернета вещей задает общий формат сообщений для всех протоколов для устройств. Этот формат сообщения используется для сообщений, передаваемых [с устройства в облако][lnk-d2c] и [из облака на устройство][lnk-c2d]. 

[!INCLUDE [iot-hub-basic](../../includes/iot-hub-basic-partial.md)]

[Сообщение Центра Интернета вещей][lnk-messaging] состоит из следующих компонентов.

* Набор *свойств системы*. Свойства, которые интерпретирует или задает Центр Интернета вещей. Этот набор определяется предварительно.
* Набор *свойств приложения*. Словарь свойств строки, которые приложение может задать и использовать без необходимости десериализации текста сообщения. Центр Интернета вещей никогда не изменяет эти свойства.
* Непрозрачная двоичная основная часть.

Имена и значения свойств могут содержать только буквенно-цифровые символы ASCII и символы ```{'!', '#', '$', '%, '&', "'", '*', '+', '-', '.', '^', '_', '`', '|', '~'}``` при  

* отправке сообщений с устройства в облако по протоколу HTTPS;
* Отправка сообщений из облака на устройство.

Дополнительные сведения о способах кодировки и декодирования сообщений, отправляемых с помощью разных протоколов, см. в статье, посвященной [пакетам SDK для Azure IoT][lnk-sdks].

В следующей таблице указаны системные свойства в сообщениях Центра Интернета вещей.

| Свойство | ОПИСАНИЕ |
| --- | --- |
| MessageId |Задаваемый пользователем идентификатор сообщения, используемый для шаблонов типа "запрос-ответ". Формат: строка с учетом регистра (длиной до 128 знаков), состоящая из букв и цифр в 7-битовом формате ASCII + `{'-', ':',’.', '+', '%', '_', '#', '*', '?', '!', '(', ')', ',', '=', '@', ';', '$', '''}`. |
| Порядковый номер |Число (уникальное для каждой очереди устройства), которое Центр Интернета вещей назначает каждому сообщению, отправленному из облака на устройство. |
| Кому |Место назначения, которое указывается в сообщениях, отправляемых [из облака на устройство][lnk-c2d]. |
| ExpiryTimeUtc |Дата и время истечения срока действия сообщения. |
| EnqueuedTime |Дата и время получения сообщения, отправленного [из облака на устройство][lnk-c2d], Центром Интернета вещей. |
| CorrelationId |Строковое свойство в сообщении ответа, которое обычно содержит идентификатор сообщения запроса в шаблонах "запрос-ответ". |
| UserId |Идентификатор, используемый для указания источника сообщений. Если сообщения создает центр Интернета вещей, для этого параметра задается значение `{iot hub name}`. |
| Ack |Генератор отзывов на сообщения. Это свойство используется в сообщениях, отправляемых из облака в устройство, чтобы запросить у Центра Интернета вещей отправку отзыва после того, как сообщение будет использовано устройством. Возможные значения: **none** (по умолчанию) — отзывы не создаются, **positive** — отзыв будет получен, когда исходное сообщение будет передано, **negative** — отзыв будет получен, когда истечет срок действия исходного сообщения (или будет превышен лимит доставок) и при этом устройство его не примет, **full** — активированы значения positive и negative. Дополнительные сведения см. в разделе [Отзыв на сообщение][lnk-feedback]. |
| ConnectionDeviceId |Центр Интернета вещей устанавливает этот идентификатор в сообщениях, отправляемых с устройства в облако. Содержит идентификатор **deviceId** устройства, отправившего сообщение. |
| ConnectionDeviceGenerationId |Центр Интернета вещей устанавливает этот идентификатор в сообщениях, отправляемых с устройства в облако. Содержит идентификатор **generationId** (согласно разделу [Device identity properties][lnk-device-properties] (Свойства удостоверений устройств)) устройства, отправившего сообщение. |
| ConnectionAuthMethod |Центр Интернета вещей устанавливает этот метод проверки подлинности в сообщениях, отправляемых с устройства в облако. Это свойство содержит сведения о методе проверки подлинности, используемом для аутентификации устройства, отправляющего сообщение. Дополнительные сведения см. в разделе [Свойства для защиты от спуфинга][lnk-antispoofing]. |
| CreationTimeUtc | Дата и время создания сообщения на устройстве. На устройстве это значение должно быть задано явно. |

## <a name="message-size"></a>Размер сообщения

Центр Интернета вещей измеряет размер сообщения вне зависимости от протокола, учитывая только фактический объем полезных данных. Размер в байтах вычисляется как сумма следующих показателей:

* размер текста в байтах;
* размер в байтах всех значений свойств системы сообщений;
* размер в байтах всех имен и значений свойств пользователей.

Имена и значения свойств ограничены символами ASCII, то есть длина строк равна размеру в байтах.

## <a name="next-steps"></a>Дополнительная информация

Сведения об ограничениях на размер сообщений в Центре Интернета вещей см. в справочнике [по квотам и регулированию Центра Интернета вещей][lnk-quotas].

Сведения о создании и чтении сообщений Центра Интернета вещей на разных языках программирования см. в руководствах по [началу работы][lnk-get-started].

[lnk-messaging]: iot-hub-devguide-messaging.md
[lnk-quotas]: iot-hub-devguide-quotas-throttling.md
[lnk-get-started]: iot-hub-get-started.md
[lnk-sdks]: iot-hub-devguide-sdks.md
[lnk-c2d]: iot-hub-devguide-messages-c2d.md
[lnk-d2c]: iot-hub-devguide-messages-d2c.md
[lnk-feedback]: iot-hub-devguide-messages-c2d.md#message-feedback
[lnk-device-properties]: iot-hub-devguide-identity-registry.md#device-identity-properties
[lnk-antispoofing]: iot-hub-devguide-messages-d2c.md#anti-spoofing-properties
