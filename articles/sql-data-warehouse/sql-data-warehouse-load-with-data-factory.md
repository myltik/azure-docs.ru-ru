---
title: Загрузка данных в хранилище данных SQL Azure (фабрика данных) | Документация Майкрософт
description: В этом руководстве вы загрузите данные в хранилище данных SQL Azure, используя фабрику данных Azure и базу данных SQL Server в качестве источника данных.
services: sql-data-warehouse
documentationcenter: NA
author: ckarst
manager: jhubbard
editor: ''
tags: azure-sql-data-warehouse;azure-data-factory
ms.service: sql-data-warehouse
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.custom: loading
ms.date: 02/08/2017
ms.author: cakarst;barbkess
ms.openlocfilehash: 6399f1a3390119685c1c9fd7332937e0cdb6f9ea
ms.sourcegitcommit: 3a4ebcb58192f5bf7969482393090cb356294399
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/12/2018
ms.locfileid: "30961703"
---
# <a name="load-data-into-sql-data-warehouse-with-data-factory"></a>Загрузка данных в хранилище данных SQL с помощью фабрики данных

Фабрику данных Azure можно использовать для загрузки данных в хранилище данных SQL Azure из любых [поддерживаемых исходных хранилищ данных](../data-factory/copy-activity-overview.md). Например, с помощью фабрики данных можно загрузить данные из базы данных SQL Azure или базы данных Oracle в хранилище данных SQL. В руководстве в этой статье показано, как загрузить данные из локальной базы данных SQL Server в хранилище данных SQL.

**Оценка времени**. Для работы с этим руководством потребуется около 10–15 минут (при условии, что предварительные требования уже выполнены).

## <a name="prerequisites"></a>предварительным требованиям

- **База данных SQL Server** с таблицами, содержащими данные, которые требуется скопировать в хранилище данных SQL.  

- **Хранилище данных SQL.** Если у вас еще нет хранилища данных, создайте его, как описано в статье [Создание хранилища данных SQL Azure](sql-data-warehouse-get-started-provision.md).

- **Учетная запись хранения Azure.** Если у вас еще нет учетной записи хранения, узнайте, как [ее создать](../storage/common/storage-create-storage-account.md). Чтобы оптимизировать производительность, разместите учетную запись хранения и хранилище данных в одном регионе Azure.

## <a name="configure-a-data-factory"></a>Настройка фабрики данных
1. Войдите на [портал Azure][].
2. Найдите хранилище данных и щелкните, чтобы открыть его.
3. В главной колонке щелкните **Загрузка данных** > **Фабрика данных Azure**.

    ![Запуск мастера загрузки данных](media/sql-data-warehouse-load-with-data-factory/launch-load-data-wizard.png)

4. Если в вашей подписке Azure нет фабрики данных, то вы увидите диалоговое окно **Новая фабрика данных** на отдельной вкладке браузера. Введите требуемые данные и щелкните **Создать**. После создания фабрики данных диалоговое окно **Новая фабрика данных** закроется, и вы увидите диалоговое окно **Select Data Factory** (Выбор фабрики данных).

    Если в вашей подписке Azure уже есть одна или несколько фабрик данных, то, вы увидите диалоговое окно **Select Data Factory** (Выбор фабрики данных). В этом диалоговом окне можно выбрать существующую фабрику данных или щелкнуть **Create new data factory** (Создать новую фабрику данных), чтобы создать новую.

    ![Настройка фабрики данных](media/sql-data-warehouse-load-with-data-factory/configure-data-factory.png)

5. В диалоговом окне **Выбор фабрики данных** параметр **Загрузить данные** выбран по умолчанию. Щелкните **Далее**, чтобы начать создание задачи загрузки данных.

## <a name="configure-the-data-factory-properties"></a>Настройка свойств фабрики данных
Создав фабрику данных, переходите к настройке расписания загрузки данных.

1. В качестве **имени задачи** введите **DWLoadData-fromSQLServer**.
2. Используйте параметр по умолчанию **Запустить один раз** и нажмите кнопку **Далее**.

    ![Настройка расписания загрузки](media/sql-data-warehouse-load-with-data-factory/configure-load-schedule.png)

## <a name="configure-the-source-data-store-and-gateway"></a>Настройка исходного хранилища данных и шлюза
Теперь для фабрики данных нужно указать локальную базу данных SQL Server для загрузки данных.

1. Выберите **SQL Server** в каталоге хранилищ данных, поддерживаемых в качестве источника данных, и нажмите кнопку **Далее**.

    ![Выбор источника SQL Server](media/sql-data-warehouse-load-with-data-factory/choose-sql-server-source.png)

2. Откроется диалоговое окно **Выбор локальной базы данных SQL Server**. Первое поле **Имя подключения** заполнено автоматически. Во втором поле нужно указать имя **шлюза**. При использовании существующей фабрики данных, у которой уже имеется шлюз, можно повторно использовать его, выбрав этот шлюз из раскрывающегося списка. Щелкните ссылку **Создать шлюз**, чтобы создать шлюз управления данными.  

    > [!NOTE]
    > Если исходное хранилище данных расположено в локальной среде или в виртуальной машине IaaS Azure, то шлюз управления данными указывать необязательно. Шлюз связан с фабрикой данных по схеме "один к одному". Он не может использоваться другой фабрикой данных, но может использоваться несколькими задачами загрузки в одной фабрике данных. Шлюз можно использовать для подключения к нескольким хранилищам данных при выполнении задач загрузки данных.
    >
    > Дополнительные сведения о шлюзе см. в статье [Шлюз управления данными](../data-factory/v1/data-factory-data-management-gateway.md).

3. Откроется диалоговое окно **Создание шлюза**. В качестве имени введите **GatewayForDWLoading** и нажмите кнопку **Создать**.

4. Откроется диалоговое окно **Настройка шлюза**. Щелкните ссылку **Launch express setup on this computer** (Запустить экспресс-установку на этом компьютере), чтобы автоматически скачать, установить и зарегистрировать шлюз управления данными на текущем компьютере. Ход выполнения отображается во всплывающем окне. Если этот компьютер не может подключиться к хранилищу данных, то можно вручную [скачать и установить шлюз](https://www.microsoft.com/download/details.aspx?id=39717) на компьютере, который может подключиться к хранилищу данных, а затем использовать ключ для регистрации.
    > [!NOTE]
    > Экспресс-установка по умолчанию выполняется с помощью Microsoft Edge и Internet Explorer. Если вы используете Google Chrome, сначала установите расширение ClickOnce из интернет-магазина Chrome.

    ![Запуск экспресс-установки](media/sql-data-warehouse-load-with-data-factory/launch-express-setup.png)

5. Дождитесь завершения установки шлюза. После регистрации и подключения шлюза всплывающее окно закроется, а новый шлюз отобразится в поле шлюза. Заполните остальные обязательные поля, а затем нажмите кнопку **Далее**.
    - **Имя сервера**: имя локального сервера SQL.
    - **Имя базы**: имя базы данных сервера SQL.
    - **Credential encryption** (Шифрование учетных данных). Используйте значение по умолчанию (By web browser (В браузере)).
    - **Тип проверки подлинности**: выберите тип проверки подлинности, который вы используете.
    - **Имя пользователя** и **пароль**: введите имя и пароль для пользователя с правами на копирование данных.

    ![Запуск экспресс-установки](media/sql-data-warehouse-load-with-data-factory/configure-sql-server.png)

6. Затем вам нужно выбрать таблицы, из которых будут копироваться данные. Эти таблицы можно отфильтровать с помощью ключевых слов. Кроме того, на нижней панели доступен предварительный просмотр схемы таблиц и данных. Выбрав нужные элементы, нажмите кнопку **Далее**.

    ![Выбор таблиц](media/sql-data-warehouse-load-with-data-factory/select-tables.png)

## <a name="configure-the-destination-your-sql-data-warehouse"></a>Настройка целевого расположения — хранилища данных SQL

Теперь для фабрики данных нужно указать сведения о назначении.

1. Сведения о подключении к хранилищу данных SQL будут заполнены автоматически. Введите пароль для этого имени пользователя, а затем нажмите кнопку **Далее**.

    ![Настройка назначения](media/sql-data-warehouse-load-with-data-factory/configure-destination.png)

2. Отобразится интеллектуальное сопоставление таблиц, которое позволяет связать исходные и целевые таблицы на основе имен таблиц. Если в целевом расположении отсутствует таблица, ADF по умолчанию создаст ее с тем же именем (если в качестве исходного хранилища используется SQL Server или база данных Azure SQL). Вы также можете сопоставить имеющуюся таблицу. Просмотрите результат и нажмите кнопку **Далее**.

    ![Сопоставление таблиц](media/sql-data-warehouse-load-with-data-factory/table-mapping.png)

3. Просмотрите сопоставление схем и проверьте наличие сообщений об ошибке. Интеллектуальное сопоставление основано на имени столбца. Если между исходным и целевым столбцами обнаружится преобразование неподдерживаемого типа данных, появится сообщение об ошибке с указанием на соответствующую таблицу. Если включить функцию автоматического создания таблиц, в фабрике данных может выполняться преобразование типов данных. Это позволяет устранить несовместимость между исходными и целевыми хранилищами.

    ![Сопоставление схем](media/sql-data-warehouse-load-with-data-factory/schema-mapping.png)

4. Нажмите кнопку **Далее**.

## <a name="configure-the-performance-settings"></a>Настройка параметров производительности
В параметрах производительности настройте учетную запись хранения Azure для промежуточного хранения данных перед их загрузкой в хранилище данных SQL, используя [PolyBase](sql-data-warehouse-best-practices.md#use-polybase-to-load-and-export-data-quickly). После завершения копирования промежуточные данные в хранилище будут удалены автоматически.

Выберите существующую учетную запись хранения Azure и нажмите кнопку **Далее**.

![Настройка промежуточного BLOB-объекта](media/sql-data-warehouse-load-with-data-factory/configure-staging-blob.png)

## <a name="review-summary-information-and-deploy-the-pipeline"></a>Просмотр сводных данных и развертывание конвейера

Проверьте конфигурацию и нажмите кнопку **Готово**, чтобы развернуть конвейер.

![Развертывание фабрики данных](media/sql-data-warehouse-load-with-data-factory/deploy-data-factory.png)

## <a name="monitor-data-loading-progress"></a>Мониторинг загрузки данных

На странице **развертывания** можно увидеть ход выполнения развертывания и его результаты.

1. После развертывания для мониторинга загрузки данных щелкните ссылку **Click here to monitor copy pipeline** (Щелкните здесь для мониторинга конвейера копирования).

    ![Отслеживание конвейера](media/sql-data-warehouse-load-with-data-factory/monitor-pipeline.png)

2. Созданный конвейер загрузки данных **DWLoadData-fromSQLServer** будет выбран автоматически слева в **обозревателе ресурсов**.

    ![Представление конвейера](media/sql-data-warehouse-load-with-data-factory/view-pipeline.png)

3. Щелкните конвейер в центральной области, чтобы просмотреть подробные сведения о состоянии каждой таблицы, связанной с действием.

    ![Просмотр действия таблицы](media/sql-data-warehouse-load-with-data-factory/view-table-activity.png)

4. Вы также можете щелкнуть действие, чтобы просмотреть данные о загрузке на панели справа, включая размер данных, строки, пропускную способность и т. д.

    ![Просмотр сведений о действии таблицы](media/sql-data-warehouse-load-with-data-factory/view-table-activity-details.png)

5. Чтобы запустить это представление мониторинга позже, в хранилище данных SQL щелкните **Загрузить данные > Фабрика данных Azure**, выберите свою фабрику и щелкните **Monitor existing loading tasks** (Отслеживать существующие задачи загрузки).

## <a name="next-steps"></a>Дополнительная информация

Инструкции по переносу базы данных в хранилище данных SQL см. в статье [Перенос решения в хранилище данных SQL](sql-data-warehouse-overview-migrate.md).

Чтобы узнать больше о фабрике данных Azure и ее возможностях по перемещению данных, ознакомьтесь со следующими статьями:

- [Общие сведения о службе фабрики данных Azure, службе интеграции данных в облаке](../data-factory/introduction.md)
- [Перемещение данных с помощью действия копирования](../data-factory/copy-activity-overview.md)
- [Перемещение данных в хранилище данных Azure SQL и из него с помощью фабрики данных Azure](../data-factory/connector-azure-sql-data-warehouse.md)

Чтобы узнать, как просматривать данные в хранилище данных SQL, ознакомьтесь со следующими статьями:

- [Подключение к хранилищу данных SQL с помощью Visual Studio и SSDT](sql-data-warehouse-query-visual-studio.md)
- [Визуализация данных с помощью Power BI](sql-data-warehouse-get-started-visualize-with-power-bi.md)

<!-- Azure references -->
[портал Azure]: https://portal.azure.com
