---
title: Создание локальной среды выполнения интеграции в фабрике данных Azure | Документация Майкрософт
description: Узнайте, как создать локальную среду выполнения интеграции в фабрике данных Azure, чтобы предоставить фабрике данных доступ к хранилищам данных в частной сети.
services: data-factory
documentationcenter: ''
author: nabhishek
manager: craigg
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/15/2018
ms.author: abnarain
ms.openlocfilehash: b18fa2879056600cfc9c6a85afc599e2695af711
ms.sourcegitcommit: 6fcd9e220b9cd4cb2d4365de0299bf48fbb18c17
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2018
---
# <a name="how-to-create-and-configure-self-hosted-integration-runtime"></a>Создание и настройка локальной среды выполнения интеграции
Среда выполнения интеграции (IR) — это инфраструктура вычислений, которую фабрика данных Azure использует для обеспечения интеграции данных в разных сетевых средах. Дополнительные сведения о среде выполнения интеграции см. [в этом обзоре](concepts-integration-runtime.md).

> [!NOTE]
> Эта статья относится к версии 2 фабрики данных, которая в настоящее время доступна в предварительной версии. Если вы используете общедоступную версию 1 службы фабрики данных, используйте [документацию по версии 1 фабрики данных](v1/data-factory-introduction.md).

Локальная среда выполнения интеграции может выполнять операции копирования между облачными хранилищами данных и хранилищами данных в частной сети, а также организовывать действия преобразования для вычислительных ресурсов в локальной среде или виртуальной сети Azure. Локальная среда выполнения интеграции устанавливается на локальном компьютере или виртуальной машине в частной сети.  

Из этого документа вы узнаете, как создать и настроить локальную IR.

## <a name="high-level-steps-to-install-self-hosted-ir"></a>Список действий по установке локальной IR
1.  Создайте локальную среду выполнения интеграции. Ниже приведен пример скрипта PowerShell.

    ```powershell
    Set-AzureRmDataFactoryV2IntegrationRuntime -ResourceGroupName $resouceGroupName -DataFactoryName $dataFactoryName -Name $selfHostedIntegrationRuntimeName -Type SelfHosted -Description "selfhosted IR description"
    ```
2.  Скачайте и установите на локальном компьютере локальную среду выполнения интеграции.
3.  Получите ключ проверки подлинности и зарегистрируйте локальную среду выполнения интеграции с помощью этого ключа. Ниже приведен пример скрипта PowerShell.

    ```powershell
    Get-AzureRmDataFactoryV2IntegrationRuntimeKey -ResourceGroupName $resouceGroupName -DataFactoryName $dataFactoryName -Name $selfHostedIntegrationRuntime.  
    ```

## <a name="command-flow-and-data-flow"></a>Поток команд и поток данных
Когда вы копируете данные между локальной средой и облаком, действие копирования применяет среду выполнения интеграции для фактической передачи данных из локального хранилища данных в облачное или обратно.

Вот основные шаги потока данных при копировании с использованием локальной IR.

![Общий обзор](media\create-self-hosted-integration-runtime\high-level-overview.png)

1. Разработчик данных создает локальную среду выполнения интеграции в фабрике данных Azure с помощью командлета PowerShell. На портале Azure эта функция пока не поддерживается.
2. Разработчик данных создает связанную службу для локального хранилища данных, указывая экземпляр локальной среды выполнения интеграции, которую он намерен использовать для подключения к хранилищам данных. В ходе настройки связанной службы разработчик указывает типы аутентификации и учетные данные в приложении "Диспетчер учетных данных" (пока не поддерживается). Диспетчер учетных данных проверяет подключение к хранилищу данных и сохраняет учетные данные в локальной среде выполнения интеграции.
4.  Узел локальной среды выполнения интеграции шифрует учетные данные с помощью программного интерфейса защиты данных (API защиты данных) и сохраняет их локально. Если вы настроили несколько узлов для обеспечения высокой доступности, учетные данные дополнительно синхронизируются между этими узлами. Каждый узел шифрует их с помощью DPAPI и сохраняет локально. Синхронизация учетных данных выполняется локальной средой выполнения интеграции, и разработчик данных может отслеживать это выполнение.    
5.  Служба фабрики данных взаимодействует с локальной средой выполнения интеграции для целей планирования заданий и управления ими через **канал управления**, который использует общую очередь служебной шины Azure. Когда нужно выполнить задание действия, фабрика данных помещает в очередь запрос и соответствующие учетные данные (если они не сохранены в локальной среде выполнения интеграции). Локальная среда выполнения интеграции опрашивает очередь и запускает задание.
6.  Локальная среда выполнения интеграции копирует данные из локального хранилища в облачное или из облачного в локальное, в зависимости от настроек действия копирования в конвейере данных. На этом этапе локальная среда выполнения интеграции напрямую взаимодействует с облачными службами хранилища, такими как хранилище BLOB-объектов Azure, через защищенный канал (HTTPS).

## <a name="considerations-for-using-self-hosted-ir"></a>Рекомендации по использованию локальной среды выполнения интеграции

- Один экземпляр локальной среды выполнения интеграции можно использовать для нескольких локальных источников данных. Но при этом **каждый экземпляр локальной среды выполнения интеграции связан только с одной фабрикой данных Azure** и не может использоваться для работы с другой фабрикой данных.
- На компьютере может быть установлен **только один экземпляр локальной среды выполнения интеграции**. Предположим, у вас есть две фабрики данных, которым необходимо получить доступ к локальным источникам данных. В этом случае вам необходимо установить локальную среду выполнения интеграции на двух локальных компьютерах. Другими словами, локальная среда выполнения интеграции привязана к конкретной фабрике данных
- **Локальную среду выполнения интеграции не обязательно устанавливать на том же компьютере, где установлен источник данных**. Но чем ближе она будет расположена к источнику данных, тем меньше потребуется времени на подключение к источнику данных. Рекомендуем устанавливать локальную среду выполнения интеграции на компьютере, отличном от того, на котором размещен локальный источник данных. Если локальная среда выполнения интеграции и источник данных будут выполняться на разных компьютерах, между ними не возникнет конкуренции за ресурсы компьютера.
- Вы можете **установить несколько локальных сред выполнения интеграции на разных компьютерах и подключить их к одному локальному источнику данных**. Например, можно создать две локальные среды выполнения интеграции для работы с двумя фабриками данных, в которых зарегистрирован один и тот же локальный источник данных.
- Если вы уже установили шлюз на компьютер, который обслуживает сценарий **Power BI**, установите **отдельную локальную среду выполнения интеграции для фабрики данных Azure** на другой компьютер.
- Локальная среда выполнения интеграции является обязательным элементом для поддержки интеграции данных в виртуальной сети Azure.
- Источник данных следует считать локальным (то есть защищенным брандмауэром), даже если используется **ExpressRoute**. Для связи между службой и источником данных следует использовать локальную среду выполнения интеграции.
- Локальная среда выполнения интеграции является обязательной, даже если хранилище данных размещено в облаке на **виртуальной машине Azure IaaS**.
- Задачи могут завершаться ошибкой в среде Integration Runtime (Self-hosted), установленной на сервере Windows Server, на котором включено шифрование, совместимое с FIPS. Чтобы обойти эту проблему, отключите на сервере шифрование, совместимое с FIPS. Чтобы отключить шифрование, совместимое с FIPS, измените следующее значение реестра с "1" (включено) на "0" (отключено): `HKLM\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy\Enabled`.

## <a name="prerequisites"></a>предварительным требованиям

- Поддерживаемые **операционные системы**: Windows 7 с пакетом обновления 1, Windows 8.1, Windows 10, Windows Server 2008 R2 с пакетом обновления 1 (SP1), Windows Server 2012, Windows Server 2012 R2, Windows Server 2016. Установка локальной среды выполнения интеграции на **контроллер домена не поддерживается**.
- Требуется **.NET Framework 4.6.1 или более поздней версии**. Если локальная среда выполнения интеграции устанавливается на компьютер под управлением Windows 7, используйте .NET Framework 4.6.1 или более поздней версии. Дополнительные сведения см. в разделе [Требования к системе для .NET Framework](/dotnet/framework/get-started/system-requirements).
- Минимальная рекомендуемая **конфигурация** для компьютера, на котором устанавливается локальная среда выполнения интеграции: четырехъядерный процессор с тактовой частотой 2 ГГц, 8 ГБ ОЗУ и 80 ГБ дискового пространства.
- Когда хост-компьютер переходит в режим гибернации, локальная среда выполнения интеграции не может отвечать на запросы данных. Поэтому перед установкой локальной среды выполнения интеграции на компьютере следует настроить соответствующую схему управления питанием. Если компьютер использует режим гибернации, программа установки локальной среды выполнения интеграции отобразит соответствующее сообщение.
- Для успешной установки и настройки локальной среды выполнения интеграции вам потребуются права администратора на компьютере.
- Так как циклы копирования выполняются с определенной частотой, ресурсы компьютера (ЦП, память) используются нерегулярно: есть пиковые нагрузки и есть время простоя. Использование ресурсов также зависит от объема перемещаемых данных. Когда выполняется несколько заданий копирования, в пиковые периоды уровень использования ресурсов системы повышается.

## <a name="installation-best-practices"></a>Рекомендации по установке
Чтобы установить локальную среду выполнения интеграции выполнения, скачайте пакет установки MSI из [центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=39717). Пошаговые инструкции вы найдете в разделе [Перемещение данных между локальными источниками и облаком с помощью шлюза управления данными](tutorial-hybrid-copy-powershell.md).

- На компьютере, где устанавливается локальная среда выполнения интеграции, нужно настроить схему управления питанием так, чтобы он не использовал режим гибернации. Когда компьютер этого узла переходит в режим гибернации, локальная среда выполнения интеграции не может отвечать на запросы данных.
- Регулярно выполняйте резервное копирование учетных данных, настроенных в локальной среде выполнения интеграции.

## <a name="install-and-register-self-hosted-ir-from-download-center"></a>Установка и регистрация локальной IR из центра загрузки Майкрософт

1. Перейдите на [страницу загрузки среды выполнения интеграции Microsoft](https://www.microsoft.com/download/details.aspx?id=39717).
2. Щелкните **Скачать**, выберите нужную версию (**32-разрядную** или **64-разрядную**) и нажмите кнопку **Далее**.
3. Сразу запустите **MSI** -файл или сохраните его на жесткий диск и затем запустите.
4. На странице **приветствия** выберите **язык**, после чего нажмите кнопку **Далее**.
5. **Примите** условия лицензионного соглашения и нажмите кнопку **Далее**.
6. Выберите **папку** для установки локальной среды выполнения интеграции и нажмите кнопку **Далее**.
7. На странице **Готово к установке** щелкните **Установить**.
8. Нажмите кнопку **Готово** для завершения установки.
9. Получите ключ аутентификации с помощью Azure PowerShell. Ниже представлен код PowerShell для извлечения ключа аутентификации.

    ```powershell
    Get-AzureRmDataFactoryV2IntegrationRuntimeKey -ResourceGroupName $resouceGroupName -DataFactoryName $dataFactoryName -Name $selfHostedIntegrationRuntime
    ```
11. В диспетчере конфигурации Microsoft для среды выполнения интеграции откройте страницу **регистрации среды выполнения интеграции (с локальным размещением)** и выполните следующие действия.
    1. Вставьте в текстовое поле **ключ аутентификации**.
    2. Чтобы просмотреть текст ключа, щелкните **Show authentication key** (Показать ключ аутентификации).
    3. Щелкните **Зарегистрировать**.


## <a name="high-availability-and-scalability"></a>Высокий уровень доступности и масштабируемости
Локальная среда Integration Runtime может связываться с несколькими локальными компьютерами. Такие компьютеры называются узлами. Для локальной среды выполнения интеграции можно использовать до четырех узлов. Ниже перечислены преимущества связывания нескольких узлов (локальных компьютеров с установленным шлюзом) с логическим шлюзом.
1. Высокая доступность локальной среды выполнения интеграции при использовании нескольких узлов (до 4) избавляет от единой точки сбоя в решении больших данных или облачных данных в фабрике данных Azure.
2. Повышение производительности и пропускной способности при перемещении данных между локальными и облачными хранилищами данных. Узнайте больше о [сравнении производительности](copy-activity-performance.md).

Чтобы связать несколько узлов, достаточно лишь установить программное обеспечение локальной среды Integration Runtime из [центра загрузки](https://www.microsoft.com/download/details.aspx?id=39717) и зарегистрировать его с помощью любого из ключей аутентификации, полученных командлетом New-AzureRmDataFactoryV2IntegrationRuntimeKey, как описано в [этом руководстве](tutorial-hybrid-copy-powershell.md).

> [!NOTE]
> Для дополнительных узлов не нужно создавать отдельную локальную среду выполнения интеграции. Вы можете установить эту среду на другом компьютере и зарегистрировать ее, используя тот же ключ аутентификации. 

> [!NOTE]
> Прежде чем добавить еще один узел для обеспечения **высокого уровня доступности и масштабируемости**, установите для параметра **удаленного доступа к интрасети** значение **Включено** на первом узле (Диспетчер конфигураций Microsoft Integration Runtime -> Параметры -> Remote access to intranet (Удаленный доступ к интрасети)). 

### <a name="tlsssl-certificate-requirements"></a>Требования к TLS- и SSL-сертификатам
Ниже приведены требования к TLS- и SSL-сертификатам, используемым для защиты взаимодействия между узлами Integration Runtime.

- Сертификат должен быть общедоступным доверенным сертификатом X509 v3. Мы рекомендуем использовать сертификаты, выданные общедоступным (сторонним) центром сертификации.
- Все узлы среды выполнения интеграции должны доверять этому сертификату.
- Поддерживаются групповые сертификаты. Например, если вы используете полное доменное имя **node1.domain.contoso.com**, в сертификате можно указать имя субъекта ***.domain.contoso.com**.
- Мы не рекомендуем использовать сертификаты с альтернативным именем субъекта (SAN), так как в текущей реализации применяется только последнее из альтернативных имен, а остальные игнорируются. (например, Если у вас есть сертификат SAN с альтернативными именами субъекта **node1.domain.contoso.com** и **node2.domain.contoso.com**, его можно применить только для компьютера с полным доменным именем **node2.domain.contoso.com**.
- Поддержка ключа любого размера, поддерживаемого Windows Server 2012 R2 для SSL-сертификатов.
- Сертификаты с ключами CNG не поддерживаются. Не поддерживаются сертификаты на основе ключей CNG.

## <a name="system-tray-icons-notifications"></a>Значки и уведомления в области уведомлений
Если навести курсор на значок или уведомление в области уведомлений, вы получите сведения о состоянии локальной среды выполнения интеграции.

![Сообщения в области уведомлений](media\create-self-hosted-integration-runtime\system-tray-notifications.png)

## <a name="ports-and-firewall"></a>Порты и брандмауэр
Описанные здесь рекомендации относятся к двум брандмауэрам: к **корпоративному брандмауэру**, работающему на центральном маршрутизаторе организации, и к **брандмауэру Windows**, настроенному на локальном компьютере, на котором установлена локальная среда выполнения интеграции.

![Брандмауэр](media\create-self-hosted-integration-runtime\firewall.png)

На уровне **корпоративного брандмауэра** необходимо настроить следующие домены и исходящие порты.

Имена доменов | порты; | ОПИСАНИЕ
------------ | ----- | ------------
*.servicebus.windows.net | 443, 80 | Используется для связи с серверной частью службы перемещения данных.
*.core.windows.net | 443 | Используется для промежуточного копирования с помощью большого двоичного объекта Azure (если оно настроено).
*.frontend.clouddatahub.net | 443 | Используется для связи с серверной частью службы перемещения данных.

Эти исходящие порты, как правило, уже разрешены на уровне **брандмауэра Windows**. Если это не так, аналогичные настройки доменов и портов следует указать на компьютере, где установлена локальная среда выполнения интеграции.

> [!NOTE]
> В зависимости от того, какие источники и приемники используются, может потребоваться добавить в список разрешений корпоративного брандмауэра или брандмауэра Windows дополнительные домены и исходящие порты.
>
> Для некоторых баз данных в облаке (например, База данных SQL Azure, Azure Data Lake и т. д.) нужно добавить IP-адрес компьютера, на котором работает локальная среда выполнения интеграции, в список разрешений брандмауэра.

### <a name="copy-data-from-a-source-to-a-sink"></a>Копирование данных из источника в приемник
Настройте все нужные правила на корпоративном брандмауэре и на брандмауэре Windows на компьютерах, где выполняются локальная среда выполнения интеграции и хранилище данных. Если правила настроены верно, локальная среда выполнения интеграции сможет успешно подключаться как к источнику, так и к приемнику. Активируйте правила для каждого хранилища данных, задействованного в операции копирования.

Например, при **копировании данных из локального хранилища данных в приемник, размещенный в Базе данных SQL Azure или хранилище данных SQL Azure**, потребуются следующие настройки.

- Разрешите исходящий трафик **TCP** через порт **1433** для брандмауэра Windows и корпоративного брандмауэра.
- В параметрах брандмауэра Azure SQL Server добавьте в список разрешенных IP-адресов адрес компьютера, на котором выполняется локальная среда выполнения интеграции.

> [!NOTE]
> Если брандмауэр блокирует исходящий порт 1433, то локальная среда выполнения интеграции не сможет получить доступ к SQL Azure напрямую. В этом случае можно использовать [промежуточное копирование](copy-activity-performance.md) в базу данных SQL Azure или хранилище данных SQL Azure. Тогда для перемещения данных понадобится только протокол HTTPS (порт 443).


## <a name="proxy-server-considerations"></a>Рекомендации для прокси-сервера
Если для доступа в Интернет в вашей корпоративной среде используется прокси-сервер, настройте параметры этого прокси-сервера в локальной среде выполнения интеграции. Прокси-сервер можно настроить на этапе начальной регистрации.

![Выбор прокси-сервера](media\create-self-hosted-integration-runtime\specify-proxy.png)

Локальная среда выполнения интеграции использует прокси-сервер для подключения к облачной службе. Щелкните ссылку "Изменить" во время начальной настройки. Отобразится диалоговое окно настройки прокси-сервера.

![Настройка прокси-сервера](media\create-self-hosted-integration-runtime\set-http-proxy.png)

Доступны три варианта конфигурации.

- **Не использовать прокси**. Локальная среда выполнения интеграции не использует явно настроенный прокси-сервер для подключения к облачным службам.
- **Использовать системный прокси**. Локальная среда выполнения интеграции использует параметры прокси-сервера, настроенные в файлах diahost.exe.config и diawp.exe.config. Если в файлах diahost.exe.config и diawp.exe.config параметры прокси-сервера не указаны, локальная среда выполнения интеграции подключается к облачной службе напрямую, не используя прокси-сервер.
- **Использовать настраиваемый прокси**. Локальная среда выполнения интеграции использует собственные параметры HTTP-прокси вместо конфигурации, настроенной в файлах diahost.exe.config и diawp.exe.config. Необходимо указать адрес и порт. Имя пользователя и пароль являются необязательными и указываются в зависимости от настроек аутентификации прокси-сервера. Все параметры шифруются с помощью Windows DPAPI в локальной среде выполнения интеграции и хранятся локально на компьютере.

Служба узла локальной среды выполнения интеграции данными автоматически перезапускается после сохранения обновленных параметров прокси-сервера.

После успешной регистрации локальной среды выполнения интеграции вы можете просмотреть или изменить параметры прокси-сервера с помощью диспетчера конфигурации для среды выполнения интеграции.

1.  Запустите **Диспетчер конфигурации Microsoft для среды выполнения интеграции**.
2.  Переключитесь на вкладку **Параметры** .
3.  Щелкните ссылку **Изменить** в разделе **HTTP-прокси**, чтобы открыть диалоговое окно **Указание HTTP-прокси**.
4.  После нажатия кнопки **Далее** появится диалоговое окно предупреждения, запрашивающее разрешение на сохранение настроек прокси-сервера и перезапуск службы узла среды выполнения интеграции.

При помощи диспетчера конфигурации можно просмотреть и обновить HTTP-прокси.

![Просмотр прокси-сервера](media\create-self-hosted-integration-runtime\view-proxy.png)

> [!NOTE]
> Если вы настроите на прокси-сервере аутентификацию NTLM, служба узла среды выполнения интеграции будет запускаться под учетной записью домена. Если через какое-то время вы измените пароль для учетной записи домена, то не забудьте обновить параметры конфигурации службы и перезапустить ее. Учитывая это требование, для доступа к прокси-серверу рекомендуется использовать выделенную учетную запись домена, для которой не требуется часто менять пароль.

### <a name="configure-proxy-server-settings"></a>Настройка параметров прокси-сервера

Если для HTTP-прокси выбран вариант конфигурации **Использовать системный прокси**, локальная среда выполнения интеграции использует параметры прокси-сервера, заданные в файлах diahost.exe.config и diawp.exe.config. Если в файлах diahost.exe.config и diawp.exe.config параметры прокси-сервера не настроены, локальная среда выполнения интеграции подключается к облачной службе напрямую, не используя прокси-сервер. Ниже приводится процедура обновления файла конфигурации diahost.exe.config.

1. В проводнике создайте резервную копию исходного файла C:\Program Files\Microsoft Integration Runtime\3.0\Shared\diahost.exe.config.
2. Запустите Блокнот с правами администратора и откройте текстовый файл C:\Program Files\Microsoft Integration Runtime\3.0\Shared\diahost.exe.config. Найдите тег по умолчанию для system.net, как показано в коде ниже.

    ```xml
    <system.net>
        <defaultProxy useDefaultCredentials="true" />
    </system.net>
    ```
    Затем можно добавить данные прокси-сервера, как показано в следующем примере:

    ```xml
    <system.net>
        <defaultProxy enabled="true">
              <proxy bypassonlocal="true" proxyaddress="http://proxy.domain.org:8888/" />
        </defaultProxy>
    </system.net>
    ```

    Внутри тега прокси-сервера можно указать дополнительные свойства, чтобы задать требуемые параметры, например scriptLocation. Сведения о синтаксисе вы найдете в статье [Элемент <proxy> (параметры сети)](https://msdn.microsoft.com/library/sa91de1e.aspx).

    ```xml
    <proxy autoDetect="true|false|unspecified" bypassonlocal="true|false|unspecified" proxyaddress="uriString" scriptLocation="uriString" usesystemdefault="true|false|unspecified "/>
    ```
3. Сохраните файл конфигурации в исходном расположении, а затем перезапустите службу узла локальной среды выполнения интеграции, чтобы она учла эти изменения. Чтобы перезапустить службу, воспользуйтесь приложением "Службы" на панели управления или откройте **диспетчер конфигурации для среды выполнения интеграции**, нажмите кнопку **Остановить службу**, а затем щелкните **Запустить службу**. Если служба не запускается, вероятно, в измененном файле конфигурации приложения добавлен неправильный синтаксис тегов XML.

> [!IMPORTANT]
> Не забудьте обновить оба файла (diahost.exe.config и diawp.exe.config).

Кроме того, необходимо также убедиться, что Microsoft Azure входит в белый список в вашей компании. Список допустимых IP-адресов Microsoft Azure можно скачать из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=41653).

### <a name="possible-symptoms-for-firewall-and-proxy-server-related-issues"></a>Возможные признаки проблем, связанных с брандмауэром и прокси-сервером
Вероятная причина приведенных ниже ошибок — неправильная конфигурация брандмауэра или прокси-сервера, которая блокирует подключение локальной среды выполнения интеграции к фабрике данных для аутентификации. Чтобы настроить брандмауэр и прокси-сервер должным образом, см. предыдущий раздел.

1.  При попытке регистрации локальной среды выполнения интеграции появляется следующая ошибка: "Зарегистрировать этот узел среды выполнения интеграции не удалось! Убедитесь, что используется действительный ключ проверки подлинности и что на этом компьютере запущена служба узла среды выполнения. "
2.  При открытии диспетчера конфигурации среды выполнения интеграции отображается состояние "**Отключено**" или "**Подключение**". В средстве просмотра событий Windows в разделе "Журналы приложения и служб" > "Шлюз управления данными" отображается сообщение об ошибке следующего вида:

    ```
    Unable to connect to the remote server
    A component of Integration Runtime has become unresponsive and restarts automatically. Component name: Integration Runtime (Self-hosted).
    ```

### <a name="enable-remote-access-from-intranet"></a>Разрешение удаленного доступа из интрасети  
Если для шифрования учетных данных на другом компьютере (в сети), отличном от того, на котором установлена локальная среда выполнения интеграции, используется **PowerShell** или **приложение диспетчера учетных данных**, вам потребуется включить параметр **Удаленный доступ из интрасети**. Если для шифрования данных вы запускаете **PowerShell** или **приложение диспетчера учетных данных** на компьютере, где установлена локальная среда выполнения интеграции, параметр **Удаленный доступ из интрасети** включать не нужно.

Этот параметр нужно **включить** перед добавлением еще одного узла для обеспечения **высокой доступности и масштабируемости**.  

Во время установки локальной среды выполнения интеграции (версии 3.3.xxxx.x и выше) программа установки по умолчанию отключает параметр **Удаленный доступ из интрасети** на компьютере, где будет работать локальная среда выполнения интеграции.

При использовании стороннего брандмауэра вы сможете открыть порт 8060 (или настроенный пользователем порт) вручную. Если во время установки локальной среды выполнения интеграции возникли проблемы с брандмауэром, попробуйте установить локальную среду выполнения интеграции без настройки брандмауэра, используя следующую команду.

```
msiexec /q /i IntegrationRuntime.msi NOFIREWALL=1
```
> [!NOTE]
> **Приложение диспетчера учетных данных** пока недоступно для шифрования учетных данных в ADF версии 2. Мы добавим поддержку этой возможности позже.  

Если вы не хотите открывать порт 8060 на компьютере, где работает локальная среда выполнения интеграции, то для настройки учетных данных для хранилища данных вам придется использовать другой механизм, а не приложение "Настройка учетных данных". Например, вы можете применить командлет PowerShell New-AzureRmDataFactoryV2LinkedServiceEncryptCredential. Дополнительные сведения см. в статье о настройке учетных данных и параметров безопасности.


## <a name="next-steps"></a>Дополнительная информация
Выполните пошаговые инструкции, приведенные в [руководстве по копированию локальных данных в облако](tutorial-hybrid-copy-powershell.md).
