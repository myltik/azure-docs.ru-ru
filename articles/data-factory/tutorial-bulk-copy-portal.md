---
title: Копирование данных в пакетном режиме с помощью фабрики данных Azure | Документация Майкрософт
description: Узнайте, как использовать фабрику данных Azure и действие копирования для копирования данных из исходного хранилища данных в хранилище данных назначения в пакетном режиме.
services: data-factory
documentationcenter: ''
author: linda33wj
manager: craigg
ms.reviewer: douglasl
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 01/10/2018
ms.author: jingwang
ms.openlocfilehash: 440b07b494b34db7ff3fcdf5d5ac830b165c339d
ms.sourcegitcommit: 48ab1b6526ce290316b9da4d18de00c77526a541
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2018
ms.locfileid: "30173289"
---
# <a name="copy-multiple-tables-in-bulk-by-using-azure-data-factory"></a>Копирование нескольких таблиц в пакетном режиме с помощью фабрики данных Azure
В этом руководстве показано **копирование нескольких таблиц из базы данных SQL Azure в хранилище данных SQL Azure**. Этот подход можно применить и в других сценариях. Например, копирование таблиц из SQL Server или Oracle в базу данных SQL Azure, хранилище данных или большой двоичный объект Azure, копирование различных путей из большого двоичного объекта в таблицы базы данных SQL Azure.

> [!NOTE]
> - Если вы еще не работали с фабрикой данных Azure, ознакомьтесь со статьей [Введение в фабрику данных Azure](introduction.md).
> - Эта статья относится к версии 2 фабрики данных, которая в настоящее время доступна в предварительной версии. Если вы используете общедоступную версию 1 службы фабрики данных, ознакомьтесь с [документацией по фабрике данных версии 1](v1/data-factory-copy-data-from-azure-blob-storage-to-sql-database.md).

В целом это руководство включает следующие шаги:

> [!div class="checklist"]
> * создадите фабрику данных;
> * Создание связанных служб базы данных SQL Azure, хранилища данных SQL Azure и службы хранилища Azure.
> * Создание наборов данных базы данных SQL Azure и хранилища данных SQL.
> * Создание конвейера для поиска таблиц, которые нужно скопировать, и конвейера для выполнения операции копирования. 
> * Запуск конвейера.
> * Мониторинг конвейера и выполнения действий.

В этом руководстве используется портал Azure. Сведения об использовании других средств или пакетов SDK для создания фабрики данных см. в [этом кратком руководстве](quickstart-create-data-factory-dot-net.md). 

## <a name="end-to-end-workflow"></a>Комплексный рабочий процесс
Предположим, у вас есть несколько таблиц в базе данных SQL Azure и вы хотите скопировать их в хранилище данных SQL. Вот логическая последовательность действий рабочего процесса в конвейерах:

![Рабочий процесс](media/tutorial-bulk-copy-portal/tutorial-copy-multiple-tables.png)

* Первый конвейер ищет список таблиц, который необходимо скопировать в хранилище данных-приемник.  В качестве альтернативы можно создать таблицу метаданных, в которой перечислены все таблицы, которые нужно скопировать в хранилище данных-приемник. Затем конвейер активирует другой конвейер, который выполняет итерацию по каждой таблице базы данных и выполняет операцию копирования данных.
* Второй конвейер выполняет фактическое копирование. Он принимает список таблиц в качестве параметра. Чтобы добиться лучшей производительности, для каждой таблицы в списке скопируйте определенную таблицу из базы данных SQL Azure в соответствующую таблицу хранилища данных SQL Azure, используя [промежуточное копирование с помощью хранилища BLOB-объектов и PolyBase](connector-azure-sql-data-warehouse.md#use-polybase-to-load-data-into-azure-sql-data-warehouse). В этом примере первый конвейер передает список таблиц в качестве значения параметра. 

Если у вас еще нет подписки Azure, создайте [бесплатную](https://azure.microsoft.com/free/) учетную запись Azure, прежде чем начинать работу.

## <a name="prerequisites"></a>предварительным требованиям
* **Учетная запись хранения Azure.** Учетная запись хранения Azure используется в качестве промежуточного хранилища больших двоичных объектов в операции массового копирования. 
* **База данных SQL Azure**. Эта база данных содержит исходные данные. 
* **Хранилище данных Azure SQL.** Это хранилище данных содержит данные, копируемые из базы данных SQL. 

### <a name="prepare-sql-database-and-sql-data-warehouse"></a>Подготовка базы данных SQL и хранилища данных SQL

**Подготовка исходной базы данных SQL Azure:**

Создайте базу данных SQL Azure, используя пример данных Adventure Works LT, представленный в статье [Создание базы данных SQL Azure на портале Azure](../sql-database/sql-database-get-started-portal.md). В этом руководстве копируются все таблицы из этого примера базы данных в хранилище данных SQL.

**Подготовка хранилища данных-приемника SQL Azure:**

1. Если у вас нет хранилища данных SQL Azure, выполните шаги из раздела [Создание хранилища данных SQL](../sql-data-warehouse/sql-data-warehouse-get-started-tutorial.md).

2. Создайте соответствующие схемы таблиц в хранилище данных SQL Azure. [Служебную программу переноса](https://www.microsoft.com/download/details.aspx?id=49100) можно использовать для **миграции схемы** из базы данных SQL Azure в хранилище данных SQL Azure. Фабрика данных Azure используется для миграции и копирования данных на более поздних этапах.

## <a name="azure-services-to-access-sql-server"></a>Доступ служб Azure к серверу SQL Server

В базе данных SQL и хранилище данных SQL Azure предоставьте службам Azure доступ к серверу SQL Server. Убедитесь, что параметр **Разрешить доступ к службам Azure** имеет значение **ВКЛ** для вашего сервера Azure SQL. Этот параметр позволяет службе фабрики данных читать данные из базы данных SQL Azure и записывать данные в хранилище данных SQL Azure. Чтобы проверить и при необходимости включить этот параметр, сделайте следующее.

1. Щелкните **Больше служб** слева и выберите **Серверы SQL**.
2. Выберите сервер и щелкните **Брандмауэр** в разделе **Параметры**.
3. На странице **Параметры брандмауэра** щелкните **ВКЛ** для параметра **Разрешить доступ к службам Azure**.

## <a name="create-a-data-factory"></a>Создать фабрику данных
1. Запустите веб-браузер **Microsoft Edge** или **Google Chrome**. Сейчас только эти браузеры поддерживают пользовательский интерфейс фабрики данных.
1. В меню слева щелкните **Создать**, выберите **Данные+аналитика** и щелкните **Фабрика данных**. 
   
   ![Создать -> Фабрика данных](./media/tutorial-bulk-copy-portal/new-azure-data-factory-menu.png)
2. На странице **Новая фабрика данных** введите **ADFTutorialBulkCopyDF** в поле **Имя**. 
      
     ![Страница "Новая фабрика данных"](./media/tutorial-bulk-copy-portal/new-azure-data-factory.png)
 
   Имя фабрики данных Azure должно быть **глобально уникальным**. Если вы увидите следующую ошибку для поля имени, введите другое имя фабрики данных (например, ваше_имя_ADFTutorialBulkCopyDF). Ознакомьтесь со статьей [Фабрика данных Azure — правила именования](naming-rules.md), чтобы узнать правила именования для артефактов службы "Фабрика данных".
  
       `Data factory name “ADFTutorialBulkCopyDF” is not available`
3. Выберите **подписку** Azure, в рамках которой вы хотите создать фабрику данных. 
4. Для **группы ресурсов** выполните одно из следующих действий.
     
      - Выберите **Использовать существующую**и укажите существующую группу ресурсов в раскрывающемся списке. 
      - Выберите **Создать новую**и укажите имя группы ресурсов.   
         
      Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/resource-group-overview.md).  
4. Выберите **V2 (Preview)** (V2 (предварительная версия)) для **версии**.
5. Укажите **расположение** фабрики данных. Сейчас фабрика данных версии 2 позволяет создавать фабрики данных только в восточной части США, восточной части США 2 и Западной Европе. Хранилища данных (служба хранилища Azure, база данных SQL Azure и т. д.) и вычисления (HDInsight и т. д.), используемые фабрикой данных, могут располагаться в других регионах.
6. Кроме того, установите флажок **Закрепить на панели мониторинга**.     
7. Нажмите кнопку **Создать**.
8. На панели мониторинга вы увидите приведенный ниже элемент с состоянием **Deploying data factory** (Развертывание фабрики данных). 

    ![Элемент Deploying data factory (Развертывание фабрики данных)](media//tutorial-bulk-copy-portal/deploying-data-factory.png)
9. Когда завершится создание, откроется страница **Фабрика данных**, как показано на рисунке ниже.
   
    ![Домашняя страница фабрики данных](./media/tutorial-bulk-copy-portal/data-factory-home-page.png)
10. Щелкните плитку **Создание и мониторинг**, чтобы открыть на отдельной вкладке приложение пользовательского интерфейса фабрики данных.
11. На странице **Начало работы** перейдите на вкладку **Изменить** в левой панели, как показано на следующем рисунке:  

    ![Страница "Начало работы"](./media/tutorial-bulk-copy-portal/get-started-page.png)

## <a name="create-linked-services"></a>Создание связанных служб
Связанная служба связывает хранилища данных и вычислительные ресурсы с фабрикой данных. Связанная служба содержит сведения о подключении, которые фабрика данных использует для подключения к хранилищу данных в среде выполнения. 

В этом руководстве вы создадите привязку к фабрике данных для Базы данных SQL Azure, хранилища данных SQL Azure и хранилища BLOB-объектов Azure. База данных Azure SQL используется в качестве исходного хранилища данных. Хранилище данных SQL Azure выполняет функцию приемника (целевого хранилища данных). Хранилище BLOB-объектов Azure временно хранит данные, чтобы передать их в хранилище данных SQL с помощью PolyBase. 

### <a name="create-the-source-azure-sql-database-linked-service"></a>Создание исходной связанной службы базы данных SQL Azure
На этом шаге вы создадите связанную службу, которая свяжет базу данных SQL Azure с фабрикой данных. 

1. Щелкните **Подключения** в нижней части окна, а затем — **+ Создать** на панели инструментов. 

    ![Кнопка создания связанной службы](./media/tutorial-bulk-copy-portal/new-linked-service-button.png)
2. В окне **Новая связанная служба** выберите **База данных SQL Microsoft Azure** и щелкните **Продолжить**. 

    ![Выбор Базы данных SQL Azure](./media/tutorial-bulk-copy-portal/select-azure-sql-database.png)
3. В окне **New Linked Service** (Новая связанная служба) выполните следующие действия: 

    1. Введите **AzureSqlDatabaseLinkedService** в поле **Имя**. 
    2. Выберите нужный сервер Azure SQL в списке **Имя сервера**.
    3. Выберите базу данных Azure SQL в списке **Имя базы данных**. 
    4. Введите **имя пользователя** для подключения к базе данных Azure SQL. 
    5. Введите **пароль** для этого пользователя. 
    6. Чтобы проверить подключение к базе данных Azure SQL с указанными данными, нажмите кнопку **Проверить подключение**.
    7. Выберите команду **Сохранить**.

        ![Параметры базы данных SQL Azure](./media/tutorial-bulk-copy-portal/azure-sql-database-settings.png)

### <a name="create-the-sink-azure-sql-data-warehouse-linked-service"></a>Создание связанной службы-приемника хранилища данных SQL Azure

1. На вкладке **Подключения** снова щелкните **+ Создать** на панели инструментов. 
2. В окне **Новая связанная служба** выберите **Хранилище данных SQL Microsoft Azure** и нажмите кнопку **Продолжить**. 
3. В окне **New Linked Service** (Новая связанная служба) выполните следующие действия: 

    1. Введите **AzureSqlDWLinkedService** в поле **Имя**. 
    2. Выберите нужный сервер Azure SQL в списке **Имя сервера**.
    3. Выберите базу данных Azure SQL в списке **Имя базы данных**. 
    4. Введите **имя пользователя** для подключения к базе данных Azure SQL. 
    5. Введите **пароль** для этого пользователя. 
    6. Чтобы проверить подключение к базе данных Azure SQL с указанными данными, нажмите кнопку **Проверить подключение**.
    7. Выберите команду **Сохранить**.

### <a name="create-the-staging-azure-storage-linked-service"></a>Создание промежуточной связанной службы хранилища Azure
В этом руководстве хранилища BLOB-объектов Azure используются в качестве области промежуточного хранения, чтобы включить PolyBase для повышения производительности копирования.

1. На вкладке **Подключения** снова щелкните **+ Создать** на панели инструментов. 
2. В окне **Новая связанная служба** выберите **Хранилище больших двоичных объектов** и нажмите кнопку **Продолжить**. 
3. В окне **New Linked Service** (Новая связанная служба) выполните следующие действия: 

    1. Введите **AzureStorageLinkedService** в поле **Имя**. 
    2. Выберите **учетную запись хранения** в списке **Имя учетной записи хранения**.
    4. Выберите команду **Сохранить**.


## <a name="create-datasets"></a>Создание наборов данных
В этом руководстве вы создадите наборы данных источника и приемника, в которых указывается место хранения данных. 

Исходный набор данных AzureSqlDatabaseDataset ссылается на службу AzureSqlDatabaseLinkedService. Связанная служба определяет строку подключения для подключения к базе данных. Набор данных указывает имена базы данных и таблицы, которые содержат исходные данные. 

Целевой набор данных AzureSqlDWDataset ссылается на службу AzureSqlDWLinkedService. Связанная служба определяет строку подключения для подключения к хранилищу данных. Набор данных указывает имена базы данных и таблицы, в которую копируются данные. 

В этом руководстве таблицы SQL для источника и назначения не заданы жестко в определениях наборов данных. Действие ForEach передает имена таблиц действию копирования во время выполнения. 

### <a name="create-a-dataset-for-source-sql-database"></a>Создание набора данных для исходной базы данных SQL

1. Нажмите кнопку **+ (плюс)** на левой панели и выберите пункт **Набор данных**. 

    ![Меню "Новый набор данных"](./media/tutorial-bulk-copy-portal/new-dataset-menu.png)
2. В окне **Новый набор данных** выберите **База данных SQL Microsoft Azure** и щелкните **Готово**. Вы увидите новую вкладку с именем **AzureSqlTable1**. 
    
    ![Выбор Базы данных SQL Azure](./media/tutorial-bulk-copy-portal/select-azure-sql-database-dataset.png)
3. В окне свойств в нижней части страницы введите значение **AzureSqlDatabaseDataset** в поле **Имя**.

    ![Имя исходного набора данных](./media/tutorial-bulk-copy-portal/source-dataset-general.png)
4. Перейдите на вкладку **Подключения** и выполните следующие действия: 

    1. Выберите **AzureSqlDatabaseLinkedService** в списке **Связанная служба**.
    2. Выберите любую таблицу в списке **Таблица**. Эта таблица используется в качестве заглушки. Реальный запрос к исходному набору данных будет указан отдельно при создании конвейера. Этот запрос нужен для извлечения данных из базы данных SQL Azure. Или можно установить флажок **Изменить** и ввести произвольное имя таблицы, например **dummyName**. 

    ![Страница подключения к исходному набору данных](./media/tutorial-bulk-copy-portal/source-dataset-connection-page.png)
 

### <a name="create-a-dataset-for-sink-sql-data-warehouse"></a>Создание набора данных для хранилища данных-приемника SQL

1. Нажмите кнопку **+ (плюс)** на левой панели и выберите пункт **Набор данных**. 
2. В окне **Новый набор данных** выберите **Хранилище данных SQL Microsoft Azure** и щелкните **Готово**. Вы увидите новую вкладку с именем **AzureSqlDWTable1**. 
3. В окне свойств в нижней части страницы введите значение **AzureSqlDWDataset** в поле **Имя**.
4. Перейдите на вкладку **Подключения** и выберите **AzureSqlDatabaseLinkedService** в списке **Связанная служба**.
5. Перейдите на вкладку **Параметры** и щелкните **+ Создать**

    ![Страница подключения к исходному набору данных](./media/tutorial-bulk-copy-portal/sink-dataset-new-parameter-button.png)
6. Введите **DWTableName** в качестве имени параметра. Если вы копируете и вставляете имя **DWTableName** со страницы, убедитесь в отсутствии **пробела** в конце имени. 
7. В разделе **Parameterized properties** (Параметризованные свойства) введите `@{dataset().DWTableName}` в качестве значения для свойства **tableName**. В свойстве **TableName** для набора данных укажите значение, которое передается в качестве аргумента для параметра **DWTableName**. Действие ForEach последовательно перебирает список таблиц и по одной передает их действию копирования. 
   
    ![Имя параметра](./media/tutorial-bulk-copy-portal/dwtablename-tablename.png)

## <a name="create-pipelines"></a>Создание конвейеров
В этом руководстве вы создадите два конвейера: **IterateAndCopySQLTables** и **GetTableListAndTriggerCopyData**. 

Конвейер **GetTableListAndTriggerCopyData** выполняет два действия.

* Ищет системную таблицу базы данных SQL Azure, чтобы получить список таблиц для копирования.
* Активирует конвейер **IterateAndCopySQLTables** для копирования данных.

Конвейер **GetTableListAndTriggerCopyData** принимает в качестве параметра список таблиц. Для каждой таблицы в списке он копирует данные из таблицы в базе данных SQL Azure в хранилище данных SQL Azure с помощью промежуточного копирования и PolyBase.

### <a name="create-the-pipeline-iterateandcopysqltables"></a>Создание конвейера IterateAndCopySQLTables

1. На левой панели нажмите кнопку **+ (плюс)** и выберите пункт **Конвейер**.

    ![Меню создания конвейера](./media/tutorial-bulk-copy-portal/new-pipeline-menu.png)
2. В окне "Свойства" укажите имя конвейера **IterateAndCopySQLTables**. 

    ![Имя конвейера](./media/tutorial-bulk-copy-portal/first-pipeline-name.png)
3. Перейдите на вкладку **Параметры** и выполните здесь следующие действия. 

    1. Щелкните **+ Создать**. 
    2. Введите **tableList** в качестве **имени** параметра.
    3. Выберите **Объект** для параметра **Тип**.

        ![Параметр конвейера](./media/tutorial-bulk-copy-portal/first-pipeline-parameter.png)
4. На панели элементов **Действия** разверните **Iteration & Conditions** (Итерация и условия), затем перетащите действие **ForEach** в область конструктора конвейера. Также на панели элементов **Действия** можно применить поиск. В окне **Свойства** в нижней части страницы введите значение **IterateSQLTables** в поле **Имя**. 

    ![Имя действия ForEach](./media/tutorial-bulk-copy-portal/for-each-activity-name.png)
5. Перейдите на вкладку **Параметры** и введите `@pipeline().parameters.tableList` в качестве значения для параметра **Элементы**.

    ![Настройки действия ForEach](./media/tutorial-bulk-copy-portal/for-each-activity-settings.png)
6. Чтобы добавить дочернее действие к действию **ForEach**, **дважды щелкните** существующее действие ForEach или щелкните **значок редактирования** (карандаш). Ссылки на действия отображаются только для выбранного действия. 

    ![Имя действия ForEach](./media/tutorial-bulk-copy-portal/edit-for-each-activity.png)
7. На панели элементов **Действия** разверните **DataFlow** (Поток данных) и перетащите действие **Копирование** в область конструктора конвейера, а затем измените имя в окне "Свойства" на **CopyData**. Обратите внимание на строку навигации вверху. Здесь IterateAndCopySQLTable — это имя конвейера, а IterateSQLTables — имя действия ForEach. Конструктор находится в области действия. Чтобы снова переключиться в редактор конвейера из редактора ForEach, щелкните ссылку в этом меню навигации. 

    ![Копирование в цикле ForEach](./media/tutorial-bulk-copy-portal/copy-in-for-each.png)
8. Перейдите на вкладку **Источник** и выполните здесь следующие действия:

    1. Выберите **AzureSqlDatabaseDataset** в списке **Source Dataset** (Исходный набор данных). 
    2. Выберите вариант **Запрос** для параметра **Пользовательский запрос**. 
    3. Введите следующий запрос SQL в поле **Запрос**.

        ```sql
        SELECT * FROM [@{item().TABLE_SCHEMA}].[@{item().TABLE_NAME}]
        ``` 

        ![Параметры источника копирования](./media/tutorial-bulk-copy-portal/copy-source-settings.png)
9. Перейдите на вкладку **Приемник** и выполните здесь следующие действия: 

    1. Выберите **AzureSqlDWDataset** в списке **Sink Dataset** (Целевой набор данных).
    2. Разверните раздел **Параметры Polybase** и выберите вариант **Allow polybase** (Разрешить polybase). 
    3. Очистите параметр **Use Type default** (Тип по умолчанию). 
    4. Введите следующий скрипт SQL в область **Скрипт очистки**. 

        ```sql
        TRUNCATE TABLE [@{item().TABLE_SCHEMA}].[@{item().TABLE_NAME}]
        ```

        ![Параметры приемника копирования](./media/tutorial-bulk-copy-portal/copy-sink-settings.png)
10. Перейдите на вкладку **Параметры**, при необходимости прокрутите вниз до раздела **Sink Dataset** (Набор данных приемника), где вы найдете параметр **DWTableName**. Задайте для этого параметра значение `[@{item().TABLE_SCHEMA}].[@{item().TABLE_NAME}]`.

    ![Параметры приемника копирования](./media/tutorial-bulk-copy-portal/copy-sink-parameters.png)
11. Перейдите на вкладку **Настройки** и выполните здесь следующие действия: 

    1. Выберите **True** (Истина) для параметра **Enable Staging** (Использовать промежуточное хранилище).
    2. Выберите **AzureStorageLinkedService** в списке **Store Account Linked Service** (Связанная служба учетной записи хранилища).

        ![Включить промежуточный режим](./media/tutorial-bulk-copy-portal/copy-sink-staging-settings.png)
12. Чтобы проверить параметры конвейера, нажмите кнопку **Проверить**. Убедитесь, что проверка завершается без ошибок. Чтобы закрыть **отчет о проверке конвейера**, нажмите кнопку **>>**.

    ![Пример отчета о проверке конвейера](./media/tutorial-bulk-copy-portal/first-pipeline-validation-report.png)

### <a name="create-the-pipeline-gettablelistandtriggercopydata"></a>Создание конвейера GetTableListAndTriggerCopyData

Этот конвейер выполняет два действия:

* Ищет системную таблицу базы данных SQL Azure, чтобы получить список таблиц для копирования.
* Активирует конвейер IterateAndCopySQLTables для выполнения копирования данных.

1. На левой панели нажмите кнопку **+ (плюс)** и выберите пункт **Конвейер**.

    ![Меню создания конвейера](./media/tutorial-bulk-copy-portal/new-pipeline-menu.png)
2. В окне "Свойства" укажите имя конвейера **GetTableListAndTriggerCopyData**. 

    ![Имя конвейера](./media/tutorial-bulk-copy-portal/second-pipeline-name.png)
3. На панели **Действия** разверните элемент **Общие** и перетащите действие **Поиск** в область конструктора конвейера, а затем выполните следующие действия:

    1. Введите **LookupTableList** в качестве значения для параметра **Имя**. 
    2. Введите **Получение списка таблиц из базы данных Azure SQL** в поле **Описание**.

        ![Действие поиска — страница общих сведений](./media/tutorial-bulk-copy-portal/lookup-general-page.png)
4. Перейдите на страницу **Настройки** и выполните здесь следующие действия.

    1. Выберите **AzureSqlDatabaseDataset** в списке **Source Dataset** (Исходный набор данных). 
    2. Выберите **Запрос** в списке **Пользовательский запрос**. 
    3. Введите следующий запрос SQL в поле **Запрос**.

        ```sql
        SELECT TABLE_SCHEMA, TABLE_NAME FROM information_schema.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_SCHEMA = 'SalesLT' and TABLE_NAME <> 'ProductModel'
        ```
    4. Снимите флажок для поля **First row only** (Только первая строка).

        ![Активность подстановки — страница параметров](./media/tutorial-bulk-copy-portal/lookup-settings-page.png)
5. Перетащите действие **Выполнить конвейер** из панели элементов "Действия" в область конструктора конвейера и задайте для него имя **TriggerCopy**.

    ![Действие выполнения конвейера — страница общих сведений](./media/tutorial-bulk-copy-portal/execute-pipeline-general-page.png)    
6. Перейдите на страницу **Настройки** и выполните здесь следующие действия. 

    1. Выберите **IterateAndCopySQLTables** в списке **Вызываемый конвейер**. 
    2. Разверните раздел **Дополнительно**. 
    3. Щелкните **+ Создать** в разделе **Параметры**. 
    4. Введите **tableList** в качестве **имени** параметра.
    5. Введите `@activity('LookupTableList').output.value` в качестве **значения** параметра. Теперь список результатов, полученных от действия поиска, будет использоваться как входные данные для второго конвейера. Список результатов содержит список таблиц, данные которых нужно скопировать в место назначения. 

        ![Действие выполнения конвейера — страница настроек](./media/tutorial-bulk-copy-portal/execute-pipeline-settings-page.png)
7. **Подключите** действие **Поиск** к действию **Выполнение конвейера**, перетащив **зеленое поле** от действия поиска к действию выполнения конвейера слева.

    ![Соединение действий поиска и выполнения конвейера](./media/tutorial-bulk-copy-portal/connect-lookup-execute-pipeline.png)
8. Чтобы проверить работу конвейера, нажмите кнопку **Проверка** на панели инструментов. Убедитесь, что проверка завершается без ошибок. Чтобы закрыть **отчет о проверке конвейера**, нажмите кнопку **>>**.

    ![Второй конвейер — отчет о проверке](./media/tutorial-bulk-copy-portal/second-pipeline-validation-report.png)
9. Чтобы опубликовать сущности (наборы данных, конвейеры, т. д.) в службе фабрики данных, щелкните **Опубликовать все**. Подождите, пока публикация успешно завершится. 

    ![Кнопка "Опубликовать"](./media/tutorial-bulk-copy-portal/publish.png)

## <a name="trigger-a-pipeline-run"></a>Активация выполнения конвейера

1. Убедитесь, что активна вкладка **GetTableListAndTriggerCopyData**. 
2. Щелкните **Триггер**, а затем — **Trigger Now** (Запустить сейчас). 

    ![Trigger Now (Активировать сейчас)](./media/tutorial-bulk-copy-portal/trigger-now.png)

## <a name="monitor-the-pipeline-run"></a>Выполнили мониторинг конвейера.

1. Перейдите на вкладку **Мониторинг**. Убедитесь, что здесь отображаются запуски обоих конвейеров. Если их еще нет, нажмите кнопку **Обновить**. Продолжайте обновлять отображение списка, пока не отобразится состояние **Успешно**. 

    ![Запуски конвейера](./media/tutorial-bulk-copy-portal/pipeline-runs.png)
2. Чтобы просмотреть запуски действий, связанные с конвейером GetTableListAndTriggerCopyData, щелкните первую ссылку в разделе действий для этого конвейера. Вы увидите два запуска действий для этого запуска конвейера. 

    ![Выполнение действия](./media/tutorial-bulk-copy-portal/activity-runs-1.png)    
3. Чтобы просмотреть выходные данные действия **Поиск**, щелкните ссылку в столбце **Выходные данные** для этого действия. Окно **Выходные данные** можно развернуть и восстановить. Завершив просмотр, нажмите кнопку **X**, чтобы закрыть окно **Выходные данные**.

    ```json
    {
        "count": 9,
        "value": [
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "Customer"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "ProductDescription"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "Product"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "ProductModelProductDescription"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "ProductCategory"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "Address"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "CustomerAddress"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "SalesOrderDetail"
            },
            {
                "TABLE_SCHEMA": "SalesLT",
                "TABLE_NAME": "SalesOrderHeader"
            }
        ],
        "effectiveIntegrationRuntime": "DefaultIntegrationRuntime (East US)",
        "effectiveIntegrationRuntimes": [
            {
                "name": "DefaultIntegrationRuntime",
                "type": "Managed",
                "location": "East US",
                "billedDuration": 0,
                "nodes": null
            }
        ]
    }
    ```    
4. Чтобы вернуться к предыдущему представлению **Запуски конвейера**, щелкните ссылку **Конвейеры** в верхней части окна. Щелкните ссылку **View Activity Runs** (Просмотр запусков действий), которая стоит первой в столбце **Действия** для конвейера **IterateAndCopySQLTables**. Вы увидите примерно такие результаты, как на следующем рисунке. Обратите внимание, что здесь отображается одно действие **копирования** для каждой таблицы из выходных данных действия **Поиск**. 

    ![Выполнение действия](./media/tutorial-bulk-copy-portal/activity-runs-2.png)
5. Убедитесь, что нужные данные скопированы в хранилище данных SQL, которое вы использовали в этом руководстве в качестве приемника. 

## <a name="next-steps"></a>Дополнительная информация
В этом руководстве вы выполнили следующие шаги: 

> [!div class="checklist"]
> * создадите фабрику данных;
> * Создание связанных служб базы данных SQL Azure, хранилища данных SQL Azure и службы хранилища Azure.
> * Создание наборов данных базы данных SQL Azure и хранилища данных SQL.
> * Создание конвейера для поиска таблиц, которые нужно скопировать, и конвейера для выполнения операции копирования. 
> * Запуск конвейера.
> * Мониторинг конвейера и выполнения действий.

Перейдите к следующему руководству, чтобы узнать о копировании данных по шагам из источника в место назначения:
> [!div class="nextstepaction"]
>[Пошаговая загрузка данных из базы данных SQL Azure в хранилище BLOB-объектов Azure](tutorial-incremental-copy-portal.md)