---
title: Аутентификация и авторизация в служебной шине Azure | Документация Майкрософт
description: Аутентификация приложений в служебной шине с помощью аутентификации на основе подписанного URL-адреса (SAS).
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: ''
ms.assetid: 18bad0ed-1cee-4a5c-a377-facc4785c8c9
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/14/2017
ms.author: sethm
ms.openlocfilehash: b8b5887f2003dd793ae7a50f066b893f685002a0
ms.sourcegitcommit: 9a61faf3463003375a53279e3adce241b5700879
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2017
ms.locfileid: "24813935"
---
# <a name="service-bus-authentication-and-authorization"></a>Аутентификация и авторизация в служебной шине

Приложения могут получать доступ к ресурсам служебной шины Azure с помощью проверки подлинности по маркерам на основе подписанного URL-адреса (SAS). При использовании подписанного URL-адреса (SAS) приложения представляют служебной шине маркер, подписанный симметричным ключом, известным как поставщику маркеров, так и служебной шине (то есть "общим"). Этот ключ непосредственно связан с правилом предоставления определенных прав доступа (например, разрешение получать, прослушивать или отправлять сообщения). Правила SAS можно настроить в пространстве имен или непосредственно в сущностях, таких как очередь или раздел. Они позволяют осуществлять более точное управление доступом.

Маркеры SAS могут быть созданы непосредственно в клиенте служебной шины или с помощью промежуточного маркера, выдающего конечную точку, с которой взаимодействует клиент. Например, для подтверждения удостоверения и прав доступа системе может понадобиться, чтобы клиент вызвал конечную точку веб-службы, защищенную с помощью авторизации Active Directory. Затем веб-служба вернет соответствующий маркер служебной шины. Этот маркер SAS можно легко создать, используя включенный в пакет Azure SDK поставщик маркеров служебной шины. 

> [!IMPORTANT]
> Если вы используете службу контроля доступа Azure Active Directory (также известна как служба контроля доступа или ACS) вместе со служебной шиной, обратите внимание, что сейчас поддержка этого метода ограничена и вам необходимо использовать в приложении подписанный URL-адрес (SAS). Дополнительные сведения см. в [этой записи блога](https://blogs.msdn.microsoft.com/servicebus/2017/06/01/upcoming-changes-to-acs-enabled-namespaces/) и в [этой статье](service-bus-migrate-acs-sas.md).

## <a name="shared-access-signature-authentication"></a>Проверка подлинности с помощью подписанного URL-адреса

[Проверка подлинности SAS](service-bus-sas.md) позволяет предоставлять пользователю доступ к ресурсам служебной шины с определенными правами. Проверка подлинности SAS в служебной шине предусматривает настройку соответствующих прав для криптографического ключа в ресурсе служебной шины. Затем клиенты могут получить доступ к этому ресурсу. Для этого им нужно предоставить маркер SAS, который состоит из универсального кода ресурса (URI) данного ресурса, а также указать срок действия, подписанный с использованием настроенного ключа.

Ключи для SAS можно настроить в пространстве имен служебной шины. Ключ применяется ко всем сущностям обмена сообщениями в пределах этого пространства имен. Также можно настроить ключи для очередей и разделов служебной шины. Кроме того, SAS поддерживается в [ретрансляторе Azure](../service-bus-relay/relay-authentication-and-authorization.md).

Чтобы использовать SAS, в пространстве имен, очереди или разделе можно настроить объект [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule). Это правило состоит из трех элементов:

* *KeyName* — определяет правило.
* *PrimaryKey* — криптографический ключ, используемый для подписи и проверки маркеров SAS.
* *SecondaryKey* — криптографический ключ, используемый для подписи и проверки маркеров SAS.
* *Rights* — набор прав **Listen** (Прослушивание), **Send** (Отправка) или **Manage** (Управление).

Правила авторизации, настроенные на уровне пространства имен, могут предоставлять доступ ко всем сущностям в пространстве имен для клиентов с маркерами, подписанными с использованием соответствующего ключа. В пространстве имен, очереди или разделе служебной шины можно настроить до 12 таких правил авторизации. По умолчанию правило [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) со всеми правами настраивается для каждого пространства имен в ходе первоначальной подготовки.

Чтобы получить доступ к сущности, клиенту требуется маркер SAS, созданный с помощью определенного правила [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule). Маркер SAS создается с помощью хэш-функции HMAC-SHA256 строки ресурса, состоящей из URI ресурса, к которому запрашивается доступ, и срока действия с криптографическим ключом, связанным с правилом авторизации.

Поддержка проверки подлинности SAS для служебной шины включена в пакет Azure SDK для .NET 2.0 и более поздних версий. SAS включает в себя поддержку правила [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule). Все интерфейсы API, которые принимают строку подключения в качестве параметра, поддерживают строки подключения SAS.

## <a name="next-steps"></a>Дополнительная информация

- Дополнительные сведения о SAS см. в статье [Аутентификация служебной шины с помощью подписанных URL-адресов](service-bus-sas.md).
- [Переход от службы контроля доступа Azure Active Directory к авторизации подписанного URL-адреса](service-bus-migrate-acs-sas.md).
- [Изменения пространств имен с поддержкой ACS](https://blogs.msdn.microsoft.com/servicebus/2017/06/01/upcoming-changes-to-acs-enabled-namespaces/).
- Соответствующую информацию об аутентификации и авторизации с помощью ретранслятора Azure см. в разделе [Проверка подлинности и авторизация в ретрансляторе Azure](../service-bus-relay/relay-authentication-and-authorization.md). 

